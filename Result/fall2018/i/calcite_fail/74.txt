(SELECT DISTINCT name FROM drinker) EXCEPT (WITH badbars AS (WITH notlikes AS ((SELECT drinker.name AS person, beer.name AS drink FROM drinker, beer) EXCEPT (SELECT * FROM likes)) SELECT DISTINCT notlikes.person, serves.bar FROM notlikes, serves WHERE notlikes.drink=serves.beer) SELECT DISTINCT frequents.drinker FROM frequents, badbars WHERE frequents.drinker=badbars.person AND frequents.bar=badbars.bar);
