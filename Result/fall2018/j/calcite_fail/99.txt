select name, bar from (((select barname as bar, name from (select name as barname, address as addressname from bar) as bar1, bar where barname != name) EXCEPT ((select distinct bar, name from (select name as bar, bar as name, beer from ((select name, bar, beer from serves, bar where name != bar) EXCEPT ALL (select bar, name, beer from serves, bar where bar != name)) as whole) as new_whole))) INTERSECT ALL (select distinct bar, name from ((select bar, name, beer from serves, bar) EXCEPT ALL (select name as bar_name, bar as bar_serves, beer as beer_name from serves, bar where name != bar)) as new where bar != name)) as final;