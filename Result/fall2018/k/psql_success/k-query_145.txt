(SELECT name, COALESCE(amount, 0) FROM (SELECT bar2.name, amount FROM (SELECT bar, SUM(price) AS amount FROM (SELECT drinker, bar, (SUM(price) * times_a_week) AS price FROM (frequents NATURAL JOIN likes NATURAL JOIN serves) WHERE frequents.drinker = likes.drinker AND beer IN (SELECT beer FROM likes WHERE drinker = frequents.drinker) GROUP BY bar, drinker) AS perperson GROUP BY bar) AS profits RIGHT OUTER JOIN (SELECT name FROM bar) AS bar2 ON bar2.name = profits.bar) AS allbars) ORDER BY amount DESC NULLS LAST, name;