SELECT bar,sum FROM ((SELECT bar, SUM(money) FROM (SELECT bar, times_a_week*price AS money FROM (SELECT frequents.bar,frequents.drinker,frequents.times_a_week,serves.beer,serves.price FROM serves,likes,frequents WHERE frequents.bar = serves.bar AND likes.beer = serves.beer AND frequents.drinker = likes.drinker) as subTable) AS sub GROUP BY bar )UNION (SELECT bar, 0.0 FROM ((SELECT name AS bar FROM bar)EXCEPT(SELECT bar FROM (SELECT bar, SUM(money) FROM (SELECT bar, times_a_week*price AS money FROM (SELECT frequents.bar,frequents.drinker,frequents.times_a_week,serves.beer,serves.price FROM serves,likes,frequents WHERE frequents.bar = serves.bar AND likes.beer = serves.beer AND frequents.drinker = likes.drinker) as subTable) AS sub GROUP BY bar)AS T)) AS GIT))as G ORDER BY sum DESC,bar;

