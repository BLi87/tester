--Worked with Richard Vargo
select * from (select name, coalesce (sum,0) as total from (select name, sum from bar b left outer join (select bar, sum(money) from (select bar,drinker,price*times_a_week as money from (select * from likes natural join (select * from serves natural join frequents) as bleh) as jesus) as legend group by bar) as gg on gg.bar = b.name) as goat) as final_res order by total desc, name;