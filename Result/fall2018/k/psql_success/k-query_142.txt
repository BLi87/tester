select bar, sum from ((select serves.bar, sum(serves.price*frequents.times_a_week) from serves, frequents, likes where serves.bar=frequents.bar and likes.drinker=frequents.drinker and serves.beer=likes.beer group by serves.bar) union (select distinct bar.name, serves.price-serves.price from bar, serves where bar.name in ((select bar.name from bar) except (select serves.bar from serves, frequents, likes where serves.bar=frequents.bar and likes.drinker=frequents.drinker and serves.beer=likes.beer group by serves.bar)))) as foo order by sum desc, bar asc