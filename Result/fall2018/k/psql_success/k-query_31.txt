SELECT res1.bar, res1.amount FROM (SELECT bar, sum(price * times_a_week) amount FROM (select drinker, frequents.bar, times_a_week, beer, price FROM frequents JOIN serves on frequents.bar = serves.bar) AS t1 join likes on t1.beer = likes.beer where t1.drinker = likes.drinker group by bar UNION SELECT x1.bar, round(serves.price-serves.price) amount from (select name as bar from bar except select bar from (select drinker, frequents.bar, times_a_week, beer, price from frequents join serves on frequents.bar = serves.bar) as t2 join likes on t2.beer = likes.beer where t2.drinker = likes.drinker) as x1, serves) as res1 order by res1.amount desc, res1.bar asc;