select a.name,sum(rev) from ((select r.name, sum(revenue) as rev  from (select frequents.drinker,bar.name,likes.beer,serves.price*times_a_week as revenue from frequents,likes,serves,bar where bar.name = frequents.bar and bar.name = serves.bar and frequents.drinker = likes.drinker and frequents.bar = serves.bar and serves.beer = likes.beer) as r group by r.name order by rev desc,r.name) union all select bar.name,case when bar.name = 'The Edge' THEN cast (0 as numeric) else cast (0 as numeric) end from bar) as a group by a.name order by sum desc,a.name;