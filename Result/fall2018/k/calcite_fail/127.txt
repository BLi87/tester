SELECT b.name, SUM(s.price * f.times_a_week) FROM Bar AS b, Serves AS s, Frequents As f WHERE s.beer IN (SELECT l.beer FROM Likes AS l WHERE l.drinker IN (SELECT f.drinker WHERE f.bar = s.bar AND f.bar = b.name)) GROUP BY b.name UNION SELECT b.name, 0 FROM Bar AS b WHERE NOT EXISTS (SELECT s.beer FROM Serves AS s WHERE NOT EXISTS (SELECT 1.beer FROM Likes AS l WHERE l.drinker IN (SELECT drinker FROM Frequents WHERE bar=b.name AND s.bar=b.name AND s.beer = l.beer))) ORDER BY 2 DESC,1 ASC;
