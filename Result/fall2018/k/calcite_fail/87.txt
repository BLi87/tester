SELECT bar, SUM(sale) FROM (SELECT * FROM (SELECT bar, price * times_a_week sale FROM (SELECT drinker, Frequents.bar, times_a_week, beer, price FROM Frequents JOIN Serves ON Frequents.bar = Serves.bar) AS join1 JOIN Likes ON join1.beer = Likes.beer WHERE join1.drinker = Likes.drinker) as join2 UNION ALL SELECT join4.name bar, times_a_week - times_a_week FROM (SELECT name FROM bar EXCEPT SELECT bar FROM (SELECT bar, price * times_a_week sale FROM (SELECT drinker, Frequents.bar, times_a_week, beer, price FROM Frequents JOIN Serves ON Frequents.bar = Serves.bar) AS join1 JOIN Likes ON join1.beer = Likes.beer WHERE join1.drinker = Likes.drinker) AS join3) AS join4 CROSS JOIN Frequents) AS join5 GROUP BY bar ORDER BY sum DESC, bar ASC;