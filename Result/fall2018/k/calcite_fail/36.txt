SELECT name, COALESCE(amount, 0) AS amount FROM bar LEFT JOIN (SELECT bar, SUM(total) AS amount  FROM (SELECT frequents.drinker, frequents.bar, frequents.times_a_week, likes.beer, serves.price, times_a_week*price AS total FROM frequents JOIN serves ON frequents.bar = serves.bar JOIN likes ON likes.beer = serves.beer AND frequents.drinker = likes.drinker) AS foo GROUP BY bar) AS foo2 ON bar.name = foo2.bar ORDER BY amount DESC, name;