SELECT bar, SUM(amt) amt FROM ((SELECT DISTINCT bar, SUM(price * times_a_week) amt FROM serves NATURAL JOIN likes NATURAL JOIN frequents GROUP BY bar) UNION (SELECT name, 0 FROM bar)) a2 GROUP BY bar ORDER BY amt DESC, bar;