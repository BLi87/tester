"select beer, bar
from serves
where beer in (select beer from likes where drinker = 'Dan')
except
select s1.beer, s1.bar
from serves s1, serves s2
where s1.beer = s2.beer
  and s1.price < s2.price
  and s1.beer in (select beer from likes where drinker = 'Dan')","{""blocks"":{""id"":""BLOCK_SETOP@4bdcaf36"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@64030b91"",""rightBlockId"":""BLOCK_SELECT@af78c87"",""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":9,""endColumnNum"":63,""quoted"":false},""children"":{""BLOCK_SELECT@af78c87"":{""id"":""BLOCK_SELECT@af78c87"",""parentId"":""BLOCK_SETOP@4bdcaf36"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@59546cfe"",""value"":""NS_IDENT@3fa76c61.BEER"",""pos"":{""lineNum"":5,""columnNum"":8,""endLineNum"":5,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2d2acd89"",""value"":""NS_IDENT@3fa76c61.BAR"",""pos"":{""lineNum"":5,""columnNum"":17,""endLineNum"":5,""endColumnNum"":22,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@3fa76c61"",""NS_IDENT@2d5f7182""],""fromNode"":{""id"":""OP_JOIN@55cff952"",""value"":""COMMA"",""pos"":{""lineNum"":6,""columnNum"":15,""endLineNum"":6,""endColumnNum"":15,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@4a55a6e8"",""value"":""NS_IDENT@3fa76c61"",""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@8c46918"",""value"":""NS_IDENT@2d5f7182"",""pos"":{""lineNum"":6,""columnNum"":17,""endLineNum"":6,""endColumnNum"":22,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@60d1b21f"",""value"":""AND"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":9,""endColumnNum"":62,""quoted"":false},""children"":[{""id"":""OP_BINARY@4e2916c3"",""value"":""AND"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":8,""endColumnNum"":25,""quoted"":false},""children"":[{""id"":""OP_BINARY@6fd1660"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@2a27cb34"",""value"":""NS_IDENT@3fa76c61.beer"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6892cc6f"",""value"":""NS_IDENT@2d5f7182.beer"",""pos"":{""lineNum"":7,""columnNum"":17,""endLineNum"":7,""endColumnNum"":23,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@20095ab4"",""value"":""<"",""pos"":{""lineNum"":8,""columnNum"":7,""endLineNum"":8,""endColumnNum"":25,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4a6c18ad"",""value"":""NS_IDENT@3fa76c61.price"",""pos"":{""lineNum"":8,""columnNum"":7,""endLineNum"":8,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5e8604bf"",""value"":""NS_IDENT@2d5f7182.price"",""pos"":{""lineNum"":8,""columnNum"":18,""endLineNum"":8,""endColumnNum"":25,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@ae7950d"",""value"":""IN"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":62,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@64aad6db"",""value"":""NS_IDENT@3fa76c61.beer"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@773dab28"",""value"":""BLOCK_SELECT@773dab28"",""pos"":{""lineNum"":9,""columnNum"":19,""endLineNum"":9,""endColumnNum"":62,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@2d2acd89"",""value"":""NS_IDENT@3fa76c61.BAR"",""pos"":{""lineNum"":5,""columnNum"":17,""endLineNum"":5,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4a6c18ad"",""value"":""NS_IDENT@3fa76c61.price"",""pos"":{""lineNum"":8,""columnNum"":7,""endLineNum"":8,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5e8604bf"",""value"":""NS_IDENT@2d5f7182.price"",""pos"":{""lineNum"":8,""columnNum"":18,""endLineNum"":8,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6892cc6f"",""value"":""NS_IDENT@2d5f7182.beer"",""pos"":{""lineNum"":7,""columnNum"":17,""endLineNum"":7,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@59546cfe"",""value"":""NS_IDENT@3fa76c61.BEER"",""pos"":{""lineNum"":5,""columnNum"":8,""endLineNum"":5,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2a27cb34"",""value"":""NS_IDENT@3fa76c61.beer"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@64aad6db"",""value"":""NS_IDENT@3fa76c61.beer"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":13,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":5,""columnNum"":1,""endLineNum"":9,""endColumnNum"":63,""quoted"":false},""children"":{""BLOCK_SELECT@773dab28"":{""id"":""BLOCK_SELECT@773dab28"",""parentId"":""BLOCK_SELECT@af78c87"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@621f89b8"",""value"":""NS_IDENT@540dbda9.BEER"",""pos"":{""lineNum"":9,""columnNum"":26,""endLineNum"":9,""endColumnNum"":29,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@540dbda9""],""fromNode"":{""id"":""JOIN_OPERAND@1ecfcbc9"",""value"":""NS_IDENT@540dbda9"",""pos"":{""lineNum"":9,""columnNum"":36,""endLineNum"":9,""endColumnNum"":40,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@3d43fe"",""value"":""="",""pos"":{""lineNum"":9,""columnNum"":48,""endLineNum"":9,""endColumnNum"":62,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4ed38226"",""value"":""NS_IDENT@540dbda9.drinker"",""pos"":{""lineNum"":9,""columnNum"":48,""endLineNum"":9,""endColumnNum"":54,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@53e3a87a"",""value"":""'Dan'"",""pos"":{""lineNum"":9,""columnNum"":58,""endLineNum"":9,""endColumnNum"":62,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@621f89b8"",""value"":""NS_IDENT@540dbda9.BEER"",""pos"":{""lineNum"":9,""columnNum"":26,""endLineNum"":9,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4ed38226"",""value"":""NS_IDENT@540dbda9.drinker"",""pos"":{""lineNum"":9,""columnNum"":48,""endLineNum"":9,""endColumnNum"":54,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":9,""columnNum"":19,""endLineNum"":9,""endColumnNum"":62,""quoted"":false},""children"":{}}}},""BLOCK_SELECT@64030b91"":{""id"":""BLOCK_SELECT@64030b91"",""parentId"":""BLOCK_SETOP@4bdcaf36"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@2e3cdec2"",""value"":""NS_IDENT@287f7811.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3051e0b2"",""value"":""NS_IDENT@287f7811.BAR"",""pos"":{""lineNum"":1,""columnNum"":14,""endLineNum"":1,""endColumnNum"":16,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@287f7811""],""fromNode"":{""id"":""JOIN_OPERAND@4158debd"",""value"":""NS_IDENT@287f7811"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":11,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@48c3205a"",""value"":""IN"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":59,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1949309d"",""value"":""NS_IDENT@287f7811.beer"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@66e889df"",""value"":""BLOCK_SELECT@66e889df"",""pos"":{""lineNum"":3,""columnNum"":16,""endLineNum"":3,""endColumnNum"":59,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@2e3cdec2"",""value"":""NS_IDENT@287f7811.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1949309d"",""value"":""NS_IDENT@287f7811.beer"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3051e0b2"",""value"":""NS_IDENT@287f7811.BAR"",""pos"":{""lineNum"":1,""columnNum"":14,""endLineNum"":1,""endColumnNum"":16,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":3,""endColumnNum"":60,""quoted"":false},""children"":{""BLOCK_SELECT@66e889df"":{""id"":""BLOCK_SELECT@66e889df"",""parentId"":""BLOCK_SELECT@64030b91"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@6ed06f69"",""value"":""NS_IDENT@58294867.BEER"",""pos"":{""lineNum"":3,""columnNum"":23,""endLineNum"":3,""endColumnNum"":26,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@58294867""],""fromNode"":{""id"":""JOIN_OPERAND@22d1886d"",""value"":""NS_IDENT@58294867"",""pos"":{""lineNum"":3,""columnNum"":33,""endLineNum"":3,""endColumnNum"":37,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@5a6482a9"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":45,""endLineNum"":3,""endColumnNum"":59,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@67403656"",""value"":""NS_IDENT@58294867.drinker"",""pos"":{""lineNum"":3,""columnNum"":45,""endLineNum"":3,""endColumnNum"":51,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@39109136"",""value"":""'Dan'"",""pos"":{""lineNum"":3,""columnNum"":55,""endLineNum"":3,""endColumnNum"":59,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@6ed06f69"",""value"":""NS_IDENT@58294867.BEER"",""pos"":{""lineNum"":3,""columnNum"":23,""endLineNum"":3,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@67403656"",""value"":""NS_IDENT@58294867.drinker"",""pos"":{""lineNum"":3,""columnNum"":45,""endLineNum"":3,""endColumnNum"":51,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":16,""endLineNum"":3,""endColumnNum"":59,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@287f7811"":{""tableId"":""NS_IDENT@287f7811"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":11,""quoted"":false}},""NS_IDENT@3fa76c61"":{""tableId"":""NS_IDENT@3fa76c61"",""identifier"":""S1"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":14,""quoted"":false}},""NS_IDENT@540dbda9"":{""tableId"":""NS_IDENT@540dbda9"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":9,""columnNum"":36,""endLineNum"":9,""endColumnNum"":40,""quoted"":false}},""NS_IDENT@58294867"":{""tableId"":""NS_IDENT@58294867"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":33,""endLineNum"":3,""endColumnNum"":37,""quoted"":false}},""NS_IDENT@2d5f7182"":{""tableId"":""NS_IDENT@2d5f7182"",""identifier"":""S2"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":17,""endLineNum"":6,""endColumnNum"":25,""quoted"":false}}},""corrTables"":[]}
"
"with dan_likes as
  (
    select s.*
    from serves s, likes l
    where l.drinker = 'Dan' and s.beer = l.beer
  ),
  highest_price as (
    select beer, max(price)
    from dan_likes
    group by beer
  )
   
   
select serves.beer, serves.bar
  from serves, highest_price
  where serves.beer = highest_price.beer and serves.price = highest_price.max
","{""failed"":true,""errorMsg"":""Parsing error at line 16, column 74. Query syntax may be incorrect""}
"
"WITH maxs AS (SELECT beer, max(price) as price
  FROM serves as s1
  GROUP BY beer),
  danbeers AS (SELECT beer FROM likes WHERE drinker = 'Dan')
SELECT serves.beer, serves.bar
FROM serves, maxs, danbeers
WHERE serves.beer = maxs.beer and serves.price = maxs.price and serves.beer IN(danbeers.beer);","{""blocks"":{""id"":""BLOCK_SELECT@5ecba515"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@58399d82"",""value"":""NS_IDENT@5c645b43.BEER"",""pos"":{""lineNum"":5,""columnNum"":8,""endLineNum"":5,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@46d8f407"",""value"":""NS_IDENT@5c645b43.BAR"",""pos"":{""lineNum"":5,""columnNum"":21,""endLineNum"":5,""endColumnNum"":30,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@5c645b43"",""NS_IDENT@6bd16207"",""NS_IDENT@298d9a05""],""fromNode"":{""id"":""OP_JOIN@102d92c4"",""value"":""COMMA"",""pos"":{""lineNum"":6,""columnNum"":18,""endLineNum"":6,""endColumnNum"":18,""quoted"":false},""children"":[{""id"":""OP_JOIN@2b97cc1f"",""value"":""COMMA"",""pos"":{""lineNum"":6,""columnNum"":12,""endLineNum"":6,""endColumnNum"":12,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@60723d6a"",""value"":""NS_IDENT@5c645b43"",""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@18324f97"",""value"":""NS_IDENT@6bd16207"",""pos"":{""lineNum"":6,""columnNum"":14,""endLineNum"":6,""endColumnNum"":17,""quoted"":false},""children"":[]}],""natural"":false},{""id"":""JOIN_OPERAND@abbc908"",""value"":""NS_IDENT@298d9a05"",""pos"":{""lineNum"":6,""columnNum"":20,""endLineNum"":6,""endColumnNum"":27,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@1f1cae23"",""value"":""AND"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":93,""quoted"":false},""children"":[{""id"":""OP_BINARY@60dd3c23"",""value"":""AND"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":59,""quoted"":false},""children"":[{""id"":""OP_BINARY@69c93ca4"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":29,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@60e5272"",""value"":""NS_IDENT@5c645b43.beer"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7d755813"",""value"":""NS_IDENT@6bd16207.BEER"",""pos"":{""lineNum"":7,""columnNum"":21,""endLineNum"":7,""endColumnNum"":29,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@40d10481"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":35,""endLineNum"":7,""endColumnNum"":59,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@63da207f"",""value"":""NS_IDENT@5c645b43.price"",""pos"":{""lineNum"":7,""columnNum"":35,""endLineNum"":7,""endColumnNum"":46,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@173373b4"",""value"":""NS_IDENT@6bd16207.PRICE"",""pos"":{""lineNum"":7,""columnNum"":50,""endLineNum"":7,""endColumnNum"":59,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@16a9a4f1"",""value"":""IN"",""pos"":{""lineNum"":7,""columnNum"":65,""endLineNum"":7,""endColumnNum"":93,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@52b6319f"",""value"":""NS_IDENT@5c645b43.beer"",""pos"":{""lineNum"":7,""columnNum"":65,""endLineNum"":7,""endColumnNum"":75,""quoted"":false},""children"":[]},{""id"":""NODE_LIST@7c455e96"",""pos"":{""lineNum"":7,""columnNum"":79,""endLineNum"":7,""endColumnNum"":93,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5e9456ae"",""value"":""NS_IDENT@298d9a05.BEER"",""pos"":{""lineNum"":7,""columnNum"":80,""endLineNum"":7,""endColumnNum"":92,""quoted"":false},""children"":[]}]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@7d755813"",""value"":""NS_IDENT@6bd16207.BEER"",""pos"":{""lineNum"":7,""columnNum"":21,""endLineNum"":7,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@173373b4"",""value"":""NS_IDENT@6bd16207.PRICE"",""pos"":{""lineNum"":7,""columnNum"":50,""endLineNum"":7,""endColumnNum"":59,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@63da207f"",""value"":""NS_IDENT@5c645b43.price"",""pos"":{""lineNum"":7,""columnNum"":35,""endLineNum"":7,""endColumnNum"":46,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@52b6319f"",""value"":""NS_IDENT@5c645b43.beer"",""pos"":{""lineNum"":7,""columnNum"":65,""endLineNum"":7,""endColumnNum"":75,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@46d8f407"",""value"":""NS_IDENT@5c645b43.BAR"",""pos"":{""lineNum"":5,""columnNum"":21,""endLineNum"":5,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@58399d82"",""value"":""NS_IDENT@5c645b43.BEER"",""pos"":{""lineNum"":5,""columnNum"":8,""endLineNum"":5,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@60e5272"",""value"":""NS_IDENT@5c645b43.beer"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5e9456ae"",""value"":""NS_IDENT@298d9a05.BEER"",""pos"":{""lineNum"":7,""columnNum"":80,""endLineNum"":7,""endColumnNum"":92,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":5,""columnNum"":1,""endLineNum"":7,""endColumnNum"":93,""quoted"":false},""children"":{}},""tables"":{""NS_IDENT@260f2144"":{""tableId"":""NS_IDENT@260f2144"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":33,""endLineNum"":4,""endColumnNum"":37,""quoted"":false}},""NS_IDENT@1eb6e1c"":{""tableId"":""NS_IDENT@1eb6e1c"",""identifier"":""S1"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":8,""endLineNum"":2,""endColumnNum"":19,""quoted"":false}},""NS_IDENT@6bd16207"":{""tableId"":""NS_IDENT@6bd16207"",""identifier"":""MAXS"",""dbTableName"":""MAXS"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":14,""endLineNum"":6,""endColumnNum"":17,""quoted"":false}},""NS_IDENT@298d9a05"":{""tableId"":""NS_IDENT@298d9a05"",""identifier"":""DANBEERS"",""dbTableName"":""DANBEERS"",""fields"":[""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":20,""endLineNum"":6,""endColumnNum"":27,""quoted"":false}},""NS_IDENT@5c645b43"":{""tableId"":""NS_IDENT@5c645b43"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":11,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@18a645fd"",""alias"":""MAXS"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@50d3bf39"",""value"":""NS_IDENT@1eb6e1c.BEER"",""pos"":{""lineNum"":1,""columnNum"":22,""endLineNum"":1,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@29852487"",""value"":""MAX"",""pos"":{""lineNum"":1,""columnNum"":28,""endLineNum"":1,""endColumnNum"":37,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@771db12c"",""value"":""NS_IDENT@1eb6e1c.PRICE"",""pos"":{""lineNum"":1,""columnNum"":32,""endLineNum"":1,""endColumnNum"":36,""quoted"":false},""children"":[]}],""alias"":""PRICE""}],""fromItemIds"":[""NS_IDENT@1eb6e1c""],""fromNode"":{""id"":""JOIN_OPERAND@201aa8c1"",""value"":""NS_IDENT@1eb6e1c"",""pos"":{""lineNum"":2,""columnNum"":8,""endLineNum"":2,""endColumnNum"":13,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@4fe875be"",""value"":""NS_IDENT@1eb6e1c.beer"",""pos"":{""lineNum"":3,""columnNum"":12,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@4fe875be"",""value"":""NS_IDENT@1eb6e1c.beer"",""pos"":{""lineNum"":3,""columnNum"":12,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@50d3bf39"",""value"":""NS_IDENT@1eb6e1c.BEER"",""pos"":{""lineNum"":1,""columnNum"":22,""endLineNum"":1,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@771db12c"",""value"":""NS_IDENT@1eb6e1c.PRICE"",""pos"":{""lineNum"":1,""columnNum"":32,""endLineNum"":1,""endColumnNum"":36,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":15,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@1ddd3478"",""alias"":""DANBEERS"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@3c017078"",""value"":""NS_IDENT@260f2144.BEER"",""pos"":{""lineNum"":4,""columnNum"":23,""endLineNum"":4,""endColumnNum"":26,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@260f2144""],""fromNode"":{""id"":""JOIN_OPERAND@68809cc7"",""value"":""NS_IDENT@260f2144"",""pos"":{""lineNum"":4,""columnNum"":33,""endLineNum"":4,""endColumnNum"":37,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@bdc8014"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":45,""endLineNum"":4,""endColumnNum"":59,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@736f3e9e"",""value"":""NS_IDENT@260f2144.drinker"",""pos"":{""lineNum"":4,""columnNum"":45,""endLineNum"":4,""endColumnNum"":51,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@1f443fae"",""value"":""'Dan'"",""pos"":{""lineNum"":4,""columnNum"":55,""endLineNum"":4,""endColumnNum"":59,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@3c017078"",""value"":""NS_IDENT@260f2144.BEER"",""pos"":{""lineNum"":4,""columnNum"":23,""endLineNum"":4,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@736f3e9e"",""value"":""NS_IDENT@260f2144.drinker"",""pos"":{""lineNum"":4,""columnNum"":45,""endLineNum"":4,""endColumnNum"":51,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":4,""columnNum"":16,""endLineNum"":4,""endColumnNum"":59,""quoted"":false},""children"":{}}]}
"
"WITH 
maxPrice AS
(SELECT beer, MAX(price) AS maxp
FROM serves
GROUP BY beer),

maxBar AS
(SELECT S.bar, S.beer
FROM serves S, maxPrice
WHERE maxPrice.beer = S.beer AND maxPrice.maxp = S.price)

SELECT M.beer, M.bar
FROM maxBar M
WHERE M.beer IN (SELECT beer FROM likes WHERE drinker = 'Dan');","{""blocks"":{""id"":""BLOCK_SELECT@5ecba515"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@6124287a"",""value"":""NS_IDENT@522ba524.BEER"",""pos"":{""lineNum"":12,""columnNum"":8,""endLineNum"":12,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@19569ebd"",""value"":""NS_IDENT@522ba524.BAR"",""pos"":{""lineNum"":12,""columnNum"":16,""endLineNum"":12,""endColumnNum"":20,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@522ba524""],""fromNode"":{""id"":""JOIN_OPERAND@13cd7ea5"",""value"":""NS_IDENT@522ba524"",""pos"":{""lineNum"":13,""columnNum"":6,""endLineNum"":13,""endColumnNum"":11,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@78de58ea"",""value"":""IN"",""pos"":{""lineNum"":14,""columnNum"":7,""endLineNum"":14,""endColumnNum"":61,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@432034a"",""value"":""NS_IDENT@522ba524.BEER"",""pos"":{""lineNum"":14,""columnNum"":7,""endLineNum"":14,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@512d4583"",""value"":""BLOCK_SELECT@512d4583"",""pos"":{""lineNum"":14,""columnNum"":18,""endLineNum"":14,""endColumnNum"":61,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@6124287a"",""value"":""NS_IDENT@522ba524.BEER"",""pos"":{""lineNum"":12,""columnNum"":8,""endLineNum"":12,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@432034a"",""value"":""NS_IDENT@522ba524.BEER"",""pos"":{""lineNum"":14,""columnNum"":7,""endLineNum"":14,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@19569ebd"",""value"":""NS_IDENT@522ba524.BAR"",""pos"":{""lineNum"":12,""columnNum"":16,""endLineNum"":12,""endColumnNum"":20,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":12,""columnNum"":1,""endLineNum"":14,""endColumnNum"":62,""quoted"":false},""children"":{""BLOCK_SELECT@512d4583"":{""id"":""BLOCK_SELECT@512d4583"",""parentId"":""BLOCK_SELECT@5ecba515"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@69c93ca4"",""value"":""NS_IDENT@185f7840.BEER"",""pos"":{""lineNum"":14,""columnNum"":25,""endLineNum"":14,""endColumnNum"":28,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@185f7840""],""fromNode"":{""id"":""JOIN_OPERAND@2abc224d"",""value"":""NS_IDENT@185f7840"",""pos"":{""lineNum"":14,""columnNum"":35,""endLineNum"":14,""endColumnNum"":39,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@1f1cae23"",""value"":""="",""pos"":{""lineNum"":14,""columnNum"":47,""endLineNum"":14,""endColumnNum"":61,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@16a9a4f1"",""value"":""NS_IDENT@185f7840.drinker"",""pos"":{""lineNum"":14,""columnNum"":47,""endLineNum"":14,""endColumnNum"":53,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@60dd3c23"",""value"":""'Dan'"",""pos"":{""lineNum"":14,""columnNum"":57,""endLineNum"":14,""endColumnNum"":61,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@16a9a4f1"",""value"":""NS_IDENT@185f7840.drinker"",""pos"":{""lineNum"":14,""columnNum"":47,""endLineNum"":14,""endColumnNum"":53,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@69c93ca4"",""value"":""NS_IDENT@185f7840.BEER"",""pos"":{""lineNum"":14,""columnNum"":25,""endLineNum"":14,""endColumnNum"":28,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":14,""columnNum"":18,""endLineNum"":14,""endColumnNum"":61,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@185f7840"":{""tableId"":""NS_IDENT@185f7840"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":14,""columnNum"":35,""endLineNum"":14,""endColumnNum"":39,""quoted"":false}},""NS_IDENT@522ba524"":{""tableId"":""NS_IDENT@522ba524"",""identifier"":""M"",""dbTableName"":""MAXBAR"",""fields"":[""BAR VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":13,""columnNum"":6,""endLineNum"":13,""endColumnNum"":13,""quoted"":false}},""NS_IDENT@50d3bf39"":{""tableId"":""NS_IDENT@50d3bf39"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":6,""endLineNum"":4,""endColumnNum"":11,""quoted"":false}},""NS_IDENT@6bd16207"":{""tableId"":""NS_IDENT@6bd16207"",""identifier"":""S"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":9,""columnNum"":6,""endLineNum"":9,""endColumnNum"":13,""quoted"":false}},""NS_IDENT@298d9a05"":{""tableId"":""NS_IDENT@298d9a05"",""identifier"":""MAXPRICE"",""dbTableName"":""MAXPRICE"",""fields"":[""BEER VARCHAR(100)"",""MAXP DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":9,""columnNum"":16,""endLineNum"":9,""endColumnNum"":23,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@1d207fad"",""alias"":""MAXPRICE"",""fields"":[""BEER VARCHAR(100)"",""MAXP DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@26ae880a"",""value"":""NS_IDENT@50d3bf39.BEER"",""pos"":{""lineNum"":3,""columnNum"":9,""endLineNum"":3,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@3c017078"",""value"":""MAX"",""pos"":{""lineNum"":3,""columnNum"":15,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@51827393"",""value"":""NS_IDENT@50d3bf39.PRICE"",""pos"":{""lineNum"":3,""columnNum"":19,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[]}],""alias"":""MAXP""}],""fromItemIds"":[""NS_IDENT@50d3bf39""],""fromNode"":{""id"":""JOIN_OPERAND@bdecc21"",""value"":""NS_IDENT@50d3bf39"",""pos"":{""lineNum"":4,""columnNum"":6,""endLineNum"":4,""endColumnNum"":11,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@4455f57d"",""value"":""NS_IDENT@50d3bf39.beer"",""pos"":{""lineNum"":5,""columnNum"":10,""endLineNum"":5,""endColumnNum"":13,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@4455f57d"",""value"":""NS_IDENT@50d3bf39.beer"",""pos"":{""lineNum"":5,""columnNum"":10,""endLineNum"":5,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@26ae880a"",""value"":""NS_IDENT@50d3bf39.BEER"",""pos"":{""lineNum"":3,""columnNum"":9,""endLineNum"":3,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@51827393"",""value"":""NS_IDENT@50d3bf39.PRICE"",""pos"":{""lineNum"":3,""columnNum"":19,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":2,""endLineNum"":5,""endColumnNum"":13,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@1440c311"",""alias"":""MAXBAR"",""fields"":[""BAR VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@58399d82"",""value"":""NS_IDENT@6bd16207.BAR"",""pos"":{""lineNum"":8,""columnNum"":9,""endLineNum"":8,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@46d8f407"",""value"":""NS_IDENT@6bd16207.BEER"",""pos"":{""lineNum"":8,""columnNum"":16,""endLineNum"":8,""endColumnNum"":21,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@6bd16207"",""NS_IDENT@298d9a05""],""fromNode"":{""id"":""OP_JOIN@f973499"",""value"":""COMMA"",""pos"":{""lineNum"":9,""columnNum"":14,""endLineNum"":9,""endColumnNum"":14,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@43cf6ea3"",""value"":""NS_IDENT@6bd16207"",""pos"":{""lineNum"":9,""columnNum"":6,""endLineNum"":9,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@37c5fc56"",""value"":""NS_IDENT@298d9a05"",""pos"":{""lineNum"":9,""columnNum"":16,""endLineNum"":9,""endColumnNum"":23,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@79ab34c1"",""value"":""AND"",""pos"":{""lineNum"":10,""columnNum"":7,""endLineNum"":10,""endColumnNum"":56,""quoted"":false},""children"":[{""id"":""OP_BINARY@736f3e9e"",""value"":""="",""pos"":{""lineNum"":10,""columnNum"":7,""endLineNum"":10,""endColumnNum"":28,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@49dbaaf3"",""value"":""NS_IDENT@298d9a05.BEER"",""pos"":{""lineNum"":10,""columnNum"":7,""endLineNum"":10,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@22d9c961"",""value"":""NS_IDENT@6bd16207.beer"",""pos"":{""lineNum"":10,""columnNum"":23,""endLineNum"":10,""endColumnNum"":28,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@73ba6fe6"",""value"":""="",""pos"":{""lineNum"":10,""columnNum"":34,""endLineNum"":10,""endColumnNum"":56,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@bdc8014"",""value"":""NS_IDENT@298d9a05.MAXP"",""pos"":{""lineNum"":10,""columnNum"":34,""endLineNum"":10,""endColumnNum"":46,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1f443fae"",""value"":""NS_IDENT@6bd16207.price"",""pos"":{""lineNum"":10,""columnNum"":50,""endLineNum"":10,""endColumnNum"":56,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@22d9c961"",""value"":""NS_IDENT@6bd16207.beer"",""pos"":{""lineNum"":10,""columnNum"":23,""endLineNum"":10,""endColumnNum"":28,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1f443fae"",""value"":""NS_IDENT@6bd16207.price"",""pos"":{""lineNum"":10,""columnNum"":50,""endLineNum"":10,""endColumnNum"":56,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@bdc8014"",""value"":""NS_IDENT@298d9a05.MAXP"",""pos"":{""lineNum"":10,""columnNum"":34,""endLineNum"":10,""endColumnNum"":46,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@46d8f407"",""value"":""NS_IDENT@6bd16207.BEER"",""pos"":{""lineNum"":8,""columnNum"":16,""endLineNum"":8,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@58399d82"",""value"":""NS_IDENT@6bd16207.BAR"",""pos"":{""lineNum"":8,""columnNum"":9,""endLineNum"":8,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@49dbaaf3"",""value"":""NS_IDENT@298d9a05.BEER"",""pos"":{""lineNum"":10,""columnNum"":7,""endLineNum"":10,""endColumnNum"":19,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":8,""columnNum"":2,""endLineNum"":10,""endColumnNum"":56,""quoted"":false},""children"":{}}]}
"
"With dan as (select beer from likes where drinker = 'Dan'), b as (select serves.beer, bar, price from dan INNER JOIN serves on dan.beer = serves.beer) select beer, bar from b WHERE price >= ALL (select price from serves WHERE b.beer = serves.beer);","{""blocks"":{""id"":""BLOCK_SELECT@189b5fb1"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@6093d508"",""value"":""NS_IDENT@7435a578.BEER"",""pos"":{""lineNum"":1,""columnNum"":159,""endLineNum"":1,""endColumnNum"":162,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3c7cfcbb"",""value"":""NS_IDENT@7435a578.BAR"",""pos"":{""lineNum"":1,""columnNum"":165,""endLineNum"":1,""endColumnNum"":167,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@7435a578""],""fromNode"":{""id"":""JOIN_OPERAND@f973499"",""value"":""NS_IDENT@7435a578"",""pos"":{""lineNum"":1,""columnNum"":174,""endLineNum"":1,""endColumnNum"":174,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@68ba310d"",""value"":"">= ALL"",""pos"":{""lineNum"":1,""columnNum"":182,""endLineNum"":1,""endColumnNum"":246,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5eb97ced"",""value"":""NS_IDENT@7435a578.PRICE"",""pos"":{""lineNum"":1,""columnNum"":182,""endLineNum"":1,""endColumnNum"":186,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@783ec989"",""value"":""BLOCK_SELECT@783ec989"",""pos"":{""lineNum"":1,""columnNum"":196,""endLineNum"":1,""endColumnNum"":246,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@3c7cfcbb"",""value"":""NS_IDENT@7435a578.BAR"",""pos"":{""lineNum"":1,""columnNum"":165,""endLineNum"":1,""endColumnNum"":167,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6093d508"",""value"":""NS_IDENT@7435a578.BEER"",""pos"":{""lineNum"":1,""columnNum"":159,""endLineNum"":1,""endColumnNum"":162,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5eb97ced"",""value"":""NS_IDENT@7435a578.PRICE"",""pos"":{""lineNum"":1,""columnNum"":182,""endLineNum"":1,""endColumnNum"":186,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@7435a578.BEER""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":152,""endLineNum"":1,""endColumnNum"":247,""quoted"":false},""children"":{""BLOCK_SELECT@783ec989"":{""id"":""BLOCK_SELECT@783ec989"",""parentId"":""BLOCK_SELECT@189b5fb1"",""fields"":[""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@6f667ad1"",""value"":""NS_IDENT@2b214b94.PRICE"",""pos"":{""lineNum"":1,""columnNum"":203,""endLineNum"":1,""endColumnNum"":207,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@2b214b94""],""fromNode"":{""id"":""JOIN_OPERAND@1ddd3478"",""value"":""NS_IDENT@2b214b94"",""pos"":{""lineNum"":1,""columnNum"":214,""endLineNum"":1,""endColumnNum"":219,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@765df79d"",""value"":""="",""pos"":{""lineNum"":1,""columnNum"":227,""endLineNum"":1,""endColumnNum"":246,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@388b401d"",""value"":""NS_IDENT@7435a578.BEER"",""pos"":{""lineNum"":1,""columnNum"":227,""endLineNum"":1,""endColumnNum"":232,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2bfbffb2"",""value"":""NS_IDENT@2b214b94.beer"",""pos"":{""lineNum"":1,""columnNum"":236,""endLineNum"":1,""endColumnNum"":246,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_CORRELATE@388b401d"",""value"":""NS_IDENT@7435a578.BEER"",""pos"":{""lineNum"":1,""columnNum"":227,""endLineNum"":1,""endColumnNum"":232,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2bfbffb2"",""value"":""NS_IDENT@2b214b94.beer"",""pos"":{""lineNum"":1,""columnNum"":236,""endLineNum"":1,""endColumnNum"":246,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6f667ad1"",""value"":""NS_IDENT@2b214b94.PRICE"",""pos"":{""lineNum"":1,""columnNum"":203,""endLineNum"":1,""endColumnNum"":207,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@7435a578""],""corrCtxIds"":[""BLOCK_SELECT@189b5fb1""],""pos"":{""lineNum"":1,""columnNum"":196,""endLineNum"":1,""endColumnNum"":246,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@736f3e9e"":{""tableId"":""NS_IDENT@736f3e9e"",""identifier"":""DAN"",""dbTableName"":""DAN"",""fields"":[""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":103,""endLineNum"":1,""endColumnNum"":105,""quoted"":false}},""NS_IDENT@4f186450"":{""tableId"":""NS_IDENT@4f186450"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":31,""endLineNum"":1,""endColumnNum"":35,""quoted"":false}},""NS_IDENT@7435a578"":{""tableId"":""NS_IDENT@7435a578"",""identifier"":""B"",""dbTableName"":""B"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":174,""endLineNum"":1,""endColumnNum"":174,""quoted"":false}},""NS_IDENT@2b214b94"":{""tableId"":""NS_IDENT@2b214b94"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":214,""endLineNum"":1,""endColumnNum"":219,""quoted"":false}},""NS_IDENT@bdc8014"":{""tableId"":""NS_IDENT@bdc8014"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":118,""endLineNum"":1,""endColumnNum"":123,""quoted"":false}}},""corrTables"":[""NS_IDENT@7435a578""],""withBlocks"":[{""id"":""BLOCK_SELECT@4690f583"",""alias"":""DAN"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@64138b0c"",""value"":""NS_IDENT@4f186450.BEER"",""pos"":{""lineNum"":1,""columnNum"":21,""endLineNum"":1,""endColumnNum"":24,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@4f186450""],""fromNode"":{""id"":""JOIN_OPERAND@21f9277b"",""value"":""NS_IDENT@4f186450"",""pos"":{""lineNum"":1,""columnNum"":31,""endLineNum"":1,""endColumnNum"":35,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@131fcb6f"",""value"":""="",""pos"":{""lineNum"":1,""columnNum"":43,""endLineNum"":1,""endColumnNum"":57,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@460b6d54"",""value"":""NS_IDENT@4f186450.drinker"",""pos"":{""lineNum"":1,""columnNum"":43,""endLineNum"":1,""endColumnNum"":49,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@6c37bd27"",""value"":""'Dan'"",""pos"":{""lineNum"":1,""columnNum"":53,""endLineNum"":1,""endColumnNum"":57,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@64138b0c"",""value"":""NS_IDENT@4f186450.BEER"",""pos"":{""lineNum"":1,""columnNum"":21,""endLineNum"":1,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@460b6d54"",""value"":""NS_IDENT@4f186450.drinker"",""pos"":{""lineNum"":1,""columnNum"":43,""endLineNum"":1,""endColumnNum"":49,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":14,""endLineNum"":1,""endColumnNum"":57,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@66bfd864"",""alias"":""B"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@1f443fae"",""value"":""NS_IDENT@bdc8014.BEER"",""pos"":{""lineNum"":1,""columnNum"":74,""endLineNum"":1,""endColumnNum"":84,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@79ab34c1"",""value"":""NS_IDENT@bdc8014.BAR"",""pos"":{""lineNum"":1,""columnNum"":87,""endLineNum"":1,""endColumnNum"":89,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@281f23f2"",""value"":""NS_IDENT@bdc8014.PRICE"",""pos"":{""lineNum"":1,""columnNum"":92,""endLineNum"":1,""endColumnNum"":96,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@736f3e9e"",""NS_IDENT@bdc8014""],""fromNode"":{""id"":""OP_JOIN@1e6308a9"",""value"":""INNER"",""pos"":{""lineNum"":1,""columnNum"":113,""endLineNum"":1,""endColumnNum"":116,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@30cecdca"",""value"":""NS_IDENT@736f3e9e"",""pos"":{""lineNum"":1,""columnNum"":103,""endLineNum"":1,""endColumnNum"":105,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@6edc4161"",""value"":""NS_IDENT@bdc8014"",""pos"":{""lineNum"":1,""columnNum"":118,""endLineNum"":1,""endColumnNum"":123,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@319854f0"",""value"":""="",""pos"":{""lineNum"":1,""columnNum"":128,""endLineNum"":1,""endColumnNum"":149,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@529cfee5"",""value"":""NS_IDENT@736f3e9e.BEER"",""pos"":{""lineNum"":1,""columnNum"":128,""endLineNum"":1,""endColumnNum"":135,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7ca0863b"",""value"":""NS_IDENT@bdc8014.beer"",""pos"":{""lineNum"":1,""columnNum"":139,""endLineNum"":1,""endColumnNum"":149,""quoted"":false},""children"":[]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@281f23f2"",""value"":""NS_IDENT@bdc8014.PRICE"",""pos"":{""lineNum"":1,""columnNum"":92,""endLineNum"":1,""endColumnNum"":96,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7ca0863b"",""value"":""NS_IDENT@bdc8014.beer"",""pos"":{""lineNum"":1,""columnNum"":139,""endLineNum"":1,""endColumnNum"":149,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@529cfee5"",""value"":""NS_IDENT@736f3e9e.BEER"",""pos"":{""lineNum"":1,""columnNum"":128,""endLineNum"":1,""endColumnNum"":135,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@79ab34c1"",""value"":""NS_IDENT@bdc8014.BAR"",""pos"":{""lineNum"":1,""columnNum"":87,""endLineNum"":1,""endColumnNum"":89,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1f443fae"",""value"":""NS_IDENT@bdc8014.BEER"",""pos"":{""lineNum"":1,""columnNum"":74,""endLineNum"":1,""endColumnNum"":84,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":67,""endLineNum"":1,""endColumnNum"":149,""quoted"":false},""children"":{}}]}
"
"SELECT P.beer, s1.bar
FROM likes l1, serves s1,
	(SELECT MAX(price) as price, beer
	FROM serves
	GROUP BY beer)
	AS P
WHERE l1.drinker = 'Dan' and l1.beer = P.beer and s1.beer = P.beer and s1.price = P.price;","{""blocks"":{""id"":""BLOCK_SELECT@2b9b7f1f"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@bdc8014"",""value"":""NS_SELECT@52b6319f.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@10876a6"",""value"":""NS_IDENT@60dd3c23.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":21,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@69c93ca4"",""NS_IDENT@60dd3c23"",""NS_SELECT@52b6319f""],""fromNode"":{""id"":""OP_JOIN@5c20ffa8"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":25,""endLineNum"":2,""endColumnNum"":25,""quoted"":false},""children"":[{""id"":""OP_JOIN@7fedfe27"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":14,""endLineNum"":2,""endColumnNum"":14,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@2d66530f"",""value"":""NS_IDENT@69c93ca4"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@1869f114"",""value"":""NS_IDENT@60dd3c23"",""pos"":{""lineNum"":2,""columnNum"":16,""endLineNum"":2,""endColumnNum"":21,""quoted"":false},""children"":[]}],""natural"":false},{""id"":""JOIN_OPERAND@37a64f9d"",""value"":""BLOCK_SELECT@37a64f9d"",""pos"":{""lineNum"":3,""columnNum"":3,""endLineNum"":5,""endColumnNum"":14,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@248deced"",""value"":""AND"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":89,""quoted"":false},""children"":[{""id"":""OP_BINARY@1d12b024"",""value"":""AND"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":66,""quoted"":false},""children"":[{""id"":""OP_BINARY@70abf9b0"",""value"":""AND"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":45,""quoted"":false},""children"":[{""id"":""OP_BINARY@1603dc2f"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5e39850"",""value"":""NS_IDENT@69c93ca4.drinker"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@2227a6c1"",""value"":""'Dan'"",""pos"":{""lineNum"":7,""columnNum"":20,""endLineNum"":7,""endColumnNum"":24,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@78c1a023"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":30,""endLineNum"":7,""endColumnNum"":45,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@398474a2"",""value"":""NS_IDENT@69c93ca4.beer"",""pos"":{""lineNum"":7,""columnNum"":30,""endLineNum"":7,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@61799544"",""value"":""NS_SELECT@52b6319f.BEER"",""pos"":{""lineNum"":7,""columnNum"":40,""endLineNum"":7,""endColumnNum"":45,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@325bb9a6"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":51,""endLineNum"":7,""endColumnNum"":66,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@6a10b263"",""value"":""NS_IDENT@60dd3c23.beer"",""pos"":{""lineNum"":7,""columnNum"":51,""endLineNum"":7,""endColumnNum"":57,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@476ec9d0"",""value"":""NS_SELECT@52b6319f.BEER"",""pos"":{""lineNum"":7,""columnNum"":61,""endLineNum"":7,""endColumnNum"":66,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@2c16fadb"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":72,""endLineNum"":7,""endColumnNum"":89,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@72fe8a4f"",""value"":""NS_IDENT@60dd3c23.price"",""pos"":{""lineNum"":7,""columnNum"":72,""endLineNum"":7,""endColumnNum"":79,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@43effd89"",""value"":""NS_SELECT@52b6319f.PRICE"",""pos"":{""lineNum"":7,""columnNum"":83,""endLineNum"":7,""endColumnNum"":89,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@10876a6"",""value"":""NS_IDENT@60dd3c23.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@72fe8a4f"",""value"":""NS_IDENT@60dd3c23.price"",""pos"":{""lineNum"":7,""columnNum"":72,""endLineNum"":7,""endColumnNum"":79,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@bdc8014"",""value"":""NS_SELECT@52b6319f.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@43effd89"",""value"":""NS_SELECT@52b6319f.PRICE"",""pos"":{""lineNum"":7,""columnNum"":83,""endLineNum"":7,""endColumnNum"":89,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5e39850"",""value"":""NS_IDENT@69c93ca4.drinker"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@398474a2"",""value"":""NS_IDENT@69c93ca4.beer"",""pos"":{""lineNum"":7,""columnNum"":30,""endLineNum"":7,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@61799544"",""value"":""NS_SELECT@52b6319f.BEER"",""pos"":{""lineNum"":7,""columnNum"":40,""endLineNum"":7,""endColumnNum"":45,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6a10b263"",""value"":""NS_IDENT@60dd3c23.beer"",""pos"":{""lineNum"":7,""columnNum"":51,""endLineNum"":7,""endColumnNum"":57,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@476ec9d0"",""value"":""NS_SELECT@52b6319f.BEER"",""pos"":{""lineNum"":7,""columnNum"":61,""endLineNum"":7,""endColumnNum"":66,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":7,""endColumnNum"":89,""quoted"":false},""children"":{""BLOCK_SELECT@37a64f9d"":{""id"":""BLOCK_SELECT@37a64f9d"",""parentId"":""BLOCK_SELECT@2b9b7f1f"",""alias"":""P"",""fields"":[""PRICE DECIMAL(5, 2)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""OP_AGG_FUNC@1f1cae23"",""value"":""MAX"",""pos"":{""lineNum"":3,""columnNum"":10,""endLineNum"":3,""endColumnNum"":19,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7c455e96"",""value"":""NS_IDENT@5e9456ae.PRICE"",""pos"":{""lineNum"":3,""columnNum"":14,""endLineNum"":3,""endColumnNum"":18,""quoted"":false},""children"":[]}],""alias"":""PRICE""},{""id"":""COLUMN_LOCAL@5bcde458"",""value"":""NS_IDENT@5e9456ae.BEER"",""pos"":{""lineNum"":3,""columnNum"":31,""endLineNum"":3,""endColumnNum"":34,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@5e9456ae""],""fromNode"":{""id"":""JOIN_OPERAND@21f9277b"",""value"":""NS_IDENT@5e9456ae"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":12,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@1bcf67e8"",""value"":""NS_IDENT@5e9456ae.beer"",""pos"":{""lineNum"":5,""columnNum"":11,""endLineNum"":5,""endColumnNum"":14,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@1bcf67e8"",""value"":""NS_IDENT@5e9456ae.beer"",""pos"":{""lineNum"":5,""columnNum"":11,""endLineNum"":5,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7c455e96"",""value"":""NS_IDENT@5e9456ae.PRICE"",""pos"":{""lineNum"":3,""columnNum"":14,""endLineNum"":3,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5bcde458"",""value"":""NS_IDENT@5e9456ae.BEER"",""pos"":{""lineNum"":3,""columnNum"":31,""endLineNum"":3,""endColumnNum"":34,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":3,""endLineNum"":5,""endColumnNum"":14,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@60dd3c23"":{""tableId"":""NS_IDENT@60dd3c23"",""identifier"":""S1"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":16,""endLineNum"":2,""endColumnNum"":24,""quoted"":false}},""NS_SELECT@52b6319f"":{""tableId"":""NS_SELECT@52b6319f"",""identifier"":""P"",""blockId"":""BLOCK_SELECT@37a64f9d"",""fields"":[""PRICE DECIMAL(5, 2)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":3,""endLineNum"":6,""endColumnNum"":5,""quoted"":false}},""NS_IDENT@5e9456ae"":{""tableId"":""NS_IDENT@5e9456ae"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@69c93ca4"":{""tableId"":""NS_IDENT@69c93ca4"",""identifier"":""L1"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":13,""quoted"":false}}},""corrTables"":[]}
"
"SELECT DISTINCT l.beer, s.bar
FROM serves as s, likes as l
WHERE l.drinker = 'Dan' AND (l.beer, s.bar) IN 
(SELECT beer, bar
FROM serves 
WHERE (beer, bar) NOT IN (SELECT a.beer, a.bar
	FROM serves as a, serves as b
	WHERE a.price < b.price AND a.bar <> b.bar AND a.beer = b.beer));","{""failed"":true}
"
"SELECT L1.beer, bar
FROM Likes L1, Serves S1
WHERE drinker = 'Dan'
AND L1.beer = S1.beer
AND S1.price = (SELECT MAX(price)
		    FROM Serves S2
		    WHERE S1.beer = S2.beer)","{""blocks"":{""id"":""BLOCK_SELECT@61d01788"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@13047d7d"",""value"":""NS_IDENT@87abc48.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@65bb9029"",""value"":""NS_IDENT@7435a578.BAR"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":19,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@87abc48"",""NS_IDENT@7435a578""],""fromNode"":{""id"":""OP_JOIN@21f9277b"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":14,""endLineNum"":2,""endColumnNum"":14,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@201aa8c1"",""value"":""NS_IDENT@87abc48"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@5d58c727"",""value"":""NS_IDENT@7435a578"",""pos"":{""lineNum"":2,""columnNum"":16,""endLineNum"":2,""endColumnNum"":21,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@27b71f50"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":7,""endColumnNum"":29,""quoted"":false},""children"":[{""id"":""OP_BINARY@5cf87cfd"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":4,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""OP_BINARY@53692008"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7f02251"",""value"":""NS_IDENT@87abc48.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@29fc1a2b"",""value"":""'Dan'"",""pos"":{""lineNum"":3,""columnNum"":17,""endLineNum"":3,""endColumnNum"":21,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@460b6d54"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":4,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7b2a3ff8"",""value"":""NS_IDENT@87abc48.beer"",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":4,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1bbae752"",""value"":""NS_IDENT@7435a578.beer"",""pos"":{""lineNum"":4,""columnNum"":15,""endLineNum"":4,""endColumnNum"":21,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@3a4ba480"",""value"":""="",""pos"":{""lineNum"":5,""columnNum"":5,""endLineNum"":7,""endColumnNum"":29,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@76075d65"",""value"":""NS_IDENT@7435a578.price"",""pos"":{""lineNum"":5,""columnNum"":5,""endLineNum"":5,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT_SCALAR@4d0b0fd4"",""value"":""BLOCK_SELECT@247667dd"",""pos"":{""lineNum"":5,""columnNum"":17,""endLineNum"":7,""endColumnNum"":29,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@1bbae752"",""value"":""NS_IDENT@7435a578.beer"",""pos"":{""lineNum"":4,""columnNum"":15,""endLineNum"":4,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@76075d65"",""value"":""NS_IDENT@7435a578.price"",""pos"":{""lineNum"":5,""columnNum"":5,""endLineNum"":5,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7f02251"",""value"":""NS_IDENT@87abc48.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@13047d7d"",""value"":""NS_IDENT@87abc48.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7b2a3ff8"",""value"":""NS_IDENT@87abc48.beer"",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":4,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@65bb9029"",""value"":""NS_IDENT@7435a578.BAR"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":19,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@7435a578.beer""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":7,""endColumnNum"":30,""quoted"":false},""children"":{""BLOCK_SELECT@247667dd"":{""id"":""BLOCK_SELECT@247667dd"",""parentId"":""BLOCK_SELECT@61d01788"",""fields"":[""EXPR$0 DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""OP_AGG_FUNC@25d3cfc8"",""value"":""MAX"",""pos"":{""lineNum"":5,""columnNum"":24,""endLineNum"":5,""endColumnNum"":33,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@30331109"",""value"":""NS_IDENT@2b8d084.PRICE"",""pos"":{""lineNum"":5,""columnNum"":28,""endLineNum"":5,""endColumnNum"":32,""quoted"":false},""children"":[]}]}],""fromItemIds"":[""NS_IDENT@2b8d084""],""fromNode"":{""id"":""JOIN_OPERAND@1d4664d7"",""value"":""NS_IDENT@2b8d084"",""pos"":{""lineNum"":6,""columnNum"":12,""endLineNum"":6,""endColumnNum"":17,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@3e48e859"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":13,""endLineNum"":7,""endColumnNum"":29,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@3a022576"",""value"":""NS_IDENT@7435a578.beer"",""pos"":{""lineNum"":7,""columnNum"":13,""endLineNum"":7,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2dbd803f"",""value"":""NS_IDENT@2b8d084.beer"",""pos"":{""lineNum"":7,""columnNum"":23,""endLineNum"":7,""endColumnNum"":29,""quoted"":false},""children"":[]}]},""isAggregate"":true,""identifiers"":[{""id"":""COLUMN_CORRELATE@3a022576"",""value"":""NS_IDENT@7435a578.beer"",""pos"":{""lineNum"":7,""columnNum"":13,""endLineNum"":7,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2dbd803f"",""value"":""NS_IDENT@2b8d084.beer"",""pos"":{""lineNum"":7,""columnNum"":23,""endLineNum"":7,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@30331109"",""value"":""NS_IDENT@2b8d084.PRICE"",""pos"":{""lineNum"":5,""columnNum"":28,""endLineNum"":5,""endColumnNum"":32,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@7435a578""],""corrCtxIds"":[""BLOCK_SELECT@61d01788""],""pos"":{""lineNum"":5,""columnNum"":17,""endLineNum"":7,""endColumnNum"":29,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@7435a578"":{""tableId"":""NS_IDENT@7435a578"",""identifier"":""S1"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":16,""endLineNum"":2,""endColumnNum"":24,""quoted"":false}},""NS_IDENT@87abc48"":{""tableId"":""NS_IDENT@87abc48"",""identifier"":""L1"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":13,""quoted"":false}},""NS_IDENT@2b8d084"":{""tableId"":""NS_IDENT@2b8d084"",""identifier"":""S2"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":12,""endLineNum"":6,""endColumnNum"":20,""quoted"":false}}},""corrTables"":[""NS_IDENT@7435a578""]}
"
"SELECT A.beer, A.bar FROM serves as A, 
(SELECT beer, MAX(price) as p FROM serves GROUP BY beer) as B 
WHERE A.beer = B.beer AND A.price = B.p
AND A.beer IN (SELECT beer FROM likes WHERE drinker = 'Dan')","{""blocks"":{""id"":""BLOCK_SELECT@2b9b7f1f"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@5754de72"",""value"":""NS_IDENT@30506c0d.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@320494b6"",""value"":""NS_IDENT@30506c0d.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@30506c0d"",""NS_SELECT@6124287a""],""fromNode"":{""id"":""OP_JOIN@6872f9c8"",""value"":""COMMA"",""pos"":{""lineNum"":1,""columnNum"":38,""endLineNum"":1,""endColumnNum"":38,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@bdecc21"",""value"":""NS_IDENT@30506c0d"",""pos"":{""lineNum"":1,""columnNum"":27,""endLineNum"":1,""endColumnNum"":32,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@5e3a39cd"",""value"":""BLOCK_SELECT@5e3a39cd"",""pos"":{""lineNum"":2,""columnNum"":2,""endLineNum"":2,""endColumnNum"":55,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@325bb9a6"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":4,""endColumnNum"":59,""quoted"":false},""children"":[{""id"":""OP_BINARY@70abf9b0"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":39,""quoted"":false},""children"":[{""id"":""OP_BINARY@1603dc2f"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@37fdfb05"",""value"":""NS_IDENT@30506c0d.beer"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5e39850"",""value"":""NS_SELECT@6124287a.BEER"",""pos"":{""lineNum"":3,""columnNum"":16,""endLineNum"":3,""endColumnNum"":21,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@78c1a023"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":27,""endLineNum"":3,""endColumnNum"":39,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@398474a2"",""value"":""NS_IDENT@30506c0d.price"",""pos"":{""lineNum"":3,""columnNum"":27,""endLineNum"":3,""endColumnNum"":33,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@61799544"",""value"":""NS_SELECT@6124287a.P"",""pos"":{""lineNum"":3,""columnNum"":37,""endLineNum"":3,""endColumnNum"":39,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@476ec9d0"",""value"":""IN"",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":4,""endColumnNum"":59,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@6a10b263"",""value"":""NS_IDENT@30506c0d.beer"",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":4,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@6f099cef"",""value"":""BLOCK_SELECT@6f099cef"",""pos"":{""lineNum"":4,""columnNum"":16,""endLineNum"":4,""endColumnNum"":59,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@320494b6"",""value"":""NS_IDENT@30506c0d.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@398474a2"",""value"":""NS_IDENT@30506c0d.price"",""pos"":{""lineNum"":3,""columnNum"":27,""endLineNum"":3,""endColumnNum"":33,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6a10b263"",""value"":""NS_IDENT@30506c0d.beer"",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":4,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5754de72"",""value"":""NS_IDENT@30506c0d.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@61799544"",""value"":""NS_SELECT@6124287a.P"",""pos"":{""lineNum"":3,""columnNum"":37,""endLineNum"":3,""endColumnNum"":39,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@37fdfb05"",""value"":""NS_IDENT@30506c0d.beer"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5e39850"",""value"":""NS_SELECT@6124287a.BEER"",""pos"":{""lineNum"":3,""columnNum"":16,""endLineNum"":3,""endColumnNum"":21,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":4,""endColumnNum"":60,""quoted"":false},""children"":{""BLOCK_SELECT@6f099cef"":{""id"":""BLOCK_SELECT@6f099cef"",""parentId"":""BLOCK_SELECT@2b9b7f1f"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@43effd89"",""value"":""NS_IDENT@51dbd6e4.BEER"",""pos"":{""lineNum"":4,""columnNum"":23,""endLineNum"":4,""endColumnNum"":26,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@51dbd6e4""],""fromNode"":{""id"":""JOIN_OPERAND@1d207fad"",""value"":""NS_IDENT@51dbd6e4"",""pos"":{""lineNum"":4,""columnNum"":33,""endLineNum"":4,""endColumnNum"":37,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@1f443fae"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":45,""endLineNum"":4,""endColumnNum"":59,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@bdc8014"",""value"":""NS_IDENT@51dbd6e4.drinker"",""pos"":{""lineNum"":4,""columnNum"":45,""endLineNum"":4,""endColumnNum"":51,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@1e9804b9"",""value"":""'Dan'"",""pos"":{""lineNum"":4,""columnNum"":55,""endLineNum"":4,""endColumnNum"":59,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@43effd89"",""value"":""NS_IDENT@51dbd6e4.BEER"",""pos"":{""lineNum"":4,""columnNum"":23,""endLineNum"":4,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@bdc8014"",""value"":""NS_IDENT@51dbd6e4.drinker"",""pos"":{""lineNum"":4,""columnNum"":45,""endLineNum"":4,""endColumnNum"":51,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":4,""columnNum"":16,""endLineNum"":4,""endColumnNum"":59,""quoted"":false},""children"":{}},""BLOCK_SELECT@5e3a39cd"":{""id"":""BLOCK_SELECT@5e3a39cd"",""parentId"":""BLOCK_SELECT@2b9b7f1f"",""alias"":""B"",""fields"":[""BEER VARCHAR(100)"",""P DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@6e1f8469"",""value"":""NS_IDENT@19569ebd.BEER"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@3b6c624"",""value"":""MAX"",""pos"":{""lineNum"":2,""columnNum"":15,""endLineNum"":2,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1eaf1e62"",""value"":""NS_IDENT@19569ebd.PRICE"",""pos"":{""lineNum"":2,""columnNum"":19,""endLineNum"":2,""endColumnNum"":23,""quoted"":false},""children"":[]}],""alias"":""P""}],""fromItemIds"":[""NS_IDENT@19569ebd""],""fromNode"":{""id"":""JOIN_OPERAND@21f9277b"",""value"":""NS_IDENT@19569ebd"",""pos"":{""lineNum"":2,""columnNum"":36,""endLineNum"":2,""endColumnNum"":41,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@4c98a6d5"",""value"":""NS_IDENT@19569ebd.beer"",""pos"":{""lineNum"":2,""columnNum"":52,""endLineNum"":2,""endColumnNum"":55,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@6e1f8469"",""value"":""NS_IDENT@19569ebd.BEER"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1eaf1e62"",""value"":""NS_IDENT@19569ebd.PRICE"",""pos"":{""lineNum"":2,""columnNum"":19,""endLineNum"":2,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4c98a6d5"",""value"":""NS_IDENT@19569ebd.beer"",""pos"":{""lineNum"":2,""columnNum"":52,""endLineNum"":2,""endColumnNum"":55,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":2,""endLineNum"":2,""endColumnNum"":55,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@30506c0d"":{""tableId"":""NS_IDENT@30506c0d"",""identifier"":""A"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":27,""endLineNum"":1,""endColumnNum"":37,""quoted"":false}},""NS_IDENT@51dbd6e4"":{""tableId"":""NS_IDENT@51dbd6e4"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":33,""endLineNum"":4,""endColumnNum"":37,""quoted"":false}},""NS_SELECT@6124287a"":{""tableId"":""NS_SELECT@6124287a"",""identifier"":""B"",""blockId"":""BLOCK_SELECT@5e3a39cd"",""fields"":[""BEER VARCHAR(100)"",""P DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":2,""endLineNum"":2,""endColumnNum"":61,""quoted"":false}},""NS_IDENT@19569ebd"":{""tableId"":""NS_IDENT@19569ebd"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":36,""endLineNum"":2,""endColumnNum"":41,""quoted"":false}}},""corrTables"":[]}
"
"WITH beerHigh AS 
  (SELECT DISTINCT s1.*
  FROM serves AS s1, serves as s2
  WHERE s1.beer = s2.beer
  AND s1.price >= ALL(SELECT price FROM serves
                      WHERE s1.beer = beer))
SELECT beerHigh.beer, beerHigh.bar
FROM beerHigh, likes
WHERE beerHigh.beer = likes.beer
  AND likes.drinker = 'Dan'","{""blocks"":{""id"":""BLOCK_SELECT@1ddd3478"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@2679311f"",""value"":""NS_IDENT@57b75756.BEER"",""pos"":{""lineNum"":7,""columnNum"":8,""endLineNum"":7,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@451f87af"",""value"":""NS_IDENT@57b75756.BAR"",""pos"":{""lineNum"":7,""columnNum"":23,""endLineNum"":7,""endColumnNum"":34,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@57b75756"",""NS_IDENT@5327a06e""],""fromNode"":{""id"":""OP_JOIN@f973499"",""value"":""COMMA"",""pos"":{""lineNum"":8,""columnNum"":14,""endLineNum"":8,""endColumnNum"":14,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@4d33940d"",""value"":""NS_IDENT@57b75756"",""pos"":{""lineNum"":8,""columnNum"":6,""endLineNum"":8,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@43cf6ea3"",""value"":""NS_IDENT@5327a06e"",""pos"":{""lineNum"":8,""columnNum"":16,""endLineNum"":8,""endColumnNum"":20,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@40368a46"",""value"":""AND"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":10,""endColumnNum"":27,""quoted"":false},""children"":[{""id"":""OP_BINARY@2822c6ff"",""value"":""="",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":32,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@621f89b8"",""value"":""NS_IDENT@57b75756.beer"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@f339eae"",""value"":""NS_IDENT@5327a06e.beer"",""pos"":{""lineNum"":9,""columnNum"":23,""endLineNum"":9,""endColumnNum"":32,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@53e3a87a"",""value"":""="",""pos"":{""lineNum"":10,""columnNum"":7,""endLineNum"":10,""endColumnNum"":27,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4dafba3e"",""value"":""NS_IDENT@5327a06e.drinker"",""pos"":{""lineNum"":10,""columnNum"":7,""endLineNum"":10,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@7e9da981"",""value"":""'Dan'"",""pos"":{""lineNum"":10,""columnNum"":23,""endLineNum"":10,""endColumnNum"":27,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@f339eae"",""value"":""NS_IDENT@5327a06e.beer"",""pos"":{""lineNum"":9,""columnNum"":23,""endLineNum"":9,""endColumnNum"":32,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@621f89b8"",""value"":""NS_IDENT@57b75756.beer"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@451f87af"",""value"":""NS_IDENT@57b75756.BAR"",""pos"":{""lineNum"":7,""columnNum"":23,""endLineNum"":7,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2679311f"",""value"":""NS_IDENT@57b75756.BEER"",""pos"":{""lineNum"":7,""columnNum"":8,""endLineNum"":7,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4dafba3e"",""value"":""NS_IDENT@5327a06e.drinker"",""pos"":{""lineNum"":10,""columnNum"":7,""endLineNum"":10,""endColumnNum"":19,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":7,""columnNum"":1,""endLineNum"":10,""endColumnNum"":27,""quoted"":false},""children"":{}},""tables"":{""NS_IDENT@7cab1508"":{""tableId"":""NS_IDENT@7cab1508"",""identifier"":""S2"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":22,""endLineNum"":3,""endColumnNum"":33,""quoted"":false}},""NS_IDENT@5327a06e"":{""tableId"":""NS_IDENT@5327a06e"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":16,""endLineNum"":8,""endColumnNum"":20,""quoted"":false}},""NS_IDENT@2301b75"":{""tableId"":""NS_IDENT@2301b75"",""identifier"":""S1"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":8,""endLineNum"":3,""endColumnNum"":19,""quoted"":false}},""NS_IDENT@705f83a7"":{""tableId"":""NS_IDENT@705f83a7"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":41,""endLineNum"":5,""endColumnNum"":46,""quoted"":false}},""NS_IDENT@57b75756"":{""tableId"":""NS_IDENT@57b75756"",""identifier"":""BEERHIGH"",""dbTableName"":""BEERHIGH"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":6,""endLineNum"":8,""endColumnNum"":13,""quoted"":false}}},""corrTables"":[""NS_IDENT@2301b75""],""withBlocks"":[{""id"":""BLOCK_SELECT@47b2e9e1"",""alias"":""BEERHIGH"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""isDistinct"":true,""selectList"":[{""id"":""COLUMN_STAR@258ee7de"",""value"":""*"",""pos"":{""lineNum"":2,""columnNum"":20,""endLineNum"":2,""endColumnNum"":23,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@2301b75"",""NS_IDENT@7cab1508""],""fromNode"":{""id"":""OP_JOIN@21fff664"",""value"":""COMMA"",""pos"":{""lineNum"":3,""columnNum"":20,""endLineNum"":3,""endColumnNum"":20,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@1e6308a9"",""value"":""NS_IDENT@2301b75"",""pos"":{""lineNum"":3,""columnNum"":8,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@30cecdca"",""value"":""NS_IDENT@7cab1508"",""pos"":{""lineNum"":3,""columnNum"":22,""endLineNum"":3,""endColumnNum"":27,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@2bf94401"",""value"":""AND"",""pos"":{""lineNum"":4,""columnNum"":9,""endLineNum"":6,""endColumnNum"":42,""quoted"":false},""children"":[{""id"":""OP_BINARY@65fd6708"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":9,""endLineNum"":4,""endColumnNum"":25,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@67403656"",""value"":""NS_IDENT@2301b75.beer"",""pos"":{""lineNum"":4,""columnNum"":9,""endLineNum"":4,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@77b9d0c7"",""value"":""NS_IDENT@7cab1508.beer"",""pos"":{""lineNum"":4,""columnNum"":19,""endLineNum"":4,""endColumnNum"":25,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@127f9161"",""value"":"">= ALL"",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":6,""endColumnNum"":42,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@749ab7b4"",""value"":""NS_IDENT@2301b75.price"",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":5,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@18a645fd"",""value"":""BLOCK_SELECT@18a645fd"",""pos"":{""lineNum"":5,""columnNum"":23,""endLineNum"":6,""endColumnNum"":42,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@749ab7b4"",""value"":""NS_IDENT@2301b75.price"",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":5,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@77b9d0c7"",""value"":""NS_IDENT@7cab1508.beer"",""pos"":{""lineNum"":4,""columnNum"":19,""endLineNum"":4,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@67403656"",""value"":""NS_IDENT@2301b75.beer"",""pos"":{""lineNum"":4,""columnNum"":9,""endLineNum"":4,""endColumnNum"":15,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@2301b75.beer""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":4,""endLineNum"":6,""endColumnNum"":43,""quoted"":false},""children"":{""BLOCK_SELECT@18a645fd"":{""id"":""BLOCK_SELECT@18a645fd"",""parentId"":""BLOCK_SELECT@47b2e9e1"",""fields"":[""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@723ed581"",""value"":""NS_IDENT@705f83a7.PRICE"",""pos"":{""lineNum"":5,""columnNum"":30,""endLineNum"":5,""endColumnNum"":34,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@705f83a7""],""fromNode"":{""id"":""JOIN_OPERAND@52a36910"",""value"":""NS_IDENT@705f83a7"",""pos"":{""lineNum"":5,""columnNum"":41,""endLineNum"":5,""endColumnNum"":46,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@746b18fd"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":29,""endLineNum"":6,""endColumnNum"":42,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@60e21209"",""value"":""NS_IDENT@2301b75.beer"",""pos"":{""lineNum"":6,""columnNum"":29,""endLineNum"":6,""endColumnNum"":35,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@630d1b2f"",""value"":""NS_IDENT@705f83a7.beer"",""pos"":{""lineNum"":6,""columnNum"":39,""endLineNum"":6,""endColumnNum"":42,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@723ed581"",""value"":""NS_IDENT@705f83a7.PRICE"",""pos"":{""lineNum"":5,""columnNum"":30,""endLineNum"":5,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@60e21209"",""value"":""NS_IDENT@2301b75.beer"",""pos"":{""lineNum"":6,""columnNum"":29,""endLineNum"":6,""endColumnNum"":35,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@630d1b2f"",""value"":""NS_IDENT@705f83a7.beer"",""pos"":{""lineNum"":6,""columnNum"":39,""endLineNum"":6,""endColumnNum"":42,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@2301b75""],""corrCtxIds"":[""BLOCK_SELECT@47b2e9e1""],""pos"":{""lineNum"":5,""columnNum"":23,""endLineNum"":6,""endColumnNum"":42,""quoted"":false},""children"":{}}}}]}
"
"SELECT S.beer, S.bar
FROM serves S, likes L
WHERE L.drinker = 'Dan' and L.beer = S.beer and S.price >= ALL(SELECT price FROM serves WHERE beer = S.beer)","{""blocks"":{""id"":""BLOCK_SELECT@847f3e7"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@4cdd2c73"",""value"":""NS_IDENT@151335cb.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4e4c3a38"",""value"":""NS_IDENT@151335cb.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@151335cb"",""NS_IDENT@2b4c3c29""],""fromNode"":{""id"":""OP_JOIN@bdecc21"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":14,""endLineNum"":2,""endColumnNum"":14,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@21f9277b"",""value"":""NS_IDENT@151335cb"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@201aa8c1"",""value"":""NS_IDENT@2b4c3c29"",""pos"":{""lineNum"":2,""columnNum"":16,""endLineNum"":2,""endColumnNum"":20,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@7b2a3ff8"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":107,""quoted"":false},""children"":[{""id"":""OP_BINARY@1bcf67e8"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":43,""quoted"":false},""children"":[{""id"":""OP_BINARY@dffa30b"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@6f952d6c"",""value"":""NS_IDENT@2b4c3c29.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@383790cf"",""value"":""'Dan'"",""pos"":{""lineNum"":3,""columnNum"":19,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@6b587673"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":29,""endLineNum"":3,""endColumnNum"":43,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4d8126f"",""value"":""NS_IDENT@2b4c3c29.beer"",""pos"":{""lineNum"":3,""columnNum"":29,""endLineNum"":3,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6d3c232f"",""value"":""NS_IDENT@151335cb.beer"",""pos"":{""lineNum"":3,""columnNum"":38,""endLineNum"":3,""endColumnNum"":43,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@53692008"",""value"":"">= ALL"",""pos"":{""lineNum"":3,""columnNum"":49,""endLineNum"":3,""endColumnNum"":107,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5f404594"",""value"":""NS_IDENT@151335cb.price"",""pos"":{""lineNum"":3,""columnNum"":49,""endLineNum"":3,""endColumnNum"":55,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@4bff2185"",""value"":""BLOCK_SELECT@4bff2185"",""pos"":{""lineNum"":3,""columnNum"":64,""endLineNum"":3,""endColumnNum"":107,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@6f952d6c"",""value"":""NS_IDENT@2b4c3c29.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6d3c232f"",""value"":""NS_IDENT@151335cb.beer"",""pos"":{""lineNum"":3,""columnNum"":38,""endLineNum"":3,""endColumnNum"":43,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5f404594"",""value"":""NS_IDENT@151335cb.price"",""pos"":{""lineNum"":3,""columnNum"":49,""endLineNum"":3,""endColumnNum"":55,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4cdd2c73"",""value"":""NS_IDENT@151335cb.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4d8126f"",""value"":""NS_IDENT@2b4c3c29.beer"",""pos"":{""lineNum"":3,""columnNum"":29,""endLineNum"":3,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4e4c3a38"",""value"":""NS_IDENT@151335cb.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@151335cb.beer""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":3,""endColumnNum"":108,""quoted"":false},""children"":{""BLOCK_SELECT@4bff2185"":{""id"":""BLOCK_SELECT@4bff2185"",""parentId"":""BLOCK_SELECT@847f3e7"",""fields"":[""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@ccd1bc3"",""value"":""NS_IDENT@5e39850.PRICE"",""pos"":{""lineNum"":3,""columnNum"":71,""endLineNum"":3,""endColumnNum"":75,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@5e39850""],""fromNode"":{""id"":""JOIN_OPERAND@4690f583"",""value"":""NS_IDENT@5e39850"",""pos"":{""lineNum"":3,""columnNum"":82,""endLineNum"":3,""endColumnNum"":87,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@26dcd8c0"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":95,""endLineNum"":3,""endColumnNum"":107,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@441cc260"",""value"":""NS_IDENT@5e39850.beer"",""pos"":{""lineNum"":3,""columnNum"":95,""endLineNum"":3,""endColumnNum"":98,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@73a00e09"",""value"":""NS_IDENT@151335cb.beer"",""pos"":{""lineNum"":3,""columnNum"":102,""endLineNum"":3,""endColumnNum"":107,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@441cc260"",""value"":""NS_IDENT@5e39850.beer"",""pos"":{""lineNum"":3,""columnNum"":95,""endLineNum"":3,""endColumnNum"":98,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@ccd1bc3"",""value"":""NS_IDENT@5e39850.PRICE"",""pos"":{""lineNum"":3,""columnNum"":71,""endLineNum"":3,""endColumnNum"":75,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@73a00e09"",""value"":""NS_IDENT@151335cb.beer"",""pos"":{""lineNum"":3,""columnNum"":102,""endLineNum"":3,""endColumnNum"":107,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@151335cb""],""corrCtxIds"":[""BLOCK_SELECT@847f3e7""],""pos"":{""lineNum"":3,""columnNum"":64,""endLineNum"":3,""endColumnNum"":107,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@5e39850"":{""tableId"":""NS_IDENT@5e39850"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":82,""endLineNum"":3,""endColumnNum"":87,""quoted"":false}},""NS_IDENT@151335cb"":{""tableId"":""NS_IDENT@151335cb"",""identifier"":""S"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":13,""quoted"":false}},""NS_IDENT@2b4c3c29"":{""tableId"":""NS_IDENT@2b4c3c29"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":16,""endLineNum"":2,""endColumnNum"":22,""quoted"":false}}},""corrTables"":[""NS_IDENT@151335cb""]}
"
"WITH maxFound AS
(SELECT beer, MAX(price)
FROM serves
GROUP BY beer),
danBeer AS
(SELECT beer
FROM likes
WHERE drinker = 'Dan')

SELECT danBeer.beer AS ""beer"", bar
FROM serves, maxFound, danBeer
WHERE danBeer.beer = serves.beer and maxFound.beer = danBeer.beer and maxFound.max = serves.price;
","{""failed"":true,""errorMsg"":""Parsing error at line 12, column 79. Query syntax may be incorrect""}
"
"SELECT danMax.beer, s.bar FROM
(SELECT likes.beer, max(serves.price) maxPrice FROM 
likes, serves WHERE likes.drinker = 'Dan' AND likes.beer = serves.beer GROUP BY likes.beer) danMax,
serves s WHERE s.price = danMax.maxPrice AND s.beer = danMax.beer","{""blocks"":{""id"":""BLOCK_SELECT@2b9b7f1f"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@22d9c961"",""value"":""NS_SELECT@60e5272.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6dd91637"",""value"":""NS_IDENT@10876a6.BAR"",""pos"":{""lineNum"":1,""columnNum"":21,""endLineNum"":1,""endColumnNum"":25,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_SELECT@60e5272"",""NS_IDENT@10876a6""],""fromNode"":{""id"":""OP_JOIN@5c20ffa8"",""value"":""COMMA"",""pos"":{""lineNum"":3,""columnNum"":99,""endLineNum"":3,""endColumnNum"":99,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@2f879bab"",""value"":""BLOCK_SELECT@2f879bab"",""pos"":{""lineNum"":2,""columnNum"":2,""endLineNum"":3,""endColumnNum"":90,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@66bfd864"",""value"":""NS_IDENT@10876a6"",""pos"":{""lineNum"":4,""columnNum"":1,""endLineNum"":4,""endColumnNum"":6,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@49dbaaf3"",""value"":""AND"",""pos"":{""lineNum"":4,""columnNum"":16,""endLineNum"":4,""endColumnNum"":65,""quoted"":false},""children"":[{""id"":""OP_BINARY@a64e035"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":16,""endLineNum"":4,""endColumnNum"":40,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_IDENT@10876a6.price"",""pos"":{""lineNum"":4,""columnNum"":16,""endLineNum"":4,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7fab4be7"",""value"":""NS_SELECT@60e5272.MAXPRICE"",""pos"":{""lineNum"":4,""columnNum"":26,""endLineNum"":4,""endColumnNum"":40,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@64138b0c"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":46,""endLineNum"":4,""endColumnNum"":65,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4d74c3ba"",""value"":""NS_IDENT@10876a6.beer"",""pos"":{""lineNum"":4,""columnNum"":46,""endLineNum"":4,""endColumnNum"":51,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@41c204a0"",""value"":""NS_SELECT@60e5272.BEER"",""pos"":{""lineNum"":4,""columnNum"":55,""endLineNum"":4,""endColumnNum"":65,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@22d9c961"",""value"":""NS_SELECT@60e5272.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@41c204a0"",""value"":""NS_SELECT@60e5272.BEER"",""pos"":{""lineNum"":4,""columnNum"":55,""endLineNum"":4,""endColumnNum"":65,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6dd91637"",""value"":""NS_IDENT@10876a6.BAR"",""pos"":{""lineNum"":1,""columnNum"":21,""endLineNum"":1,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_IDENT@10876a6.price"",""pos"":{""lineNum"":4,""columnNum"":16,""endLineNum"":4,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7fab4be7"",""value"":""NS_SELECT@60e5272.MAXPRICE"",""pos"":{""lineNum"":4,""columnNum"":26,""endLineNum"":4,""endColumnNum"":40,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4d74c3ba"",""value"":""NS_IDENT@10876a6.beer"",""pos"":{""lineNum"":4,""columnNum"":46,""endLineNum"":4,""endColumnNum"":51,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":4,""endColumnNum"":65,""quoted"":false},""children"":{""BLOCK_SELECT@2f879bab"":{""id"":""BLOCK_SELECT@2f879bab"",""parentId"":""BLOCK_SELECT@2b9b7f1f"",""alias"":""DANMAX"",""fields"":[""BEER VARCHAR(100)"",""MAXPRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@52b6319f"",""value"":""NS_IDENT@7d755813.BEER"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@16a9a4f1"",""value"":""MAX"",""pos"":{""lineNum"":2,""columnNum"":21,""endLineNum"":2,""endColumnNum"":37,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1f1cae23"",""value"":""NS_IDENT@40d10481.PRICE"",""pos"":{""lineNum"":2,""columnNum"":25,""endLineNum"":2,""endColumnNum"":36,""quoted"":false},""children"":[]}],""alias"":""MAXPRICE""}],""fromItemIds"":[""NS_IDENT@7d755813"",""NS_IDENT@40d10481""],""fromNode"":{""id"":""OP_JOIN@458544e0"",""value"":""COMMA"",""pos"":{""lineNum"":3,""columnNum"":6,""endLineNum"":3,""endColumnNum"":6,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@6090f3ca"",""value"":""NS_IDENT@7d755813"",""pos"":{""lineNum"":3,""columnNum"":1,""endLineNum"":3,""endColumnNum"":5,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@6872f9c8"",""value"":""NS_IDENT@40d10481"",""pos"":{""lineNum"":3,""columnNum"":8,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@76075d65"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":21,""endLineNum"":3,""endColumnNum"":70,""quoted"":false},""children"":[{""id"":""OP_BINARY@7b2a3ff8"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":21,""endLineNum"":3,""endColumnNum"":41,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@dffa30b"",""value"":""NS_IDENT@7d755813.drinker"",""pos"":{""lineNum"":3,""columnNum"":21,""endLineNum"":3,""endColumnNum"":33,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@878537d"",""value"":""'Dan'"",""pos"":{""lineNum"":3,""columnNum"":37,""endLineNum"":3,""endColumnNum"":41,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@5cf87cfd"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":47,""endLineNum"":3,""endColumnNum"":70,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1bbae752"",""value"":""NS_IDENT@7d755813.beer"",""pos"":{""lineNum"":3,""columnNum"":47,""endLineNum"":3,""endColumnNum"":56,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@460b6d54"",""value"":""NS_IDENT@40d10481.beer"",""pos"":{""lineNum"":3,""columnNum"":60,""endLineNum"":3,""endColumnNum"":70,""quoted"":false},""children"":[]}]}]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@4d23015c"",""value"":""NS_IDENT@7d755813.beer"",""pos"":{""lineNum"":3,""columnNum"":81,""endLineNum"":3,""endColumnNum"":90,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@1f1cae23"",""value"":""NS_IDENT@40d10481.PRICE"",""pos"":{""lineNum"":2,""columnNum"":25,""endLineNum"":2,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1bbae752"",""value"":""NS_IDENT@7d755813.beer"",""pos"":{""lineNum"":3,""columnNum"":47,""endLineNum"":3,""endColumnNum"":56,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@52b6319f"",""value"":""NS_IDENT@7d755813.BEER"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4d23015c"",""value"":""NS_IDENT@7d755813.beer"",""pos"":{""lineNum"":3,""columnNum"":81,""endLineNum"":3,""endColumnNum"":90,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@dffa30b"",""value"":""NS_IDENT@7d755813.drinker"",""pos"":{""lineNum"":3,""columnNum"":21,""endLineNum"":3,""endColumnNum"":33,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@460b6d54"",""value"":""NS_IDENT@40d10481.beer"",""pos"":{""lineNum"":3,""columnNum"":60,""endLineNum"":3,""endColumnNum"":70,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":2,""endLineNum"":3,""endColumnNum"":90,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@40d10481"":{""tableId"":""NS_IDENT@40d10481"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":8,""endLineNum"":3,""endColumnNum"":13,""quoted"":false}},""NS_IDENT@7d755813"":{""tableId"":""NS_IDENT@7d755813"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":1,""endLineNum"":3,""endColumnNum"":5,""quoted"":false}},""NS_SELECT@60e5272"":{""tableId"":""NS_SELECT@60e5272"",""identifier"":""DANMAX"",""blockId"":""BLOCK_SELECT@2f879bab"",""fields"":[""BEER VARCHAR(100)"",""MAXPRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":2,""endLineNum"":3,""endColumnNum"":98,""quoted"":false}},""NS_IDENT@10876a6"":{""tableId"":""NS_IDENT@10876a6"",""identifier"":""S"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":1,""endLineNum"":4,""endColumnNum"":8,""quoted"":false}}},""corrTables"":[]}
"
"select serves.beer, serves.bar
from likes likes, serves serves
where likes.beer = serves.beer
and likes.drinker = 'Dan'
and serves.price = 
(
select max(serves.price)
from serves serves
where serves.beer = likes.beer
);","{""blocks"":{""id"":""BLOCK_SELECT@61d01788"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@13047d7d"",""value"":""NS_IDENT@7435a578.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@65bb9029"",""value"":""NS_IDENT@7435a578.BAR"",""pos"":{""lineNum"":1,""columnNum"":21,""endLineNum"":1,""endColumnNum"":30,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@87abc48"",""NS_IDENT@7435a578""],""fromNode"":{""id"":""OP_JOIN@21f9277b"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":17,""endLineNum"":2,""endColumnNum"":17,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@201aa8c1"",""value"":""NS_IDENT@87abc48"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@5d58c727"",""value"":""NS_IDENT@7435a578"",""pos"":{""lineNum"":2,""columnNum"":19,""endLineNum"":2,""endColumnNum"":24,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@27b71f50"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":9,""endColumnNum"":30,""quoted"":false},""children"":[{""id"":""OP_BINARY@5cf87cfd"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":4,""endColumnNum"":25,""quoted"":false},""children"":[{""id"":""OP_BINARY@7b2a3ff8"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":30,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7f02251"",""value"":""NS_IDENT@87abc48.beer"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@53692008"",""value"":""NS_IDENT@7435a578.beer"",""pos"":{""lineNum"":3,""columnNum"":20,""endLineNum"":3,""endColumnNum"":30,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@460b6d54"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":4,""endColumnNum"":25,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1bbae752"",""value"":""NS_IDENT@87abc48.drinker"",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":4,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@29fc1a2b"",""value"":""'Dan'"",""pos"":{""lineNum"":4,""columnNum"":21,""endLineNum"":4,""endColumnNum"":25,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@3a4ba480"",""value"":""="",""pos"":{""lineNum"":5,""columnNum"":5,""endLineNum"":9,""endColumnNum"":30,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@76075d65"",""value"":""NS_IDENT@7435a578.price"",""pos"":{""lineNum"":5,""columnNum"":5,""endLineNum"":5,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT_SCALAR@4d0b0fd4"",""value"":""BLOCK_SELECT@247667dd"",""pos"":{""lineNum"":7,""columnNum"":1,""endLineNum"":9,""endColumnNum"":30,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@1bbae752"",""value"":""NS_IDENT@87abc48.drinker"",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":4,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@76075d65"",""value"":""NS_IDENT@7435a578.price"",""pos"":{""lineNum"":5,""columnNum"":5,""endLineNum"":5,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7f02251"",""value"":""NS_IDENT@87abc48.beer"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@13047d7d"",""value"":""NS_IDENT@7435a578.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@53692008"",""value"":""NS_IDENT@7435a578.beer"",""pos"":{""lineNum"":3,""columnNum"":20,""endLineNum"":3,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@65bb9029"",""value"":""NS_IDENT@7435a578.BAR"",""pos"":{""lineNum"":1,""columnNum"":21,""endLineNum"":1,""endColumnNum"":30,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@87abc48.beer""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":10,""endColumnNum"":1,""quoted"":false},""children"":{""BLOCK_SELECT@247667dd"":{""id"":""BLOCK_SELECT@247667dd"",""parentId"":""BLOCK_SELECT@61d01788"",""fields"":[""EXPR$0 DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""OP_AGG_FUNC@25d3cfc8"",""value"":""MAX"",""pos"":{""lineNum"":7,""columnNum"":8,""endLineNum"":7,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@30331109"",""value"":""NS_IDENT@2b8d084.PRICE"",""pos"":{""lineNum"":7,""columnNum"":12,""endLineNum"":7,""endColumnNum"":23,""quoted"":false},""children"":[]}]}],""fromItemIds"":[""NS_IDENT@2b8d084""],""fromNode"":{""id"":""JOIN_OPERAND@1d4664d7"",""value"":""NS_IDENT@2b8d084"",""pos"":{""lineNum"":8,""columnNum"":6,""endLineNum"":8,""endColumnNum"":11,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@3e48e859"",""value"":""="",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":30,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@3a022576"",""value"":""NS_IDENT@2b8d084.beer"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@2dbd803f"",""value"":""NS_IDENT@87abc48.beer"",""pos"":{""lineNum"":9,""columnNum"":21,""endLineNum"":9,""endColumnNum"":30,""quoted"":false},""children"":[]}]},""isAggregate"":true,""identifiers"":[{""id"":""COLUMN_LOCAL@3a022576"",""value"":""NS_IDENT@2b8d084.beer"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@2dbd803f"",""value"":""NS_IDENT@87abc48.beer"",""pos"":{""lineNum"":9,""columnNum"":21,""endLineNum"":9,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@30331109"",""value"":""NS_IDENT@2b8d084.PRICE"",""pos"":{""lineNum"":7,""columnNum"":12,""endLineNum"":7,""endColumnNum"":23,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@87abc48""],""corrCtxIds"":[""BLOCK_SELECT@61d01788""],""pos"":{""lineNum"":7,""columnNum"":1,""endLineNum"":9,""endColumnNum"":30,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@7435a578"":{""tableId"":""NS_IDENT@7435a578"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":19,""endLineNum"":2,""endColumnNum"":31,""quoted"":false}},""NS_IDENT@87abc48"":{""tableId"":""NS_IDENT@87abc48"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":16,""quoted"":false}},""NS_IDENT@2b8d084"":{""tableId"":""NS_IDENT@2b8d084"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":6,""endLineNum"":8,""endColumnNum"":18,""quoted"":false}}},""corrTables"":[""NS_IDENT@87abc48""]}
"
"WITH DBP AS 
(SELECT beer, MAX(price) price FROM serves
WHERE beer IN (SELECT beer FROM likes WHERE drinker = 'Dan')  
GROUP BY beer)
SELECT serves.beer, serves.bar FROM DBP, serves
WHERE serves.beer = DBP.beer AND serves.price = DBP.price","{""blocks"":{""id"":""BLOCK_SELECT@1ddd3478"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@51827393"",""value"":""NS_IDENT@3c017078.BEER"",""pos"":{""lineNum"":5,""columnNum"":8,""endLineNum"":5,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5c645b43"",""value"":""NS_IDENT@3c017078.BAR"",""pos"":{""lineNum"":5,""columnNum"":21,""endLineNum"":5,""endColumnNum"":30,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@260f2144"",""NS_IDENT@3c017078""],""fromNode"":{""id"":""OP_JOIN@37c5fc56"",""value"":""COMMA"",""pos"":{""lineNum"":5,""columnNum"":40,""endLineNum"":5,""endColumnNum"":40,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@1c025cb"",""value"":""NS_IDENT@260f2144"",""pos"":{""lineNum"":5,""columnNum"":37,""endLineNum"":5,""endColumnNum"":39,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@50825a02"",""value"":""NS_IDENT@3c017078"",""pos"":{""lineNum"":5,""columnNum"":42,""endLineNum"":5,""endColumnNum"":47,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@215a34b4"",""value"":""AND"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":57,""quoted"":false},""children"":[{""id"":""OP_BINARY@1f1cae23"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":28,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5e9456ae"",""value"":""NS_IDENT@3c017078.beer"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@16a9a4f1"",""value"":""NS_IDENT@260f2144.BEER"",""pos"":{""lineNum"":6,""columnNum"":21,""endLineNum"":6,""endColumnNum"":28,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@5bcde458"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":34,""endLineNum"":6,""endColumnNum"":57,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7c455e96"",""value"":""NS_IDENT@3c017078.price"",""pos"":{""lineNum"":6,""columnNum"":34,""endLineNum"":6,""endColumnNum"":45,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@985696"",""value"":""NS_IDENT@260f2144.PRICE"",""pos"":{""lineNum"":6,""columnNum"":49,""endLineNum"":6,""endColumnNum"":57,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@5c645b43"",""value"":""NS_IDENT@3c017078.BAR"",""pos"":{""lineNum"":5,""columnNum"":21,""endLineNum"":5,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5e9456ae"",""value"":""NS_IDENT@3c017078.beer"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@16a9a4f1"",""value"":""NS_IDENT@260f2144.BEER"",""pos"":{""lineNum"":6,""columnNum"":21,""endLineNum"":6,""endColumnNum"":28,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7c455e96"",""value"":""NS_IDENT@3c017078.price"",""pos"":{""lineNum"":6,""columnNum"":34,""endLineNum"":6,""endColumnNum"":45,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@51827393"",""value"":""NS_IDENT@3c017078.BEER"",""pos"":{""lineNum"":5,""columnNum"":8,""endLineNum"":5,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@985696"",""value"":""NS_IDENT@260f2144.PRICE"",""pos"":{""lineNum"":6,""columnNum"":49,""endLineNum"":6,""endColumnNum"":57,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":5,""columnNum"":1,""endLineNum"":6,""endColumnNum"":57,""quoted"":false},""children"":{}},""tables"":{""NS_IDENT@260f2144"":{""tableId"":""NS_IDENT@260f2144"",""identifier"":""DBP"",""dbTableName"":""DBP"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":37,""endLineNum"":5,""endColumnNum"":39,""quoted"":false}},""NS_IDENT@29852487"":{""tableId"":""NS_IDENT@29852487"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":33,""endLineNum"":3,""endColumnNum"":37,""quoted"":false}},""NS_IDENT@3c017078"":{""tableId"":""NS_IDENT@3c017078"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":42,""endLineNum"":5,""endColumnNum"":47,""quoted"":false}},""NS_IDENT@14fc5d40"":{""tableId"":""NS_IDENT@14fc5d40"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":37,""endLineNum"":2,""endColumnNum"":42,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@2d66530f"",""alias"":""DBP"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@51dbd6e4"",""value"":""NS_IDENT@14fc5d40.BEER"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@5f13be1"",""value"":""MAX"",""pos"":{""lineNum"":2,""columnNum"":15,""endLineNum"":2,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5f303ecd"",""value"":""NS_IDENT@14fc5d40.PRICE"",""pos"":{""lineNum"":2,""columnNum"":19,""endLineNum"":2,""endColumnNum"":23,""quoted"":false},""children"":[]}],""alias"":""PRICE""}],""fromItemIds"":[""NS_IDENT@14fc5d40""],""fromNode"":{""id"":""JOIN_OPERAND@6df7988f"",""value"":""NS_IDENT@14fc5d40"",""pos"":{""lineNum"":2,""columnNum"":37,""endLineNum"":2,""endColumnNum"":42,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@29fc1a2b"",""value"":""IN"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":59,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@27b71f50"",""value"":""NS_IDENT@14fc5d40.beer"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@59712875"",""value"":""BLOCK_SELECT@59712875"",""pos"":{""lineNum"":3,""columnNum"":16,""endLineNum"":3,""endColumnNum"":59,""quoted"":false},""children"":[]}]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@5eb97ced"",""value"":""NS_IDENT@14fc5d40.beer"",""pos"":{""lineNum"":4,""columnNum"":10,""endLineNum"":4,""endColumnNum"":13,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@51dbd6e4"",""value"":""NS_IDENT@14fc5d40.BEER"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5eb97ced"",""value"":""NS_IDENT@14fc5d40.beer"",""pos"":{""lineNum"":4,""columnNum"":10,""endLineNum"":4,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@27b71f50"",""value"":""NS_IDENT@14fc5d40.beer"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5f303ecd"",""value"":""NS_IDENT@14fc5d40.PRICE"",""pos"":{""lineNum"":2,""columnNum"":19,""endLineNum"":2,""endColumnNum"":23,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":2,""endLineNum"":4,""endColumnNum"":13,""quoted"":false},""children"":{""BLOCK_SELECT@59712875"":{""id"":""BLOCK_SELECT@59712875"",""parentId"":""BLOCK_SELECT@2d66530f"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@677b8e13"",""value"":""NS_IDENT@29852487.BEER"",""pos"":{""lineNum"":3,""columnNum"":23,""endLineNum"":3,""endColumnNum"":26,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@29852487""],""fromNode"":{""id"":""JOIN_OPERAND@bdecc21"",""value"":""NS_IDENT@29852487"",""pos"":{""lineNum"":3,""columnNum"":33,""endLineNum"":3,""endColumnNum"":37,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@5cf8edcf"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":45,""endLineNum"":3,""endColumnNum"":59,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@57540fd0"",""value"":""NS_IDENT@29852487.drinker"",""pos"":{""lineNum"":3,""columnNum"":45,""endLineNum"":3,""endColumnNum"":51,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@7bde1f3a"",""value"":""'Dan'"",""pos"":{""lineNum"":3,""columnNum"":55,""endLineNum"":3,""endColumnNum"":59,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@677b8e13"",""value"":""NS_IDENT@29852487.BEER"",""pos"":{""lineNum"":3,""columnNum"":23,""endLineNum"":3,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@57540fd0"",""value"":""NS_IDENT@29852487.drinker"",""pos"":{""lineNum"":3,""columnNum"":45,""endLineNum"":3,""endColumnNum"":51,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":16,""endLineNum"":3,""endColumnNum"":59,""quoted"":false},""children"":{}}}}]}
"
"Select distinct beer, bar
From serves
Where (beer, price) in (Select distinct beer, max(price)
From serves
Where beer in (Select beer
  From likes s1
  Where drinker='Dan')
Group by beer);
","{""failed"":true}
"
"select serves.beer, serves.bar
from serves, likes
where likes.drinker = 'Dan' and  likes.beer = serves.beer and serves.price >= ALL(SELECT serves.price FROM serves where likes.drinker = 'Dan' and  likes.beer = serves.beer );","{""blocks"":{""id"":""BLOCK_SELECT@4a03bb68"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@6a10b263"",""value"":""NS_IDENT@5e39850.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@325bb9a6"",""value"":""NS_IDENT@5e39850.BAR"",""pos"":{""lineNum"":1,""columnNum"":21,""endLineNum"":1,""endColumnNum"":30,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@5e39850"",""NS_IDENT@78c1a023""],""fromNode"":{""id"":""OP_JOIN@54da32dc"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":12,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@1d782abe"",""value"":""NS_IDENT@5e39850"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@6df7988f"",""value"":""NS_IDENT@78c1a023"",""pos"":{""lineNum"":2,""columnNum"":14,""endLineNum"":2,""endColumnNum"":18,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@27b71f50"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":171,""quoted"":false},""children"":[{""id"":""OP_BINARY@5cf87cfd"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":57,""quoted"":false},""children"":[{""id"":""OP_BINARY@53692008"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":27,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7f02251"",""value"":""NS_IDENT@78c1a023.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@29fc1a2b"",""value"":""'Dan'"",""pos"":{""lineNum"":3,""columnNum"":23,""endLineNum"":3,""endColumnNum"":27,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@460b6d54"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":34,""endLineNum"":3,""endColumnNum"":57,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7b2a3ff8"",""value"":""NS_IDENT@78c1a023.beer"",""pos"":{""lineNum"":3,""columnNum"":34,""endLineNum"":3,""endColumnNum"":43,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1bbae752"",""value"":""NS_IDENT@5e39850.beer"",""pos"":{""lineNum"":3,""columnNum"":47,""endLineNum"":3,""endColumnNum"":57,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@3a4ba480"",""value"":"">= ALL"",""pos"":{""lineNum"":3,""columnNum"":63,""endLineNum"":3,""endColumnNum"":171,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@76075d65"",""value"":""NS_IDENT@5e39850.price"",""pos"":{""lineNum"":3,""columnNum"":63,""endLineNum"":3,""endColumnNum"":74,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@6bcbf05b"",""value"":""BLOCK_SELECT@6bcbf05b"",""pos"":{""lineNum"":3,""columnNum"":83,""endLineNum"":3,""endColumnNum"":171,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@76075d65"",""value"":""NS_IDENT@5e39850.price"",""pos"":{""lineNum"":3,""columnNum"":63,""endLineNum"":3,""endColumnNum"":74,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7f02251"",""value"":""NS_IDENT@78c1a023.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@325bb9a6"",""value"":""NS_IDENT@5e39850.BAR"",""pos"":{""lineNum"":1,""columnNum"":21,""endLineNum"":1,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7b2a3ff8"",""value"":""NS_IDENT@78c1a023.beer"",""pos"":{""lineNum"":3,""columnNum"":34,""endLineNum"":3,""endColumnNum"":43,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1bbae752"",""value"":""NS_IDENT@5e39850.beer"",""pos"":{""lineNum"":3,""columnNum"":47,""endLineNum"":3,""endColumnNum"":57,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6a10b263"",""value"":""NS_IDENT@5e39850.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":18,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@78c1a023.beer"",""NS_IDENT@78c1a023.drinker""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":3,""endColumnNum"":173,""quoted"":false},""children"":{""BLOCK_SELECT@6bcbf05b"":{""id"":""BLOCK_SELECT@6bcbf05b"",""parentId"":""BLOCK_SELECT@4a03bb68"",""fields"":[""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@6c37bd27"",""value"":""NS_IDENT@2227a6c1.PRICE"",""pos"":{""lineNum"":3,""columnNum"":90,""endLineNum"":3,""endColumnNum"":101,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@2227a6c1""],""fromNode"":{""id"":""JOIN_OPERAND@37a64f9d"",""value"":""NS_IDENT@2227a6c1"",""pos"":{""lineNum"":3,""columnNum"":108,""endLineNum"":3,""endColumnNum"":113,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@7df60067"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":121,""endLineNum"":3,""endColumnNum"":171,""quoted"":false},""children"":[{""id"":""OP_BINARY@31ddd4a4"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":121,""endLineNum"":3,""endColumnNum"":141,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@3e48e859"",""value"":""NS_IDENT@78c1a023.drinker"",""pos"":{""lineNum"":3,""columnNum"":121,""endLineNum"":3,""endColumnNum"":133,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@4fe875be"",""value"":""'Dan'"",""pos"":{""lineNum"":3,""columnNum"":137,""endLineNum"":3,""endColumnNum"":141,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@22d1886d"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":148,""endLineNum"":3,""endColumnNum"":171,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@1a5f7e7c"",""value"":""NS_IDENT@78c1a023.beer"",""pos"":{""lineNum"":3,""columnNum"":148,""endLineNum"":3,""endColumnNum"":157,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5b22b970"",""value"":""NS_IDENT@2227a6c1.beer"",""pos"":{""lineNum"":3,""columnNum"":161,""endLineNum"":3,""endColumnNum"":171,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_CORRELATE@3e48e859"",""value"":""NS_IDENT@78c1a023.drinker"",""pos"":{""lineNum"":3,""columnNum"":121,""endLineNum"":3,""endColumnNum"":133,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@1a5f7e7c"",""value"":""NS_IDENT@78c1a023.beer"",""pos"":{""lineNum"":3,""columnNum"":148,""endLineNum"":3,""endColumnNum"":157,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6c37bd27"",""value"":""NS_IDENT@2227a6c1.PRICE"",""pos"":{""lineNum"":3,""columnNum"":90,""endLineNum"":3,""endColumnNum"":101,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5b22b970"",""value"":""NS_IDENT@2227a6c1.beer"",""pos"":{""lineNum"":3,""columnNum"":161,""endLineNum"":3,""endColumnNum"":171,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@78c1a023""],""corrCtxIds"":[""BLOCK_SELECT@4a03bb68""],""pos"":{""lineNum"":3,""columnNum"":83,""endLineNum"":3,""endColumnNum"":171,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@2227a6c1"":{""tableId"":""NS_IDENT@2227a6c1"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":108,""endLineNum"":3,""endColumnNum"":113,""quoted"":false}},""NS_IDENT@5e39850"":{""tableId"":""NS_IDENT@5e39850"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":11,""quoted"":false}},""NS_IDENT@78c1a023"":{""tableId"":""NS_IDENT@78c1a023"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":14,""endLineNum"":2,""endColumnNum"":18,""quoted"":false}}},""corrTables"":[""NS_IDENT@78c1a023""]}
"
"with beerprice as
(select s.beer as beer , max(s.price) as price
from serves s
where s.beer in (select l.beer from likes l where l.drinker = 'Dan')
group by s.beer)

select x.beer, x.bar
from beerprice f, serves x
where f.beer = x. beer and f.price = x.price","{""blocks"":{""id"":""BLOCK_SELECT@5226e402"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@58399d82"",""value"":""NS_IDENT@298d9a05.BEER"",""pos"":{""lineNum"":7,""columnNum"":8,""endLineNum"":7,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@46d8f407"",""value"":""NS_IDENT@298d9a05.BAR"",""pos"":{""lineNum"":7,""columnNum"":16,""endLineNum"":7,""endColumnNum"":20,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@6bd16207"",""NS_IDENT@298d9a05""],""fromNode"":{""id"":""OP_JOIN@1ddd3478"",""value"":""COMMA"",""pos"":{""lineNum"":8,""columnNum"":17,""endLineNum"":8,""endColumnNum"":17,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@f973499"",""value"":""NS_IDENT@6bd16207"",""pos"":{""lineNum"":8,""columnNum"":6,""endLineNum"":8,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@4d33940d"",""value"":""NS_IDENT@298d9a05"",""pos"":{""lineNum"":8,""columnNum"":19,""endLineNum"":8,""endColumnNum"":24,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@6dd91637"",""value"":""AND"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":44,""quoted"":false},""children"":[{""id"":""OP_BINARY@77bd7fe7"",""value"":""="",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":22,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5bcde458"",""value"":""NS_IDENT@6bd16207.BEER"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@215a34b4"",""value"":""NS_IDENT@298d9a05.beer"",""pos"":{""lineNum"":9,""columnNum"":16,""endLineNum"":9,""endColumnNum"":22,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@71870da7"",""value"":""="",""pos"":{""lineNum"":9,""columnNum"":28,""endLineNum"":9,""endColumnNum"":44,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@35d3ab60"",""value"":""NS_IDENT@6bd16207.PRICE"",""pos"":{""lineNum"":9,""columnNum"":28,""endLineNum"":9,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@10876a6"",""value"":""NS_IDENT@298d9a05.price"",""pos"":{""lineNum"":9,""columnNum"":38,""endLineNum"":9,""endColumnNum"":44,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@215a34b4"",""value"":""NS_IDENT@298d9a05.beer"",""pos"":{""lineNum"":9,""columnNum"":16,""endLineNum"":9,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@10876a6"",""value"":""NS_IDENT@298d9a05.price"",""pos"":{""lineNum"":9,""columnNum"":38,""endLineNum"":9,""endColumnNum"":44,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@35d3ab60"",""value"":""NS_IDENT@6bd16207.PRICE"",""pos"":{""lineNum"":9,""columnNum"":28,""endLineNum"":9,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@46d8f407"",""value"":""NS_IDENT@298d9a05.BAR"",""pos"":{""lineNum"":7,""columnNum"":16,""endLineNum"":7,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@58399d82"",""value"":""NS_IDENT@298d9a05.BEER"",""pos"":{""lineNum"":7,""columnNum"":8,""endLineNum"":7,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5bcde458"",""value"":""NS_IDENT@6bd16207.BEER"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":12,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":7,""columnNum"":1,""endLineNum"":9,""endColumnNum"":44,""quoted"":false},""children"":{}},""tables"":{""NS_IDENT@51dbd6e4"":{""tableId"":""NS_IDENT@51dbd6e4"",""identifier"":""S"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":6,""endLineNum"":3,""endColumnNum"":13,""quoted"":false}},""NS_IDENT@3c017078"":{""tableId"":""NS_IDENT@3c017078"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":37,""endLineNum"":4,""endColumnNum"":43,""quoted"":false}},""NS_IDENT@6bd16207"":{""tableId"":""NS_IDENT@6bd16207"",""identifier"":""F"",""dbTableName"":""BEERPRICE"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":6,""endLineNum"":8,""endColumnNum"":16,""quoted"":false}},""NS_IDENT@298d9a05"":{""tableId"":""NS_IDENT@298d9a05"",""identifier"":""X"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":19,""endLineNum"":8,""endColumnNum"":26,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@1d207fad"",""alias"":""BEERPRICE"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@25a73de1"",""value"":""NS_IDENT@51dbd6e4.BEER"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":14,""quoted"":false},""children"":[],""alias"":""BEER""},{""id"":""OP_AGG_FUNC@771db12c"",""value"":""MAX"",""pos"":{""lineNum"":2,""columnNum"":26,""endLineNum"":2,""endColumnNum"":37,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@3afae281"",""value"":""NS_IDENT@51dbd6e4.PRICE"",""pos"":{""lineNum"":2,""columnNum"":30,""endLineNum"":2,""endColumnNum"":36,""quoted"":false},""children"":[]}],""alias"":""PRICE""}],""fromItemIds"":[""NS_IDENT@51dbd6e4""],""fromNode"":{""id"":""JOIN_OPERAND@3a095ec0"",""value"":""NS_IDENT@51dbd6e4"",""pos"":{""lineNum"":3,""columnNum"":6,""endLineNum"":3,""endColumnNum"":11,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@7a24eb3"",""value"":""IN"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":67,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@74971ed9"",""value"":""NS_IDENT@51dbd6e4.beer"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@47b2e9e1"",""value"":""BLOCK_SELECT@47b2e9e1"",""pos"":{""lineNum"":4,""columnNum"":18,""endLineNum"":4,""endColumnNum"":67,""quoted"":false},""children"":[]}]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@7aad3f7d"",""value"":""NS_IDENT@51dbd6e4.beer"",""pos"":{""lineNum"":5,""columnNum"":10,""endLineNum"":5,""endColumnNum"":15,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@25a73de1"",""value"":""NS_IDENT@51dbd6e4.BEER"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":14,""quoted"":false},""children"":[],""alias"":""BEER""},{""id"":""COLUMN_LOCAL@3afae281"",""value"":""NS_IDENT@51dbd6e4.PRICE"",""pos"":{""lineNum"":2,""columnNum"":30,""endLineNum"":2,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7aad3f7d"",""value"":""NS_IDENT@51dbd6e4.beer"",""pos"":{""lineNum"":5,""columnNum"":10,""endLineNum"":5,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@74971ed9"",""value"":""NS_IDENT@51dbd6e4.beer"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":12,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":2,""endLineNum"":5,""endColumnNum"":15,""quoted"":false},""children"":{""BLOCK_SELECT@47b2e9e1"":{""id"":""BLOCK_SELECT@47b2e9e1"",""parentId"":""BLOCK_SELECT@1d207fad"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@4c27d39d"",""value"":""NS_IDENT@3c017078.BEER"",""pos"":{""lineNum"":4,""columnNum"":25,""endLineNum"":4,""endColumnNum"":30,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@3c017078""],""fromNode"":{""id"":""JOIN_OPERAND@25b865b5"",""value"":""NS_IDENT@3c017078"",""pos"":{""lineNum"":4,""columnNum"":37,""endLineNum"":4,""endColumnNum"":41,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@1542af63"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":51,""endLineNum"":4,""endColumnNum"":67,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@629f066f"",""value"":""NS_IDENT@3c017078.drinker"",""pos"":{""lineNum"":4,""columnNum"":51,""endLineNum"":4,""endColumnNum"":59,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@57540fd0"",""value"":""'Dan'"",""pos"":{""lineNum"":4,""columnNum"":63,""endLineNum"":4,""endColumnNum"":67,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@4c27d39d"",""value"":""NS_IDENT@3c017078.BEER"",""pos"":{""lineNum"":4,""columnNum"":25,""endLineNum"":4,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@629f066f"",""value"":""NS_IDENT@3c017078.drinker"",""pos"":{""lineNum"":4,""columnNum"":51,""endLineNum"":4,""endColumnNum"":59,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":4,""columnNum"":18,""endLineNum"":4,""endColumnNum"":67,""quoted"":false},""children"":{}}}}]}
"
"
WITH 

	dansdrinks(bar, beer, price) AS
	(SELECT s.bar, l.beer, s.price
	FROM serves s, likes l
	WHERE s.beer = l.beer AND l.drinker = 'Dan'),

	cheap(beer, bar) AS
	(SELECT d1.beer, d1.bar
	FROM dansdrinks d1, dansdrinks d2
	WHERE d1.beer = d2.beer AND d1.price < d2.price)

(SELECT beer, bar FROM dansdrinks)
EXCEPT
(SELECT beer, bar FROM cheap);","{""blocks"":{""id"":""BLOCK_SETOP@765df79d"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@151335cb"",""rightBlockId"":""BLOCK_SELECT@4e4c3a38"",""pos"":{""lineNum"":14,""columnNum"":2,""endLineNum"":16,""endColumnNum"":28,""quoted"":false},""children"":{""BLOCK_SELECT@151335cb"":{""id"":""BLOCK_SELECT@151335cb"",""parentId"":""BLOCK_SETOP@765df79d"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@377008df"",""value"":""NS_IDENT@f72203.BEER"",""pos"":{""lineNum"":14,""columnNum"":9,""endLineNum"":14,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@22bb5646"",""value"":""NS_IDENT@f72203.BAR"",""pos"":{""lineNum"":14,""columnNum"":15,""endLineNum"":14,""endColumnNum"":17,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@f72203""],""fromNode"":{""id"":""JOIN_OPERAND@4abf3f0"",""value"":""NS_IDENT@f72203"",""pos"":{""lineNum"":14,""columnNum"":24,""endLineNum"":14,""endColumnNum"":33,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@377008df"",""value"":""NS_IDENT@f72203.BEER"",""pos"":{""lineNum"":14,""columnNum"":9,""endLineNum"":14,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@22bb5646"",""value"":""NS_IDENT@f72203.BAR"",""pos"":{""lineNum"":14,""columnNum"":15,""endLineNum"":14,""endColumnNum"":17,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":14,""columnNum"":2,""endLineNum"":14,""endColumnNum"":33,""quoted"":false},""children"":{}},""BLOCK_SELECT@4e4c3a38"":{""id"":""BLOCK_SELECT@4e4c3a38"",""parentId"":""BLOCK_SETOP@765df79d"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@153d4abb"",""value"":""NS_IDENT@2ce45a7b.BEER"",""pos"":{""lineNum"":16,""columnNum"":9,""endLineNum"":16,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5a67e962"",""value"":""NS_IDENT@2ce45a7b.BAR"",""pos"":{""lineNum"":16,""columnNum"":15,""endLineNum"":16,""endColumnNum"":17,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@2ce45a7b""],""fromNode"":{""id"":""JOIN_OPERAND@293cde83"",""value"":""NS_IDENT@2ce45a7b"",""pos"":{""lineNum"":16,""columnNum"":24,""endLineNum"":16,""endColumnNum"":28,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@153d4abb"",""value"":""NS_IDENT@2ce45a7b.BEER"",""pos"":{""lineNum"":16,""columnNum"":9,""endLineNum"":16,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5a67e962"",""value"":""NS_IDENT@2ce45a7b.BAR"",""pos"":{""lineNum"":16,""columnNum"":15,""endLineNum"":16,""endColumnNum"":17,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":16,""columnNum"":2,""endLineNum"":16,""endColumnNum"":28,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@451f87af"":{""tableId"":""NS_IDENT@451f87af"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":17,""endLineNum"":6,""endColumnNum"":23,""quoted"":false}},""NS_IDENT@3fa76c61"":{""tableId"":""NS_IDENT@3fa76c61"",""identifier"":""D1"",""dbTableName"":""DANSDRINKS"",""fields"":[""BAR VARCHAR(100)"",""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":11,""columnNum"":7,""endLineNum"":11,""endColumnNum"":19,""quoted"":false}},""NS_IDENT@f72203"":{""tableId"":""NS_IDENT@f72203"",""identifier"":""DANSDRINKS"",""dbTableName"":""DANSDRINKS"",""fields"":[""BAR VARCHAR(100)"",""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":14,""columnNum"":24,""endLineNum"":14,""endColumnNum"":33,""quoted"":false}},""NS_IDENT@2ce45a7b"":{""tableId"":""NS_IDENT@2ce45a7b"",""identifier"":""CHEAP"",""dbTableName"":""CHEAP"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":16,""columnNum"":24,""endLineNum"":16,""endColumnNum"":28,""quoted"":false}},""NS_IDENT@2d5f7182"":{""tableId"":""NS_IDENT@2d5f7182"",""identifier"":""D2"",""dbTableName"":""DANSDRINKS"",""fields"":[""BAR VARCHAR(100)"",""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":11,""columnNum"":22,""endLineNum"":11,""endColumnNum"":34,""quoted"":false}},""NS_IDENT@57b75756"":{""tableId"":""NS_IDENT@57b75756"",""identifier"":""S"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":14,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@2d66530f"",""alias"":""DANSDRINKS"",""fields"":[""BAR VARCHAR(100)"",""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@44cb460e"",""value"":""NS_IDENT@57b75756.BAR"",""pos"":{""lineNum"":5,""columnNum"":10,""endLineNum"":5,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2e3cdec2"",""value"":""NS_IDENT@451f87af.BEER"",""pos"":{""lineNum"":5,""columnNum"":17,""endLineNum"":5,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3051e0b2"",""value"":""NS_IDENT@57b75756.PRICE"",""pos"":{""lineNum"":5,""columnNum"":25,""endLineNum"":5,""endColumnNum"":31,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@57b75756"",""NS_IDENT@451f87af""],""fromNode"":{""id"":""OP_JOIN@1869f114"",""value"":""COMMA"",""pos"":{""lineNum"":6,""columnNum"":15,""endLineNum"":6,""endColumnNum"":15,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@6872f9c8"",""value"":""NS_IDENT@57b75756"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@52a36910"",""value"":""NS_IDENT@451f87af"",""pos"":{""lineNum"":6,""columnNum"":17,""endLineNum"":6,""endColumnNum"":21,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@3b0ee03a"",""value"":""AND"",""pos"":{""lineNum"":7,""columnNum"":8,""endLineNum"":7,""endColumnNum"":44,""quoted"":false},""children"":[{""id"":""OP_BINARY@4349754"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":8,""endLineNum"":7,""endColumnNum"":22,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@ae372b9"",""value"":""NS_IDENT@57b75756.beer"",""pos"":{""lineNum"":7,""columnNum"":8,""endLineNum"":7,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2532b351"",""value"":""NS_IDENT@451f87af.beer"",""pos"":{""lineNum"":7,""columnNum"":17,""endLineNum"":7,""endColumnNum"":22,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@b967222"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":28,""endLineNum"":7,""endColumnNum"":44,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@6a2eea2a"",""value"":""NS_IDENT@451f87af.drinker"",""pos"":{""lineNum"":7,""columnNum"":28,""endLineNum"":7,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@28a6301f"",""value"":""'Dan'"",""pos"":{""lineNum"":7,""columnNum"":40,""endLineNum"":7,""endColumnNum"":44,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@44cb460e"",""value"":""NS_IDENT@57b75756.BAR"",""pos"":{""lineNum"":5,""columnNum"":10,""endLineNum"":5,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6a2eea2a"",""value"":""NS_IDENT@451f87af.drinker"",""pos"":{""lineNum"":7,""columnNum"":28,""endLineNum"":7,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2e3cdec2"",""value"":""NS_IDENT@451f87af.BEER"",""pos"":{""lineNum"":5,""columnNum"":17,""endLineNum"":5,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@ae372b9"",""value"":""NS_IDENT@57b75756.beer"",""pos"":{""lineNum"":7,""columnNum"":8,""endLineNum"":7,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3051e0b2"",""value"":""NS_IDENT@57b75756.PRICE"",""pos"":{""lineNum"":5,""columnNum"":25,""endLineNum"":5,""endColumnNum"":31,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2532b351"",""value"":""NS_IDENT@451f87af.beer"",""pos"":{""lineNum"":7,""columnNum"":17,""endLineNum"":7,""endColumnNum"":22,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":5,""columnNum"":3,""endLineNum"":7,""endColumnNum"":44,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@66bfd864"",""alias"":""CHEAP"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@4ed38226"",""value"":""NS_IDENT@3fa76c61.BEER"",""pos"":{""lineNum"":10,""columnNum"":10,""endLineNum"":10,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3d43fe"",""value"":""NS_IDENT@3fa76c61.BAR"",""pos"":{""lineNum"":10,""columnNum"":19,""endLineNum"":10,""endColumnNum"":24,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@3fa76c61"",""NS_IDENT@2d5f7182""],""fromNode"":{""id"":""OP_JOIN@4aac85fa"",""value"":""COMMA"",""pos"":{""lineNum"":11,""columnNum"":20,""endLineNum"":11,""endColumnNum"":20,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@21fff664"",""value"":""NS_IDENT@3fa76c61"",""pos"":{""lineNum"":11,""columnNum"":7,""endLineNum"":11,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@6079cf5"",""value"":""NS_IDENT@2d5f7182"",""pos"":{""lineNum"":11,""columnNum"":22,""endLineNum"":11,""endColumnNum"":31,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@7e9da981"",""value"":""AND"",""pos"":{""lineNum"":12,""columnNum"":8,""endLineNum"":12,""endColumnNum"":48,""quoted"":false},""children"":[{""id"":""OP_BINARY@2822c6ff"",""value"":""="",""pos"":{""lineNum"":12,""columnNum"":8,""endLineNum"":12,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@621f89b8"",""value"":""NS_IDENT@3fa76c61.BEER"",""pos"":{""lineNum"":12,""columnNum"":8,""endLineNum"":12,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@f339eae"",""value"":""NS_IDENT@2d5f7182.BEER"",""pos"":{""lineNum"":12,""columnNum"":18,""endLineNum"":12,""endColumnNum"":24,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@40368a46"",""value"":""<"",""pos"":{""lineNum"":12,""columnNum"":30,""endLineNum"":12,""endColumnNum"":48,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4dafba3e"",""value"":""NS_IDENT@3fa76c61.PRICE"",""pos"":{""lineNum"":12,""columnNum"":30,""endLineNum"":12,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@53e3a87a"",""value"":""NS_IDENT@2d5f7182.PRICE"",""pos"":{""lineNum"":12,""columnNum"":41,""endLineNum"":12,""endColumnNum"":48,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@f339eae"",""value"":""NS_IDENT@2d5f7182.BEER"",""pos"":{""lineNum"":12,""columnNum"":18,""endLineNum"":12,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@621f89b8"",""value"":""NS_IDENT@3fa76c61.BEER"",""pos"":{""lineNum"":12,""columnNum"":8,""endLineNum"":12,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@53e3a87a"",""value"":""NS_IDENT@2d5f7182.PRICE"",""pos"":{""lineNum"":12,""columnNum"":41,""endLineNum"":12,""endColumnNum"":48,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4ed38226"",""value"":""NS_IDENT@3fa76c61.BEER"",""pos"":{""lineNum"":10,""columnNum"":10,""endLineNum"":10,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3d43fe"",""value"":""NS_IDENT@3fa76c61.BAR"",""pos"":{""lineNum"":10,""columnNum"":19,""endLineNum"":10,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4dafba3e"",""value"":""NS_IDENT@3fa76c61.PRICE"",""pos"":{""lineNum"":12,""columnNum"":30,""endLineNum"":12,""endColumnNum"":37,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":10,""columnNum"":3,""endLineNum"":12,""endColumnNum"":48,""quoted"":false},""children"":{}}]}
"
"SELECT DISTINCT A.beer, A.bar
FROM likes, serves A
WHERE likes.drinker = 'Dan' and likes.beer = A.beer 
and A.price >= ALL(SELECT price
                  FROM serves B
                  WHERE B.beer = A.beer and B.bar != A.bar)","{""failed"":true,""errorMsg"":""Parsing error at line 6, column 51. Query syntax may be incorrect""}
"
"with DanBars as
  (select S.bar, S.beer, S.price
  from serves S, likes L
  where L.beer = S.beer and L.drinker = 'Dan')

select beer, bar
from DanBars D1
where not exists 
  (select *
  from DanBars D2
  where D2.price > D1.price and D1.beer = D2.beer);","{""blocks"":{""id"":""BLOCK_SELECT@1917d90f"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@215a34b4"",""value"":""NS_IDENT@5bcde458.BEER"",""pos"":{""lineNum"":6,""columnNum"":8,""endLineNum"":6,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@35d3ab60"",""value"":""NS_IDENT@5bcde458.BAR"",""pos"":{""lineNum"":6,""columnNum"":14,""endLineNum"":6,""endColumnNum"":16,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@5bcde458""],""fromNode"":{""id"":""JOIN_OPERAND@21fff664"",""value"":""NS_IDENT@5bcde458"",""pos"":{""lineNum"":7,""columnNum"":6,""endLineNum"":7,""endColumnNum"":12,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_PREFIX@4a55a6e8"",""value"":""NOT"",""pos"":{""lineNum"":8,""columnNum"":7,""endLineNum"":11,""endColumnNum"":49,""quoted"":false},""children"":[{""id"":""OP_PREFIX@660591fb"",""value"":""EXISTS"",""pos"":{""lineNum"":8,""columnNum"":11,""endLineNum"":11,""endColumnNum"":49,""quoted"":false},""children"":[{""id"":""BLOCK_SELECT@66bfd864"",""value"":""BLOCK_SELECT@66bfd864"",""pos"":{""lineNum"":9,""columnNum"":4,""endLineNum"":11,""endColumnNum"":49,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@215a34b4"",""value"":""NS_IDENT@5bcde458.BEER"",""pos"":{""lineNum"":6,""columnNum"":8,""endLineNum"":6,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@35d3ab60"",""value"":""NS_IDENT@5bcde458.BAR"",""pos"":{""lineNum"":6,""columnNum"":14,""endLineNum"":6,""endColumnNum"":16,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@5bcde458.BEER"",""NS_IDENT@5bcde458.PRICE""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":6,""columnNum"":1,""endLineNum"":11,""endColumnNum"":50,""quoted"":false},""children"":{""BLOCK_SELECT@66bfd864"":{""id"":""BLOCK_SELECT@66bfd864"",""parentId"":""BLOCK_SELECT@1917d90f"",""fields"":[""BAR VARCHAR(100)"",""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@682bd3c4"",""value"":""*"",""pos"":{""lineNum"":9,""columnNum"":11,""endLineNum"":9,""endColumnNum"":11,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@71870da7""],""fromNode"":{""id"":""JOIN_OPERAND@4aac85fa"",""value"":""NS_IDENT@71870da7"",""pos"":{""lineNum"":10,""columnNum"":8,""endLineNum"":10,""endColumnNum"":14,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@24097e9b"",""value"":""AND"",""pos"":{""lineNum"":11,""columnNum"":9,""endLineNum"":11,""endColumnNum"":49,""quoted"":false},""children"":[{""id"":""OP_BINARY@5eb97ced"",""value"":"">"",""pos"":{""lineNum"":11,""columnNum"":9,""endLineNum"":11,""endColumnNum"":27,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@68ba310d"",""value"":""NS_IDENT@71870da7.PRICE"",""pos"":{""lineNum"":11,""columnNum"":9,""endLineNum"":11,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@153f66e7"",""value"":""NS_IDENT@5bcde458.PRICE"",""pos"":{""lineNum"":11,""columnNum"":20,""endLineNum"":11,""endColumnNum"":27,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@7aad3f7d"",""value"":""="",""pos"":{""lineNum"":11,""columnNum"":33,""endLineNum"":11,""endColumnNum"":49,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@6f667ad1"",""value"":""NS_IDENT@5bcde458.BEER"",""pos"":{""lineNum"":11,""columnNum"":33,""endLineNum"":11,""endColumnNum"":39,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@566d0c69"",""value"":""NS_IDENT@71870da7.BEER"",""pos"":{""lineNum"":11,""columnNum"":43,""endLineNum"":11,""endColumnNum"":49,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@68ba310d"",""value"":""NS_IDENT@71870da7.PRICE"",""pos"":{""lineNum"":11,""columnNum"":9,""endLineNum"":11,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@153f66e7"",""value"":""NS_IDENT@5bcde458.PRICE"",""pos"":{""lineNum"":11,""columnNum"":20,""endLineNum"":11,""endColumnNum"":27,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@6f667ad1"",""value"":""NS_IDENT@5bcde458.BEER"",""pos"":{""lineNum"":11,""columnNum"":33,""endLineNum"":11,""endColumnNum"":39,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@566d0c69"",""value"":""NS_IDENT@71870da7.BEER"",""pos"":{""lineNum"":11,""columnNum"":43,""endLineNum"":11,""endColumnNum"":49,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@5bcde458""],""corrCtxIds"":[""BLOCK_SELECT@1917d90f""],""pos"":{""lineNum"":9,""columnNum"":4,""endLineNum"":11,""endColumnNum"":49,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@5bcde458"":{""tableId"":""NS_IDENT@5bcde458"",""identifier"":""D1"",""dbTableName"":""DANBARS"",""fields"":[""BAR VARCHAR(100)"",""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":6,""endLineNum"":7,""endColumnNum"":15,""quoted"":false}},""NS_IDENT@7d755813"":{""tableId"":""NS_IDENT@7d755813"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":24,""quoted"":false}},""NS_IDENT@71870da7"":{""tableId"":""NS_IDENT@71870da7"",""identifier"":""D2"",""dbTableName"":""DANBARS"",""fields"":[""BAR VARCHAR(100)"",""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":10,""columnNum"":8,""endLineNum"":10,""endColumnNum"":17,""quoted"":false}},""NS_IDENT@7551da2a"":{""tableId"":""NS_IDENT@7551da2a"",""identifier"":""S"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":8,""endLineNum"":3,""endColumnNum"":15,""quoted"":false}}},""corrTables"":[""NS_IDENT@5bcde458""],""withBlocks"":[{""id"":""BLOCK_SELECT@2d66530f"",""alias"":""DANBARS"",""fields"":[""BAR VARCHAR(100)"",""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@63da207f"",""value"":""NS_IDENT@7551da2a.BAR"",""pos"":{""lineNum"":2,""columnNum"":11,""endLineNum"":2,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@40d10481"",""value"":""NS_IDENT@7551da2a.BEER"",""pos"":{""lineNum"":2,""columnNum"":18,""endLineNum"":2,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@52b6319f"",""value"":""NS_IDENT@7551da2a.PRICE"",""pos"":{""lineNum"":2,""columnNum"":26,""endLineNum"":2,""endColumnNum"":32,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@7551da2a"",""NS_IDENT@7d755813""],""fromNode"":{""id"":""OP_JOIN@1869f114"",""value"":""COMMA"",""pos"":{""lineNum"":3,""columnNum"":16,""endLineNum"":3,""endColumnNum"":16,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@6872f9c8"",""value"":""NS_IDENT@7551da2a"",""pos"":{""lineNum"":3,""columnNum"":8,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@52a36910"",""value"":""NS_IDENT@7d755813"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":22,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@7a24eb3"",""value"":""AND"",""pos"":{""lineNum"":4,""columnNum"":9,""endLineNum"":4,""endColumnNum"":45,""quoted"":false},""children"":[{""id"":""OP_BINARY@4455f57d"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":9,""endLineNum"":4,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@76075d65"",""value"":""NS_IDENT@7d755813.beer"",""pos"":{""lineNum"":4,""columnNum"":9,""endLineNum"":4,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@878537d"",""value"":""NS_IDENT@7551da2a.beer"",""pos"":{""lineNum"":4,""columnNum"":18,""endLineNum"":4,""endColumnNum"":23,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@4d0b0fd4"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":29,""endLineNum"":4,""endColumnNum"":45,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@29fc1a2b"",""value"":""NS_IDENT@7d755813.drinker"",""pos"":{""lineNum"":4,""columnNum"":29,""endLineNum"":4,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@677b8e13"",""value"":""'Dan'"",""pos"":{""lineNum"":4,""columnNum"":41,""endLineNum"":4,""endColumnNum"":45,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@29fc1a2b"",""value"":""NS_IDENT@7d755813.drinker"",""pos"":{""lineNum"":4,""columnNum"":29,""endLineNum"":4,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@63da207f"",""value"":""NS_IDENT@7551da2a.BAR"",""pos"":{""lineNum"":2,""columnNum"":11,""endLineNum"":2,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@76075d65"",""value"":""NS_IDENT@7d755813.beer"",""pos"":{""lineNum"":4,""columnNum"":9,""endLineNum"":4,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@52b6319f"",""value"":""NS_IDENT@7551da2a.PRICE"",""pos"":{""lineNum"":2,""columnNum"":26,""endLineNum"":2,""endColumnNum"":32,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@40d10481"",""value"":""NS_IDENT@7551da2a.BEER"",""pos"":{""lineNum"":2,""columnNum"":18,""endLineNum"":2,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@878537d"",""value"":""NS_IDENT@7551da2a.beer"",""pos"":{""lineNum"":4,""columnNum"":18,""endLineNum"":4,""endColumnNum"":23,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":4,""endLineNum"":4,""endColumnNum"":45,""quoted"":false},""children"":{}}]}
"
"(select l.beer, s.bar 
from likes l,serves s, serves s2  
where l.drinker='Dan' and l.beer = s.beer)
EXCEPT 
(select s2.beer, s2.bar
from serves s, serves s2
where s.bar !=s2.bar and s.beer = s2.beer and s.price> s2.price);","{""failed"":true,""errorMsg"":""Parsing error at line 7, column 13. Query syntax may be incorrect""}
"
"select b1.beer, b1.bar from serves b1 where b1.beer in (select beer from likes where drinker = 'Dan') and not exists (select price from serves where beer = b1.beer and price > b1.price)


","{""blocks"":{""id"":""BLOCK_SELECT@40021799"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@57c88764"",""value"":""NS_IDENT@4cdd2c73.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@37fdfb05"",""value"":""NS_IDENT@4cdd2c73.BAR"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":22,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@4cdd2c73""],""fromNode"":{""id"":""JOIN_OPERAND@488b50ec"",""value"":""NS_IDENT@4cdd2c73"",""pos"":{""lineNum"":1,""columnNum"":29,""endLineNum"":1,""endColumnNum"":34,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@5116ac09"",""value"":""AND"",""pos"":{""lineNum"":1,""columnNum"":45,""endLineNum"":1,""endColumnNum"":184,""quoted"":false},""children"":[{""id"":""OP_BINARY@5b022357"",""value"":""IN"",""pos"":{""lineNum"":1,""columnNum"":45,""endLineNum"":1,""endColumnNum"":100,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4cd1c1dc"",""value"":""NS_IDENT@4cdd2c73.beer"",""pos"":{""lineNum"":1,""columnNum"":45,""endLineNum"":1,""endColumnNum"":51,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@4e868ef5"",""value"":""BLOCK_SELECT@4e868ef5"",""pos"":{""lineNum"":1,""columnNum"":57,""endLineNum"":1,""endColumnNum"":100,""quoted"":false},""children"":[]}]},{""id"":""OP_PREFIX@614aeccc"",""value"":""NOT"",""pos"":{""lineNum"":1,""columnNum"":107,""endLineNum"":1,""endColumnNum"":184,""quoted"":false},""children"":[{""id"":""OP_PREFIX@6f8e0cee"",""value"":""EXISTS"",""pos"":{""lineNum"":1,""columnNum"":111,""endLineNum"":1,""endColumnNum"":184,""quoted"":false},""children"":[{""id"":""BLOCK_SELECT@47b2e9e1"",""value"":""BLOCK_SELECT@47b2e9e1"",""pos"":{""lineNum"":1,""columnNum"":119,""endLineNum"":1,""endColumnNum"":184,""quoted"":false},""children"":[]}]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@37fdfb05"",""value"":""NS_IDENT@4cdd2c73.BAR"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@57c88764"",""value"":""NS_IDENT@4cdd2c73.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4cd1c1dc"",""value"":""NS_IDENT@4cdd2c73.beer"",""pos"":{""lineNum"":1,""columnNum"":45,""endLineNum"":1,""endColumnNum"":51,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@4cdd2c73.beer"",""NS_IDENT@4cdd2c73.price""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":1,""endColumnNum"":185,""quoted"":false},""children"":{""BLOCK_SELECT@4e868ef5"":{""id"":""BLOCK_SELECT@4e868ef5"",""parentId"":""BLOCK_SELECT@40021799"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@3a91d146"",""value"":""NS_IDENT@398474a2.BEER"",""pos"":{""lineNum"":1,""columnNum"":64,""endLineNum"":1,""endColumnNum"":67,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@398474a2""],""fromNode"":{""id"":""JOIN_OPERAND@1d4664d7"",""value"":""NS_IDENT@398474a2"",""pos"":{""lineNum"":1,""columnNum"":74,""endLineNum"":1,""endColumnNum"":78,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@27b71f50"",""value"":""="",""pos"":{""lineNum"":1,""columnNum"":86,""endLineNum"":1,""endColumnNum"":100,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@3a4ba480"",""value"":""NS_IDENT@398474a2.drinker"",""pos"":{""lineNum"":1,""columnNum"":86,""endLineNum"":1,""endColumnNum"":92,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@6d4a65c6"",""value"":""'Dan'"",""pos"":{""lineNum"":1,""columnNum"":96,""endLineNum"":1,""endColumnNum"":100,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@3a4ba480"",""value"":""NS_IDENT@398474a2.drinker"",""pos"":{""lineNum"":1,""columnNum"":86,""endLineNum"":1,""endColumnNum"":92,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3a91d146"",""value"":""NS_IDENT@398474a2.BEER"",""pos"":{""lineNum"":1,""columnNum"":64,""endLineNum"":1,""endColumnNum"":67,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":57,""endLineNum"":1,""endColumnNum"":100,""quoted"":false},""children"":{}},""BLOCK_SELECT@47b2e9e1"":{""id"":""BLOCK_SELECT@47b2e9e1"",""parentId"":""BLOCK_SELECT@40021799"",""fields"":[""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@dffa30b"",""value"":""NS_IDENT@70abf9b0.PRICE"",""pos"":{""lineNum"":1,""columnNum"":126,""endLineNum"":1,""endColumnNum"":130,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@70abf9b0""],""fromNode"":{""id"":""JOIN_OPERAND@59942b48"",""value"":""NS_IDENT@70abf9b0"",""pos"":{""lineNum"":1,""columnNum"":137,""endLineNum"":1,""endColumnNum"":142,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@7ca0863b"",""value"":""AND"",""pos"":{""lineNum"":1,""columnNum"":150,""endLineNum"":1,""endColumnNum"":184,""quoted"":false},""children"":[{""id"":""OP_BINARY@22d1886d"",""value"":""="",""pos"":{""lineNum"":1,""columnNum"":150,""endLineNum"":1,""endColumnNum"":163,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1a5f7e7c"",""value"":""NS_IDENT@70abf9b0.beer"",""pos"":{""lineNum"":1,""columnNum"":150,""endLineNum"":1,""endColumnNum"":153,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@5b22b970"",""value"":""NS_IDENT@4cdd2c73.beer"",""pos"":{""lineNum"":1,""columnNum"":157,""endLineNum"":1,""endColumnNum"":163,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@529cfee5"",""value"":"">"",""pos"":{""lineNum"":1,""columnNum"":169,""endLineNum"":1,""endColumnNum"":184,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7df60067"",""value"":""NS_IDENT@70abf9b0.price"",""pos"":{""lineNum"":1,""columnNum"":169,""endLineNum"":1,""endColumnNum"":173,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@1cbb3d3b"",""value"":""NS_IDENT@4cdd2c73.price"",""pos"":{""lineNum"":1,""columnNum"":177,""endLineNum"":1,""endColumnNum"":184,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_CORRELATE@1cbb3d3b"",""value"":""NS_IDENT@4cdd2c73.price"",""pos"":{""lineNum"":1,""columnNum"":177,""endLineNum"":1,""endColumnNum"":184,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@dffa30b"",""value"":""NS_IDENT@70abf9b0.PRICE"",""pos"":{""lineNum"":1,""columnNum"":126,""endLineNum"":1,""endColumnNum"":130,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7df60067"",""value"":""NS_IDENT@70abf9b0.price"",""pos"":{""lineNum"":1,""columnNum"":169,""endLineNum"":1,""endColumnNum"":173,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@5b22b970"",""value"":""NS_IDENT@4cdd2c73.beer"",""pos"":{""lineNum"":1,""columnNum"":157,""endLineNum"":1,""endColumnNum"":163,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1a5f7e7c"",""value"":""NS_IDENT@70abf9b0.beer"",""pos"":{""lineNum"":1,""columnNum"":150,""endLineNum"":1,""endColumnNum"":153,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@4cdd2c73""],""corrCtxIds"":[""BLOCK_SELECT@40021799""],""pos"":{""lineNum"":1,""columnNum"":119,""endLineNum"":1,""endColumnNum"":184,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@398474a2"":{""tableId"":""NS_IDENT@398474a2"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":74,""endLineNum"":1,""endColumnNum"":78,""quoted"":false}},""NS_IDENT@70abf9b0"":{""tableId"":""NS_IDENT@70abf9b0"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":137,""endLineNum"":1,""endColumnNum"":142,""quoted"":false}},""NS_IDENT@4cdd2c73"":{""tableId"":""NS_IDENT@4cdd2c73"",""identifier"":""B1"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":29,""endLineNum"":1,""endColumnNum"":37,""quoted"":false}}},""corrTables"":[""NS_IDENT@4cdd2c73""]}
"
"SELECT s1.beer, s1.bar
FROM serves s1, likes l1
WHERE l1.drinker='Dan' 
and l1.beer=s1.beer 
and (s1.beer,s1.price) IN
(
	SELECT beer, MAX(price)
	FROM serves s2
	GROUP BY beer
)

","{""failed"":true}
"
"SELECT S.beer, S.bar
FROM likes L, serves S
WHERE L.drinker = 'Dan' and L.beer=S.beer 
and S.price >= ALL(SELECT price from serves S1 WHERE S1.beer=S.beer);","{""blocks"":{""id"":""BLOCK_SELECT@264c5d07"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@4cdd2c73"",""value"":""NS_IDENT@2b4c3c29.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4e4c3a38"",""value"":""NS_IDENT@2b4c3c29.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@151335cb"",""NS_IDENT@2b4c3c29""],""fromNode"":{""id"":""OP_JOIN@6090f3ca"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":13,""endLineNum"":2,""endColumnNum"":13,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@37a64f9d"",""value"":""NS_IDENT@151335cb"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@25b865b5"",""value"":""NS_IDENT@2b4c3c29"",""pos"":{""lineNum"":2,""columnNum"":15,""endLineNum"":2,""endColumnNum"":20,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@53692008"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":4,""endColumnNum"":67,""quoted"":false},""children"":[{""id"":""OP_BINARY@6b587673"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":41,""quoted"":false},""children"":[{""id"":""OP_BINARY@7f02251"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4784013e"",""value"":""NS_IDENT@151335cb.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@27b71f50"",""value"":""'Dan'"",""pos"":{""lineNum"":3,""columnNum"":19,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@6d3c232f"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":29,""endLineNum"":3,""endColumnNum"":41,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@dffa30b"",""value"":""NS_IDENT@151335cb.beer"",""pos"":{""lineNum"":3,""columnNum"":29,""endLineNum"":3,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4d8126f"",""value"":""NS_IDENT@2b4c3c29.beer"",""pos"":{""lineNum"":3,""columnNum"":36,""endLineNum"":3,""endColumnNum"":41,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@5f404594"",""value"":"">= ALL"",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":4,""endColumnNum"":67,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1bcf67e8"",""value"":""NS_IDENT@2b4c3c29.price"",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":4,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@afb5821"",""value"":""BLOCK_SELECT@afb5821"",""pos"":{""lineNum"":4,""columnNum"":20,""endLineNum"":4,""endColumnNum"":67,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@4784013e"",""value"":""NS_IDENT@151335cb.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4d8126f"",""value"":""NS_IDENT@2b4c3c29.beer"",""pos"":{""lineNum"":3,""columnNum"":36,""endLineNum"":3,""endColumnNum"":41,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1bcf67e8"",""value"":""NS_IDENT@2b4c3c29.price"",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":4,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4cdd2c73"",""value"":""NS_IDENT@2b4c3c29.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@dffa30b"",""value"":""NS_IDENT@151335cb.beer"",""pos"":{""lineNum"":3,""columnNum"":29,""endLineNum"":3,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4e4c3a38"",""value"":""NS_IDENT@2b4c3c29.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@2b4c3c29.beer""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":4,""endColumnNum"":68,""quoted"":false},""children"":{""BLOCK_SELECT@afb5821"":{""id"":""BLOCK_SELECT@afb5821"",""parentId"":""BLOCK_SELECT@264c5d07"",""fields"":[""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@131fcb6f"",""value"":""NS_IDENT@5e39850.PRICE"",""pos"":{""lineNum"":4,""columnNum"":27,""endLineNum"":4,""endColumnNum"":31,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@5e39850""],""fromNode"":{""id"":""JOIN_OPERAND@56ccd751"",""value"":""NS_IDENT@5e39850"",""pos"":{""lineNum"":4,""columnNum"":38,""endLineNum"":4,""endColumnNum"":43,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@26dcd8c0"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":54,""endLineNum"":4,""endColumnNum"":67,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@441cc260"",""value"":""NS_IDENT@5e39850.beer"",""pos"":{""lineNum"":4,""columnNum"":54,""endLineNum"":4,""endColumnNum"":60,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@73a00e09"",""value"":""NS_IDENT@2b4c3c29.beer"",""pos"":{""lineNum"":4,""columnNum"":62,""endLineNum"":4,""endColumnNum"":67,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@441cc260"",""value"":""NS_IDENT@5e39850.beer"",""pos"":{""lineNum"":4,""columnNum"":54,""endLineNum"":4,""endColumnNum"":60,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@131fcb6f"",""value"":""NS_IDENT@5e39850.PRICE"",""pos"":{""lineNum"":4,""columnNum"":27,""endLineNum"":4,""endColumnNum"":31,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@73a00e09"",""value"":""NS_IDENT@2b4c3c29.beer"",""pos"":{""lineNum"":4,""columnNum"":62,""endLineNum"":4,""endColumnNum"":67,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@2b4c3c29""],""corrCtxIds"":[""BLOCK_SELECT@264c5d07""],""pos"":{""lineNum"":4,""columnNum"":20,""endLineNum"":4,""endColumnNum"":67,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@5e39850"":{""tableId"":""NS_IDENT@5e39850"",""identifier"":""S1"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":38,""endLineNum"":4,""endColumnNum"":46,""quoted"":false}},""NS_IDENT@151335cb"":{""tableId"":""NS_IDENT@151335cb"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@2b4c3c29"":{""tableId"":""NS_IDENT@2b4c3c29"",""identifier"":""S"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":15,""endLineNum"":2,""endColumnNum"":22,""quoted"":false}}},""corrTables"":[""NS_IDENT@2b4c3c29""]}
"
"SELECT L.beer, bar
FROM likes L, serves
WHERE L.drinker = 'Dan' AND L.beer = serves.beer AND serves.price = 
(SELECT MAX(price)
FROM serves S
WHERE L.beer = S.beer 
)","{""blocks"":{""id"":""BLOCK_SELECT@2b9b7f1f"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@13047d7d"",""value"":""NS_IDENT@87abc48.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@65bb9029"",""value"":""NS_IDENT@7435a578.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":18,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@87abc48"",""NS_IDENT@7435a578""],""fromNode"":{""id"":""OP_JOIN@201aa8c1"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":13,""endLineNum"":2,""endColumnNum"":13,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@5d58c727"",""value"":""NS_IDENT@87abc48"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@27b22f74"",""value"":""NS_IDENT@7435a578"",""pos"":{""lineNum"":2,""columnNum"":15,""endLineNum"":2,""endColumnNum"":20,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@27b71f50"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":6,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""OP_BINARY@5cf87cfd"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":48,""quoted"":false},""children"":[{""id"":""OP_BINARY@53692008"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7f02251"",""value"":""NS_IDENT@87abc48.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@29fc1a2b"",""value"":""'Dan'"",""pos"":{""lineNum"":3,""columnNum"":19,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@460b6d54"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":29,""endLineNum"":3,""endColumnNum"":48,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7b2a3ff8"",""value"":""NS_IDENT@87abc48.beer"",""pos"":{""lineNum"":3,""columnNum"":29,""endLineNum"":3,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1bbae752"",""value"":""NS_IDENT@7435a578.beer"",""pos"":{""lineNum"":3,""columnNum"":38,""endLineNum"":3,""endColumnNum"":48,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@3a4ba480"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":54,""endLineNum"":6,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@76075d65"",""value"":""NS_IDENT@7435a578.price"",""pos"":{""lineNum"":3,""columnNum"":54,""endLineNum"":3,""endColumnNum"":65,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT_SCALAR@4d0b0fd4"",""value"":""BLOCK_SELECT@6f099cef"",""pos"":{""lineNum"":4,""columnNum"":2,""endLineNum"":6,""endColumnNum"":21,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@1bbae752"",""value"":""NS_IDENT@7435a578.beer"",""pos"":{""lineNum"":3,""columnNum"":38,""endLineNum"":3,""endColumnNum"":48,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@76075d65"",""value"":""NS_IDENT@7435a578.price"",""pos"":{""lineNum"":3,""columnNum"":54,""endLineNum"":3,""endColumnNum"":65,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7f02251"",""value"":""NS_IDENT@87abc48.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@13047d7d"",""value"":""NS_IDENT@87abc48.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7b2a3ff8"",""value"":""NS_IDENT@87abc48.beer"",""pos"":{""lineNum"":3,""columnNum"":29,""endLineNum"":3,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@65bb9029"",""value"":""NS_IDENT@7435a578.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":18,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@87abc48.beer""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":7,""endColumnNum"":1,""quoted"":false},""children"":{""BLOCK_SELECT@6f099cef"":{""id"":""BLOCK_SELECT@6f099cef"",""parentId"":""BLOCK_SELECT@2b9b7f1f"",""fields"":[""EXPR$0 DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""OP_AGG_FUNC@25d3cfc8"",""value"":""MAX"",""pos"":{""lineNum"":4,""columnNum"":9,""endLineNum"":4,""endColumnNum"":18,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@30331109"",""value"":""NS_IDENT@2b8d084.PRICE"",""pos"":{""lineNum"":4,""columnNum"":13,""endLineNum"":4,""endColumnNum"":17,""quoted"":false},""children"":[]}]}],""fromItemIds"":[""NS_IDENT@2b8d084""],""fromNode"":{""id"":""JOIN_OPERAND@46c00568"",""value"":""NS_IDENT@2b8d084"",""pos"":{""lineNum"":5,""columnNum"":6,""endLineNum"":5,""endColumnNum"":11,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@3e48e859"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@3a022576"",""value"":""NS_IDENT@87abc48.beer"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2dbd803f"",""value"":""NS_IDENT@2b8d084.beer"",""pos"":{""lineNum"":6,""columnNum"":16,""endLineNum"":6,""endColumnNum"":21,""quoted"":false},""children"":[]}]},""isAggregate"":true,""identifiers"":[{""id"":""COLUMN_CORRELATE@3a022576"",""value"":""NS_IDENT@87abc48.beer"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2dbd803f"",""value"":""NS_IDENT@2b8d084.beer"",""pos"":{""lineNum"":6,""columnNum"":16,""endLineNum"":6,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@30331109"",""value"":""NS_IDENT@2b8d084.PRICE"",""pos"":{""lineNum"":4,""columnNum"":13,""endLineNum"":4,""endColumnNum"":17,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@87abc48""],""corrCtxIds"":[""BLOCK_SELECT@2b9b7f1f""],""pos"":{""lineNum"":4,""columnNum"":2,""endLineNum"":6,""endColumnNum"":21,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@7435a578"":{""tableId"":""NS_IDENT@7435a578"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":15,""endLineNum"":2,""endColumnNum"":20,""quoted"":false}},""NS_IDENT@87abc48"":{""tableId"":""NS_IDENT@87abc48"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@2b8d084"":{""tableId"":""NS_IDENT@2b8d084"",""identifier"":""S"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":6,""endLineNum"":5,""endColumnNum"":13,""quoted"":false}}},""corrTables"":[""NS_IDENT@87abc48""]}
"
"(SELECT s.beer AS beer, s.bar AS bar
FROM Serves s, Likes L
WHERE L.drinker = 'Dan' AND L.beer = s.beer)

EXCEPT

(SELECT s.beer AS beer, s.bar AS bar
FROM Serves s, Serves sec
WHERE s.beer = sec.beer AND s.bar != sec.bar AND sec.price > s.price)","{""failed"":true,""errorMsg"":""Parsing error at line 9, column 35. Query syntax may be incorrect""}
"
"WITH mPrice AS
(SELECT s1.beer, MAX(s1.price)
FROM serves s1
GROUP BY s1.beer)
SELECT s.beer, s.bar
FROM likes l, serves s, mPrice m
WHERE l.drinker = 'Dan' AND l.beer = s.beer AND s.price = m.max AND s.beer = m.beer;
","{""failed"":true,""errorMsg"":""Parsing error at line 7, column 60. Query syntax may be incorrect""}
"
"select beer, bar from serves a where (not exists(select * from serves b where a.beer = b.beer and b.price > a.price)) and a.beer in (select beer from likes where drinker = 'Dan')","{""blocks"":{""id"":""BLOCK_SELECT@40021799"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@7435a578"",""value"":""NS_IDENT@281f23f2.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@13047d7d"",""value"":""NS_IDENT@281f23f2.BAR"",""pos"":{""lineNum"":1,""columnNum"":14,""endLineNum"":1,""endColumnNum"":16,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@281f23f2""],""fromNode"":{""id"":""JOIN_OPERAND@488b50ec"",""value"":""NS_IDENT@281f23f2"",""pos"":{""lineNum"":1,""columnNum"":23,""endLineNum"":1,""endColumnNum"":28,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@5116ac09"",""value"":""AND"",""pos"":{""lineNum"":1,""columnNum"":39,""endLineNum"":1,""endColumnNum"":177,""quoted"":false},""children"":[{""id"":""OP_PREFIX@7a6ebe1e"",""value"":""NOT"",""pos"":{""lineNum"":1,""columnNum"":39,""endLineNum"":1,""endColumnNum"":115,""quoted"":false},""children"":[{""id"":""OP_PREFIX@417d6615"",""value"":""EXISTS"",""pos"":{""lineNum"":1,""columnNum"":43,""endLineNum"":1,""endColumnNum"":115,""quoted"":false},""children"":[{""id"":""BLOCK_SELECT@4e868ef5"",""value"":""BLOCK_SELECT@4e868ef5"",""pos"":{""lineNum"":1,""columnNum"":50,""endLineNum"":1,""endColumnNum"":115,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@614aeccc"",""value"":""IN"",""pos"":{""lineNum"":1,""columnNum"":123,""endLineNum"":1,""endColumnNum"":177,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@b9dfc5a"",""value"":""NS_IDENT@281f23f2.beer"",""pos"":{""lineNum"":1,""columnNum"":123,""endLineNum"":1,""endColumnNum"":128,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@2d66530f"",""value"":""BLOCK_SELECT@2d66530f"",""pos"":{""lineNum"":1,""columnNum"":134,""endLineNum"":1,""endColumnNum"":177,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@b9dfc5a"",""value"":""NS_IDENT@281f23f2.beer"",""pos"":{""lineNum"":1,""columnNum"":123,""endLineNum"":1,""endColumnNum"":128,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@13047d7d"",""value"":""NS_IDENT@281f23f2.BAR"",""pos"":{""lineNum"":1,""columnNum"":14,""endLineNum"":1,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7435a578"",""value"":""NS_IDENT@281f23f2.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":11,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@281f23f2.price"",""NS_IDENT@281f23f2.beer""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":1,""endColumnNum"":178,""quoted"":false},""children"":{""BLOCK_SELECT@4e868ef5"":{""id"":""BLOCK_SELECT@4e868ef5"",""parentId"":""BLOCK_SELECT@40021799"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@7dd00705"",""value"":""*"",""pos"":{""lineNum"":1,""columnNum"":57,""endLineNum"":1,""endColumnNum"":57,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@65bb9029""],""fromNode"":{""id"":""JOIN_OPERAND@afb5821"",""value"":""NS_IDENT@65bb9029"",""pos"":{""lineNum"":1,""columnNum"":64,""endLineNum"":1,""endColumnNum"":69,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@4455f57d"",""value"":""AND"",""pos"":{""lineNum"":1,""columnNum"":79,""endLineNum"":1,""endColumnNum"":115,""quoted"":false},""children"":[{""id"":""OP_BINARY@74971ed9"",""value"":""="",""pos"":{""lineNum"":1,""columnNum"":79,""endLineNum"":1,""endColumnNum"":93,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@27b71f50"",""value"":""NS_IDENT@281f23f2.beer"",""pos"":{""lineNum"":1,""columnNum"":79,""endLineNum"":1,""endColumnNum"":84,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@383790cf"",""value"":""NS_IDENT@65bb9029.beer"",""pos"":{""lineNum"":1,""columnNum"":88,""endLineNum"":1,""endColumnNum"":93,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@878537d"",""value"":"">"",""pos"":{""lineNum"":1,""columnNum"":99,""endLineNum"":1,""endColumnNum"":115,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@131fcb6f"",""value"":""NS_IDENT@65bb9029.price"",""pos"":{""lineNum"":1,""columnNum"":99,""endLineNum"":1,""endColumnNum"":105,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@ccd1bc3"",""value"":""NS_IDENT@281f23f2.price"",""pos"":{""lineNum"":1,""columnNum"":109,""endLineNum"":1,""endColumnNum"":115,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_CORRELATE@ccd1bc3"",""value"":""NS_IDENT@281f23f2.price"",""pos"":{""lineNum"":1,""columnNum"":109,""endLineNum"":1,""endColumnNum"":115,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@383790cf"",""value"":""NS_IDENT@65bb9029.beer"",""pos"":{""lineNum"":1,""columnNum"":88,""endLineNum"":1,""endColumnNum"":93,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@131fcb6f"",""value"":""NS_IDENT@65bb9029.price"",""pos"":{""lineNum"":1,""columnNum"":99,""endLineNum"":1,""endColumnNum"":105,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@27b71f50"",""value"":""NS_IDENT@281f23f2.beer"",""pos"":{""lineNum"":1,""columnNum"":79,""endLineNum"":1,""endColumnNum"":84,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@281f23f2""],""corrCtxIds"":[""BLOCK_SELECT@40021799""],""pos"":{""lineNum"":1,""columnNum"":50,""endLineNum"":1,""endColumnNum"":115,""quoted"":false},""children"":{}},""BLOCK_SELECT@2d66530f"":{""id"":""BLOCK_SELECT@2d66530f"",""parentId"":""BLOCK_SELECT@40021799"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@53692008"",""value"":""NS_IDENT@2b8d084.BEER"",""pos"":{""lineNum"":1,""columnNum"":141,""endLineNum"":1,""endColumnNum"":144,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@2b8d084""],""fromNode"":{""id"":""JOIN_OPERAND@1869f114"",""value"":""NS_IDENT@2b8d084"",""pos"":{""lineNum"":1,""columnNum"":151,""endLineNum"":1,""endColumnNum"":155,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@2bcec6a6"",""value"":""="",""pos"":{""lineNum"":1,""columnNum"":163,""endLineNum"":1,""endColumnNum"":177,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@388b401d"",""value"":""NS_IDENT@2b8d084.drinker"",""pos"":{""lineNum"":1,""columnNum"":163,""endLineNum"":1,""endColumnNum"":169,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@5cf87cfd"",""value"":""'Dan'"",""pos"":{""lineNum"":1,""columnNum"":173,""endLineNum"":1,""endColumnNum"":177,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@388b401d"",""value"":""NS_IDENT@2b8d084.drinker"",""pos"":{""lineNum"":1,""columnNum"":163,""endLineNum"":1,""endColumnNum"":169,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@53692008"",""value"":""NS_IDENT@2b8d084.BEER"",""pos"":{""lineNum"":1,""columnNum"":141,""endLineNum"":1,""endColumnNum"":144,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":134,""endLineNum"":1,""endColumnNum"":177,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@281f23f2"":{""tableId"":""NS_IDENT@281f23f2"",""identifier"":""A"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":23,""endLineNum"":1,""endColumnNum"":30,""quoted"":false}},""NS_IDENT@65bb9029"":{""tableId"":""NS_IDENT@65bb9029"",""identifier"":""B"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":64,""endLineNum"":1,""endColumnNum"":71,""quoted"":false}},""NS_IDENT@2b8d084"":{""tableId"":""NS_IDENT@2b8d084"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":151,""endLineNum"":1,""endColumnNum"":155,""quoted"":false}}},""corrTables"":[""NS_IDENT@281f23f2""]}
"
"SELECT maximum.beer, serves.bar 
FROM (SELECT L.beer, max(S.price) as priceMax
FROM likes L, serves S
WHERE L.beer = S.beer
AND L.drinker = 'Dan'
GROUP BY L.beer) maximum, serves
WHERE serves.price = maximum.priceMax
AND serves.beer = maximum.beer","{""blocks"":{""id"":""BLOCK_SELECT@61d01788"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@22d9c961"",""value"":""NS_SELECT@60e5272.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6dd91637"",""value"":""NS_IDENT@10876a6.BAR"",""pos"":{""lineNum"":1,""columnNum"":22,""endLineNum"":1,""endColumnNum"":31,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_SELECT@60e5272"",""NS_IDENT@10876a6""],""fromNode"":{""id"":""OP_JOIN@4bff2185"",""value"":""COMMA"",""pos"":{""lineNum"":6,""columnNum"":25,""endLineNum"":6,""endColumnNum"":25,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@7fedfe27"",""value"":""BLOCK_SELECT@7fedfe27"",""pos"":{""lineNum"":2,""columnNum"":7,""endLineNum"":6,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@1917d90f"",""value"":""NS_IDENT@10876a6"",""pos"":{""lineNum"":6,""columnNum"":27,""endLineNum"":6,""endColumnNum"":32,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@49dbaaf3"",""value"":""AND"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":8,""endColumnNum"":30,""quoted"":false},""children"":[{""id"":""OP_BINARY@a64e035"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":37,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_IDENT@10876a6.price"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7fab4be7"",""value"":""NS_SELECT@60e5272.PRICEMAX"",""pos"":{""lineNum"":7,""columnNum"":22,""endLineNum"":7,""endColumnNum"":37,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@64138b0c"",""value"":""="",""pos"":{""lineNum"":8,""columnNum"":5,""endLineNum"":8,""endColumnNum"":30,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4d74c3ba"",""value"":""NS_IDENT@10876a6.beer"",""pos"":{""lineNum"":8,""columnNum"":5,""endLineNum"":8,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@41c204a0"",""value"":""NS_SELECT@60e5272.BEER"",""pos"":{""lineNum"":8,""columnNum"":19,""endLineNum"":8,""endColumnNum"":30,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@22d9c961"",""value"":""NS_SELECT@60e5272.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@41c204a0"",""value"":""NS_SELECT@60e5272.BEER"",""pos"":{""lineNum"":8,""columnNum"":19,""endLineNum"":8,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6dd91637"",""value"":""NS_IDENT@10876a6.BAR"",""pos"":{""lineNum"":1,""columnNum"":22,""endLineNum"":1,""endColumnNum"":31,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_IDENT@10876a6.price"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7fab4be7"",""value"":""NS_SELECT@60e5272.PRICEMAX"",""pos"":{""lineNum"":7,""columnNum"":22,""endLineNum"":7,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4d74c3ba"",""value"":""NS_IDENT@10876a6.beer"",""pos"":{""lineNum"":8,""columnNum"":5,""endLineNum"":8,""endColumnNum"":15,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":8,""endColumnNum"":30,""quoted"":false},""children"":{""BLOCK_SELECT@7fedfe27"":{""id"":""BLOCK_SELECT@7fedfe27"",""parentId"":""BLOCK_SELECT@61d01788"",""alias"":""MAXIMUM"",""fields"":[""BEER VARCHAR(100)"",""PRICEMAX DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@52b6319f"",""value"":""NS_IDENT@7d755813.BEER"",""pos"":{""lineNum"":2,""columnNum"":14,""endLineNum"":2,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@16a9a4f1"",""value"":""MAX"",""pos"":{""lineNum"":2,""columnNum"":22,""endLineNum"":2,""endColumnNum"":33,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1f1cae23"",""value"":""NS_IDENT@40d10481.PRICE"",""pos"":{""lineNum"":2,""columnNum"":26,""endLineNum"":2,""endColumnNum"":32,""quoted"":false},""children"":[]}],""alias"":""PRICEMAX""}],""fromItemIds"":[""NS_IDENT@7d755813"",""NS_IDENT@40d10481""],""fromNode"":{""id"":""OP_JOIN@56ccd751"",""value"":""COMMA"",""pos"":{""lineNum"":3,""columnNum"":13,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@4690f583"",""value"":""NS_IDENT@7d755813"",""pos"":{""lineNum"":3,""columnNum"":6,""endLineNum"":3,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@1869f114"",""value"":""NS_IDENT@40d10481"",""pos"":{""lineNum"":3,""columnNum"":15,""endLineNum"":3,""endColumnNum"":20,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@3a4ba480"",""value"":""AND"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":5,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""OP_BINARY@460b6d54"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4d8126f"",""value"":""NS_IDENT@7d755813.beer"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1bbae752"",""value"":""NS_IDENT@40d10481.beer"",""pos"":{""lineNum"":4,""columnNum"":16,""endLineNum"":4,""endColumnNum"":21,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@76075d65"",""value"":""="",""pos"":{""lineNum"":5,""columnNum"":5,""endLineNum"":5,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5cf87cfd"",""value"":""NS_IDENT@7d755813.drinker"",""pos"":{""lineNum"":5,""columnNum"":5,""endLineNum"":5,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@4455f57d"",""value"":""'Dan'"",""pos"":{""lineNum"":5,""columnNum"":17,""endLineNum"":5,""endColumnNum"":21,""quoted"":false},""children"":[]}]}]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@383f1975"",""value"":""NS_IDENT@7d755813.beer"",""pos"":{""lineNum"":6,""columnNum"":10,""endLineNum"":6,""endColumnNum"":15,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@1f1cae23"",""value"":""NS_IDENT@40d10481.PRICE"",""pos"":{""lineNum"":2,""columnNum"":26,""endLineNum"":2,""endColumnNum"":32,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1bbae752"",""value"":""NS_IDENT@40d10481.beer"",""pos"":{""lineNum"":4,""columnNum"":16,""endLineNum"":4,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@52b6319f"",""value"":""NS_IDENT@7d755813.BEER"",""pos"":{""lineNum"":2,""columnNum"":14,""endLineNum"":2,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@383f1975"",""value"":""NS_IDENT@7d755813.beer"",""pos"":{""lineNum"":6,""columnNum"":10,""endLineNum"":6,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4d8126f"",""value"":""NS_IDENT@7d755813.beer"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5cf87cfd"",""value"":""NS_IDENT@7d755813.drinker"",""pos"":{""lineNum"":5,""columnNum"":5,""endLineNum"":5,""endColumnNum"":13,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":7,""endLineNum"":6,""endColumnNum"":15,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@40d10481"":{""tableId"":""NS_IDENT@40d10481"",""identifier"":""S"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":15,""endLineNum"":3,""endColumnNum"":22,""quoted"":false}},""NS_IDENT@7d755813"":{""tableId"":""NS_IDENT@7d755813"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":6,""endLineNum"":3,""endColumnNum"":12,""quoted"":false}},""NS_SELECT@60e5272"":{""tableId"":""NS_SELECT@60e5272"",""identifier"":""MAXIMUM"",""blockId"":""BLOCK_SELECT@7fedfe27"",""fields"":[""BEER VARCHAR(100)"",""PRICEMAX DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":7,""endLineNum"":6,""endColumnNum"":24,""quoted"":false}},""NS_IDENT@10876a6"":{""tableId"":""NS_IDENT@10876a6"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":27,""endLineNum"":6,""endColumnNum"":32,""quoted"":false}}},""corrTables"":[]}
"
"SELECT DISTINCT a.beer, s1.bar
from likes a, serves s1
where (a.drinker = 'Dan' and s1.beer = a.beer and s1.price = (SELECT MAX(price) from serves s2 where s1.beer = s2.beer))","{""blocks"":{""id"":""BLOCK_SELECT@847f3e7"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":true,""selectList"":[{""id"":""COLUMN_LOCAL@3051e0b2"",""value"":""NS_IDENT@451f87af.BEER"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@57d0fc89"",""value"":""NS_IDENT@2e3cdec2.BAR"",""pos"":{""lineNum"":1,""columnNum"":25,""endLineNum"":1,""endColumnNum"":30,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@451f87af"",""NS_IDENT@2e3cdec2""],""fromNode"":{""id"":""OP_JOIN@52a36910"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":13,""endLineNum"":2,""endColumnNum"":13,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@3a095ec0"",""value"":""NS_IDENT@451f87af"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@4f20a5e0"",""value"":""NS_IDENT@2e3cdec2"",""pos"":{""lineNum"":2,""columnNum"":15,""endLineNum"":2,""endColumnNum"":20,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@27c04377"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":8,""endLineNum"":3,""endColumnNum"":118,""quoted"":false},""children"":[{""id"":""OP_BINARY@515ebef3"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":8,""endLineNum"":3,""endColumnNum"":45,""quoted"":false},""children"":[{""id"":""OP_BINARY@47e4d9d0"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":8,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@48c3205a"",""value"":""NS_IDENT@451f87af.drinker"",""pos"":{""lineNum"":3,""columnNum"":8,""endLineNum"":3,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@ae372b9"",""value"":""'Dan'"",""pos"":{""lineNum"":3,""columnNum"":20,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@3015db78"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":30,""endLineNum"":3,""endColumnNum"":45,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@49798e84"",""value"":""NS_IDENT@2e3cdec2.beer"",""pos"":{""lineNum"":3,""columnNum"":30,""endLineNum"":3,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6ed06f69"",""value"":""NS_IDENT@451f87af.beer"",""pos"":{""lineNum"":3,""columnNum"":40,""endLineNum"":3,""endColumnNum"":45,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@39109136"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":51,""endLineNum"":3,""endColumnNum"":118,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@545607f2"",""value"":""NS_IDENT@2e3cdec2.price"",""pos"":{""lineNum"":3,""columnNum"":51,""endLineNum"":3,""endColumnNum"":58,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT_SCALAR@2098d37d"",""value"":""BLOCK_SELECT@4bff2185"",""pos"":{""lineNum"":3,""columnNum"":63,""endLineNum"":3,""endColumnNum"":118,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@48c3205a"",""value"":""NS_IDENT@451f87af.drinker"",""pos"":{""lineNum"":3,""columnNum"":8,""endLineNum"":3,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6ed06f69"",""value"":""NS_IDENT@451f87af.beer"",""pos"":{""lineNum"":3,""columnNum"":40,""endLineNum"":3,""endColumnNum"":45,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@49798e84"",""value"":""NS_IDENT@2e3cdec2.beer"",""pos"":{""lineNum"":3,""columnNum"":30,""endLineNum"":3,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3051e0b2"",""value"":""NS_IDENT@451f87af.BEER"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@545607f2"",""value"":""NS_IDENT@2e3cdec2.price"",""pos"":{""lineNum"":3,""columnNum"":51,""endLineNum"":3,""endColumnNum"":58,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@57d0fc89"",""value"":""NS_IDENT@2e3cdec2.BAR"",""pos"":{""lineNum"":1,""columnNum"":25,""endLineNum"":1,""endColumnNum"":30,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@2e3cdec2.beer""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":3,""endColumnNum"":120,""quoted"":false},""children"":{""BLOCK_SELECT@4bff2185"":{""id"":""BLOCK_SELECT@4bff2185"",""parentId"":""BLOCK_SELECT@847f3e7"",""fields"":[""EXPR$0 DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""OP_AGG_FUNC@749ab7b4"",""value"":""MAX"",""pos"":{""lineNum"":3,""columnNum"":70,""endLineNum"":3,""endColumnNum"":79,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@127f9161"",""value"":""NS_IDENT@59546cfe.PRICE"",""pos"":{""lineNum"":3,""columnNum"":74,""endLineNum"":3,""endColumnNum"":78,""quoted"":false},""children"":[]}]}],""fromItemIds"":[""NS_IDENT@59546cfe""],""fromNode"":{""id"":""JOIN_OPERAND@458544e0"",""value"":""NS_IDENT@59546cfe"",""pos"":{""lineNum"":3,""columnNum"":86,""endLineNum"":3,""endColumnNum"":91,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@63718b93"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":102,""endLineNum"":3,""endColumnNum"":118,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@3721177d"",""value"":""NS_IDENT@2e3cdec2.beer"",""pos"":{""lineNum"":3,""columnNum"":102,""endLineNum"":3,""endColumnNum"":108,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@766a4535"",""value"":""NS_IDENT@59546cfe.beer"",""pos"":{""lineNum"":3,""columnNum"":112,""endLineNum"":3,""endColumnNum"":118,""quoted"":false},""children"":[]}]},""isAggregate"":true,""identifiers"":[{""id"":""COLUMN_LOCAL@766a4535"",""value"":""NS_IDENT@59546cfe.beer"",""pos"":{""lineNum"":3,""columnNum"":112,""endLineNum"":3,""endColumnNum"":118,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@3721177d"",""value"":""NS_IDENT@2e3cdec2.beer"",""pos"":{""lineNum"":3,""columnNum"":102,""endLineNum"":3,""endColumnNum"":108,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@127f9161"",""value"":""NS_IDENT@59546cfe.PRICE"",""pos"":{""lineNum"":3,""columnNum"":74,""endLineNum"":3,""endColumnNum"":78,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@2e3cdec2""],""corrCtxIds"":[""BLOCK_SELECT@847f3e7""],""pos"":{""lineNum"":3,""columnNum"":63,""endLineNum"":3,""endColumnNum"":118,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@451f87af"":{""tableId"":""NS_IDENT@451f87af"",""identifier"":""A"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@59546cfe"":{""tableId"":""NS_IDENT@59546cfe"",""identifier"":""S2"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":86,""endLineNum"":3,""endColumnNum"":94,""quoted"":false}},""NS_IDENT@2e3cdec2"":{""tableId"":""NS_IDENT@2e3cdec2"",""identifier"":""S1"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":15,""endLineNum"":2,""endColumnNum"":23,""quoted"":false}}},""corrTables"":[""NS_IDENT@2e3cdec2""]}
"
"WITH Temp1 as (select MAX(price), serves.beer from serves, likes
where likes.drinker = 'Dan' and likes.beer = serves.beer group by serves.beer) 
select serves.beer, serves.bar
from Temp1, serves
where Temp1.beer = serves.beer and Temp1.max = serves.price","{""failed"":true,""errorMsg"":""Parsing error at line 5, column 41. Query syntax may be incorrect""}
"
"WITH highPrices AS(
	Select MAX(price) AS price, beer
	FROM serves
	GROUP BY beer)
SELECT S.beer, S.bar
FROM serves S, likes L, highPrices H
WHERE S.beer = L.beer AND L.drinker = 'Dan' AND S.beer = H.beer AND H.price = S.price;","{""blocks"":{""id"":""BLOCK_SELECT@37c5fc56"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@51dbd6e4"",""value"":""NS_IDENT@47d7bfb3.BEER"",""pos"":{""lineNum"":5,""columnNum"":8,""endLineNum"":5,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5f13be1"",""value"":""NS_IDENT@47d7bfb3.BAR"",""pos"":{""lineNum"":5,""columnNum"":16,""endLineNum"":5,""endColumnNum"":20,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@47d7bfb3"",""NS_IDENT@770b3be0"",""NS_IDENT@1eb6e1c""],""fromNode"":{""id"":""OP_JOIN@703feacd"",""value"":""COMMA"",""pos"":{""lineNum"":6,""columnNum"":23,""endLineNum"":6,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""OP_JOIN@7051777c"",""value"":""COMMA"",""pos"":{""lineNum"":6,""columnNum"":14,""endLineNum"":6,""endColumnNum"":14,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@5ecba515"",""value"":""NS_IDENT@47d7bfb3"",""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@512d4583"",""value"":""NS_IDENT@770b3be0"",""pos"":{""lineNum"":6,""columnNum"":16,""endLineNum"":6,""endColumnNum"":20,""quoted"":false},""children"":[]}],""natural"":false},{""id"":""JOIN_OPERAND@2b97cc1f"",""value"":""NS_IDENT@1eb6e1c"",""pos"":{""lineNum"":6,""columnNum"":25,""endLineNum"":6,""endColumnNum"":34,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@70e3f36f"",""value"":""AND"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":85,""quoted"":false},""children"":[{""id"":""OP_BINARY@3c7cfcbb"",""value"":""AND"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":63,""quoted"":false},""children"":[{""id"":""OP_BINARY@29f0c4f2"",""value"":""AND"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":43,""quoted"":false},""children"":[{""id"":""OP_BINARY@87abc48"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1698d7c0"",""value"":""NS_IDENT@47d7bfb3.beer"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@281f23f2"",""value"":""NS_IDENT@770b3be0.beer"",""pos"":{""lineNum"":7,""columnNum"":16,""endLineNum"":7,""endColumnNum"":21,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@782168b7"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":27,""endLineNum"":7,""endColumnNum"":43,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@28d79cba"",""value"":""NS_IDENT@770b3be0.drinker"",""pos"":{""lineNum"":7,""columnNum"":27,""endLineNum"":7,""endColumnNum"":35,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@49601f82"",""value"":""'Dan'"",""pos"":{""lineNum"":7,""columnNum"":39,""endLineNum"":7,""endColumnNum"":43,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@13047d7d"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":49,""endLineNum"":7,""endColumnNum"":63,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7435a578"",""value"":""NS_IDENT@47d7bfb3.beer"",""pos"":{""lineNum"":7,""columnNum"":49,""endLineNum"":7,""endColumnNum"":54,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6093d508"",""value"":""NS_IDENT@1eb6e1c.BEER"",""pos"":{""lineNum"":7,""columnNum"":58,""endLineNum"":7,""endColumnNum"":63,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@2b214b94"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":69,""endLineNum"":7,""endColumnNum"":85,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@65bb9029"",""value"":""NS_IDENT@1eb6e1c.PRICE"",""pos"":{""lineNum"":7,""columnNum"":69,""endLineNum"":7,""endColumnNum"":75,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1bfe3203"",""value"":""NS_IDENT@47d7bfb3.price"",""pos"":{""lineNum"":7,""columnNum"":79,""endLineNum"":7,""endColumnNum"":85,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@51dbd6e4"",""value"":""NS_IDENT@47d7bfb3.BEER"",""pos"":{""lineNum"":5,""columnNum"":8,""endLineNum"":5,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7435a578"",""value"":""NS_IDENT@47d7bfb3.beer"",""pos"":{""lineNum"":7,""columnNum"":49,""endLineNum"":7,""endColumnNum"":54,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@28d79cba"",""value"":""NS_IDENT@770b3be0.drinker"",""pos"":{""lineNum"":7,""columnNum"":27,""endLineNum"":7,""endColumnNum"":35,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@65bb9029"",""value"":""NS_IDENT@1eb6e1c.PRICE"",""pos"":{""lineNum"":7,""columnNum"":69,""endLineNum"":7,""endColumnNum"":75,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@281f23f2"",""value"":""NS_IDENT@770b3be0.beer"",""pos"":{""lineNum"":7,""columnNum"":16,""endLineNum"":7,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1698d7c0"",""value"":""NS_IDENT@47d7bfb3.beer"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6093d508"",""value"":""NS_IDENT@1eb6e1c.BEER"",""pos"":{""lineNum"":7,""columnNum"":58,""endLineNum"":7,""endColumnNum"":63,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1bfe3203"",""value"":""NS_IDENT@47d7bfb3.price"",""pos"":{""lineNum"":7,""columnNum"":79,""endLineNum"":7,""endColumnNum"":85,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5f13be1"",""value"":""NS_IDENT@47d7bfb3.BAR"",""pos"":{""lineNum"":5,""columnNum"":16,""endLineNum"":5,""endColumnNum"":20,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":5,""columnNum"":1,""endLineNum"":7,""endColumnNum"":85,""quoted"":false},""children"":{}},""tables"":{""NS_IDENT@770b3be0"":{""tableId"":""NS_IDENT@770b3be0"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":16,""endLineNum"":6,""endColumnNum"":22,""quoted"":false}},""NS_IDENT@47d7bfb3"":{""tableId"":""NS_IDENT@47d7bfb3"",""identifier"":""S"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":13,""quoted"":false}},""NS_IDENT@2e380628"":{""tableId"":""NS_IDENT@2e380628"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@1eb6e1c"":{""tableId"":""NS_IDENT@1eb6e1c"",""identifier"":""H"",""dbTableName"":""HIGHPRICES"",""fields"":[""PRICE DECIMAL(5, 2)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":25,""endLineNum"":6,""endColumnNum"":36,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@18a645fd"",""alias"":""HIGHPRICES"",""fields"":[""PRICE DECIMAL(5, 2)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""OP_AGG_FUNC@5754de72"",""value"":""MAX"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":18,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@31ee96f4"",""value"":""NS_IDENT@2e380628.PRICE"",""pos"":{""lineNum"":2,""columnNum"":13,""endLineNum"":2,""endColumnNum"":17,""quoted"":false},""children"":[]}],""alias"":""PRICE""},{""id"":""COLUMN_LOCAL@652ab8d9"",""value"":""NS_IDENT@2e380628.BEER"",""pos"":{""lineNum"":2,""columnNum"":30,""endLineNum"":2,""endColumnNum"":33,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@2e380628""],""fromNode"":{""id"":""JOIN_OPERAND@54da32dc"",""value"":""NS_IDENT@2e380628"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":12,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@25d3cfc8"",""value"":""NS_IDENT@2e380628.beer"",""pos"":{""lineNum"":4,""columnNum"":11,""endLineNum"":4,""endColumnNum"":14,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@31ee96f4"",""value"":""NS_IDENT@2e380628.PRICE"",""pos"":{""lineNum"":2,""columnNum"":13,""endLineNum"":2,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@652ab8d9"",""value"":""NS_IDENT@2e380628.BEER"",""pos"":{""lineNum"":2,""columnNum"":30,""endLineNum"":2,""endColumnNum"":33,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@25d3cfc8"",""value"":""NS_IDENT@2e380628.beer"",""pos"":{""lineNum"":4,""columnNum"":11,""endLineNum"":4,""endColumnNum"":14,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":2,""endLineNum"":4,""endColumnNum"":14,""quoted"":false},""children"":{}}]}
"
"WITH topcost AS
(SELECT beer, MAX(price)
FROM serves
GROUP BY beer)
SELECT l.beer, s.bar
FROM serves s, topcost c, likes l
WHERE l.drinker = 'Dan' AND l.beer = s.beer AND s.price = c.max AND l.beer = c.beer
","{""failed"":true,""errorMsg"":""Parsing error at line 7, column 60. Query syntax may be incorrect""}
"
"WITH maxPrice AS
(SELECT beer, MAX(price)
FROM serves
GROUP BY beer)

SELECT L.beer, S.bar
FROM serves S, maxPrice M, likes L
WHERE L.drinker = 'Dan' AND L.beer = S.beer AND S.price = M.max AND L.beer = M.beer","{""failed"":true,""errorMsg"":""Parsing error at line 8, column 60. Query syntax may be incorrect""}
"
"select beer,bar from serves where (beer, price) in (select s1.beer, MAX(price) price from serves s1, likes l1 where drinker='Dan' and s1.beer=l1.beer group by s1.beer)","{""failed"":true}
"
"SELECT beer, bar
FROM serves AS s1
WHERE s1.beer IN (SELECT beer FROM LIKES WHERE drinker = 'Dan')
AND price >= ALL(SELECT price FROM serves WHERE s1.beer = beer);
","{""blocks"":{""id"":""BLOCK_SELECT@1b32cd16"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@5ac7aa18"",""value"":""NS_IDENT@151335cb.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4abf3f0"",""value"":""NS_IDENT@151335cb.BAR"",""pos"":{""lineNum"":1,""columnNum"":14,""endLineNum"":1,""endColumnNum"":16,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@151335cb""],""fromNode"":{""id"":""JOIN_OPERAND@37a64f9d"",""value"":""NS_IDENT@151335cb"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":11,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@322803db"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":4,""endColumnNum"":62,""quoted"":false},""children"":[{""id"":""OP_BINARY@5116ac09"",""value"":""IN"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":62,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@2787de58"",""value"":""NS_IDENT@151335cb.beer"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@67a056f1"",""value"":""BLOCK_SELECT@67a056f1"",""pos"":{""lineNum"":3,""columnNum"":19,""endLineNum"":3,""endColumnNum"":62,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@4b2a30d"",""value"":"">= ALL"",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":4,""endColumnNum"":62,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1bc425e7"",""value"":""NS_IDENT@151335cb.price"",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":4,""endColumnNum"":9,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@488b50ec"",""value"":""BLOCK_SELECT@488b50ec"",""pos"":{""lineNum"":4,""columnNum"":18,""endLineNum"":4,""endColumnNum"":62,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@4abf3f0"",""value"":""NS_IDENT@151335cb.BAR"",""pos"":{""lineNum"":1,""columnNum"":14,""endLineNum"":1,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1bc425e7"",""value"":""NS_IDENT@151335cb.price"",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":4,""endColumnNum"":9,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5ac7aa18"",""value"":""NS_IDENT@151335cb.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2787de58"",""value"":""NS_IDENT@151335cb.beer"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@151335cb.beer""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":4,""endColumnNum"":63,""quoted"":false},""children"":{""BLOCK_SELECT@67a056f1"":{""id"":""BLOCK_SELECT@67a056f1"",""parentId"":""BLOCK_SELECT@1b32cd16"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@5965844d"",""value"":""NS_IDENT@c27d163.BEER"",""pos"":{""lineNum"":3,""columnNum"":26,""endLineNum"":3,""endColumnNum"":29,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@c27d163""],""fromNode"":{""id"":""JOIN_OPERAND@458544e0"",""value"":""NS_IDENT@c27d163"",""pos"":{""lineNum"":3,""columnNum"":36,""endLineNum"":3,""endColumnNum"":40,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@76075d65"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":48,""endLineNum"":3,""endColumnNum"":62,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5cf87cfd"",""value"":""NS_IDENT@c27d163.drinker"",""pos"":{""lineNum"":3,""columnNum"":48,""endLineNum"":3,""endColumnNum"":54,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@392a04e7"",""value"":""'Dan'"",""pos"":{""lineNum"":3,""columnNum"":58,""endLineNum"":3,""endColumnNum"":62,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@5cf87cfd"",""value"":""NS_IDENT@c27d163.drinker"",""pos"":{""lineNum"":3,""columnNum"":48,""endLineNum"":3,""endColumnNum"":54,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5965844d"",""value"":""NS_IDENT@c27d163.BEER"",""pos"":{""lineNum"":3,""columnNum"":26,""endLineNum"":3,""endColumnNum"":29,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":19,""endLineNum"":3,""endColumnNum"":62,""quoted"":false},""children"":{}},""BLOCK_SELECT@488b50ec"":{""id"":""BLOCK_SELECT@488b50ec"",""parentId"":""BLOCK_SELECT@1b32cd16"",""fields"":[""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@6b587673"",""value"":""NS_IDENT@5e39850.PRICE"",""pos"":{""lineNum"":4,""columnNum"":25,""endLineNum"":4,""endColumnNum"":29,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@5e39850""],""fromNode"":{""id"":""JOIN_OPERAND@18a645fd"",""value"":""NS_IDENT@5e39850"",""pos"":{""lineNum"":4,""columnNum"":36,""endLineNum"":4,""endColumnNum"":41,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@1a5f7e7c"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":49,""endLineNum"":4,""endColumnNum"":62,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@3e48e859"",""value"":""NS_IDENT@151335cb.beer"",""pos"":{""lineNum"":4,""columnNum"":49,""endLineNum"":4,""endColumnNum"":55,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@31ddd4a4"",""value"":""NS_IDENT@5e39850.beer"",""pos"":{""lineNum"":4,""columnNum"":59,""endLineNum"":4,""endColumnNum"":62,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_CORRELATE@3e48e859"",""value"":""NS_IDENT@151335cb.beer"",""pos"":{""lineNum"":4,""columnNum"":49,""endLineNum"":4,""endColumnNum"":55,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6b587673"",""value"":""NS_IDENT@5e39850.PRICE"",""pos"":{""lineNum"":4,""columnNum"":25,""endLineNum"":4,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@31ddd4a4"",""value"":""NS_IDENT@5e39850.beer"",""pos"":{""lineNum"":4,""columnNum"":59,""endLineNum"":4,""endColumnNum"":62,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@151335cb""],""corrCtxIds"":[""BLOCK_SELECT@1b32cd16""],""pos"":{""lineNum"":4,""columnNum"":18,""endLineNum"":4,""endColumnNum"":62,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@5e39850"":{""tableId"":""NS_IDENT@5e39850"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":36,""endLineNum"":4,""endColumnNum"":41,""quoted"":false}},""NS_IDENT@151335cb"":{""tableId"":""NS_IDENT@151335cb"",""identifier"":""S1"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":17,""quoted"":false}},""NS_IDENT@c27d163"":{""tableId"":""NS_IDENT@c27d163"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":36,""endLineNum"":3,""endColumnNum"":40,""quoted"":false}}},""corrTables"":[""NS_IDENT@151335cb""]}
"
"with validbars as (select distinct s2.beer, s2.bar, s2.price
from likes l1, serves s1, serves s2
where l1.drinker='Dan' and l1.beer = s1.beer and l1.beer = s2.beer and s1.price<=s2.price),

maxbeers as (select validbars.beer, max(validbars.price)
from validbars
group by validbars.beer)

select maxbeers.beer, serves.bar
from maxbeers, serves
where maxbeers.beer = serves.beer and maxbeers.max = serves.price
","{""failed"":true,""errorMsg"":""Parsing error at line 11, column 47. Query syntax may be incorrect""}
"
"select L.beer, S.bar
from Likes L, Serves S
where L.drinker = 'Dan' and S. beer = L.beer and S.price >= all(select S2.price from Serves S2 where S2.beer = S.beer) ","{""blocks"":{""id"":""BLOCK_SELECT@264c5d07"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@4cdd2c73"",""value"":""NS_IDENT@151335cb.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4e4c3a38"",""value"":""NS_IDENT@2b4c3c29.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@151335cb"",""NS_IDENT@2b4c3c29""],""fromNode"":{""id"":""OP_JOIN@6090f3ca"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":13,""endLineNum"":2,""endColumnNum"":13,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@37a64f9d"",""value"":""NS_IDENT@151335cb"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@25b865b5"",""value"":""NS_IDENT@2b4c3c29"",""pos"":{""lineNum"":2,""columnNum"":15,""endLineNum"":2,""endColumnNum"":20,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@53692008"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":117,""quoted"":false},""children"":[{""id"":""OP_BINARY@6b587673"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":44,""quoted"":false},""children"":[{""id"":""OP_BINARY@7f02251"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4784013e"",""value"":""NS_IDENT@151335cb.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@27b71f50"",""value"":""'Dan'"",""pos"":{""lineNum"":3,""columnNum"":19,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@6d3c232f"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":29,""endLineNum"":3,""endColumnNum"":44,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@dffa30b"",""value"":""NS_IDENT@2b4c3c29.beer"",""pos"":{""lineNum"":3,""columnNum"":29,""endLineNum"":3,""endColumnNum"":35,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4d8126f"",""value"":""NS_IDENT@151335cb.beer"",""pos"":{""lineNum"":3,""columnNum"":39,""endLineNum"":3,""endColumnNum"":44,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@5f404594"",""value"":"">= ALL"",""pos"":{""lineNum"":3,""columnNum"":50,""endLineNum"":3,""endColumnNum"":117,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1bcf67e8"",""value"":""NS_IDENT@2b4c3c29.price"",""pos"":{""lineNum"":3,""columnNum"":50,""endLineNum"":3,""endColumnNum"":56,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@afb5821"",""value"":""BLOCK_SELECT@afb5821"",""pos"":{""lineNum"":3,""columnNum"":65,""endLineNum"":3,""endColumnNum"":117,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@4784013e"",""value"":""NS_IDENT@151335cb.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4d8126f"",""value"":""NS_IDENT@151335cb.beer"",""pos"":{""lineNum"":3,""columnNum"":39,""endLineNum"":3,""endColumnNum"":44,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1bcf67e8"",""value"":""NS_IDENT@2b4c3c29.price"",""pos"":{""lineNum"":3,""columnNum"":50,""endLineNum"":3,""endColumnNum"":56,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4cdd2c73"",""value"":""NS_IDENT@151335cb.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@dffa30b"",""value"":""NS_IDENT@2b4c3c29.beer"",""pos"":{""lineNum"":3,""columnNum"":29,""endLineNum"":3,""endColumnNum"":35,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4e4c3a38"",""value"":""NS_IDENT@2b4c3c29.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@2b4c3c29.beer""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":3,""endColumnNum"":118,""quoted"":false},""children"":{""BLOCK_SELECT@afb5821"":{""id"":""BLOCK_SELECT@afb5821"",""parentId"":""BLOCK_SELECT@264c5d07"",""fields"":[""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@131fcb6f"",""value"":""NS_IDENT@5e39850.PRICE"",""pos"":{""lineNum"":3,""columnNum"":72,""endLineNum"":3,""endColumnNum"":79,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@5e39850""],""fromNode"":{""id"":""JOIN_OPERAND@56ccd751"",""value"":""NS_IDENT@5e39850"",""pos"":{""lineNum"":3,""columnNum"":86,""endLineNum"":3,""endColumnNum"":91,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@26dcd8c0"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":102,""endLineNum"":3,""endColumnNum"":117,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@441cc260"",""value"":""NS_IDENT@5e39850.beer"",""pos"":{""lineNum"":3,""columnNum"":102,""endLineNum"":3,""endColumnNum"":108,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@73a00e09"",""value"":""NS_IDENT@2b4c3c29.beer"",""pos"":{""lineNum"":3,""columnNum"":112,""endLineNum"":3,""endColumnNum"":117,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@441cc260"",""value"":""NS_IDENT@5e39850.beer"",""pos"":{""lineNum"":3,""columnNum"":102,""endLineNum"":3,""endColumnNum"":108,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@131fcb6f"",""value"":""NS_IDENT@5e39850.PRICE"",""pos"":{""lineNum"":3,""columnNum"":72,""endLineNum"":3,""endColumnNum"":79,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@73a00e09"",""value"":""NS_IDENT@2b4c3c29.beer"",""pos"":{""lineNum"":3,""columnNum"":112,""endLineNum"":3,""endColumnNum"":117,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@2b4c3c29""],""corrCtxIds"":[""BLOCK_SELECT@264c5d07""],""pos"":{""lineNum"":3,""columnNum"":65,""endLineNum"":3,""endColumnNum"":117,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@5e39850"":{""tableId"":""NS_IDENT@5e39850"",""identifier"":""S2"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":86,""endLineNum"":3,""endColumnNum"":94,""quoted"":false}},""NS_IDENT@151335cb"":{""tableId"":""NS_IDENT@151335cb"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@2b4c3c29"":{""tableId"":""NS_IDENT@2b4c3c29"",""identifier"":""S"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":15,""endLineNum"":2,""endColumnNum"":22,""quoted"":false}}},""corrTables"":[""NS_IDENT@2b4c3c29""]}
"
"SELECT DISTINCT S1.beer, S1.bar
FROM Likes L, Serves S1, Serves S2 
WHERE L.drinker = 'Dan' AND L.beer = S1. beer AND S1.beer = S2.beer 
      AND S1.price >= ALL(SELECT price FROM Serves s WHERE S1.beer = s.beer);","{""blocks"":{""id"":""BLOCK_SELECT@19593091"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":true,""selectList"":[{""id"":""COLUMN_LOCAL@55ecbafe"",""value"":""NS_IDENT@3db64bd4.BEER"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@37c2eacb"",""value"":""NS_IDENT@3db64bd4.BAR"",""pos"":{""lineNum"":1,""columnNum"":26,""endLineNum"":1,""endColumnNum"":31,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@5f80fa43"",""NS_IDENT@3db64bd4"",""NS_IDENT@6e106680""],""fromNode"":{""id"":""OP_JOIN@f9b5552"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":24,""endLineNum"":2,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""OP_JOIN@6872f9c8"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":13,""endLineNum"":2,""endColumnNum"":13,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@6d2d99fc"",""value"":""NS_IDENT@5f80fa43"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@bdecc21"",""value"":""NS_IDENT@3db64bd4"",""pos"":{""lineNum"":2,""columnNum"":15,""endLineNum"":2,""endColumnNum"":20,""quoted"":false},""children"":[]}],""natural"":false},{""id"":""JOIN_OPERAND@5d58c727"",""value"":""NS_IDENT@6e106680"",""pos"":{""lineNum"":2,""columnNum"":26,""endLineNum"":2,""endColumnNum"":31,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@27c04377"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":4,""endColumnNum"":75,""quoted"":false},""children"":[{""id"":""OP_BINARY@515ebef3"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":67,""quoted"":false},""children"":[{""id"":""OP_BINARY@47e4d9d0"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":45,""quoted"":false},""children"":[{""id"":""OP_BINARY@7c6442c2"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@31da6b2e"",""value"":""NS_IDENT@5f80fa43.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@ae372b9"",""value"":""'Dan'"",""pos"":{""lineNum"":3,""columnNum"":19,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@1948ea69"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":29,""endLineNum"":3,""endColumnNum"":45,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@2d746ce4"",""value"":""NS_IDENT@5f80fa43.beer"",""pos"":{""lineNum"":3,""columnNum"":29,""endLineNum"":3,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5dbf5634"",""value"":""NS_IDENT@3db64bd4.beer"",""pos"":{""lineNum"":3,""columnNum"":38,""endLineNum"":3,""endColumnNum"":45,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@3015db78"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":51,""endLineNum"":3,""endColumnNum"":67,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@49798e84"",""value"":""NS_IDENT@3db64bd4.beer"",""pos"":{""lineNum"":3,""columnNum"":51,""endLineNum"":3,""endColumnNum"":57,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6ed06f69"",""value"":""NS_IDENT@6e106680.beer"",""pos"":{""lineNum"":3,""columnNum"":61,""endLineNum"":3,""endColumnNum"":67,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@39109136"",""value"":"">= ALL"",""pos"":{""lineNum"":4,""columnNum"":11,""endLineNum"":4,""endColumnNum"":75,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@545607f2"",""value"":""NS_IDENT@3db64bd4.price"",""pos"":{""lineNum"":4,""columnNum"":11,""endLineNum"":4,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@7fedfe27"",""value"":""BLOCK_SELECT@7fedfe27"",""pos"":{""lineNum"":4,""columnNum"":27,""endLineNum"":4,""endColumnNum"":75,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@37c2eacb"",""value"":""NS_IDENT@3db64bd4.BAR"",""pos"":{""lineNum"":1,""columnNum"":26,""endLineNum"":1,""endColumnNum"":31,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@49798e84"",""value"":""NS_IDENT@3db64bd4.beer"",""pos"":{""lineNum"":3,""columnNum"":51,""endLineNum"":3,""endColumnNum"":57,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2d746ce4"",""value"":""NS_IDENT@5f80fa43.beer"",""pos"":{""lineNum"":3,""columnNum"":29,""endLineNum"":3,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@55ecbafe"",""value"":""NS_IDENT@3db64bd4.BEER"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6ed06f69"",""value"":""NS_IDENT@6e106680.beer"",""pos"":{""lineNum"":3,""columnNum"":61,""endLineNum"":3,""endColumnNum"":67,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@31da6b2e"",""value"":""NS_IDENT@5f80fa43.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5dbf5634"",""value"":""NS_IDENT@3db64bd4.beer"",""pos"":{""lineNum"":3,""columnNum"":38,""endLineNum"":3,""endColumnNum"":45,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@545607f2"",""value"":""NS_IDENT@3db64bd4.price"",""pos"":{""lineNum"":4,""columnNum"":11,""endLineNum"":4,""endColumnNum"":18,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@3db64bd4.beer""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":4,""endColumnNum"":76,""quoted"":false},""children"":{""BLOCK_SELECT@7fedfe27"":{""id"":""BLOCK_SELECT@7fedfe27"",""parentId"":""BLOCK_SELECT@19593091"",""fields"":[""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@65fd6708"",""value"":""NS_IDENT@7fc645e4.PRICE"",""pos"":{""lineNum"":4,""columnNum"":34,""endLineNum"":4,""endColumnNum"":38,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@7fc645e4""],""fromNode"":{""id"":""JOIN_OPERAND@2d66530f"",""value"":""NS_IDENT@7fc645e4"",""pos"":{""lineNum"":4,""columnNum"":45,""endLineNum"":4,""endColumnNum"":50,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@3721177d"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":60,""endLineNum"":4,""endColumnNum"":75,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@4a3be6a5"",""value"":""NS_IDENT@3db64bd4.beer"",""pos"":{""lineNum"":4,""columnNum"":60,""endLineNum"":4,""endColumnNum"":66,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7cf162bc"",""value"":""NS_IDENT@7fc645e4.beer"",""pos"":{""lineNum"":4,""columnNum"":70,""endLineNum"":4,""endColumnNum"":75,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@65fd6708"",""value"":""NS_IDENT@7fc645e4.PRICE"",""pos"":{""lineNum"":4,""columnNum"":34,""endLineNum"":4,""endColumnNum"":38,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@4a3be6a5"",""value"":""NS_IDENT@3db64bd4.beer"",""pos"":{""lineNum"":4,""columnNum"":60,""endLineNum"":4,""endColumnNum"":66,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7cf162bc"",""value"":""NS_IDENT@7fc645e4.beer"",""pos"":{""lineNum"":4,""columnNum"":70,""endLineNum"":4,""endColumnNum"":75,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@3db64bd4""],""corrCtxIds"":[""BLOCK_SELECT@19593091""],""pos"":{""lineNum"":4,""columnNum"":27,""endLineNum"":4,""endColumnNum"":75,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@5f80fa43"":{""tableId"":""NS_IDENT@5f80fa43"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@6e106680"":{""tableId"":""NS_IDENT@6e106680"",""identifier"":""S2"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":26,""endLineNum"":2,""endColumnNum"":34,""quoted"":false}},""NS_IDENT@7fc645e4"":{""tableId"":""NS_IDENT@7fc645e4"",""identifier"":""S"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":45,""endLineNum"":4,""endColumnNum"":52,""quoted"":false}},""NS_IDENT@3db64bd4"":{""tableId"":""NS_IDENT@3db64bd4"",""identifier"":""S1"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":15,""endLineNum"":2,""endColumnNum"":23,""quoted"":false}}},""corrTables"":[""NS_IDENT@3db64bd4""]}
"
"SELECT S2.beer, S2.bar
FROM serves S2
WHERE (S2.beer, S2.price) IN (SELECT L.beer, MAX(S.price)
FROM likes L, serves S
WHERE L.drinker = 'Dan' AND L.beer = S.beer
GROUP BY L.beer);","{""failed"":true}
"
"select serves.beer, serves.bar
from serves inner join (select l.beer, s2.price
                        from likes l inner join (select beer, max(price) price from serves group by beer) s2
                        on l.drinker = 'Dan'
                        and s2.beer = l.beer) s3
on serves.price = s3.price
and serves.beer = s3.beer;","{""blocks"":{""id"":""BLOCK_SELECT@61d01788"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@6e1f8469"",""value"":""NS_IDENT@7c455e96.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3b6c624"",""value"":""NS_IDENT@7c455e96.BAR"",""pos"":{""lineNum"":1,""columnNum"":21,""endLineNum"":1,""endColumnNum"":30,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@7c455e96"",""NS_SELECT@77bd7fe7""],""fromNode"":{""id"":""OP_JOIN@4bff2185"",""value"":""INNER"",""pos"":{""lineNum"":2,""columnNum"":19,""endLineNum"":2,""endColumnNum"":22,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@4690f583"",""value"":""NS_IDENT@7c455e96"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@37a64f9d"",""value"":""BLOCK_SELECT@37a64f9d"",""pos"":{""lineNum"":2,""columnNum"":25,""endLineNum"":5,""endColumnNum"":44,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@281f23f2"",""value"":""AND"",""pos"":{""lineNum"":6,""columnNum"":4,""endLineNum"":7,""endColumnNum"":25,""quoted"":false},""children"":[{""id"":""OP_BINARY@1f443fae"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":4,""endLineNum"":6,""endColumnNum"":26,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@736f3e9e"",""value"":""NS_IDENT@7c455e96.price"",""pos"":{""lineNum"":6,""columnNum"":4,""endLineNum"":6,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@bdc8014"",""value"":""NS_SELECT@77bd7fe7.PRICE"",""pos"":{""lineNum"":6,""columnNum"":19,""endLineNum"":6,""endColumnNum"":26,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@1698d7c0"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":5,""endLineNum"":7,""endColumnNum"":25,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@73ba6fe6"",""value"":""NS_IDENT@7c455e96.beer"",""pos"":{""lineNum"":7,""columnNum"":5,""endLineNum"":7,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@79ab34c1"",""value"":""NS_SELECT@77bd7fe7.BEER"",""pos"":{""lineNum"":7,""columnNum"":19,""endLineNum"":7,""endColumnNum"":25,""quoted"":false},""children"":[]}]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@6e1f8469"",""value"":""NS_IDENT@7c455e96.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@736f3e9e"",""value"":""NS_IDENT@7c455e96.price"",""pos"":{""lineNum"":6,""columnNum"":4,""endLineNum"":6,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@73ba6fe6"",""value"":""NS_IDENT@7c455e96.beer"",""pos"":{""lineNum"":7,""columnNum"":5,""endLineNum"":7,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@bdc8014"",""value"":""NS_SELECT@77bd7fe7.PRICE"",""pos"":{""lineNum"":6,""columnNum"":19,""endLineNum"":6,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@79ab34c1"",""value"":""NS_SELECT@77bd7fe7.BEER"",""pos"":{""lineNum"":7,""columnNum"":19,""endLineNum"":7,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3b6c624"",""value"":""NS_IDENT@7c455e96.BAR"",""pos"":{""lineNum"":1,""columnNum"":21,""endLineNum"":1,""endColumnNum"":30,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":7,""endColumnNum"":25,""quoted"":false},""children"":{""BLOCK_SELECT@37a64f9d"":{""id"":""BLOCK_SELECT@37a64f9d"",""parentId"":""BLOCK_SELECT@61d01788"",""alias"":""S3"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@30506c0d"",""value"":""NS_IDENT@35d3ab60.BEER"",""pos"":{""lineNum"":2,""columnNum"":32,""endLineNum"":2,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@a64e035"",""value"":""NS_SELECT@10876a6.PRICE"",""pos"":{""lineNum"":2,""columnNum"":40,""endLineNum"":2,""endColumnNum"":47,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@35d3ab60"",""NS_SELECT@10876a6""],""fromNode"":{""id"":""OP_JOIN@25b865b5"",""value"":""INNER"",""pos"":{""lineNum"":3,""columnNum"":44,""endLineNum"":3,""endColumnNum"":47,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@f9b5552"",""value"":""NS_IDENT@35d3ab60"",""pos"":{""lineNum"":3,""columnNum"":30,""endLineNum"":3,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@6872f9c8"",""value"":""BLOCK_SELECT@6872f9c8"",""pos"":{""lineNum"":3,""columnNum"":50,""endLineNum"":3,""endColumnNum"":104,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@78faea5f"",""value"":""AND"",""pos"":{""lineNum"":4,""columnNum"":28,""endLineNum"":5,""endColumnNum"":44,""quoted"":false},""children"":[{""id"":""OP_BINARY@4e4c3a38"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":28,""endLineNum"":4,""endColumnNum"":44,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4abf3f0"",""value"":""NS_IDENT@35d3ab60.drinker"",""pos"":{""lineNum"":4,""columnNum"":28,""endLineNum"":4,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@37fdfb05"",""value"":""'Dan'"",""pos"":{""lineNum"":4,""columnNum"":40,""endLineNum"":4,""endColumnNum"":44,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@57c88764"",""value"":""="",""pos"":{""lineNum"":5,""columnNum"":29,""endLineNum"":5,""endColumnNum"":44,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@293cde83"",""value"":""NS_SELECT@10876a6.BEER"",""pos"":{""lineNum"":5,""columnNum"":29,""endLineNum"":5,""endColumnNum"":35,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@c27d163"",""value"":""NS_IDENT@35d3ab60.beer"",""pos"":{""lineNum"":5,""columnNum"":39,""endLineNum"":5,""endColumnNum"":44,""quoted"":false},""children"":[]}]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@a64e035"",""value"":""NS_SELECT@10876a6.PRICE"",""pos"":{""lineNum"":2,""columnNum"":40,""endLineNum"":2,""endColumnNum"":47,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@293cde83"",""value"":""NS_SELECT@10876a6.BEER"",""pos"":{""lineNum"":5,""columnNum"":29,""endLineNum"":5,""endColumnNum"":35,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4abf3f0"",""value"":""NS_IDENT@35d3ab60.drinker"",""pos"":{""lineNum"":4,""columnNum"":28,""endLineNum"":4,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@30506c0d"",""value"":""NS_IDENT@35d3ab60.BEER"",""pos"":{""lineNum"":2,""columnNum"":32,""endLineNum"":2,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@c27d163"",""value"":""NS_IDENT@35d3ab60.beer"",""pos"":{""lineNum"":5,""columnNum"":39,""endLineNum"":5,""endColumnNum"":44,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":25,""endLineNum"":5,""endColumnNum"":44,""quoted"":false},""children"":{""BLOCK_SELECT@6872f9c8"":{""id"":""BLOCK_SELECT@6872f9c8"",""parentId"":""BLOCK_SELECT@37a64f9d"",""alias"":""S2"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@45792847"",""value"":""NS_IDENT@71870da7.BEER"",""pos"":{""lineNum"":3,""columnNum"":57,""endLineNum"":3,""endColumnNum"":60,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@4e25147a"",""value"":""MAX"",""pos"":{""lineNum"":3,""columnNum"":63,""endLineNum"":3,""endColumnNum"":72,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@6b68cb27"",""value"":""NS_IDENT@71870da7.PRICE"",""pos"":{""lineNum"":3,""columnNum"":67,""endLineNum"":3,""endColumnNum"":71,""quoted"":false},""children"":[]}],""alias"":""PRICE""}],""fromItemIds"":[""NS_IDENT@71870da7""],""fromNode"":{""id"":""JOIN_OPERAND@6d2d99fc"",""value"":""NS_IDENT@71870da7"",""pos"":{""lineNum"":3,""columnNum"":85,""endLineNum"":3,""endColumnNum"":90,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@4c98a6d5"",""value"":""NS_IDENT@71870da7.beer"",""pos"":{""lineNum"":3,""columnNum"":101,""endLineNum"":3,""endColumnNum"":104,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@6b68cb27"",""value"":""NS_IDENT@71870da7.PRICE"",""pos"":{""lineNum"":3,""columnNum"":67,""endLineNum"":3,""endColumnNum"":71,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4c98a6d5"",""value"":""NS_IDENT@71870da7.beer"",""pos"":{""lineNum"":3,""columnNum"":101,""endLineNum"":3,""endColumnNum"":104,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@45792847"",""value"":""NS_IDENT@71870da7.BEER"",""pos"":{""lineNum"":3,""columnNum"":57,""endLineNum"":3,""endColumnNum"":60,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":50,""endLineNum"":3,""endColumnNum"":104,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@7c455e96"":{""tableId"":""NS_IDENT@7c455e96"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":11,""quoted"":false}},""NS_IDENT@71870da7"":{""tableId"":""NS_IDENT@71870da7"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":85,""endLineNum"":3,""endColumnNum"":90,""quoted"":false}},""NS_IDENT@35d3ab60"":{""tableId"":""NS_IDENT@35d3ab60"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":30,""endLineNum"":3,""endColumnNum"":36,""quoted"":false}},""NS_SELECT@10876a6"":{""tableId"":""NS_SELECT@10876a6"",""identifier"":""S2"",""blockId"":""BLOCK_SELECT@6872f9c8"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":50,""endLineNum"":3,""endColumnNum"":108,""quoted"":false}},""NS_SELECT@77bd7fe7"":{""tableId"":""NS_SELECT@77bd7fe7"",""identifier"":""S3"",""blockId"":""BLOCK_SELECT@37a64f9d"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":25,""endLineNum"":5,""endColumnNum"":48,""quoted"":false}}},""corrTables"":[]}
"
"select distinct S1.beer, S1.bar
from likes L, serves S1
where L.drinker = 'Dan' and L.beer = S1.beer and S1.price >= ALL(select price from serves where beer = S1.beer)


","{""blocks"":{""id"":""BLOCK_SELECT@19593091"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":true,""selectList"":[{""id"":""COLUMN_LOCAL@5fb7183b"",""value"":""NS_IDENT@676ff3b0.BEER"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5f80fa43"",""value"":""NS_IDENT@676ff3b0.BAR"",""pos"":{""lineNum"":1,""columnNum"":26,""endLineNum"":1,""endColumnNum"":31,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@7e9da981"",""NS_IDENT@676ff3b0""],""fromNode"":{""id"":""OP_JOIN@21f9277b"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":13,""endLineNum"":2,""endColumnNum"":13,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@5d58c727"",""value"":""NS_IDENT@7e9da981"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@52a36910"",""value"":""NS_IDENT@676ff3b0"",""pos"":{""lineNum"":2,""columnNum"":15,""endLineNum"":2,""endColumnNum"":20,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@47e4d9d0"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":110,""quoted"":false},""children"":[{""id"":""OP_BINARY@2d746ce4"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":44,""quoted"":false},""children"":[{""id"":""OP_BINARY@48c3205a"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1949309d"",""value"":""NS_IDENT@7e9da981.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@27c04377"",""value"":""'Dan'"",""pos"":{""lineNum"":3,""columnNum"":19,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@7c6442c2"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":29,""endLineNum"":3,""endColumnNum"":44,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@121c54fa"",""value"":""NS_IDENT@7e9da981.beer"",""pos"":{""lineNum"":3,""columnNum"":29,""endLineNum"":3,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4390f46e"",""value"":""NS_IDENT@676ff3b0.beer"",""pos"":{""lineNum"":3,""columnNum"":38,""endLineNum"":3,""endColumnNum"":44,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@1948ea69"",""value"":"">= ALL"",""pos"":{""lineNum"":3,""columnNum"":50,""endLineNum"":3,""endColumnNum"":110,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5dbf5634"",""value"":""NS_IDENT@676ff3b0.price"",""pos"":{""lineNum"":3,""columnNum"":50,""endLineNum"":3,""endColumnNum"":57,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@7fedfe27"",""value"":""BLOCK_SELECT@7fedfe27"",""pos"":{""lineNum"":3,""columnNum"":66,""endLineNum"":3,""endColumnNum"":110,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@5dbf5634"",""value"":""NS_IDENT@676ff3b0.price"",""pos"":{""lineNum"":3,""columnNum"":50,""endLineNum"":3,""endColumnNum"":57,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4390f46e"",""value"":""NS_IDENT@676ff3b0.beer"",""pos"":{""lineNum"":3,""columnNum"":38,""endLineNum"":3,""endColumnNum"":44,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5f80fa43"",""value"":""NS_IDENT@676ff3b0.BAR"",""pos"":{""lineNum"":1,""columnNum"":26,""endLineNum"":1,""endColumnNum"":31,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1949309d"",""value"":""NS_IDENT@7e9da981.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5fb7183b"",""value"":""NS_IDENT@676ff3b0.BEER"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@121c54fa"",""value"":""NS_IDENT@7e9da981.beer"",""pos"":{""lineNum"":3,""columnNum"":29,""endLineNum"":3,""endColumnNum"":34,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@676ff3b0.beer""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":3,""endColumnNum"":111,""quoted"":false},""children"":{""BLOCK_SELECT@7fedfe27"":{""id"":""BLOCK_SELECT@7fedfe27"",""parentId"":""BLOCK_SELECT@19593091"",""fields"":[""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@5a6482a9"",""value"":""NS_IDENT@576c5536.PRICE"",""pos"":{""lineNum"":3,""columnNum"":73,""endLineNum"":3,""endColumnNum"":77,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@576c5536""],""fromNode"":{""id"":""JOIN_OPERAND@47b2e9e1"",""value"":""NS_IDENT@576c5536"",""pos"":{""lineNum"":3,""columnNum"":84,""endLineNum"":3,""endColumnNum"":89,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@3c0fbd3a"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":97,""endLineNum"":3,""endColumnNum"":110,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@66ec9390"",""value"":""NS_IDENT@576c5536.beer"",""pos"":{""lineNum"":3,""columnNum"":97,""endLineNum"":3,""endColumnNum"":100,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@6e91893"",""value"":""NS_IDENT@676ff3b0.beer"",""pos"":{""lineNum"":3,""columnNum"":104,""endLineNum"":3,""endColumnNum"":110,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@5a6482a9"",""value"":""NS_IDENT@576c5536.PRICE"",""pos"":{""lineNum"":3,""columnNum"":73,""endLineNum"":3,""endColumnNum"":77,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@66ec9390"",""value"":""NS_IDENT@576c5536.beer"",""pos"":{""lineNum"":3,""columnNum"":97,""endLineNum"":3,""endColumnNum"":100,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@6e91893"",""value"":""NS_IDENT@676ff3b0.beer"",""pos"":{""lineNum"":3,""columnNum"":104,""endLineNum"":3,""endColumnNum"":110,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@676ff3b0""],""corrCtxIds"":[""BLOCK_SELECT@19593091""],""pos"":{""lineNum"":3,""columnNum"":66,""endLineNum"":3,""endColumnNum"":110,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@676ff3b0"":{""tableId"":""NS_IDENT@676ff3b0"",""identifier"":""S1"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":15,""endLineNum"":2,""endColumnNum"":23,""quoted"":false}},""NS_IDENT@7e9da981"":{""tableId"":""NS_IDENT@7e9da981"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@576c5536"":{""tableId"":""NS_IDENT@576c5536"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":84,""endLineNum"":3,""endColumnNum"":89,""quoted"":false}}},""corrTables"":[""NS_IDENT@676ff3b0""]}
"
"WITH Danlikes(beer) AS (SELECT beer FROM likes WHERE drinker='Dan'),Danbars(bar,beer,price) AS (SELECT serves.bar,serves.beer,serves.price FROM serves, Danlikes WHERE serves.beer=Danlikes.beer GROUP BY serves.beer,serves.bar,serves.price ORDER BY price DESC), maxbeerprice(beer,max) AS (SELECT  beer, MAX(price) FROM Danbars GROUP BY  beer) SELECT maxbeerprice.beer,Danbars.bar FROM Danbars, maxbeerprice WHERE maxbeerprice.beer = Danbars.beer AND maxbeerprice.max = Danbars.price;","{""failed"":true,""errorMsg"":""Parsing error at line 1, column 279. Query syntax may be incorrect""}
"
"select a.beer, serves.bar from serves,
(select likes.beer, max(price) as max_price
from serves, likes
where serves.beer = likes.beer
and likes.drinker = 'Dan'
group by likes.beer) as a
where a.beer = serves.beer and serves.price = max_price","{""blocks"":{""id"":""BLOCK_SELECT@61d01788"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@49dbaaf3"",""value"":""NS_SELECT@69c93ca4.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@10876a6"",""value"":""NS_IDENT@432034a.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":25,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@432034a"",""NS_SELECT@69c93ca4""],""fromNode"":{""id"":""OP_JOIN@4bff2185"",""value"":""COMMA"",""pos"":{""lineNum"":1,""columnNum"":38,""endLineNum"":1,""endColumnNum"":38,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@4690f583"",""value"":""NS_IDENT@432034a"",""pos"":{""lineNum"":1,""columnNum"":32,""endLineNum"":1,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@37a64f9d"",""value"":""BLOCK_SELECT@37a64f9d"",""pos"":{""lineNum"":2,""columnNum"":2,""endLineNum"":6,""endColumnNum"":19,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@64138b0c"",""value"":""AND"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":55,""quoted"":false},""children"":[{""id"":""OP_BINARY@7fab4be7"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":26,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@15fa55a6"",""value"":""NS_SELECT@69c93ca4.BEER"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_IDENT@432034a.beer"",""pos"":{""lineNum"":7,""columnNum"":16,""endLineNum"":7,""endColumnNum"":26,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@41c204a0"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":32,""endLineNum"":7,""endColumnNum"":55,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@a64e035"",""value"":""NS_IDENT@432034a.price"",""pos"":{""lineNum"":7,""columnNum"":32,""endLineNum"":7,""endColumnNum"":43,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4d74c3ba"",""value"":""NS_SELECT@69c93ca4.MAX_PRICE"",""pos"":{""lineNum"":7,""columnNum"":47,""endLineNum"":7,""endColumnNum"":55,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@10876a6"",""value"":""NS_IDENT@432034a.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@49dbaaf3"",""value"":""NS_SELECT@69c93ca4.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@15fa55a6"",""value"":""NS_SELECT@69c93ca4.BEER"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_IDENT@432034a.beer"",""pos"":{""lineNum"":7,""columnNum"":16,""endLineNum"":7,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@a64e035"",""value"":""NS_IDENT@432034a.price"",""pos"":{""lineNum"":7,""columnNum"":32,""endLineNum"":7,""endColumnNum"":43,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4d74c3ba"",""value"":""NS_SELECT@69c93ca4.MAX_PRICE"",""pos"":{""lineNum"":7,""columnNum"":47,""endLineNum"":7,""endColumnNum"":55,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":7,""endColumnNum"":55,""quoted"":false},""children"":{""BLOCK_SELECT@37a64f9d"":{""id"":""BLOCK_SELECT@37a64f9d"",""parentId"":""BLOCK_SELECT@61d01788"",""alias"":""A"",""fields"":[""BEER VARCHAR(100)"",""MAX_PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@60dd3c23"",""value"":""NS_IDENT@173373b4.BEER"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@5e9456ae"",""value"":""MAX"",""pos"":{""lineNum"":2,""columnNum"":21,""endLineNum"":2,""endColumnNum"":30,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@16a9a4f1"",""value"":""NS_IDENT@63da207f.PRICE"",""pos"":{""lineNum"":2,""columnNum"":25,""endLineNum"":2,""endColumnNum"":29,""quoted"":false},""children"":[]}],""alias"":""MAX_PRICE""}],""fromItemIds"":[""NS_IDENT@63da207f"",""NS_IDENT@173373b4""],""fromNode"":{""id"":""OP_JOIN@25b865b5"",""value"":""COMMA"",""pos"":{""lineNum"":3,""columnNum"":12,""endLineNum"":3,""endColumnNum"":12,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@f9b5552"",""value"":""NS_IDENT@63da207f"",""pos"":{""lineNum"":3,""columnNum"":6,""endLineNum"":3,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@6872f9c8"",""value"":""NS_IDENT@173373b4"",""pos"":{""lineNum"":3,""columnNum"":14,""endLineNum"":3,""endColumnNum"":18,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@5cf87cfd"",""value"":""AND"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":5,""endColumnNum"":25,""quoted"":false},""children"":[{""id"":""OP_BINARY@7b2a3ff8"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":30,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7f02251"",""value"":""NS_IDENT@63da207f.beer"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@53692008"",""value"":""NS_IDENT@173373b4.beer"",""pos"":{""lineNum"":4,""columnNum"":21,""endLineNum"":4,""endColumnNum"":30,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@460b6d54"",""value"":""="",""pos"":{""lineNum"":5,""columnNum"":5,""endLineNum"":5,""endColumnNum"":25,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1bbae752"",""value"":""NS_IDENT@173373b4.drinker"",""pos"":{""lineNum"":5,""columnNum"":5,""endLineNum"":5,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@ccd1bc3"",""value"":""'Dan'"",""pos"":{""lineNum"":5,""columnNum"":21,""endLineNum"":5,""endColumnNum"":25,""quoted"":false},""children"":[]}]}]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@2032e725"",""value"":""NS_IDENT@173373b4.beer"",""pos"":{""lineNum"":6,""columnNum"":10,""endLineNum"":6,""endColumnNum"":19,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@7f02251"",""value"":""NS_IDENT@63da207f.beer"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1bbae752"",""value"":""NS_IDENT@173373b4.drinker"",""pos"":{""lineNum"":5,""columnNum"":5,""endLineNum"":5,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@60dd3c23"",""value"":""NS_IDENT@173373b4.BEER"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@53692008"",""value"":""NS_IDENT@173373b4.beer"",""pos"":{""lineNum"":4,""columnNum"":21,""endLineNum"":4,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2032e725"",""value"":""NS_IDENT@173373b4.beer"",""pos"":{""lineNum"":6,""columnNum"":10,""endLineNum"":6,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@16a9a4f1"",""value"":""NS_IDENT@63da207f.PRICE"",""pos"":{""lineNum"":2,""columnNum"":25,""endLineNum"":2,""endColumnNum"":29,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":2,""endLineNum"":6,""endColumnNum"":19,""quoted"":false},""children"":{}}}},""tables"":{""NS_SELECT@69c93ca4"":{""tableId"":""NS_SELECT@69c93ca4"",""identifier"":""A"",""blockId"":""BLOCK_SELECT@37a64f9d"",""fields"":[""BEER VARCHAR(100)"",""MAX_PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":2,""endLineNum"":6,""endColumnNum"":25,""quoted"":false}},""NS_IDENT@173373b4"":{""tableId"":""NS_IDENT@173373b4"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":14,""endLineNum"":3,""endColumnNum"":18,""quoted"":false}},""NS_IDENT@63da207f"":{""tableId"":""NS_IDENT@63da207f"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":6,""endLineNum"":3,""endColumnNum"":11,""quoted"":false}},""NS_IDENT@432034a"":{""tableId"":""NS_IDENT@432034a"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":32,""endLineNum"":1,""endColumnNum"":37,""quoted"":false}}},""corrTables"":[]}
"
"WITH DanBeer AS 
  (SELECT beer
   FROM likes
   WHERE drinker='Dan')
SELECT DISTINCT s1.beer AS beer, s1.bar AS bar
FROM serves s1
WHERE ((s1.beer IN (SELECT beer from DanBeer)) AND (s1.price >= ALL(SELECT price FROM serves s2 WHERE s2.beer = s1.beer) ));","{""blocks"":{""id"":""BLOCK_SELECT@2fe88a09"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":true,""selectList"":[{""id"":""COLUMN_LOCAL@7cab1508"",""value"":""NS_IDENT@7ec25216.BEER"",""pos"":{""lineNum"":5,""columnNum"":17,""endLineNum"":5,""endColumnNum"":23,""quoted"":false},""children"":[],""alias"":""BEER""},{""id"":""COLUMN_LOCAL@258ee7de"",""value"":""NS_IDENT@7ec25216.BAR"",""pos"":{""lineNum"":5,""columnNum"":34,""endLineNum"":5,""endColumnNum"":39,""quoted"":false},""children"":[],""alias"":""BAR""}],""fromItemIds"":[""NS_IDENT@7ec25216""],""fromNode"":{""id"":""JOIN_OPERAND@1e6308a9"",""value"":""NS_IDENT@7ec25216"",""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":11,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@766a4535"",""value"":""AND"",""pos"":{""lineNum"":7,""columnNum"":9,""endLineNum"":7,""endColumnNum"":119,""quoted"":false},""children"":[{""id"":""OP_BINARY@4a3be6a5"",""value"":""IN"",""pos"":{""lineNum"":7,""columnNum"":9,""endLineNum"":7,""endColumnNum"":44,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@2f7dcef2"",""value"":""NS_IDENT@7ec25216.beer"",""pos"":{""lineNum"":7,""columnNum"":9,""endLineNum"":7,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@1917d90f"",""value"":""BLOCK_SELECT@1917d90f"",""pos"":{""lineNum"":7,""columnNum"":21,""endLineNum"":7,""endColumnNum"":44,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@3721177d"",""value"":"">= ALL"",""pos"":{""lineNum"":7,""columnNum"":53,""endLineNum"":7,""endColumnNum"":119,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7cf162bc"",""value"":""NS_IDENT@7ec25216.price"",""pos"":{""lineNum"":7,""columnNum"":53,""endLineNum"":7,""endColumnNum"":60,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@4aac85fa"",""value"":""BLOCK_SELECT@4aac85fa"",""pos"":{""lineNum"":7,""columnNum"":69,""endLineNum"":7,""endColumnNum"":119,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@7cf162bc"",""value"":""NS_IDENT@7ec25216.price"",""pos"":{""lineNum"":7,""columnNum"":53,""endLineNum"":7,""endColumnNum"":60,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2f7dcef2"",""value"":""NS_IDENT@7ec25216.beer"",""pos"":{""lineNum"":7,""columnNum"":9,""endLineNum"":7,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7cab1508"",""value"":""NS_IDENT@7ec25216.BEER"",""pos"":{""lineNum"":5,""columnNum"":17,""endLineNum"":5,""endColumnNum"":23,""quoted"":false},""children"":[],""alias"":""BEER""},{""id"":""COLUMN_LOCAL@258ee7de"",""value"":""NS_IDENT@7ec25216.BAR"",""pos"":{""lineNum"":5,""columnNum"":34,""endLineNum"":5,""endColumnNum"":39,""quoted"":false},""children"":[],""alias"":""BAR""}],""incomingIdentifiers"":[""NS_IDENT@7ec25216.beer""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":5,""columnNum"":1,""endLineNum"":7,""endColumnNum"":123,""quoted"":false},""children"":{""BLOCK_SELECT@4aac85fa"":{""id"":""BLOCK_SELECT@4aac85fa"",""parentId"":""BLOCK_SELECT@2fe88a09"",""fields"":[""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@7a2e0858"",""value"":""NS_IDENT@6e1d4137.PRICE"",""pos"":{""lineNum"":7,""columnNum"":76,""endLineNum"":7,""endColumnNum"":80,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@6e1d4137""],""fromNode"":{""id"":""JOIN_OPERAND@6079cf5"",""value"":""NS_IDENT@6e1d4137"",""pos"":{""lineNum"":7,""columnNum"":87,""endLineNum"":7,""endColumnNum"":92,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@546621c4"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":103,""endLineNum"":7,""endColumnNum"":119,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@60d1b21f"",""value"":""NS_IDENT@6e1d4137.beer"",""pos"":{""lineNum"":7,""columnNum"":103,""endLineNum"":7,""endColumnNum"":109,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@66c83fc8"",""value"":""NS_IDENT@7ec25216.beer"",""pos"":{""lineNum"":7,""columnNum"":113,""endLineNum"":7,""endColumnNum"":119,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@60d1b21f"",""value"":""NS_IDENT@6e1d4137.beer"",""pos"":{""lineNum"":7,""columnNum"":103,""endLineNum"":7,""endColumnNum"":109,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@66c83fc8"",""value"":""NS_IDENT@7ec25216.beer"",""pos"":{""lineNum"":7,""columnNum"":113,""endLineNum"":7,""endColumnNum"":119,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7a2e0858"",""value"":""NS_IDENT@6e1d4137.PRICE"",""pos"":{""lineNum"":7,""columnNum"":76,""endLineNum"":7,""endColumnNum"":80,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@7ec25216""],""corrCtxIds"":[""BLOCK_SELECT@2fe88a09""],""pos"":{""lineNum"":7,""columnNum"":69,""endLineNum"":7,""endColumnNum"":119,""quoted"":false},""children"":{}},""BLOCK_SELECT@1917d90f"":{""id"":""BLOCK_SELECT@1917d90f"",""parentId"":""BLOCK_SELECT@2fe88a09"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@2b4786dd"",""value"":""NS_IDENT@22bd2039.BEER"",""pos"":{""lineNum"":7,""columnNum"":28,""endLineNum"":7,""endColumnNum"":31,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@22bd2039""],""fromNode"":{""id"":""JOIN_OPERAND@66bfd864"",""value"":""NS_IDENT@22bd2039"",""pos"":{""lineNum"":7,""columnNum"":38,""endLineNum"":7,""endColumnNum"":44,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@2b4786dd"",""value"":""NS_IDENT@22bd2039.BEER"",""pos"":{""lineNum"":7,""columnNum"":28,""endLineNum"":7,""endColumnNum"":31,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":7,""columnNum"":21,""endLineNum"":7,""endColumnNum"":44,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@7ec25216"":{""tableId"":""NS_IDENT@7ec25216"",""identifier"":""S1"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":14,""quoted"":false}},""NS_IDENT@22bd2039"":{""tableId"":""NS_IDENT@22bd2039"",""identifier"":""DANBEER"",""dbTableName"":""DANBEER"",""fields"":[""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":38,""endLineNum"":7,""endColumnNum"":44,""quoted"":false}},""NS_IDENT@6e1d4137"":{""tableId"":""NS_IDENT@6e1d4137"",""identifier"":""S2"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":87,""endLineNum"":7,""endColumnNum"":95,""quoted"":false}},""NS_IDENT@73044cdf"":{""tableId"":""NS_IDENT@73044cdf"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":9,""endLineNum"":3,""endColumnNum"":13,""quoted"":false}}},""corrTables"":[""NS_IDENT@7ec25216""],""withBlocks"":[{""id"":""BLOCK_SELECT@72ed9aad"",""alias"":""DANBEER"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@2301b75"",""value"":""NS_IDENT@73044cdf.BEER"",""pos"":{""lineNum"":2,""columnNum"":11,""endLineNum"":2,""endColumnNum"":14,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@73044cdf""],""fromNode"":{""id"":""JOIN_OPERAND@5e3a39cd"",""value"":""NS_IDENT@73044cdf"",""pos"":{""lineNum"":3,""columnNum"":9,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@6b587673"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":10,""endLineNum"":4,""endColumnNum"":22,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@aa004a0"",""value"":""NS_IDENT@73044cdf.drinker"",""pos"":{""lineNum"":4,""columnNum"":10,""endLineNum"":4,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@5cf87cfd"",""value"":""'Dan'"",""pos"":{""lineNum"":4,""columnNum"":18,""endLineNum"":4,""endColumnNum"":22,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@2301b75"",""value"":""NS_IDENT@73044cdf.BEER"",""pos"":{""lineNum"":2,""columnNum"":11,""endLineNum"":2,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@aa004a0"",""value"":""NS_IDENT@73044cdf.drinker"",""pos"":{""lineNum"":4,""columnNum"":10,""endLineNum"":4,""endColumnNum"":16,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":4,""endLineNum"":4,""endColumnNum"":22,""quoted"":false},""children"":{}}]}
"
"SELECT S1.beer, S1.bar FROM serves as S1, 
  (SELECT beer, MAX(price) as p FROM serves GROUP BY beer) as S2 
WHERE S1.beer = S2.beer AND S1.price = S2.p
AND S1.beer IN (SELECT beer FROM likes WHERE drinker = 'Dan')
","{""blocks"":{""id"":""BLOCK_SELECT@2b9b7f1f"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@5754de72"",""value"":""NS_IDENT@30506c0d.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@320494b6"",""value"":""NS_IDENT@30506c0d.BAR"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":22,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@30506c0d"",""NS_SELECT@6124287a""],""fromNode"":{""id"":""OP_JOIN@6872f9c8"",""value"":""COMMA"",""pos"":{""lineNum"":1,""columnNum"":41,""endLineNum"":1,""endColumnNum"":41,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@bdecc21"",""value"":""NS_IDENT@30506c0d"",""pos"":{""lineNum"":1,""columnNum"":29,""endLineNum"":1,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@5e3a39cd"",""value"":""BLOCK_SELECT@5e3a39cd"",""pos"":{""lineNum"":2,""columnNum"":4,""endLineNum"":2,""endColumnNum"":57,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@325bb9a6"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":4,""endColumnNum"":60,""quoted"":false},""children"":[{""id"":""OP_BINARY@70abf9b0"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":43,""quoted"":false},""children"":[{""id"":""OP_BINARY@1603dc2f"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@37fdfb05"",""value"":""NS_IDENT@30506c0d.beer"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5e39850"",""value"":""NS_SELECT@6124287a.BEER"",""pos"":{""lineNum"":3,""columnNum"":17,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@78c1a023"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":29,""endLineNum"":3,""endColumnNum"":43,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@398474a2"",""value"":""NS_IDENT@30506c0d.price"",""pos"":{""lineNum"":3,""columnNum"":29,""endLineNum"":3,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@61799544"",""value"":""NS_SELECT@6124287a.P"",""pos"":{""lineNum"":3,""columnNum"":40,""endLineNum"":3,""endColumnNum"":43,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@476ec9d0"",""value"":""IN"",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":4,""endColumnNum"":60,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@6a10b263"",""value"":""NS_IDENT@30506c0d.beer"",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":4,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@6f099cef"",""value"":""BLOCK_SELECT@6f099cef"",""pos"":{""lineNum"":4,""columnNum"":17,""endLineNum"":4,""endColumnNum"":60,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@320494b6"",""value"":""NS_IDENT@30506c0d.BAR"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@398474a2"",""value"":""NS_IDENT@30506c0d.price"",""pos"":{""lineNum"":3,""columnNum"":29,""endLineNum"":3,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6a10b263"",""value"":""NS_IDENT@30506c0d.beer"",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":4,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5754de72"",""value"":""NS_IDENT@30506c0d.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@61799544"",""value"":""NS_SELECT@6124287a.P"",""pos"":{""lineNum"":3,""columnNum"":40,""endLineNum"":3,""endColumnNum"":43,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@37fdfb05"",""value"":""NS_IDENT@30506c0d.beer"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5e39850"",""value"":""NS_SELECT@6124287a.BEER"",""pos"":{""lineNum"":3,""columnNum"":17,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":4,""endColumnNum"":61,""quoted"":false},""children"":{""BLOCK_SELECT@6f099cef"":{""id"":""BLOCK_SELECT@6f099cef"",""parentId"":""BLOCK_SELECT@2b9b7f1f"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@43effd89"",""value"":""NS_IDENT@51dbd6e4.BEER"",""pos"":{""lineNum"":4,""columnNum"":24,""endLineNum"":4,""endColumnNum"":27,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@51dbd6e4""],""fromNode"":{""id"":""JOIN_OPERAND@1d207fad"",""value"":""NS_IDENT@51dbd6e4"",""pos"":{""lineNum"":4,""columnNum"":34,""endLineNum"":4,""endColumnNum"":38,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@1f443fae"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":46,""endLineNum"":4,""endColumnNum"":60,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@bdc8014"",""value"":""NS_IDENT@51dbd6e4.drinker"",""pos"":{""lineNum"":4,""columnNum"":46,""endLineNum"":4,""endColumnNum"":52,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@1e9804b9"",""value"":""'Dan'"",""pos"":{""lineNum"":4,""columnNum"":56,""endLineNum"":4,""endColumnNum"":60,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@43effd89"",""value"":""NS_IDENT@51dbd6e4.BEER"",""pos"":{""lineNum"":4,""columnNum"":24,""endLineNum"":4,""endColumnNum"":27,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@bdc8014"",""value"":""NS_IDENT@51dbd6e4.drinker"",""pos"":{""lineNum"":4,""columnNum"":46,""endLineNum"":4,""endColumnNum"":52,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":4,""columnNum"":17,""endLineNum"":4,""endColumnNum"":60,""quoted"":false},""children"":{}},""BLOCK_SELECT@5e3a39cd"":{""id"":""BLOCK_SELECT@5e3a39cd"",""parentId"":""BLOCK_SELECT@2b9b7f1f"",""alias"":""S2"",""fields"":[""BEER VARCHAR(100)"",""P DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@6e1f8469"",""value"":""NS_IDENT@19569ebd.BEER"",""pos"":{""lineNum"":2,""columnNum"":11,""endLineNum"":2,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@3b6c624"",""value"":""MAX"",""pos"":{""lineNum"":2,""columnNum"":17,""endLineNum"":2,""endColumnNum"":26,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1eaf1e62"",""value"":""NS_IDENT@19569ebd.PRICE"",""pos"":{""lineNum"":2,""columnNum"":21,""endLineNum"":2,""endColumnNum"":25,""quoted"":false},""children"":[]}],""alias"":""P""}],""fromItemIds"":[""NS_IDENT@19569ebd""],""fromNode"":{""id"":""JOIN_OPERAND@21f9277b"",""value"":""NS_IDENT@19569ebd"",""pos"":{""lineNum"":2,""columnNum"":38,""endLineNum"":2,""endColumnNum"":43,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@4c98a6d5"",""value"":""NS_IDENT@19569ebd.beer"",""pos"":{""lineNum"":2,""columnNum"":54,""endLineNum"":2,""endColumnNum"":57,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@6e1f8469"",""value"":""NS_IDENT@19569ebd.BEER"",""pos"":{""lineNum"":2,""columnNum"":11,""endLineNum"":2,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1eaf1e62"",""value"":""NS_IDENT@19569ebd.PRICE"",""pos"":{""lineNum"":2,""columnNum"":21,""endLineNum"":2,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4c98a6d5"",""value"":""NS_IDENT@19569ebd.beer"",""pos"":{""lineNum"":2,""columnNum"":54,""endLineNum"":2,""endColumnNum"":57,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":4,""endLineNum"":2,""endColumnNum"":57,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@30506c0d"":{""tableId"":""NS_IDENT@30506c0d"",""identifier"":""S1"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":29,""endLineNum"":1,""endColumnNum"":40,""quoted"":false}},""NS_IDENT@51dbd6e4"":{""tableId"":""NS_IDENT@51dbd6e4"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":34,""endLineNum"":4,""endColumnNum"":38,""quoted"":false}},""NS_SELECT@6124287a"":{""tableId"":""NS_SELECT@6124287a"",""identifier"":""S2"",""blockId"":""BLOCK_SELECT@5e3a39cd"",""fields"":[""BEER VARCHAR(100)"",""P DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":4,""endLineNum"":2,""endColumnNum"":64,""quoted"":false}},""NS_IDENT@19569ebd"":{""tableId"":""NS_IDENT@19569ebd"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":38,""endLineNum"":2,""endColumnNum"":43,""quoted"":false}}},""corrTables"":[]}
"
"SELECT serves.beer as beer, bar
FROM 
  (SELECT serves.beer, MAX(serves.price) as maxprice
  FROM likes, serves
  WHERE drinker = 'Dan' and likes.beer = serves.beer
  GROUP BY serves.beer
  ) as expensive, serves 
WHERE serves.beer = expensive.beer and serves.price = expensive.maxprice;","{""blocks"":{""id"":""BLOCK_SELECT@61d01788"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@6dd91637"",""value"":""NS_IDENT@71870da7.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":18,""quoted"":false},""children"":[],""alias"":""BEER""},{""id"":""COLUMN_LOCAL@706cb08"",""value"":""NS_IDENT@71870da7.BAR"",""pos"":{""lineNum"":1,""columnNum"":29,""endLineNum"":1,""endColumnNum"":31,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_SELECT@7d755813"",""NS_IDENT@71870da7""],""fromNode"":{""id"":""OP_JOIN@4bff2185"",""value"":""COMMA"",""pos"":{""lineNum"":7,""columnNum"":17,""endLineNum"":7,""endColumnNum"":17,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@7fedfe27"",""value"":""BLOCK_SELECT@7fedfe27"",""pos"":{""lineNum"":3,""columnNum"":4,""endLineNum"":6,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@1917d90f"",""value"":""NS_IDENT@71870da7"",""pos"":{""lineNum"":7,""columnNum"":19,""endLineNum"":7,""endColumnNum"":24,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@64138b0c"",""value"":""AND"",""pos"":{""lineNum"":8,""columnNum"":7,""endLineNum"":8,""endColumnNum"":72,""quoted"":false},""children"":[{""id"":""OP_BINARY@7fab4be7"",""value"":""="",""pos"":{""lineNum"":8,""columnNum"":7,""endLineNum"":8,""endColumnNum"":34,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@15fa55a6"",""value"":""NS_IDENT@71870da7.beer"",""pos"":{""lineNum"":8,""columnNum"":7,""endLineNum"":8,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_SELECT@7d755813.BEER"",""pos"":{""lineNum"":8,""columnNum"":21,""endLineNum"":8,""endColumnNum"":34,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@41c204a0"",""value"":""="",""pos"":{""lineNum"":8,""columnNum"":40,""endLineNum"":8,""endColumnNum"":72,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@a64e035"",""value"":""NS_IDENT@71870da7.price"",""pos"":{""lineNum"":8,""columnNum"":40,""endLineNum"":8,""endColumnNum"":51,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4d74c3ba"",""value"":""NS_SELECT@7d755813.MAXPRICE"",""pos"":{""lineNum"":8,""columnNum"":55,""endLineNum"":8,""endColumnNum"":72,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_SELECT@7d755813.BEER"",""pos"":{""lineNum"":8,""columnNum"":21,""endLineNum"":8,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@a64e035"",""value"":""NS_IDENT@71870da7.price"",""pos"":{""lineNum"":8,""columnNum"":40,""endLineNum"":8,""endColumnNum"":51,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4d74c3ba"",""value"":""NS_SELECT@7d755813.MAXPRICE"",""pos"":{""lineNum"":8,""columnNum"":55,""endLineNum"":8,""endColumnNum"":72,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6dd91637"",""value"":""NS_IDENT@71870da7.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":18,""quoted"":false},""children"":[],""alias"":""BEER""},{""id"":""COLUMN_LOCAL@706cb08"",""value"":""NS_IDENT@71870da7.BAR"",""pos"":{""lineNum"":1,""columnNum"":29,""endLineNum"":1,""endColumnNum"":31,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@15fa55a6"",""value"":""NS_IDENT@71870da7.beer"",""pos"":{""lineNum"":8,""columnNum"":7,""endLineNum"":8,""endColumnNum"":17,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":8,""endColumnNum"":72,""quoted"":false},""children"":{""BLOCK_SELECT@7fedfe27"":{""id"":""BLOCK_SELECT@7fedfe27"",""parentId"":""BLOCK_SELECT@61d01788"",""alias"":""EXPENSIVE"",""fields"":[""BEER VARCHAR(100)"",""MAXPRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@5e9456ae"",""value"":""NS_IDENT@60dd3c23.BEER"",""pos"":{""lineNum"":3,""columnNum"":11,""endLineNum"":3,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@1f1cae23"",""value"":""MAX"",""pos"":{""lineNum"":3,""columnNum"":24,""endLineNum"":3,""endColumnNum"":40,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7c455e96"",""value"":""NS_IDENT@60dd3c23.PRICE"",""pos"":{""lineNum"":3,""columnNum"":28,""endLineNum"":3,""endColumnNum"":39,""quoted"":false},""children"":[]}],""alias"":""MAXPRICE""}],""fromItemIds"":[""NS_IDENT@69c93ca4"",""NS_IDENT@60dd3c23""],""fromNode"":{""id"":""OP_JOIN@56ccd751"",""value"":""COMMA"",""pos"":{""lineNum"":4,""columnNum"":13,""endLineNum"":4,""endColumnNum"":13,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@18a645fd"",""value"":""NS_IDENT@69c93ca4"",""pos"":{""lineNum"":4,""columnNum"":8,""endLineNum"":4,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@f9b5552"",""value"":""NS_IDENT@60dd3c23"",""pos"":{""lineNum"":4,""columnNum"":15,""endLineNum"":4,""endColumnNum"":20,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@5cf87cfd"",""value"":""AND"",""pos"":{""lineNum"":5,""columnNum"":9,""endLineNum"":5,""endColumnNum"":52,""quoted"":false},""children"":[{""id"":""OP_BINARY@53692008"",""value"":""="",""pos"":{""lineNum"":5,""columnNum"":9,""endLineNum"":5,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7f02251"",""value"":""NS_IDENT@69c93ca4.drinker"",""pos"":{""lineNum"":5,""columnNum"":9,""endLineNum"":5,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@ccd1bc3"",""value"":""'Dan'"",""pos"":{""lineNum"":5,""columnNum"":19,""endLineNum"":5,""endColumnNum"":23,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@460b6d54"",""value"":""="",""pos"":{""lineNum"":5,""columnNum"":29,""endLineNum"":5,""endColumnNum"":52,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7b2a3ff8"",""value"":""NS_IDENT@69c93ca4.beer"",""pos"":{""lineNum"":5,""columnNum"":29,""endLineNum"":5,""endColumnNum"":38,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1bbae752"",""value"":""NS_IDENT@60dd3c23.beer"",""pos"":{""lineNum"":5,""columnNum"":42,""endLineNum"":5,""endColumnNum"":52,""quoted"":false},""children"":[]}]}]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@2032e725"",""value"":""NS_IDENT@60dd3c23.beer"",""pos"":{""lineNum"":6,""columnNum"":12,""endLineNum"":6,""endColumnNum"":22,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@2032e725"",""value"":""NS_IDENT@60dd3c23.beer"",""pos"":{""lineNum"":6,""columnNum"":12,""endLineNum"":6,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7f02251"",""value"":""NS_IDENT@69c93ca4.drinker"",""pos"":{""lineNum"":5,""columnNum"":9,""endLineNum"":5,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5e9456ae"",""value"":""NS_IDENT@60dd3c23.BEER"",""pos"":{""lineNum"":3,""columnNum"":11,""endLineNum"":3,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1bbae752"",""value"":""NS_IDENT@60dd3c23.beer"",""pos"":{""lineNum"":5,""columnNum"":42,""endLineNum"":5,""endColumnNum"":52,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7c455e96"",""value"":""NS_IDENT@60dd3c23.PRICE"",""pos"":{""lineNum"":3,""columnNum"":28,""endLineNum"":3,""endColumnNum"":39,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7b2a3ff8"",""value"":""NS_IDENT@69c93ca4.beer"",""pos"":{""lineNum"":5,""columnNum"":29,""endLineNum"":5,""endColumnNum"":38,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":4,""endLineNum"":6,""endColumnNum"":22,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@71870da7"":{""tableId"":""NS_IDENT@71870da7"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":19,""endLineNum"":7,""endColumnNum"":24,""quoted"":false}},""NS_IDENT@60dd3c23"":{""tableId"":""NS_IDENT@60dd3c23"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":15,""endLineNum"":4,""endColumnNum"":20,""quoted"":false}},""NS_SELECT@7d755813"":{""tableId"":""NS_SELECT@7d755813"",""identifier"":""EXPENSIVE"",""blockId"":""BLOCK_SELECT@7fedfe27"",""fields"":[""BEER VARCHAR(100)"",""MAXPRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":4,""endLineNum"":7,""endColumnNum"":16,""quoted"":false}},""NS_IDENT@69c93ca4"":{""tableId"":""NS_IDENT@69c93ca4"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":8,""endLineNum"":4,""endColumnNum"":12,""quoted"":false}}},""corrTables"":[]}
"
"select serves.beer, serves.bar
from serves inner join (select l.beer, s2.price
                        from likes l inner join (select beer, max(price) price from serves group by beer) s2
                        on l.drinker = 'Dan'
                        and s2.beer = l.beer) s3
on serves.price = s3.price
and serves.beer = s3.beer;","{""blocks"":{""id"":""BLOCK_SELECT@5e742e4"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@652ab8d9"",""value"":""NS_IDENT@45792847.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@51e0301d"",""value"":""NS_IDENT@45792847.BAR"",""pos"":{""lineNum"":1,""columnNum"":21,""endLineNum"":1,""endColumnNum"":30,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@45792847"",""NS_SELECT@675ffd1d""],""fromNode"":{""id"":""OP_JOIN@2d66530f"",""value"":""INNER"",""pos"":{""lineNum"":2,""columnNum"":19,""endLineNum"":2,""endColumnNum"":22,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@25b865b5"",""value"":""NS_IDENT@45792847"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@5d58c727"",""value"":""BLOCK_SELECT@5d58c727"",""pos"":{""lineNum"":2,""columnNum"":25,""endLineNum"":5,""endColumnNum"":44,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@65bb9029"",""value"":""AND"",""pos"":{""lineNum"":6,""columnNum"":4,""endLineNum"":7,""endColumnNum"":25,""quoted"":false},""children"":[{""id"":""OP_BINARY@7435a578"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":4,""endLineNum"":6,""endColumnNum"":26,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@782168b7"",""value"":""NS_IDENT@45792847.price"",""pos"":{""lineNum"":6,""columnNum"":4,""endLineNum"":6,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@29f0c4f2"",""value"":""NS_SELECT@675ffd1d.PRICE"",""pos"":{""lineNum"":6,""columnNum"":19,""endLineNum"":6,""endColumnNum"":26,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@3c7cfcbb"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":5,""endLineNum"":7,""endColumnNum"":25,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@6093d508"",""value"":""NS_IDENT@45792847.beer"",""pos"":{""lineNum"":7,""columnNum"":5,""endLineNum"":7,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@13047d7d"",""value"":""NS_SELECT@675ffd1d.BEER"",""pos"":{""lineNum"":7,""columnNum"":19,""endLineNum"":7,""endColumnNum"":25,""quoted"":false},""children"":[]}]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@13047d7d"",""value"":""NS_SELECT@675ffd1d.BEER"",""pos"":{""lineNum"":7,""columnNum"":19,""endLineNum"":7,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@51e0301d"",""value"":""NS_IDENT@45792847.BAR"",""pos"":{""lineNum"":1,""columnNum"":21,""endLineNum"":1,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@29f0c4f2"",""value"":""NS_SELECT@675ffd1d.PRICE"",""pos"":{""lineNum"":6,""columnNum"":19,""endLineNum"":6,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@782168b7"",""value"":""NS_IDENT@45792847.price"",""pos"":{""lineNum"":6,""columnNum"":4,""endLineNum"":6,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@652ab8d9"",""value"":""NS_IDENT@45792847.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6093d508"",""value"":""NS_IDENT@45792847.beer"",""pos"":{""lineNum"":7,""columnNum"":5,""endLineNum"":7,""endColumnNum"":15,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":7,""endColumnNum"":25,""quoted"":false},""children"":{""BLOCK_SELECT@5d58c727"":{""id"":""BLOCK_SELECT@5d58c727"",""parentId"":""BLOCK_SELECT@5e742e4"",""alias"":""S3"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@3b6c624"",""value"":""NS_IDENT@56303475.BEER"",""pos"":{""lineNum"":2,""columnNum"":32,""endLineNum"":2,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@73ba6fe6"",""value"":""NS_SELECT@30506c0d.PRICE"",""pos"":{""lineNum"":2,""columnNum"":40,""endLineNum"":2,""endColumnNum"":47,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@56303475"",""NS_SELECT@30506c0d""],""fromNode"":{""id"":""OP_JOIN@52a36910"",""value"":""INNER"",""pos"":{""lineNum"":3,""columnNum"":44,""endLineNum"":3,""endColumnNum"":47,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@3a095ec0"",""value"":""NS_IDENT@56303475"",""pos"":{""lineNum"":3,""columnNum"":30,""endLineNum"":3,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@4f20a5e0"",""value"":""BLOCK_SELECT@4f20a5e0"",""pos"":{""lineNum"":3,""columnNum"":50,""endLineNum"":3,""endColumnNum"":104,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@476ec9d0"",""value"":""AND"",""pos"":{""lineNum"":4,""columnNum"":28,""endLineNum"":5,""endColumnNum"":44,""quoted"":false},""children"":[{""id"":""OP_BINARY@61799544"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":28,""endLineNum"":4,""endColumnNum"":44,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@398474a2"",""value"":""NS_IDENT@56303475.drinker"",""pos"":{""lineNum"":4,""columnNum"":28,""endLineNum"":4,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@325bb9a6"",""value"":""'Dan'"",""pos"":{""lineNum"":4,""columnNum"":40,""endLineNum"":4,""endColumnNum"":44,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@6a10b263"",""value"":""="",""pos"":{""lineNum"":5,""columnNum"":29,""endLineNum"":5,""endColumnNum"":44,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@78c1a023"",""value"":""NS_SELECT@30506c0d.BEER"",""pos"":{""lineNum"":5,""columnNum"":29,""endLineNum"":5,""endColumnNum"":35,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@70abf9b0"",""value"":""NS_IDENT@56303475.beer"",""pos"":{""lineNum"":5,""columnNum"":39,""endLineNum"":5,""endColumnNum"":44,""quoted"":false},""children"":[]}]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@70abf9b0"",""value"":""NS_IDENT@56303475.beer"",""pos"":{""lineNum"":5,""columnNum"":39,""endLineNum"":5,""endColumnNum"":44,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@73ba6fe6"",""value"":""NS_SELECT@30506c0d.PRICE"",""pos"":{""lineNum"":2,""columnNum"":40,""endLineNum"":2,""endColumnNum"":47,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@398474a2"",""value"":""NS_IDENT@56303475.drinker"",""pos"":{""lineNum"":4,""columnNum"":28,""endLineNum"":4,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@78c1a023"",""value"":""NS_SELECT@30506c0d.BEER"",""pos"":{""lineNum"":5,""columnNum"":29,""endLineNum"":5,""endColumnNum"":35,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3b6c624"",""value"":""NS_IDENT@56303475.BEER"",""pos"":{""lineNum"":2,""columnNum"":32,""endLineNum"":2,""endColumnNum"":37,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":25,""endLineNum"":5,""endColumnNum"":44,""quoted"":false},""children"":{""BLOCK_SELECT@4f20a5e0"":{""id"":""BLOCK_SELECT@4f20a5e0"",""parentId"":""BLOCK_SELECT@5d58c727"",""alias"":""S2"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@52a70627"",""value"":""NS_IDENT@1dcca8d3.BEER"",""pos"":{""lineNum"":3,""columnNum"":57,""endLineNum"":3,""endColumnNum"":60,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@19569ebd"",""value"":""MAX"",""pos"":{""lineNum"":3,""columnNum"":63,""endLineNum"":3,""endColumnNum"":72,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4632cfc"",""value"":""NS_IDENT@1dcca8d3.PRICE"",""pos"":{""lineNum"":3,""columnNum"":67,""endLineNum"":3,""endColumnNum"":71,""quoted"":false},""children"":[]}],""alias"":""PRICE""}],""fromItemIds"":[""NS_IDENT@1dcca8d3""],""fromNode"":{""id"":""JOIN_OPERAND@54da32dc"",""value"":""NS_IDENT@1dcca8d3"",""pos"":{""lineNum"":3,""columnNum"":85,""endLineNum"":3,""endColumnNum"":90,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@53692008"",""value"":""NS_IDENT@1dcca8d3.beer"",""pos"":{""lineNum"":3,""columnNum"":101,""endLineNum"":3,""endColumnNum"":104,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@53692008"",""value"":""NS_IDENT@1dcca8d3.beer"",""pos"":{""lineNum"":3,""columnNum"":101,""endLineNum"":3,""endColumnNum"":104,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4632cfc"",""value"":""NS_IDENT@1dcca8d3.PRICE"",""pos"":{""lineNum"":3,""columnNum"":67,""endLineNum"":3,""endColumnNum"":71,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@52a70627"",""value"":""NS_IDENT@1dcca8d3.BEER"",""pos"":{""lineNum"":3,""columnNum"":57,""endLineNum"":3,""endColumnNum"":60,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":50,""endLineNum"":3,""endColumnNum"":104,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@45792847"":{""tableId"":""NS_IDENT@45792847"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":11,""quoted"":false}},""NS_SELECT@675ffd1d"":{""tableId"":""NS_SELECT@675ffd1d"",""identifier"":""S3"",""blockId"":""BLOCK_SELECT@5d58c727"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":25,""endLineNum"":5,""endColumnNum"":48,""quoted"":false}},""NS_IDENT@1dcca8d3"":{""tableId"":""NS_IDENT@1dcca8d3"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":85,""endLineNum"":3,""endColumnNum"":90,""quoted"":false}},""NS_IDENT@56303475"":{""tableId"":""NS_IDENT@56303475"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":30,""endLineNum"":3,""endColumnNum"":36,""quoted"":false}},""NS_SELECT@30506c0d"":{""tableId"":""NS_SELECT@30506c0d"",""identifier"":""S2"",""blockId"":""BLOCK_SELECT@4f20a5e0"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":50,""endLineNum"":3,""endColumnNum"":108,""quoted"":false}}},""corrTables"":[]}
"
"SELECT beer, bar
FROM ((SELECT beer, MAX(price)
    FROM ((SELECT beer FROM likes WHERE drinker = 'Dan') a NATURAL JOIN serves s)
    GROUP BY beer) a2 NATURAL JOIN serves s2)
WHERE price = max
","{""failed"":true,""errorMsg"":""Parsing error at line 3, column 58. Query syntax may be incorrect""}
"
"WITH Dan_likes AS (
        SELECT beer
        FROM likes 
        WHERE drinker = 'Dan'
), Serves_dans_beer AS (
        SELECT s.bar, s.beer, s.price
        FROM Serves s 
        JOIN Dan_Likes d
        ON s.beer = d.beer
)

SELECT a.beer, a.bar 
FROM Serves_dans_beer a INNER JOIN(
        SELECT beer, MAX(price) price
        FROM Serves_dans_beer
        GROUP BY beer
) b ON a.beer = b.beer AND a.price= b.price;","{""blocks"":{""id"":""BLOCK_SELECT@1440c311"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@71870da7"",""value"":""NS_IDENT@3c017078.BEER"",""pos"":{""lineNum"":12,""columnNum"":8,""endLineNum"":12,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6dd91637"",""value"":""NS_IDENT@3c017078.BAR"",""pos"":{""lineNum"":12,""columnNum"":16,""endLineNum"":12,""endColumnNum"":20,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@3c017078"",""NS_SELECT@51827393""],""fromNode"":{""id"":""OP_JOIN@189b5fb1"",""value"":""INNER"",""pos"":{""lineNum"":13,""columnNum"":31,""endLineNum"":13,""endColumnNum"":34,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@783ec989"",""value"":""NS_IDENT@3c017078"",""pos"":{""lineNum"":13,""columnNum"":6,""endLineNum"":13,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@1ddd3478"",""value"":""BLOCK_SELECT@1ddd3478"",""pos"":{""lineNum"":14,""columnNum"":9,""endLineNum"":16,""endColumnNum"":21,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@10876a6"",""value"":""AND"",""pos"":{""lineNum"":17,""columnNum"":8,""endLineNum"":17,""endColumnNum"":43,""quoted"":false},""children"":[{""id"":""OP_BINARY@5bcde458"",""value"":""="",""pos"":{""lineNum"":17,""columnNum"":8,""endLineNum"":17,""endColumnNum"":22,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7c455e96"",""value"":""NS_IDENT@3c017078.BEER"",""pos"":{""lineNum"":17,""columnNum"":8,""endLineNum"":17,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@985696"",""value"":""NS_SELECT@51827393.BEER"",""pos"":{""lineNum"":17,""columnNum"":17,""endLineNum"":17,""endColumnNum"":22,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@35d3ab60"",""value"":""="",""pos"":{""lineNum"":17,""columnNum"":28,""endLineNum"":17,""endColumnNum"":43,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@215a34b4"",""value"":""NS_IDENT@3c017078.PRICE"",""pos"":{""lineNum"":17,""columnNum"":28,""endLineNum"":17,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@77bd7fe7"",""value"":""NS_SELECT@51827393.PRICE"",""pos"":{""lineNum"":17,""columnNum"":37,""endLineNum"":17,""endColumnNum"":43,""quoted"":false},""children"":[]}]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@7c455e96"",""value"":""NS_IDENT@3c017078.BEER"",""pos"":{""lineNum"":17,""columnNum"":8,""endLineNum"":17,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@215a34b4"",""value"":""NS_IDENT@3c017078.PRICE"",""pos"":{""lineNum"":17,""columnNum"":28,""endLineNum"":17,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@985696"",""value"":""NS_SELECT@51827393.BEER"",""pos"":{""lineNum"":17,""columnNum"":17,""endLineNum"":17,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@77bd7fe7"",""value"":""NS_SELECT@51827393.PRICE"",""pos"":{""lineNum"":17,""columnNum"":37,""endLineNum"":17,""endColumnNum"":43,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@71870da7"",""value"":""NS_IDENT@3c017078.BEER"",""pos"":{""lineNum"":12,""columnNum"":8,""endLineNum"":12,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6dd91637"",""value"":""NS_IDENT@3c017078.BAR"",""pos"":{""lineNum"":12,""columnNum"":16,""endLineNum"":12,""endColumnNum"":20,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":12,""columnNum"":1,""endLineNum"":17,""endColumnNum"":43,""quoted"":false},""children"":{""BLOCK_SELECT@1ddd3478"":{""id"":""BLOCK_SELECT@1ddd3478"",""parentId"":""BLOCK_SELECT@1440c311"",""alias"":""B"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@5c645b43"",""value"":""NS_IDENT@3be4f71.BEER"",""pos"":{""lineNum"":14,""columnNum"":16,""endLineNum"":14,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@298d9a05"",""value"":""MAX"",""pos"":{""lineNum"":14,""columnNum"":22,""endLineNum"":14,""endColumnNum"":31,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@58399d82"",""value"":""NS_IDENT@3be4f71.PRICE"",""pos"":{""lineNum"":14,""columnNum"":26,""endLineNum"":14,""endColumnNum"":30,""quoted"":false},""children"":[]}],""alias"":""PRICE""}],""fromItemIds"":[""NS_IDENT@3be4f71""],""fromNode"":{""id"":""JOIN_OPERAND@f973499"",""value"":""NS_IDENT@3be4f71"",""pos"":{""lineNum"":15,""columnNum"":14,""endLineNum"":15,""endColumnNum"":29,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@27fde870"",""value"":""NS_IDENT@3be4f71.BEER"",""pos"":{""lineNum"":16,""columnNum"":18,""endLineNum"":16,""endColumnNum"":21,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@5c645b43"",""value"":""NS_IDENT@3be4f71.BEER"",""pos"":{""lineNum"":14,""columnNum"":16,""endLineNum"":14,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@58399d82"",""value"":""NS_IDENT@3be4f71.PRICE"",""pos"":{""lineNum"":14,""columnNum"":26,""endLineNum"":14,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@27fde870"",""value"":""NS_IDENT@3be4f71.BEER"",""pos"":{""lineNum"":16,""columnNum"":18,""endLineNum"":16,""endColumnNum"":21,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":14,""columnNum"":9,""endLineNum"":16,""endColumnNum"":21,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@51dbd6e4"":{""tableId"":""NS_IDENT@51dbd6e4"",""identifier"":""S"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":14,""endLineNum"":7,""endColumnNum"":21,""quoted"":false}},""NS_SELECT@51827393"":{""tableId"":""NS_SELECT@51827393"",""identifier"":""B"",""blockId"":""BLOCK_SELECT@1ddd3478"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":14,""columnNum"":9,""endLineNum"":17,""endColumnNum"":3,""quoted"":false}},""NS_IDENT@2b8bd14b"":{""tableId"":""NS_IDENT@2b8bd14b"",""identifier"":""D"",""dbTableName"":""DAN_LIKES"",""fields"":[""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":14,""endLineNum"":8,""endColumnNum"":24,""quoted"":false}},""NS_IDENT@3c017078"":{""tableId"":""NS_IDENT@3c017078"",""identifier"":""A"",""dbTableName"":""SERVES_DANS_BEER"",""fields"":[""BAR VARCHAR(100)"",""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":13,""columnNum"":6,""endLineNum"":13,""endColumnNum"":23,""quoted"":false}},""NS_IDENT@31ee96f4"":{""tableId"":""NS_IDENT@31ee96f4"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":14,""endLineNum"":3,""endColumnNum"":18,""quoted"":false}},""NS_IDENT@3be4f71"":{""tableId"":""NS_IDENT@3be4f71"",""identifier"":""SERVES_DANS_BEER"",""dbTableName"":""SERVES_DANS_BEER"",""fields"":[""BAR VARCHAR(100)"",""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":15,""columnNum"":14,""endLineNum"":15,""endColumnNum"":29,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@1d207fad"",""alias"":""DAN_LIKES"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@47d7bfb3"",""value"":""NS_IDENT@31ee96f4.BEER"",""pos"":{""lineNum"":2,""columnNum"":16,""endLineNum"":2,""endColumnNum"":19,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@31ee96f4""],""fromNode"":{""id"":""JOIN_OPERAND@bdecc21"",""value"":""NS_IDENT@31ee96f4"",""pos"":{""lineNum"":3,""columnNum"":14,""endLineNum"":3,""endColumnNum"":18,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@30331109"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":15,""endLineNum"":4,""endColumnNum"":29,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@878537d"",""value"":""NS_IDENT@31ee96f4.drinker"",""pos"":{""lineNum"":4,""columnNum"":15,""endLineNum"":4,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@40ee0a22"",""value"":""'Dan'"",""pos"":{""lineNum"":4,""columnNum"":25,""endLineNum"":4,""endColumnNum"":29,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@878537d"",""value"":""NS_IDENT@31ee96f4.drinker"",""pos"":{""lineNum"":4,""columnNum"":15,""endLineNum"":4,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@47d7bfb3"",""value"":""NS_IDENT@31ee96f4.BEER"",""pos"":{""lineNum"":2,""columnNum"":16,""endLineNum"":2,""endColumnNum"":19,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":4,""endColumnNum"":29,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@2fe88a09"",""alias"":""SERVES_DANS_BEER"",""fields"":[""BAR VARCHAR(100)"",""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@5f13be1"",""value"":""NS_IDENT@51dbd6e4.BAR"",""pos"":{""lineNum"":6,""columnNum"":16,""endLineNum"":6,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@50d3bf39"",""value"":""NS_IDENT@51dbd6e4.BEER"",""pos"":{""lineNum"":6,""columnNum"":23,""endLineNum"":6,""endColumnNum"":28,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@29852487"",""value"":""NS_IDENT@51dbd6e4.PRICE"",""pos"":{""lineNum"":6,""columnNum"":31,""endLineNum"":6,""endColumnNum"":37,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@51dbd6e4"",""NS_IDENT@2b8bd14b""],""fromNode"":{""id"":""OP_JOIN@21fff664"",""value"":""INNER"",""pos"":{""lineNum"":8,""columnNum"":9,""endLineNum"":8,""endColumnNum"":12,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@1e6308a9"",""value"":""NS_IDENT@51dbd6e4"",""pos"":{""lineNum"":7,""columnNum"":14,""endLineNum"":7,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@30cecdca"",""value"":""NS_IDENT@2b8bd14b"",""pos"":{""lineNum"":8,""columnNum"":14,""endLineNum"":8,""endColumnNum"":22,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@353efdbf"",""value"":""="",""pos"":{""lineNum"":9,""columnNum"":12,""endLineNum"":9,""endColumnNum"":26,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1965539b"",""value"":""NS_IDENT@51dbd6e4.beer"",""pos"":{""lineNum"":9,""columnNum"":12,""endLineNum"":9,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2fc07784"",""value"":""NS_IDENT@2b8bd14b.BEER"",""pos"":{""lineNum"":9,""columnNum"":21,""endLineNum"":9,""endColumnNum"":26,""quoted"":false},""children"":[]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@29852487"",""value"":""NS_IDENT@51dbd6e4.PRICE"",""pos"":{""lineNum"":6,""columnNum"":31,""endLineNum"":6,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1965539b"",""value"":""NS_IDENT@51dbd6e4.beer"",""pos"":{""lineNum"":9,""columnNum"":12,""endLineNum"":9,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@50d3bf39"",""value"":""NS_IDENT@51dbd6e4.BEER"",""pos"":{""lineNum"":6,""columnNum"":23,""endLineNum"":6,""endColumnNum"":28,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2fc07784"",""value"":""NS_IDENT@2b8bd14b.BEER"",""pos"":{""lineNum"":9,""columnNum"":21,""endLineNum"":9,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5f13be1"",""value"":""NS_IDENT@51dbd6e4.BAR"",""pos"":{""lineNum"":6,""columnNum"":16,""endLineNum"":6,""endColumnNum"":20,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":6,""columnNum"":9,""endLineNum"":9,""endColumnNum"":26,""quoted"":false},""children"":{}}]}
"
"SELECT s.beer, s.bar
FROM Serves s 
WHERE s.beer 
IN (SELECT beer FROM Likes WHERE drinker = 'Dan') AND NOT EXISTS 
(SELECT price 
FROM Serves 
WHERE beer = s.beer 
AND price > s.price)","{""blocks"":{""id"":""BLOCK_SELECT@4a1c0752"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@78faea5f"",""value"":""NS_IDENT@4abf3f0.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5e39850"",""value"":""NS_IDENT@4abf3f0.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@4abf3f0""],""fromNode"":{""id"":""JOIN_OPERAND@18a645fd"",""value"":""NS_IDENT@4abf3f0"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":11,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@1bc425e7"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":8,""endColumnNum"":19,""quoted"":false},""children"":[{""id"":""OP_BINARY@6f8e0cee"",""value"":""IN"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":4,""endColumnNum"":48,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@47f08b81"",""value"":""NS_IDENT@4abf3f0.beer"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@71c905a3"",""value"":""BLOCK_SELECT@71c905a3"",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":4,""endColumnNum"":48,""quoted"":false},""children"":[]}]},{""id"":""OP_PREFIX@5116ac09"",""value"":""NOT"",""pos"":{""lineNum"":4,""columnNum"":55,""endLineNum"":8,""endColumnNum"":19,""quoted"":false},""children"":[{""id"":""OP_PREFIX@614aeccc"",""value"":""EXISTS"",""pos"":{""lineNum"":4,""columnNum"":59,""endLineNum"":8,""endColumnNum"":19,""quoted"":false},""children"":[{""id"":""BLOCK_SELECT@59942b48"",""value"":""BLOCK_SELECT@59942b48"",""pos"":{""lineNum"":5,""columnNum"":2,""endLineNum"":8,""endColumnNum"":19,""quoted"":false},""children"":[]}]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@47f08b81"",""value"":""NS_IDENT@4abf3f0.beer"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@78faea5f"",""value"":""NS_IDENT@4abf3f0.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5e39850"",""value"":""NS_IDENT@4abf3f0.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@4abf3f0.beer"",""NS_IDENT@4abf3f0.price""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":8,""endColumnNum"":20,""quoted"":false},""children"":{""BLOCK_SELECT@71c905a3"":{""id"":""BLOCK_SELECT@71c905a3"",""parentId"":""BLOCK_SELECT@4a1c0752"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@4784013e"",""value"":""NS_IDENT@61799544.BEER"",""pos"":{""lineNum"":4,""columnNum"":12,""endLineNum"":4,""endColumnNum"":15,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@61799544""],""fromNode"":{""id"":""JOIN_OPERAND@46c00568"",""value"":""NS_IDENT@61799544"",""pos"":{""lineNum"":4,""columnNum"":22,""endLineNum"":4,""endColumnNum"":26,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@383790cf"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":34,""endLineNum"":4,""endColumnNum"":48,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@27b71f50"",""value"":""NS_IDENT@61799544.drinker"",""pos"":{""lineNum"":4,""columnNum"":34,""endLineNum"":4,""endColumnNum"":40,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@aa004a0"",""value"":""'Dan'"",""pos"":{""lineNum"":4,""columnNum"":44,""endLineNum"":4,""endColumnNum"":48,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@4784013e"",""value"":""NS_IDENT@61799544.BEER"",""pos"":{""lineNum"":4,""columnNum"":12,""endLineNum"":4,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@27b71f50"",""value"":""NS_IDENT@61799544.drinker"",""pos"":{""lineNum"":4,""columnNum"":34,""endLineNum"":4,""endColumnNum"":40,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":4,""endColumnNum"":48,""quoted"":false},""children"":{}},""BLOCK_SELECT@59942b48"":{""id"":""BLOCK_SELECT@59942b48"",""parentId"":""BLOCK_SELECT@4a1c0752"",""fields"":[""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@4d8126f"",""value"":""NS_IDENT@6a10b263.PRICE"",""pos"":{""lineNum"":5,""columnNum"":9,""endLineNum"":5,""endColumnNum"":13,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@6a10b263""],""fromNode"":{""id"":""JOIN_OPERAND@1869f114"",""value"":""NS_IDENT@6a10b263"",""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":11,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@319854f0"",""value"":""AND"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":8,""endColumnNum"":19,""quoted"":false},""children"":[{""id"":""OP_BINARY@7df60067"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":19,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5b22b970"",""value"":""NS_IDENT@6a10b263.beer"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@22d1886d"",""value"":""NS_IDENT@4abf3f0.beer"",""pos"":{""lineNum"":7,""columnNum"":14,""endLineNum"":7,""endColumnNum"":19,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@7ca0863b"",""value"":"">"",""pos"":{""lineNum"":8,""columnNum"":5,""endLineNum"":8,""endColumnNum"":19,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1cbb3d3b"",""value"":""NS_IDENT@6a10b263.price"",""pos"":{""lineNum"":8,""columnNum"":5,""endLineNum"":8,""endColumnNum"":9,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@529cfee5"",""value"":""NS_IDENT@4abf3f0.price"",""pos"":{""lineNum"":8,""columnNum"":13,""endLineNum"":8,""endColumnNum"":19,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@1cbb3d3b"",""value"":""NS_IDENT@6a10b263.price"",""pos"":{""lineNum"":8,""columnNum"":5,""endLineNum"":8,""endColumnNum"":9,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@22d1886d"",""value"":""NS_IDENT@4abf3f0.beer"",""pos"":{""lineNum"":7,""columnNum"":14,""endLineNum"":7,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@529cfee5"",""value"":""NS_IDENT@4abf3f0.price"",""pos"":{""lineNum"":8,""columnNum"":13,""endLineNum"":8,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5b22b970"",""value"":""NS_IDENT@6a10b263.beer"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4d8126f"",""value"":""NS_IDENT@6a10b263.PRICE"",""pos"":{""lineNum"":5,""columnNum"":9,""endLineNum"":5,""endColumnNum"":13,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@4abf3f0""],""corrCtxIds"":[""BLOCK_SELECT@4a1c0752""],""pos"":{""lineNum"":5,""columnNum"":2,""endLineNum"":8,""endColumnNum"":19,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@4abf3f0"":{""tableId"":""NS_IDENT@4abf3f0"",""identifier"":""S"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":13,""quoted"":false}},""NS_IDENT@61799544"":{""tableId"":""NS_IDENT@61799544"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":22,""endLineNum"":4,""endColumnNum"":26,""quoted"":false}},""NS_IDENT@6a10b263"":{""tableId"":""NS_IDENT@6a10b263"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":11,""quoted"":false}}},""corrTables"":[""NS_IDENT@4abf3f0""]}
"
"select distinct L.beer, S.bar
from likes L, serves S
where L.drinker = 'Dan'
  and L.beer = S.beer
  and S.price = (select max(price)
  from serves
  where beer = L.beer);","{""blocks"":{""id"":""BLOCK_SELECT@847f3e7"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":true,""selectList"":[{""id"":""COLUMN_LOCAL@2e34384c"",""value"":""NS_IDENT@287f7811.BEER"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1f52eb6f"",""value"":""NS_IDENT@17271176.BAR"",""pos"":{""lineNum"":1,""columnNum"":25,""endLineNum"":1,""endColumnNum"":29,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@287f7811"",""NS_IDENT@17271176""],""fromNode"":{""id"":""OP_JOIN@6df7988f"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":13,""endLineNum"":2,""endColumnNum"":13,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@22fba58c"",""value"":""NS_IDENT@287f7811"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@7e8a46b7"",""value"":""NS_IDENT@17271176"",""pos"":{""lineNum"":2,""columnNum"":15,""endLineNum"":2,""endColumnNum"":20,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@27c04377"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":7,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""OP_BINARY@515ebef3"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":4,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""OP_BINARY@47e4d9d0"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@48c3205a"",""value"":""NS_IDENT@287f7811.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@ae372b9"",""value"":""'Dan'"",""pos"":{""lineNum"":3,""columnNum"":19,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@3015db78"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@49798e84"",""value"":""NS_IDENT@287f7811.beer"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6ed06f69"",""value"":""NS_IDENT@17271176.beer"",""pos"":{""lineNum"":4,""columnNum"":16,""endLineNum"":4,""endColumnNum"":21,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@39109136"",""value"":""="",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":7,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@545607f2"",""value"":""NS_IDENT@17271176.price"",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":5,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT_SCALAR@2098d37d"",""value"":""BLOCK_SELECT@4bff2185"",""pos"":{""lineNum"":5,""columnNum"":18,""endLineNum"":7,""endColumnNum"":21,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@49798e84"",""value"":""NS_IDENT@287f7811.beer"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2e34384c"",""value"":""NS_IDENT@287f7811.BEER"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@545607f2"",""value"":""NS_IDENT@17271176.price"",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":5,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6ed06f69"",""value"":""NS_IDENT@17271176.beer"",""pos"":{""lineNum"":4,""columnNum"":16,""endLineNum"":4,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1f52eb6f"",""value"":""NS_IDENT@17271176.BAR"",""pos"":{""lineNum"":1,""columnNum"":25,""endLineNum"":1,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@48c3205a"",""value"":""NS_IDENT@287f7811.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@287f7811.beer""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":7,""endColumnNum"":22,""quoted"":false},""children"":{""BLOCK_SELECT@4bff2185"":{""id"":""BLOCK_SELECT@4bff2185"",""parentId"":""BLOCK_SELECT@847f3e7"",""fields"":[""EXPR$0 DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""OP_AGG_FUNC@749ab7b4"",""value"":""MAX"",""pos"":{""lineNum"":5,""columnNum"":25,""endLineNum"":5,""endColumnNum"":34,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@127f9161"",""value"":""NS_IDENT@2d5f7182.PRICE"",""pos"":{""lineNum"":5,""columnNum"":29,""endLineNum"":5,""endColumnNum"":33,""quoted"":false},""children"":[]}]}],""fromItemIds"":[""NS_IDENT@2d5f7182""],""fromNode"":{""id"":""JOIN_OPERAND@4690f583"",""value"":""NS_IDENT@2d5f7182"",""pos"":{""lineNum"":6,""columnNum"":8,""endLineNum"":6,""endColumnNum"":13,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@766a4535"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":9,""endLineNum"":7,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7cf162bc"",""value"":""NS_IDENT@2d5f7182.beer"",""pos"":{""lineNum"":7,""columnNum"":9,""endLineNum"":7,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@3721177d"",""value"":""NS_IDENT@287f7811.beer"",""pos"":{""lineNum"":7,""columnNum"":16,""endLineNum"":7,""endColumnNum"":21,""quoted"":false},""children"":[]}]},""isAggregate"":true,""identifiers"":[{""id"":""COLUMN_CORRELATE@3721177d"",""value"":""NS_IDENT@287f7811.beer"",""pos"":{""lineNum"":7,""columnNum"":16,""endLineNum"":7,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@127f9161"",""value"":""NS_IDENT@2d5f7182.PRICE"",""pos"":{""lineNum"":5,""columnNum"":29,""endLineNum"":5,""endColumnNum"":33,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7cf162bc"",""value"":""NS_IDENT@2d5f7182.beer"",""pos"":{""lineNum"":7,""columnNum"":9,""endLineNum"":7,""endColumnNum"":12,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@287f7811""],""corrCtxIds"":[""BLOCK_SELECT@847f3e7""],""pos"":{""lineNum"":5,""columnNum"":18,""endLineNum"":7,""endColumnNum"":21,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@287f7811"":{""tableId"":""NS_IDENT@287f7811"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@2d5f7182"":{""tableId"":""NS_IDENT@2d5f7182"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":8,""endLineNum"":6,""endColumnNum"":13,""quoted"":false}},""NS_IDENT@17271176"":{""tableId"":""NS_IDENT@17271176"",""identifier"":""S"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":15,""endLineNum"":2,""endColumnNum"":22,""quoted"":false}}},""corrTables"":[""NS_IDENT@287f7811""]}
"
"select b.beer, b.bar from serves b  
where b.beer in (select beer from likes where drinker = 'Dan')  
and not exists  (select price from serves where price > b.price and beer = b.beer)","{""blocks"":{""id"":""BLOCK_SELECT@40021799"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@57c88764"",""value"":""NS_IDENT@4cdd2c73.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@37fdfb05"",""value"":""NS_IDENT@4cdd2c73.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@4cdd2c73""],""fromNode"":{""id"":""JOIN_OPERAND@488b50ec"",""value"":""NS_IDENT@4cdd2c73"",""pos"":{""lineNum"":1,""columnNum"":27,""endLineNum"":1,""endColumnNum"":32,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@5116ac09"",""value"":""AND"",""pos"":{""lineNum"":2,""columnNum"":7,""endLineNum"":3,""endColumnNum"":81,""quoted"":false},""children"":[{""id"":""OP_BINARY@5b022357"",""value"":""IN"",""pos"":{""lineNum"":2,""columnNum"":7,""endLineNum"":2,""endColumnNum"":61,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4cd1c1dc"",""value"":""NS_IDENT@4cdd2c73.beer"",""pos"":{""lineNum"":2,""columnNum"":7,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@4e868ef5"",""value"":""BLOCK_SELECT@4e868ef5"",""pos"":{""lineNum"":2,""columnNum"":18,""endLineNum"":2,""endColumnNum"":61,""quoted"":false},""children"":[]}]},{""id"":""OP_PREFIX@614aeccc"",""value"":""NOT"",""pos"":{""lineNum"":3,""columnNum"":5,""endLineNum"":3,""endColumnNum"":81,""quoted"":false},""children"":[{""id"":""OP_PREFIX@6f8e0cee"",""value"":""EXISTS"",""pos"":{""lineNum"":3,""columnNum"":9,""endLineNum"":3,""endColumnNum"":81,""quoted"":false},""children"":[{""id"":""BLOCK_SELECT@47b2e9e1"",""value"":""BLOCK_SELECT@47b2e9e1"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":81,""quoted"":false},""children"":[]}]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@37fdfb05"",""value"":""NS_IDENT@4cdd2c73.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@57c88764"",""value"":""NS_IDENT@4cdd2c73.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4cd1c1dc"",""value"":""NS_IDENT@4cdd2c73.beer"",""pos"":{""lineNum"":2,""columnNum"":7,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@4cdd2c73.beer"",""NS_IDENT@4cdd2c73.price""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":3,""endColumnNum"":82,""quoted"":false},""children"":{""BLOCK_SELECT@4e868ef5"":{""id"":""BLOCK_SELECT@4e868ef5"",""parentId"":""BLOCK_SELECT@40021799"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@3a91d146"",""value"":""NS_IDENT@398474a2.BEER"",""pos"":{""lineNum"":2,""columnNum"":25,""endLineNum"":2,""endColumnNum"":28,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@398474a2""],""fromNode"":{""id"":""JOIN_OPERAND@1d4664d7"",""value"":""NS_IDENT@398474a2"",""pos"":{""lineNum"":2,""columnNum"":35,""endLineNum"":2,""endColumnNum"":39,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@27b71f50"",""value"":""="",""pos"":{""lineNum"":2,""columnNum"":47,""endLineNum"":2,""endColumnNum"":61,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@3a4ba480"",""value"":""NS_IDENT@398474a2.drinker"",""pos"":{""lineNum"":2,""columnNum"":47,""endLineNum"":2,""endColumnNum"":53,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@6d4a65c6"",""value"":""'Dan'"",""pos"":{""lineNum"":2,""columnNum"":57,""endLineNum"":2,""endColumnNum"":61,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@3a4ba480"",""value"":""NS_IDENT@398474a2.drinker"",""pos"":{""lineNum"":2,""columnNum"":47,""endLineNum"":2,""endColumnNum"":53,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3a91d146"",""value"":""NS_IDENT@398474a2.BEER"",""pos"":{""lineNum"":2,""columnNum"":25,""endLineNum"":2,""endColumnNum"":28,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":18,""endLineNum"":2,""endColumnNum"":61,""quoted"":false},""children"":{}},""BLOCK_SELECT@47b2e9e1"":{""id"":""BLOCK_SELECT@47b2e9e1"",""parentId"":""BLOCK_SELECT@40021799"",""fields"":[""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@dffa30b"",""value"":""NS_IDENT@70abf9b0.PRICE"",""pos"":{""lineNum"":3,""columnNum"":25,""endLineNum"":3,""endColumnNum"":29,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@70abf9b0""],""fromNode"":{""id"":""JOIN_OPERAND@59942b48"",""value"":""NS_IDENT@70abf9b0"",""pos"":{""lineNum"":3,""columnNum"":36,""endLineNum"":3,""endColumnNum"":41,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@7ca0863b"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":49,""endLineNum"":3,""endColumnNum"":81,""quoted"":false},""children"":[{""id"":""OP_BINARY@22d1886d"",""value"":"">"",""pos"":{""lineNum"":3,""columnNum"":49,""endLineNum"":3,""endColumnNum"":63,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1a5f7e7c"",""value"":""NS_IDENT@70abf9b0.price"",""pos"":{""lineNum"":3,""columnNum"":49,""endLineNum"":3,""endColumnNum"":53,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@5b22b970"",""value"":""NS_IDENT@4cdd2c73.price"",""pos"":{""lineNum"":3,""columnNum"":57,""endLineNum"":3,""endColumnNum"":63,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@529cfee5"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":69,""endLineNum"":3,""endColumnNum"":81,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7df60067"",""value"":""NS_IDENT@70abf9b0.beer"",""pos"":{""lineNum"":3,""columnNum"":69,""endLineNum"":3,""endColumnNum"":72,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@1cbb3d3b"",""value"":""NS_IDENT@4cdd2c73.beer"",""pos"":{""lineNum"":3,""columnNum"":76,""endLineNum"":3,""endColumnNum"":81,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_CORRELATE@1cbb3d3b"",""value"":""NS_IDENT@4cdd2c73.beer"",""pos"":{""lineNum"":3,""columnNum"":76,""endLineNum"":3,""endColumnNum"":81,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@dffa30b"",""value"":""NS_IDENT@70abf9b0.PRICE"",""pos"":{""lineNum"":3,""columnNum"":25,""endLineNum"":3,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7df60067"",""value"":""NS_IDENT@70abf9b0.beer"",""pos"":{""lineNum"":3,""columnNum"":69,""endLineNum"":3,""endColumnNum"":72,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@5b22b970"",""value"":""NS_IDENT@4cdd2c73.price"",""pos"":{""lineNum"":3,""columnNum"":57,""endLineNum"":3,""endColumnNum"":63,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1a5f7e7c"",""value"":""NS_IDENT@70abf9b0.price"",""pos"":{""lineNum"":3,""columnNum"":49,""endLineNum"":3,""endColumnNum"":53,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@4cdd2c73""],""corrCtxIds"":[""BLOCK_SELECT@40021799""],""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":81,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@398474a2"":{""tableId"":""NS_IDENT@398474a2"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":35,""endLineNum"":2,""endColumnNum"":39,""quoted"":false}},""NS_IDENT@70abf9b0"":{""tableId"":""NS_IDENT@70abf9b0"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":36,""endLineNum"":3,""endColumnNum"":41,""quoted"":false}},""NS_IDENT@4cdd2c73"":{""tableId"":""NS_IDENT@4cdd2c73"",""identifier"":""B"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":27,""endLineNum"":1,""endColumnNum"":34,""quoted"":false}}},""corrTables"":[""NS_IDENT@4cdd2c73""]}
"
"select s.beer, s.bar 
from serves s 
where s.beer in (select beer from likes where drinker = 'Dan') 
and not exists (select price from serves where beer = s.beer and price > s.price)","{""blocks"":{""id"":""BLOCK_SELECT@4a1c0752"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@78faea5f"",""value"":""NS_IDENT@4abf3f0.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5e39850"",""value"":""NS_IDENT@4abf3f0.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@4abf3f0""],""fromNode"":{""id"":""JOIN_OPERAND@18a645fd"",""value"":""NS_IDENT@4abf3f0"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":11,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@1bc425e7"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":4,""endColumnNum"":80,""quoted"":false},""children"":[{""id"":""OP_BINARY@6f8e0cee"",""value"":""IN"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":61,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@47f08b81"",""value"":""NS_IDENT@4abf3f0.beer"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@71c905a3"",""value"":""BLOCK_SELECT@71c905a3"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":61,""quoted"":false},""children"":[]}]},{""id"":""OP_PREFIX@5116ac09"",""value"":""NOT"",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":4,""endColumnNum"":80,""quoted"":false},""children"":[{""id"":""OP_PREFIX@614aeccc"",""value"":""EXISTS"",""pos"":{""lineNum"":4,""columnNum"":9,""endLineNum"":4,""endColumnNum"":80,""quoted"":false},""children"":[{""id"":""BLOCK_SELECT@59942b48"",""value"":""BLOCK_SELECT@59942b48"",""pos"":{""lineNum"":4,""columnNum"":17,""endLineNum"":4,""endColumnNum"":80,""quoted"":false},""children"":[]}]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@47f08b81"",""value"":""NS_IDENT@4abf3f0.beer"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@78faea5f"",""value"":""NS_IDENT@4abf3f0.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5e39850"",""value"":""NS_IDENT@4abf3f0.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@4abf3f0.beer"",""NS_IDENT@4abf3f0.price""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":4,""endColumnNum"":81,""quoted"":false},""children"":{""BLOCK_SELECT@71c905a3"":{""id"":""BLOCK_SELECT@71c905a3"",""parentId"":""BLOCK_SELECT@4a1c0752"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@4784013e"",""value"":""NS_IDENT@61799544.BEER"",""pos"":{""lineNum"":3,""columnNum"":25,""endLineNum"":3,""endColumnNum"":28,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@61799544""],""fromNode"":{""id"":""JOIN_OPERAND@46c00568"",""value"":""NS_IDENT@61799544"",""pos"":{""lineNum"":3,""columnNum"":35,""endLineNum"":3,""endColumnNum"":39,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@383790cf"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":47,""endLineNum"":3,""endColumnNum"":61,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@27b71f50"",""value"":""NS_IDENT@61799544.drinker"",""pos"":{""lineNum"":3,""columnNum"":47,""endLineNum"":3,""endColumnNum"":53,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@aa004a0"",""value"":""'Dan'"",""pos"":{""lineNum"":3,""columnNum"":57,""endLineNum"":3,""endColumnNum"":61,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@4784013e"",""value"":""NS_IDENT@61799544.BEER"",""pos"":{""lineNum"":3,""columnNum"":25,""endLineNum"":3,""endColumnNum"":28,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@27b71f50"",""value"":""NS_IDENT@61799544.drinker"",""pos"":{""lineNum"":3,""columnNum"":47,""endLineNum"":3,""endColumnNum"":53,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":61,""quoted"":false},""children"":{}},""BLOCK_SELECT@59942b48"":{""id"":""BLOCK_SELECT@59942b48"",""parentId"":""BLOCK_SELECT@4a1c0752"",""fields"":[""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@4d8126f"",""value"":""NS_IDENT@6a10b263.PRICE"",""pos"":{""lineNum"":4,""columnNum"":24,""endLineNum"":4,""endColumnNum"":28,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@6a10b263""],""fromNode"":{""id"":""JOIN_OPERAND@1869f114"",""value"":""NS_IDENT@6a10b263"",""pos"":{""lineNum"":4,""columnNum"":35,""endLineNum"":4,""endColumnNum"":40,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@319854f0"",""value"":""AND"",""pos"":{""lineNum"":4,""columnNum"":48,""endLineNum"":4,""endColumnNum"":80,""quoted"":false},""children"":[{""id"":""OP_BINARY@7df60067"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":48,""endLineNum"":4,""endColumnNum"":60,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5b22b970"",""value"":""NS_IDENT@6a10b263.beer"",""pos"":{""lineNum"":4,""columnNum"":48,""endLineNum"":4,""endColumnNum"":51,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@22d1886d"",""value"":""NS_IDENT@4abf3f0.beer"",""pos"":{""lineNum"":4,""columnNum"":55,""endLineNum"":4,""endColumnNum"":60,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@7ca0863b"",""value"":"">"",""pos"":{""lineNum"":4,""columnNum"":66,""endLineNum"":4,""endColumnNum"":80,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1cbb3d3b"",""value"":""NS_IDENT@6a10b263.price"",""pos"":{""lineNum"":4,""columnNum"":66,""endLineNum"":4,""endColumnNum"":70,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@529cfee5"",""value"":""NS_IDENT@4abf3f0.price"",""pos"":{""lineNum"":4,""columnNum"":74,""endLineNum"":4,""endColumnNum"":80,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@1cbb3d3b"",""value"":""NS_IDENT@6a10b263.price"",""pos"":{""lineNum"":4,""columnNum"":66,""endLineNum"":4,""endColumnNum"":70,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@22d1886d"",""value"":""NS_IDENT@4abf3f0.beer"",""pos"":{""lineNum"":4,""columnNum"":55,""endLineNum"":4,""endColumnNum"":60,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@529cfee5"",""value"":""NS_IDENT@4abf3f0.price"",""pos"":{""lineNum"":4,""columnNum"":74,""endLineNum"":4,""endColumnNum"":80,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5b22b970"",""value"":""NS_IDENT@6a10b263.beer"",""pos"":{""lineNum"":4,""columnNum"":48,""endLineNum"":4,""endColumnNum"":51,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4d8126f"",""value"":""NS_IDENT@6a10b263.PRICE"",""pos"":{""lineNum"":4,""columnNum"":24,""endLineNum"":4,""endColumnNum"":28,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@4abf3f0""],""corrCtxIds"":[""BLOCK_SELECT@4a1c0752""],""pos"":{""lineNum"":4,""columnNum"":17,""endLineNum"":4,""endColumnNum"":80,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@4abf3f0"":{""tableId"":""NS_IDENT@4abf3f0"",""identifier"":""S"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":13,""quoted"":false}},""NS_IDENT@61799544"":{""tableId"":""NS_IDENT@61799544"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":35,""endLineNum"":3,""endColumnNum"":39,""quoted"":false}},""NS_IDENT@6a10b263"":{""tableId"":""NS_IDENT@6a10b263"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":35,""endLineNum"":4,""endColumnNum"":40,""quoted"":false}}},""corrTables"":[""NS_IDENT@4abf3f0""]}
"
"SELECT mostExpensive.beer, bar
FROM (SELECT beer, max(price) AS price
FROM (SELECT serves.beer, price
FROM serves, likes
WHERE serves.beer = likes.beer and drinker='Dan') AS danLikes
GROUP BY beer) AS mostExpensive, serves
WHERE mostExpensive.beer = serves.beer and mostExpensive.price = serves.price;","{""blocks"":{""id"":""BLOCK_SELECT@61d01788"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@79ab34c1"",""value"":""NS_SELECT@40d10481.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@52a70627"",""value"":""NS_IDENT@1dcca8d3.BAR"",""pos"":{""lineNum"":1,""columnNum"":28,""endLineNum"":1,""endColumnNum"":30,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_SELECT@40d10481"",""NS_IDENT@1dcca8d3""],""fromNode"":{""id"":""OP_JOIN@4bff2185"",""value"":""COMMA"",""pos"":{""lineNum"":6,""columnNum"":32,""endLineNum"":6,""endColumnNum"":32,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@7fedfe27"",""value"":""BLOCK_SELECT@7fedfe27"",""pos"":{""lineNum"":2,""columnNum"":7,""endLineNum"":6,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@6079cf5"",""value"":""NS_IDENT@1dcca8d3"",""pos"":{""lineNum"":6,""columnNum"":34,""endLineNum"":6,""endColumnNum"":39,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@73ba6fe6"",""value"":""AND"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":77,""quoted"":false},""children"":[{""id"":""OP_BINARY@22d9c961"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":38,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@64138b0c"",""value"":""NS_SELECT@40d10481.BEER"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@49dbaaf3"",""value"":""NS_IDENT@1dcca8d3.beer"",""pos"":{""lineNum"":7,""columnNum"":28,""endLineNum"":7,""endColumnNum"":38,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@1f443fae"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":44,""endLineNum"":7,""endColumnNum"":77,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@736f3e9e"",""value"":""NS_SELECT@40d10481.PRICE"",""pos"":{""lineNum"":7,""columnNum"":44,""endLineNum"":7,""endColumnNum"":62,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@bdc8014"",""value"":""NS_IDENT@1dcca8d3.price"",""pos"":{""lineNum"":7,""columnNum"":66,""endLineNum"":7,""endColumnNum"":77,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@bdc8014"",""value"":""NS_IDENT@1dcca8d3.price"",""pos"":{""lineNum"":7,""columnNum"":66,""endLineNum"":7,""endColumnNum"":77,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@79ab34c1"",""value"":""NS_SELECT@40d10481.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@736f3e9e"",""value"":""NS_SELECT@40d10481.PRICE"",""pos"":{""lineNum"":7,""columnNum"":44,""endLineNum"":7,""endColumnNum"":62,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@64138b0c"",""value"":""NS_SELECT@40d10481.BEER"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@52a70627"",""value"":""NS_IDENT@1dcca8d3.BAR"",""pos"":{""lineNum"":1,""columnNum"":28,""endLineNum"":1,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@49dbaaf3"",""value"":""NS_IDENT@1dcca8d3.beer"",""pos"":{""lineNum"":7,""columnNum"":28,""endLineNum"":7,""endColumnNum"":38,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":7,""endColumnNum"":77,""quoted"":false},""children"":{""BLOCK_SELECT@7fedfe27"":{""id"":""BLOCK_SELECT@7fedfe27"",""parentId"":""BLOCK_SELECT@61d01788"",""alias"":""MOSTEXPENSIVE"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@706cb08"",""value"":""NS_SELECT@60dd3c23.BEER"",""pos"":{""lineNum"":2,""columnNum"":14,""endLineNum"":2,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@6b68cb27"",""value"":""MAX"",""pos"":{""lineNum"":2,""columnNum"":20,""endLineNum"":2,""endColumnNum"":29,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@675ffd1d"",""value"":""NS_SELECT@60dd3c23.PRICE"",""pos"":{""lineNum"":2,""columnNum"":24,""endLineNum"":2,""endColumnNum"":28,""quoted"":false},""children"":[]}],""alias"":""PRICE""}],""fromItemIds"":[""NS_SELECT@60dd3c23""],""fromNode"":{""id"":""JOIN_OPERAND@56ccd751"",""value"":""BLOCK_SELECT@56ccd751"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":5,""endColumnNum"":48,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@22d1886d"",""value"":""NS_SELECT@60dd3c23.BEER"",""pos"":{""lineNum"":6,""columnNum"":10,""endLineNum"":6,""endColumnNum"":13,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@675ffd1d"",""value"":""NS_SELECT@60dd3c23.PRICE"",""pos"":{""lineNum"":2,""columnNum"":24,""endLineNum"":2,""endColumnNum"":28,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@22d1886d"",""value"":""NS_SELECT@60dd3c23.BEER"",""pos"":{""lineNum"":6,""columnNum"":10,""endLineNum"":6,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@706cb08"",""value"":""NS_SELECT@60dd3c23.BEER"",""pos"":{""lineNum"":2,""columnNum"":14,""endLineNum"":2,""endColumnNum"":17,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":7,""endLineNum"":6,""endColumnNum"":13,""quoted"":false},""children"":{""BLOCK_SELECT@56ccd751"":{""id"":""BLOCK_SELECT@56ccd751"",""parentId"":""BLOCK_SELECT@7fedfe27"",""alias"":""DANLIKES"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@5bcde458"",""value"":""NS_IDENT@52b6319f.BEER"",""pos"":{""lineNum"":3,""columnNum"":14,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@77bd7fe7"",""value"":""NS_IDENT@52b6319f.PRICE"",""pos"":{""lineNum"":3,""columnNum"":27,""endLineNum"":3,""endColumnNum"":31,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@52b6319f"",""NS_IDENT@7c455e96""],""fromNode"":{""id"":""OP_JOIN@458544e0"",""value"":""COMMA"",""pos"":{""lineNum"":4,""columnNum"":12,""endLineNum"":4,""endColumnNum"":12,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@6090f3ca"",""value"":""NS_IDENT@52b6319f"",""pos"":{""lineNum"":4,""columnNum"":6,""endLineNum"":4,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@6872f9c8"",""value"":""NS_IDENT@7c455e96"",""pos"":{""lineNum"":4,""columnNum"":14,""endLineNum"":4,""endColumnNum"":18,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@76075d65"",""value"":""AND"",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":5,""endColumnNum"":48,""quoted"":false},""children"":[{""id"":""OP_BINARY@1bbae752"",""value"":""="",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":5,""endColumnNum"":30,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@dffa30b"",""value"":""NS_IDENT@52b6319f.beer"",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":5,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7b2a3ff8"",""value"":""NS_IDENT@7c455e96.beer"",""pos"":{""lineNum"":5,""columnNum"":21,""endLineNum"":5,""endColumnNum"":30,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@5cf87cfd"",""value"":""="",""pos"":{""lineNum"":5,""columnNum"":36,""endLineNum"":5,""endColumnNum"":48,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@460b6d54"",""value"":""NS_IDENT@7c455e96.drinker"",""pos"":{""lineNum"":5,""columnNum"":36,""endLineNum"":5,""endColumnNum"":42,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@878537d"",""value"":""'Dan'"",""pos"":{""lineNum"":5,""columnNum"":44,""endLineNum"":5,""endColumnNum"":48,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@7b2a3ff8"",""value"":""NS_IDENT@7c455e96.beer"",""pos"":{""lineNum"":5,""columnNum"":21,""endLineNum"":5,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@77bd7fe7"",""value"":""NS_IDENT@52b6319f.PRICE"",""pos"":{""lineNum"":3,""columnNum"":27,""endLineNum"":3,""endColumnNum"":31,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5bcde458"",""value"":""NS_IDENT@52b6319f.BEER"",""pos"":{""lineNum"":3,""columnNum"":14,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@dffa30b"",""value"":""NS_IDENT@52b6319f.beer"",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":5,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@460b6d54"",""value"":""NS_IDENT@7c455e96.drinker"",""pos"":{""lineNum"":5,""columnNum"":36,""endLineNum"":5,""endColumnNum"":42,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":5,""endColumnNum"":48,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@7c455e96"":{""tableId"":""NS_IDENT@7c455e96"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":14,""endLineNum"":4,""endColumnNum"":18,""quoted"":false}},""NS_IDENT@1dcca8d3"":{""tableId"":""NS_IDENT@1dcca8d3"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":34,""endLineNum"":6,""endColumnNum"":39,""quoted"":false}},""NS_SELECT@60dd3c23"":{""tableId"":""NS_SELECT@60dd3c23"",""identifier"":""DANLIKES"",""blockId"":""BLOCK_SELECT@56ccd751"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":5,""endColumnNum"":61,""quoted"":false}},""NS_IDENT@52b6319f"":{""tableId"":""NS_IDENT@52b6319f"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":6,""endLineNum"":4,""endColumnNum"":11,""quoted"":false}},""NS_SELECT@40d10481"":{""tableId"":""NS_SELECT@40d10481"",""identifier"":""MOSTEXPENSIVE"",""blockId"":""BLOCK_SELECT@7fedfe27"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":7,""endLineNum"":6,""endColumnNum"":31,""quoted"":false}}},""corrTables"":[]}
"
"SELECT L.beer, S.bar
FROM (SELECT beer FROM likes WHERE drinker='Dan') AS L, ((SELECT S1.bar, S1.beer FROM serves AS S1, serves AS S2) EXCEPT (SELECT S1.bar, S1.beer FROM serves AS S1, serves AS S2 WHERE S1.beer=S2.beer AND S1.price<S2.price)) AS S
WHERE S.beer = L.beer;","{""failed"":true}
"
"WITH beermax AS (
    SELECT beer, Max(price) as price
    FROM serves
    WHERE serves.beer in (SELECT beer FROM likes WHERE drinker = 'Dan')
    Group by beer
)
select serves.beer,bar
from serves,beermax
where serves.beer = beermax.beer and serves.price = beermax.price
","{""blocks"":{""id"":""BLOCK_SELECT@f973499"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@3be4f71"",""value"":""NS_IDENT@3c017078.BEER"",""pos"":{""lineNum"":7,""columnNum"":8,""endLineNum"":7,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6bd16207"",""value"":""NS_IDENT@3c017078.BAR"",""pos"":{""lineNum"":7,""columnNum"":20,""endLineNum"":7,""endColumnNum"":22,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@3c017078"",""NS_IDENT@51827393""],""fromNode"":{""id"":""OP_JOIN@1c025cb"",""value"":""COMMA"",""pos"":{""lineNum"":8,""columnNum"":12,""endLineNum"":8,""endColumnNum"":12,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@50825a02"",""value"":""NS_IDENT@3c017078"",""pos"":{""lineNum"":8,""columnNum"":6,""endLineNum"":8,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@68809cc7"",""value"":""NS_IDENT@51827393"",""pos"":{""lineNum"":8,""columnNum"":13,""endLineNum"":8,""endColumnNum"":19,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@77bd7fe7"",""value"":""AND"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":65,""quoted"":false},""children"":[{""id"":""OP_BINARY@7c455e96"",""value"":""="",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":32,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@16a9a4f1"",""value"":""NS_IDENT@3c017078.beer"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1f1cae23"",""value"":""NS_IDENT@51827393.BEER"",""pos"":{""lineNum"":9,""columnNum"":21,""endLineNum"":9,""endColumnNum"":32,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@215a34b4"",""value"":""="",""pos"":{""lineNum"":9,""columnNum"":38,""endLineNum"":9,""endColumnNum"":65,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@985696"",""value"":""NS_IDENT@3c017078.price"",""pos"":{""lineNum"":9,""columnNum"":38,""endLineNum"":9,""endColumnNum"":49,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5bcde458"",""value"":""NS_IDENT@51827393.PRICE"",""pos"":{""lineNum"":9,""columnNum"":53,""endLineNum"":9,""endColumnNum"":65,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@3be4f71"",""value"":""NS_IDENT@3c017078.BEER"",""pos"":{""lineNum"":7,""columnNum"":8,""endLineNum"":7,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6bd16207"",""value"":""NS_IDENT@3c017078.BAR"",""pos"":{""lineNum"":7,""columnNum"":20,""endLineNum"":7,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@16a9a4f1"",""value"":""NS_IDENT@3c017078.beer"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5bcde458"",""value"":""NS_IDENT@51827393.PRICE"",""pos"":{""lineNum"":9,""columnNum"":53,""endLineNum"":9,""endColumnNum"":65,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1f1cae23"",""value"":""NS_IDENT@51827393.BEER"",""pos"":{""lineNum"":9,""columnNum"":21,""endLineNum"":9,""endColumnNum"":32,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@985696"",""value"":""NS_IDENT@3c017078.price"",""pos"":{""lineNum"":9,""columnNum"":38,""endLineNum"":9,""endColumnNum"":49,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":7,""columnNum"":1,""endLineNum"":9,""endColumnNum"":65,""quoted"":false},""children"":{}},""tables"":{""NS_IDENT@771db12c"":{""tableId"":""NS_IDENT@771db12c"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":44,""endLineNum"":4,""endColumnNum"":48,""quoted"":false}},""NS_IDENT@51827393"":{""tableId"":""NS_IDENT@51827393"",""identifier"":""BEERMAX"",""dbTableName"":""BEERMAX"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":13,""endLineNum"":8,""endColumnNum"":19,""quoted"":false}},""NS_IDENT@3c017078"":{""tableId"":""NS_IDENT@3c017078"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":6,""endLineNum"":8,""endColumnNum"":11,""quoted"":false}},""NS_IDENT@51e0301d"":{""tableId"":""NS_IDENT@51e0301d"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":10,""endLineNum"":3,""endColumnNum"":15,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@1d207fad"",""alias"":""BEERMAX"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@2b8bd14b"",""value"":""NS_IDENT@51e0301d.BEER"",""pos"":{""lineNum"":2,""columnNum"":12,""endLineNum"":2,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@5f303ecd"",""value"":""MAX"",""pos"":{""lineNum"":2,""columnNum"":18,""endLineNum"":2,""endColumnNum"":27,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@50d3bf39"",""value"":""NS_IDENT@51e0301d.PRICE"",""pos"":{""lineNum"":2,""columnNum"":22,""endLineNum"":2,""endColumnNum"":26,""quoted"":false},""children"":[]}],""alias"":""PRICE""}],""fromItemIds"":[""NS_IDENT@51e0301d""],""fromNode"":{""id"":""JOIN_OPERAND@27b22f74"",""value"":""NS_IDENT@51e0301d"",""pos"":{""lineNum"":3,""columnNum"":10,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@4d0b0fd4"",""value"":""IN"",""pos"":{""lineNum"":4,""columnNum"":11,""endLineNum"":4,""endColumnNum"":70,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@383790cf"",""value"":""NS_IDENT@51e0301d.beer"",""pos"":{""lineNum"":4,""columnNum"":11,""endLineNum"":4,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@47b2e9e1"",""value"":""BLOCK_SELECT@47b2e9e1"",""pos"":{""lineNum"":4,""columnNum"":27,""endLineNum"":4,""endColumnNum"":70,""quoted"":false},""children"":[]}]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@68ba310d"",""value"":""NS_IDENT@51e0301d.beer"",""pos"":{""lineNum"":5,""columnNum"":14,""endLineNum"":5,""endColumnNum"":17,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@2b8bd14b"",""value"":""NS_IDENT@51e0301d.BEER"",""pos"":{""lineNum"":2,""columnNum"":12,""endLineNum"":2,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@383790cf"",""value"":""NS_IDENT@51e0301d.beer"",""pos"":{""lineNum"":4,""columnNum"":11,""endLineNum"":4,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@50d3bf39"",""value"":""NS_IDENT@51e0301d.PRICE"",""pos"":{""lineNum"":2,""columnNum"":22,""endLineNum"":2,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@68ba310d"",""value"":""NS_IDENT@51e0301d.beer"",""pos"":{""lineNum"":5,""columnNum"":14,""endLineNum"":5,""endColumnNum"":17,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":5,""endLineNum"":5,""endColumnNum"":17,""quoted"":false},""children"":{""BLOCK_SELECT@47b2e9e1"":{""id"":""BLOCK_SELECT@47b2e9e1"",""parentId"":""BLOCK_SELECT@1d207fad"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@4a9486c0"",""value"":""NS_IDENT@771db12c.BEER"",""pos"":{""lineNum"":4,""columnNum"":34,""endLineNum"":4,""endColumnNum"":37,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@771db12c""],""fromNode"":{""id"":""JOIN_OPERAND@5e3a39cd"",""value"":""NS_IDENT@771db12c"",""pos"":{""lineNum"":4,""columnNum"":44,""endLineNum"":4,""endColumnNum"":48,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@58cec85b"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":56,""endLineNum"":4,""endColumnNum"":70,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5cf8edcf"",""value"":""NS_IDENT@771db12c.drinker"",""pos"":{""lineNum"":4,""columnNum"":56,""endLineNum"":4,""endColumnNum"":62,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@15923407"",""value"":""'Dan'"",""pos"":{""lineNum"":4,""columnNum"":66,""endLineNum"":4,""endColumnNum"":70,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@5cf8edcf"",""value"":""NS_IDENT@771db12c.drinker"",""pos"":{""lineNum"":4,""columnNum"":56,""endLineNum"":4,""endColumnNum"":62,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4a9486c0"",""value"":""NS_IDENT@771db12c.BEER"",""pos"":{""lineNum"":4,""columnNum"":34,""endLineNum"":4,""endColumnNum"":37,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":4,""columnNum"":27,""endLineNum"":4,""endColumnNum"":70,""quoted"":false},""children"":{}}}}]}
"
"SELECT distinct S.beer, S.bar
FROM likes L, serves S 
WHERE L.drinker = 'Dan' and L.beer = S.beer and NOT EXISTS (SELECT * FROM serves 
WHERE L.drinker = 'Dan' and L.beer = S.beer and L.beer = beer and price > S.price)","{""blocks"":{""id"":""BLOCK_SELECT@264c5d07"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":true,""selectList"":[{""id"":""COLUMN_LOCAL@2d2acd89"",""value"":""NS_IDENT@59546cfe.BEER"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1e6dad8"",""value"":""NS_IDENT@59546cfe.BAR"",""pos"":{""lineNum"":1,""columnNum"":25,""endLineNum"":1,""endColumnNum"":29,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@67c277a0"",""NS_IDENT@59546cfe""],""fromNode"":{""id"":""OP_JOIN@6d2d99fc"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":13,""endLineNum"":2,""endColumnNum"":13,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@5e3a39cd"",""value"":""NS_IDENT@67c277a0"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@21f9277b"",""value"":""NS_IDENT@59546cfe"",""pos"":{""lineNum"":2,""columnNum"":15,""endLineNum"":2,""endColumnNum"":20,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@2d746ce4"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":4,""endColumnNum"":81,""quoted"":false},""children"":[{""id"":""OP_BINARY@121c54fa"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":43,""quoted"":false},""children"":[{""id"":""OP_BINARY@61c76850"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@257cc1fc"",""value"":""NS_IDENT@67c277a0.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@515ebef3"",""value"":""'Dan'"",""pos"":{""lineNum"":3,""columnNum"":19,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@48c3205a"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":29,""endLineNum"":3,""endColumnNum"":43,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@70242f38"",""value"":""NS_IDENT@67c277a0.beer"",""pos"":{""lineNum"":3,""columnNum"":29,""endLineNum"":3,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2a22ad2b"",""value"":""NS_IDENT@59546cfe.beer"",""pos"":{""lineNum"":3,""columnNum"":38,""endLineNum"":3,""endColumnNum"":43,""quoted"":false},""children"":[]}]}]},{""id"":""OP_PREFIX@7c6442c2"",""value"":""NOT"",""pos"":{""lineNum"":3,""columnNum"":49,""endLineNum"":4,""endColumnNum"":81,""quoted"":false},""children"":[{""id"":""OP_PREFIX@4390f46e"",""value"":""EXISTS"",""pos"":{""lineNum"":3,""columnNum"":53,""endLineNum"":4,""endColumnNum"":81,""quoted"":false},""children"":[{""id"":""BLOCK_SELECT@afb5821"",""value"":""BLOCK_SELECT@afb5821"",""pos"":{""lineNum"":3,""columnNum"":61,""endLineNum"":4,""endColumnNum"":81,""quoted"":false},""children"":[]}]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@2d2acd89"",""value"":""NS_IDENT@59546cfe.BEER"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@257cc1fc"",""value"":""NS_IDENT@67c277a0.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@70242f38"",""value"":""NS_IDENT@67c277a0.beer"",""pos"":{""lineNum"":3,""columnNum"":29,""endLineNum"":3,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1e6dad8"",""value"":""NS_IDENT@59546cfe.BAR"",""pos"":{""lineNum"":1,""columnNum"":25,""endLineNum"":1,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2a22ad2b"",""value"":""NS_IDENT@59546cfe.beer"",""pos"":{""lineNum"":3,""columnNum"":38,""endLineNum"":3,""endColumnNum"":43,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@59546cfe.beer"",""NS_IDENT@67c277a0.drinker"",""NS_IDENT@59546cfe.price"",""NS_IDENT@67c277a0.beer""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":4,""endColumnNum"":82,""quoted"":false},""children"":{""BLOCK_SELECT@afb5821"":{""id"":""BLOCK_SELECT@afb5821"",""parentId"":""BLOCK_SELECT@264c5d07"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@27c04377"",""value"":""*"",""pos"":{""lineNum"":3,""columnNum"":68,""endLineNum"":3,""endColumnNum"":68,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@540dbda9""],""fromNode"":{""id"":""JOIN_OPERAND@72ed9aad"",""value"":""NS_IDENT@540dbda9"",""pos"":{""lineNum"":3,""columnNum"":75,""endLineNum"":3,""endColumnNum"":80,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@518cf84a"",""value"":""AND"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":81,""quoted"":false},""children"":[{""id"":""OP_BINARY@1f38957"",""value"":""AND"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":61,""quoted"":false},""children"":[{""id"":""OP_BINARY@630d1b2f"",""value"":""AND"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":43,""quoted"":false},""children"":[{""id"":""OP_BINARY@14e2e1c3"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@63718b93"",""value"":""NS_IDENT@67c277a0.drinker"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@ae372b9"",""value"":""'Dan'"",""pos"":{""lineNum"":4,""columnNum"":19,""endLineNum"":4,""endColumnNum"":23,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@60e21209"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":29,""endLineNum"":4,""endColumnNum"":43,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@2b4786dd"",""value"":""NS_IDENT@67c277a0.beer"",""pos"":{""lineNum"":4,""columnNum"":29,""endLineNum"":4,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@f202d6d"",""value"":""NS_IDENT@59546cfe.beer"",""pos"":{""lineNum"":4,""columnNum"":38,""endLineNum"":4,""endColumnNum"":43,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@aac3f4e"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":49,""endLineNum"":4,""endColumnNum"":61,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@746b18fd"",""value"":""NS_IDENT@67c277a0.beer"",""pos"":{""lineNum"":4,""columnNum"":49,""endLineNum"":4,""endColumnNum"":54,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7a2e0858"",""value"":""NS_IDENT@540dbda9.beer"",""pos"":{""lineNum"":4,""columnNum"":58,""endLineNum"":4,""endColumnNum"":61,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@4c2869a9"",""value"":"">"",""pos"":{""lineNum"":4,""columnNum"":67,""endLineNum"":4,""endColumnNum"":81,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@2df3c564"",""value"":""NS_IDENT@540dbda9.price"",""pos"":{""lineNum"":4,""columnNum"":67,""endLineNum"":4,""endColumnNum"":71,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@2715644a"",""value"":""NS_IDENT@59546cfe.price"",""pos"":{""lineNum"":4,""columnNum"":75,""endLineNum"":4,""endColumnNum"":81,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@7a2e0858"",""value"":""NS_IDENT@540dbda9.beer"",""pos"":{""lineNum"":4,""columnNum"":58,""endLineNum"":4,""endColumnNum"":61,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2df3c564"",""value"":""NS_IDENT@540dbda9.price"",""pos"":{""lineNum"":4,""columnNum"":67,""endLineNum"":4,""endColumnNum"":71,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@746b18fd"",""value"":""NS_IDENT@67c277a0.beer"",""pos"":{""lineNum"":4,""columnNum"":49,""endLineNum"":4,""endColumnNum"":54,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@2715644a"",""value"":""NS_IDENT@59546cfe.price"",""pos"":{""lineNum"":4,""columnNum"":75,""endLineNum"":4,""endColumnNum"":81,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@63718b93"",""value"":""NS_IDENT@67c277a0.drinker"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@2b4786dd"",""value"":""NS_IDENT@67c277a0.beer"",""pos"":{""lineNum"":4,""columnNum"":29,""endLineNum"":4,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@f202d6d"",""value"":""NS_IDENT@59546cfe.beer"",""pos"":{""lineNum"":4,""columnNum"":38,""endLineNum"":4,""endColumnNum"":43,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@59546cfe"",""NS_IDENT@67c277a0""],""corrCtxIds"":[""BLOCK_SELECT@264c5d07""],""pos"":{""lineNum"":3,""columnNum"":61,""endLineNum"":4,""endColumnNum"":81,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@67c277a0"":{""tableId"":""NS_IDENT@67c277a0"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@540dbda9"":{""tableId"":""NS_IDENT@540dbda9"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":75,""endLineNum"":3,""endColumnNum"":80,""quoted"":false}},""NS_IDENT@59546cfe"":{""tableId"":""NS_IDENT@59546cfe"",""identifier"":""S"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":15,""endLineNum"":2,""endColumnNum"":22,""quoted"":false}}},""corrTables"":[""NS_IDENT@67c277a0"",""NS_IDENT@59546cfe""]}
"
"with DanLikes as
  (
    select beer
    from likes
    where drinker = 'Dan'
  )
select s.bar, s.beer
from serves s, DanLikes D
where s.beer = D.beer and s.price >= all(select price from serves where s.beer = beer)","{""blocks"":{""id"":""BLOCK_SELECT@2fe88a09"",""fields"":[""BAR VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_IDENT@f8f56b9.BAR"",""pos"":{""lineNum"":7,""columnNum"":8,""endLineNum"":7,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@a64e035"",""value"":""NS_IDENT@f8f56b9.BEER"",""pos"":{""lineNum"":7,""columnNum"":15,""endLineNum"":7,""endColumnNum"":20,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@f8f56b9"",""NS_IDENT@15fa55a6""],""fromNode"":{""id"":""OP_JOIN@1e6308a9"",""value"":""COMMA"",""pos"":{""lineNum"":8,""columnNum"":14,""endLineNum"":8,""endColumnNum"":14,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@6edc4161"",""value"":""NS_IDENT@f8f56b9"",""pos"":{""lineNum"":8,""columnNum"":6,""endLineNum"":8,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@5486887b"",""value"":""NS_IDENT@15fa55a6"",""pos"":{""lineNum"":8,""columnNum"":16,""endLineNum"":8,""endColumnNum"":23,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@773dab28"",""value"":""AND"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":85,""quoted"":false},""children"":[{""id"":""OP_BINARY@4af46df3"",""value"":""="",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@415156bf"",""value"":""NS_IDENT@f8f56b9.beer"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@393881f0"",""value"":""NS_IDENT@15fa55a6.BEER"",""pos"":{""lineNum"":9,""columnNum"":16,""endLineNum"":9,""endColumnNum"":21,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@af78c87"",""value"":"">= ALL"",""pos"":{""lineNum"":9,""columnNum"":27,""endLineNum"":9,""endColumnNum"":85,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4158debd"",""value"":""NS_IDENT@f8f56b9.price"",""pos"":{""lineNum"":9,""columnNum"":27,""endLineNum"":9,""endColumnNum"":33,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@1917d90f"",""value"":""BLOCK_SELECT@1917d90f"",""pos"":{""lineNum"":9,""columnNum"":42,""endLineNum"":9,""endColumnNum"":85,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@415156bf"",""value"":""NS_IDENT@f8f56b9.beer"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4158debd"",""value"":""NS_IDENT@f8f56b9.price"",""pos"":{""lineNum"":9,""columnNum"":27,""endLineNum"":9,""endColumnNum"":33,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_IDENT@f8f56b9.BAR"",""pos"":{""lineNum"":7,""columnNum"":8,""endLineNum"":7,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@a64e035"",""value"":""NS_IDENT@f8f56b9.BEER"",""pos"":{""lineNum"":7,""columnNum"":15,""endLineNum"":7,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@393881f0"",""value"":""NS_IDENT@15fa55a6.BEER"",""pos"":{""lineNum"":9,""columnNum"":16,""endLineNum"":9,""endColumnNum"":21,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@f8f56b9.beer""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":7,""columnNum"":1,""endLineNum"":9,""endColumnNum"":86,""quoted"":false},""children"":{""BLOCK_SELECT@1917d90f"":{""id"":""BLOCK_SELECT@1917d90f"",""parentId"":""BLOCK_SELECT@2fe88a09"",""fields"":[""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@2fc07784"",""value"":""NS_IDENT@22d9c961.PRICE"",""pos"":{""lineNum"":9,""columnNum"":49,""endLineNum"":9,""endColumnNum"":53,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@22d9c961""],""fromNode"":{""id"":""JOIN_OPERAND@66bfd864"",""value"":""NS_IDENT@22d9c961"",""pos"":{""lineNum"":9,""columnNum"":60,""endLineNum"":9,""endColumnNum"":65,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@24097e9b"",""value"":""="",""pos"":{""lineNum"":9,""columnNum"":73,""endLineNum"":9,""endColumnNum"":85,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@682bd3c4"",""value"":""NS_IDENT@f8f56b9.beer"",""pos"":{""lineNum"":9,""columnNum"":73,""endLineNum"":9,""endColumnNum"":78,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@f2e4acf"",""value"":""NS_IDENT@22d9c961.beer"",""pos"":{""lineNum"":9,""columnNum"":82,""endLineNum"":9,""endColumnNum"":85,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@2fc07784"",""value"":""NS_IDENT@22d9c961.PRICE"",""pos"":{""lineNum"":9,""columnNum"":49,""endLineNum"":9,""endColumnNum"":53,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@682bd3c4"",""value"":""NS_IDENT@f8f56b9.beer"",""pos"":{""lineNum"":9,""columnNum"":73,""endLineNum"":9,""endColumnNum"":78,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@f2e4acf"",""value"":""NS_IDENT@22d9c961.beer"",""pos"":{""lineNum"":9,""columnNum"":82,""endLineNum"":9,""endColumnNum"":85,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@f8f56b9""],""corrCtxIds"":[""BLOCK_SELECT@2fe88a09""],""pos"":{""lineNum"":9,""columnNum"":42,""endLineNum"":9,""endColumnNum"":85,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@43effd89"":{""tableId"":""NS_IDENT@43effd89"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":10,""endLineNum"":4,""endColumnNum"":14,""quoted"":false}},""NS_IDENT@15fa55a6"":{""tableId"":""NS_IDENT@15fa55a6"",""identifier"":""D"",""dbTableName"":""DANLIKES"",""fields"":[""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":16,""endLineNum"":8,""endColumnNum"":25,""quoted"":false}},""NS_IDENT@22d9c961"":{""tableId"":""NS_IDENT@22d9c961"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":9,""columnNum"":60,""endLineNum"":9,""endColumnNum"":65,""quoted"":false}},""NS_IDENT@f8f56b9"":{""tableId"":""NS_IDENT@f8f56b9"",""identifier"":""S"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":6,""endLineNum"":8,""endColumnNum"":13,""quoted"":false}}},""corrTables"":[""NS_IDENT@f8f56b9""],""withBlocks"":[{""id"":""BLOCK_SELECT@72ed9aad"",""alias"":""DANLIKES"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@543e593"",""value"":""NS_IDENT@43effd89.BEER"",""pos"":{""lineNum"":3,""columnNum"":12,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@43effd89""],""fromNode"":{""id"":""JOIN_OPERAND@5e3a39cd"",""value"":""NS_IDENT@43effd89"",""pos"":{""lineNum"":4,""columnNum"":10,""endLineNum"":4,""endColumnNum"":14,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@3a4ba480"",""value"":""="",""pos"":{""lineNum"":5,""columnNum"":11,""endLineNum"":5,""endColumnNum"":25,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5f404594"",""value"":""NS_IDENT@43effd89.drinker"",""pos"":{""lineNum"":5,""columnNum"":11,""endLineNum"":5,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@4455f57d"",""value"":""'Dan'"",""pos"":{""lineNum"":5,""columnNum"":21,""endLineNum"":5,""endColumnNum"":25,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@543e593"",""value"":""NS_IDENT@43effd89.BEER"",""pos"":{""lineNum"":3,""columnNum"":12,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5f404594"",""value"":""NS_IDENT@43effd89.drinker"",""pos"":{""lineNum"":5,""columnNum"":11,""endLineNum"":5,""endColumnNum"":17,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":5,""endLineNum"":5,""endColumnNum"":25,""quoted"":false},""children"":{}}]}
"
"WITH maxPrice AS (SELECT beer, max(price) AS price FROM serves GROUP BY beer),
danBeers AS (SELECT beer FROM likes WHERE drinker='Dan')
SELECT beer, bar FROM serves NATURAL JOIN maxPrice WHERE beer IN (SELECT * FROM danBeers);

","{""failed"":true,""errorMsg"":""From line 3, column 58 to line 3, column 61: Column 'BEER' is ambiguous""}
"
"-- For each beer that Dan likes, find the names of bars that serve it at the highest price.
-- Format your output as list of (beer, bar) pairs (x) [Output columns: beer, bar]

-- get beers that dan likes
with beersDanLikes1 as (select beer
from likes
where drinker='Dan'),

-- get all distinct bars that serve the beers that dan likes & the beer's price at each bar 
barprices as (select distinct s2.beer, s2.bar, s2.price
from beersDanLikes1 b1, serves s1, serves s2
where b1.beer = s1.beer and b1.beer = s2.beer and s1.price<=s2.price),

-- get the beer served at the max price out of all the prices for each beer in barprices
ans as (select barprices.beer, max(barprices.price) as price
from barprices
group by barprices.beer)

-- get beer and bar that serve each beer at the max price
select ans.beer, serves.bar
from ans, serves
where ans.beer = serves.beer and ans.price = serves.price","{""blocks"":{""id"":""BLOCK_SELECT@18324f97"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@6dcd5639"",""value"":""NS_IDENT@35088e87.BEER"",""pos"":{""lineNum"":20,""columnNum"":8,""endLineNum"":20,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3eee3e2b"",""value"":""NS_IDENT@486bc9a4.BAR"",""pos"":{""lineNum"":20,""columnNum"":18,""endLineNum"":20,""endColumnNum"":27,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@35088e87"",""NS_IDENT@486bc9a4""],""fromNode"":{""id"":""OP_JOIN@64f555e7"",""value"":""COMMA"",""pos"":{""lineNum"":21,""columnNum"":9,""endLineNum"":21,""endColumnNum"":9,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@71178a52"",""value"":""NS_IDENT@35088e87"",""pos"":{""lineNum"":21,""columnNum"":6,""endLineNum"":21,""endColumnNum"":8,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@ff6077"",""value"":""NS_IDENT@486bc9a4"",""pos"":{""lineNum"":21,""columnNum"":11,""endLineNum"":21,""endColumnNum"":16,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@5fad41be"",""value"":""AND"",""pos"":{""lineNum"":22,""columnNum"":7,""endLineNum"":22,""endColumnNum"":57,""quoted"":false},""children"":[{""id"":""OP_BINARY@149f5761"",""value"":""="",""pos"":{""lineNum"":22,""columnNum"":7,""endLineNum"":22,""endColumnNum"":28,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@3350ebdd"",""value"":""NS_IDENT@35088e87.BEER"",""pos"":{""lineNum"":22,""columnNum"":7,""endLineNum"":22,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6818d900"",""value"":""NS_IDENT@486bc9a4.beer"",""pos"":{""lineNum"":22,""columnNum"":18,""endLineNum"":22,""endColumnNum"":28,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@31e72cbc"",""value"":""="",""pos"":{""lineNum"":22,""columnNum"":34,""endLineNum"":22,""endColumnNum"":57,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@2ba33e2c"",""value"":""NS_IDENT@35088e87.PRICE"",""pos"":{""lineNum"":22,""columnNum"":34,""endLineNum"":22,""endColumnNum"":42,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1f193686"",""value"":""NS_IDENT@486bc9a4.price"",""pos"":{""lineNum"":22,""columnNum"":46,""endLineNum"":22,""endColumnNum"":57,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@3eee3e2b"",""value"":""NS_IDENT@486bc9a4.BAR"",""pos"":{""lineNum"":20,""columnNum"":18,""endLineNum"":20,""endColumnNum"":27,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3350ebdd"",""value"":""NS_IDENT@35088e87.BEER"",""pos"":{""lineNum"":22,""columnNum"":7,""endLineNum"":22,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6dcd5639"",""value"":""NS_IDENT@35088e87.BEER"",""pos"":{""lineNum"":20,""columnNum"":8,""endLineNum"":20,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1f193686"",""value"":""NS_IDENT@486bc9a4.price"",""pos"":{""lineNum"":22,""columnNum"":46,""endLineNum"":22,""endColumnNum"":57,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2ba33e2c"",""value"":""NS_IDENT@35088e87.PRICE"",""pos"":{""lineNum"":22,""columnNum"":34,""endLineNum"":22,""endColumnNum"":42,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6818d900"",""value"":""NS_IDENT@486bc9a4.beer"",""pos"":{""lineNum"":22,""columnNum"":18,""endLineNum"":22,""endColumnNum"":28,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":20,""columnNum"":1,""endLineNum"":22,""endColumnNum"":57,""quoted"":false},""children"":{}},""tables"":{""NS_IDENT@67e28be3"":{""tableId"":""NS_IDENT@67e28be3"",""identifier"":""B1"",""dbTableName"":""BEERSDANLIKES1"",""fields"":[""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":11,""columnNum"":6,""endLineNum"":11,""endColumnNum"":22,""quoted"":false}},""NS_IDENT@9d1a267"":{""tableId"":""NS_IDENT@9d1a267"",""identifier"":""BARPRICES"",""dbTableName"":""BARPRICES"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":16,""columnNum"":6,""endLineNum"":16,""endColumnNum"":14,""quoted"":false}},""NS_IDENT@6293e39e"":{""tableId"":""NS_IDENT@6293e39e"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":10,""quoted"":false}},""NS_IDENT@35088e87"":{""tableId"":""NS_IDENT@35088e87"",""identifier"":""ANS"",""dbTableName"":""ANS"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":21,""columnNum"":6,""endLineNum"":21,""endColumnNum"":8,""quoted"":false}},""NS_IDENT@de18f63"":{""tableId"":""NS_IDENT@de18f63"",""identifier"":""S2"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":11,""columnNum"":36,""endLineNum"":11,""endColumnNum"":44,""quoted"":false}},""NS_IDENT@e344ad3"":{""tableId"":""NS_IDENT@e344ad3"",""identifier"":""S1"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":11,""columnNum"":25,""endLineNum"":11,""endColumnNum"":33,""quoted"":false}},""NS_IDENT@486bc9a4"":{""tableId"":""NS_IDENT@486bc9a4"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":21,""columnNum"":11,""endLineNum"":21,""endColumnNum"":16,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@4690f583"",""alias"":""BEERSDANLIKES1"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@3daa82be"",""value"":""NS_IDENT@6293e39e.BEER"",""pos"":{""lineNum"":5,""columnNum"":32,""endLineNum"":5,""endColumnNum"":35,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@6293e39e""],""fromNode"":{""id"":""JOIN_OPERAND@21f9277b"",""value"":""NS_IDENT@6293e39e"",""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":10,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@4fe875be"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":19,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4d0b0fd4"",""value"":""NS_IDENT@6293e39e.drinker"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@67dba613"",""value"":""'Dan'"",""pos"":{""lineNum"":7,""columnNum"":15,""endLineNum"":7,""endColumnNum"":19,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@4d0b0fd4"",""value"":""NS_IDENT@6293e39e.drinker"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3daa82be"",""value"":""NS_IDENT@6293e39e.BEER"",""pos"":{""lineNum"":5,""columnNum"":32,""endLineNum"":5,""endColumnNum"":35,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":5,""columnNum"":25,""endLineNum"":7,""endColumnNum"":19,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@66bfd864"",""alias"":""BARPRICES"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""isDistinct"":true,""selectList"":[{""id"":""COLUMN_LOCAL@108bdbd8"",""value"":""NS_IDENT@de18f63.BEER"",""pos"":{""lineNum"":10,""columnNum"":31,""endLineNum"":10,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4f8b4bd0"",""value"":""NS_IDENT@de18f63.BAR"",""pos"":{""lineNum"":10,""columnNum"":40,""endLineNum"":10,""endColumnNum"":45,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@b18c4"",""value"":""NS_IDENT@de18f63.PRICE"",""pos"":{""lineNum"":10,""columnNum"":48,""endLineNum"":10,""endColumnNum"":55,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@67e28be3"",""NS_IDENT@e344ad3"",""NS_IDENT@de18f63""],""fromNode"":{""id"":""OP_JOIN@1e6308a9"",""value"":""COMMA"",""pos"":{""lineNum"":11,""columnNum"":34,""endLineNum"":11,""endColumnNum"":34,""quoted"":false},""children"":[{""id"":""OP_JOIN@30cecdca"",""value"":""COMMA"",""pos"":{""lineNum"":11,""columnNum"":23,""endLineNum"":11,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@5486887b"",""value"":""NS_IDENT@67e28be3"",""pos"":{""lineNum"":11,""columnNum"":6,""endLineNum"":11,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@5226e402"",""value"":""NS_IDENT@e344ad3"",""pos"":{""lineNum"":11,""columnNum"":25,""endLineNum"":11,""endColumnNum"":30,""quoted"":false},""children"":[]}],""natural"":false},{""id"":""JOIN_OPERAND@1ddd3478"",""value"":""NS_IDENT@de18f63"",""pos"":{""lineNum"":11,""columnNum"":36,""endLineNum"":11,""endColumnNum"":41,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@53e3a87a"",""value"":""AND"",""pos"":{""lineNum"":12,""columnNum"":7,""endLineNum"":12,""endColumnNum"":68,""quoted"":false},""children"":[{""id"":""OP_BINARY@621f89b8"",""value"":""AND"",""pos"":{""lineNum"":12,""columnNum"":7,""endLineNum"":12,""endColumnNum"":45,""quoted"":false},""children"":[{""id"":""OP_BINARY@ae7950d"",""value"":""="",""pos"":{""lineNum"":12,""columnNum"":7,""endLineNum"":12,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4e2916c3"",""value"":""NS_IDENT@67e28be3.BEER"",""pos"":{""lineNum"":12,""columnNum"":7,""endLineNum"":12,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@64aad6db"",""value"":""NS_IDENT@e344ad3.beer"",""pos"":{""lineNum"":12,""columnNum"":17,""endLineNum"":12,""endColumnNum"":23,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@546621c4"",""value"":""="",""pos"":{""lineNum"":12,""columnNum"":29,""endLineNum"":12,""endColumnNum"":45,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@60d1b21f"",""value"":""NS_IDENT@67e28be3.BEER"",""pos"":{""lineNum"":12,""columnNum"":29,""endLineNum"":12,""endColumnNum"":35,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@66c83fc8"",""value"":""NS_IDENT@de18f63.beer"",""pos"":{""lineNum"":12,""columnNum"":39,""endLineNum"":12,""endColumnNum"":45,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@4dafba3e"",""value"":""<="",""pos"":{""lineNum"":12,""columnNum"":51,""endLineNum"":12,""endColumnNum"":68,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@f339eae"",""value"":""NS_IDENT@e344ad3.price"",""pos"":{""lineNum"":12,""columnNum"":51,""endLineNum"":12,""endColumnNum"":58,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2822c6ff"",""value"":""NS_IDENT@de18f63.price"",""pos"":{""lineNum"":12,""columnNum"":61,""endLineNum"":12,""endColumnNum"":68,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@4e2916c3"",""value"":""NS_IDENT@67e28be3.BEER"",""pos"":{""lineNum"":12,""columnNum"":7,""endLineNum"":12,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@f339eae"",""value"":""NS_IDENT@e344ad3.price"",""pos"":{""lineNum"":12,""columnNum"":51,""endLineNum"":12,""endColumnNum"":58,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@66c83fc8"",""value"":""NS_IDENT@de18f63.beer"",""pos"":{""lineNum"":12,""columnNum"":39,""endLineNum"":12,""endColumnNum"":45,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4f8b4bd0"",""value"":""NS_IDENT@de18f63.BAR"",""pos"":{""lineNum"":10,""columnNum"":40,""endLineNum"":10,""endColumnNum"":45,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2822c6ff"",""value"":""NS_IDENT@de18f63.price"",""pos"":{""lineNum"":12,""columnNum"":61,""endLineNum"":12,""endColumnNum"":68,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@108bdbd8"",""value"":""NS_IDENT@de18f63.BEER"",""pos"":{""lineNum"":10,""columnNum"":31,""endLineNum"":10,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@b18c4"",""value"":""NS_IDENT@de18f63.PRICE"",""pos"":{""lineNum"":10,""columnNum"":48,""endLineNum"":10,""endColumnNum"":55,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@60d1b21f"",""value"":""NS_IDENT@67e28be3.BEER"",""pos"":{""lineNum"":12,""columnNum"":29,""endLineNum"":12,""endColumnNum"":35,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@64aad6db"",""value"":""NS_IDENT@e344ad3.beer"",""pos"":{""lineNum"":12,""columnNum"":17,""endLineNum"":12,""endColumnNum"":23,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":10,""columnNum"":15,""endLineNum"":12,""endColumnNum"":68,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@4d33940d"",""alias"":""ANS"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@55ecbafe"",""value"":""NS_IDENT@9d1a267.BEER"",""pos"":{""lineNum"":15,""columnNum"":16,""endLineNum"":15,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@29ea78b1"",""value"":""MAX"",""pos"":{""lineNum"":15,""columnNum"":32,""endLineNum"":15,""endColumnNum"":51,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@59546cfe"",""value"":""NS_IDENT@9d1a267.PRICE"",""pos"":{""lineNum"":15,""columnNum"":36,""endLineNum"":15,""endColumnNum"":50,""quoted"":false},""children"":[]}],""alias"":""PRICE""}],""fromItemIds"":[""NS_IDENT@9d1a267""],""fromNode"":{""id"":""JOIN_OPERAND@43cf6ea3"",""value"":""NS_IDENT@9d1a267"",""pos"":{""lineNum"":16,""columnNum"":6,""endLineNum"":16,""endColumnNum"":14,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@6e106680"",""value"":""NS_IDENT@9d1a267.BEER"",""pos"":{""lineNum"":17,""columnNum"":10,""endLineNum"":17,""endColumnNum"":23,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@59546cfe"",""value"":""NS_IDENT@9d1a267.PRICE"",""pos"":{""lineNum"":15,""columnNum"":36,""endLineNum"":15,""endColumnNum"":50,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@55ecbafe"",""value"":""NS_IDENT@9d1a267.BEER"",""pos"":{""lineNum"":15,""columnNum"":16,""endLineNum"":15,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6e106680"",""value"":""NS_IDENT@9d1a267.BEER"",""pos"":{""lineNum"":17,""columnNum"":10,""endLineNum"":17,""endColumnNum"":23,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":15,""columnNum"":9,""endLineNum"":17,""endColumnNum"":23,""quoted"":false},""children"":{}}]}
"
"SELECT S.beer, S.bar
FROM likes L, serves S
WHERE L.drinker = 'Dan'
      AND S.beer = L.beer
      AND S.price > ALL (SELECT X.price FROM serves X WHERE S.beer = X.beer AND S.price <> X.price)
","{""blocks"":{""id"":""BLOCK_SELECT@847f3e7"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@398474a2"",""value"":""NS_IDENT@5e39850.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@78c1a023"",""value"":""NS_IDENT@5e39850.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@c27d163"",""NS_IDENT@5e39850""],""fromNode"":{""id"":""OP_JOIN@37a64f9d"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":13,""endLineNum"":2,""endColumnNum"":13,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@25b865b5"",""value"":""NS_IDENT@c27d163"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@f9b5552"",""value"":""NS_IDENT@5e39850"",""pos"":{""lineNum"":2,""columnNum"":15,""endLineNum"":2,""endColumnNum"":20,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@7b2a3ff8"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":5,""endColumnNum"":98,""quoted"":false},""children"":[{""id"":""OP_BINARY@1bcf67e8"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":4,""endColumnNum"":25,""quoted"":false},""children"":[{""id"":""OP_BINARY@dffa30b"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@6f952d6c"",""value"":""NS_IDENT@c27d163.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@383790cf"",""value"":""'Dan'"",""pos"":{""lineNum"":3,""columnNum"":19,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@6b587673"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":11,""endLineNum"":4,""endColumnNum"":25,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4d8126f"",""value"":""NS_IDENT@5e39850.beer"",""pos"":{""lineNum"":4,""columnNum"":11,""endLineNum"":4,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6d3c232f"",""value"":""NS_IDENT@c27d163.beer"",""pos"":{""lineNum"":4,""columnNum"":20,""endLineNum"":4,""endColumnNum"":25,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@53692008"",""value"":""> ALL"",""pos"":{""lineNum"":5,""columnNum"":11,""endLineNum"":5,""endColumnNum"":98,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5f404594"",""value"":""NS_IDENT@5e39850.price"",""pos"":{""lineNum"":5,""columnNum"":11,""endLineNum"":5,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@4bff2185"",""value"":""BLOCK_SELECT@4bff2185"",""pos"":{""lineNum"":5,""columnNum"":26,""endLineNum"":5,""endColumnNum"":98,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@6f952d6c"",""value"":""NS_IDENT@c27d163.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5f404594"",""value"":""NS_IDENT@5e39850.price"",""pos"":{""lineNum"":5,""columnNum"":11,""endLineNum"":5,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@78c1a023"",""value"":""NS_IDENT@5e39850.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@398474a2"",""value"":""NS_IDENT@5e39850.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6d3c232f"",""value"":""NS_IDENT@c27d163.beer"",""pos"":{""lineNum"":4,""columnNum"":20,""endLineNum"":4,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4d8126f"",""value"":""NS_IDENT@5e39850.beer"",""pos"":{""lineNum"":4,""columnNum"":11,""endLineNum"":4,""endColumnNum"":16,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@5e39850.price"",""NS_IDENT@5e39850.beer""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":5,""endColumnNum"":99,""quoted"":false},""children"":{""BLOCK_SELECT@4bff2185"":{""id"":""BLOCK_SELECT@4bff2185"",""parentId"":""BLOCK_SELECT@847f3e7"",""fields"":[""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@ccd1bc3"",""value"":""NS_IDENT@72fe8a4f.PRICE"",""pos"":{""lineNum"":5,""columnNum"":33,""endLineNum"":5,""endColumnNum"":39,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@72fe8a4f""],""fromNode"":{""id"":""JOIN_OPERAND@458544e0"",""value"":""NS_IDENT@72fe8a4f"",""pos"":{""lineNum"":5,""columnNum"":46,""endLineNum"":5,""endColumnNum"":51,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@31ddd4a4"",""value"":""AND"",""pos"":{""lineNum"":5,""columnNum"":61,""endLineNum"":5,""endColumnNum"":98,""quoted"":false},""children"":[{""id"":""OP_BINARY@3b569985"",""value"":""="",""pos"":{""lineNum"":5,""columnNum"":61,""endLineNum"":5,""endColumnNum"":75,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@773c0293"",""value"":""NS_IDENT@5e39850.beer"",""pos"":{""lineNum"":5,""columnNum"":61,""endLineNum"":5,""endColumnNum"":66,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@55b8dbda"",""value"":""NS_IDENT@72fe8a4f.beer"",""pos"":{""lineNum"":5,""columnNum"":70,""endLineNum"":5,""endColumnNum"":75,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@3e48e859"",""value"":""<>"",""pos"":{""lineNum"":5,""columnNum"":81,""endLineNum"":5,""endColumnNum"":98,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@3a022576"",""value"":""NS_IDENT@5e39850.price"",""pos"":{""lineNum"":5,""columnNum"":81,""endLineNum"":5,""endColumnNum"":87,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2dbd803f"",""value"":""NS_IDENT@72fe8a4f.price"",""pos"":{""lineNum"":5,""columnNum"":92,""endLineNum"":5,""endColumnNum"":98,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@55b8dbda"",""value"":""NS_IDENT@72fe8a4f.beer"",""pos"":{""lineNum"":5,""columnNum"":70,""endLineNum"":5,""endColumnNum"":75,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2dbd803f"",""value"":""NS_IDENT@72fe8a4f.price"",""pos"":{""lineNum"":5,""columnNum"":92,""endLineNum"":5,""endColumnNum"":98,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@ccd1bc3"",""value"":""NS_IDENT@72fe8a4f.PRICE"",""pos"":{""lineNum"":5,""columnNum"":33,""endLineNum"":5,""endColumnNum"":39,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@3a022576"",""value"":""NS_IDENT@5e39850.price"",""pos"":{""lineNum"":5,""columnNum"":81,""endLineNum"":5,""endColumnNum"":87,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@773c0293"",""value"":""NS_IDENT@5e39850.beer"",""pos"":{""lineNum"":5,""columnNum"":61,""endLineNum"":5,""endColumnNum"":66,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@5e39850""],""corrCtxIds"":[""BLOCK_SELECT@847f3e7""],""pos"":{""lineNum"":5,""columnNum"":26,""endLineNum"":5,""endColumnNum"":98,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@5e39850"":{""tableId"":""NS_IDENT@5e39850"",""identifier"":""S"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":15,""endLineNum"":2,""endColumnNum"":22,""quoted"":false}},""NS_IDENT@72fe8a4f"":{""tableId"":""NS_IDENT@72fe8a4f"",""identifier"":""X"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":46,""endLineNum"":5,""endColumnNum"":53,""quoted"":false}},""NS_IDENT@c27d163"":{""tableId"":""NS_IDENT@c27d163"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false}}},""corrTables"":[""NS_IDENT@5e39850""]}
"
"SELECT b.beer, serves.bar
FROM 
(SELECT a.beer, max(a.price) AS price FROM 
(SELECT likes.beer, bar, price
FROM likes, serves
WHERE drinker = 'Dan' AND likes.beer = serves.beer
GROUP BY likes.beer, serves.bar, serves.price
ORDER BY price desc) a
GROUP BY a.beer) b, serves
WHERE b.beer = serves.beer AND b.price = serves.price;

","{""blocks"":{""id"":""BLOCK_SELECT@1dab9dd6"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@5fad41be"",""value"":""NS_SELECT@5c0f79f0.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@314ed053"",""value"":""NS_IDENT@58a4a74d.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":25,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_SELECT@5c0f79f0"",""NS_IDENT@58a4a74d""],""fromNode"":{""id"":""OP_JOIN@1869f114"",""value"":""COMMA"",""pos"":{""lineNum"":9,""columnNum"":19,""endLineNum"":9,""endColumnNum"":19,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@18a645fd"",""value"":""BLOCK_SELECT@18a645fd"",""pos"":{""lineNum"":3,""columnNum"":2,""endLineNum"":9,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@3241713e"",""value"":""NS_IDENT@58a4a74d"",""pos"":{""lineNum"":9,""columnNum"":21,""endLineNum"":9,""endColumnNum"":26,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@31e72cbc"",""value"":""AND"",""pos"":{""lineNum"":10,""columnNum"":7,""endLineNum"":10,""endColumnNum"":53,""quoted"":false},""children"":[{""id"":""OP_BINARY@6818d900"",""value"":""="",""pos"":{""lineNum"":10,""columnNum"":7,""endLineNum"":10,""endColumnNum"":26,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@29c2c826"",""value"":""NS_SELECT@5c0f79f0.BEER"",""pos"":{""lineNum"":10,""columnNum"":7,""endLineNum"":10,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3350ebdd"",""value"":""NS_IDENT@58a4a74d.beer"",""pos"":{""lineNum"":10,""columnNum"":16,""endLineNum"":10,""endColumnNum"":26,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@1f193686"",""value"":""="",""pos"":{""lineNum"":10,""columnNum"":32,""endLineNum"":10,""endColumnNum"":53,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@149f5761"",""value"":""NS_SELECT@5c0f79f0.PRICE"",""pos"":{""lineNum"":10,""columnNum"":32,""endLineNum"":10,""endColumnNum"":38,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2ba33e2c"",""value"":""NS_IDENT@58a4a74d.price"",""pos"":{""lineNum"":10,""columnNum"":42,""endLineNum"":10,""endColumnNum"":53,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@5fad41be"",""value"":""NS_SELECT@5c0f79f0.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2ba33e2c"",""value"":""NS_IDENT@58a4a74d.price"",""pos"":{""lineNum"":10,""columnNum"":42,""endLineNum"":10,""endColumnNum"":53,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@149f5761"",""value"":""NS_SELECT@5c0f79f0.PRICE"",""pos"":{""lineNum"":10,""columnNum"":32,""endLineNum"":10,""endColumnNum"":38,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3350ebdd"",""value"":""NS_IDENT@58a4a74d.beer"",""pos"":{""lineNum"":10,""columnNum"":16,""endLineNum"":10,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@314ed053"",""value"":""NS_IDENT@58a4a74d.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@29c2c826"",""value"":""NS_SELECT@5c0f79f0.BEER"",""pos"":{""lineNum"":10,""columnNum"":7,""endLineNum"":10,""endColumnNum"":12,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":10,""endColumnNum"":53,""quoted"":false},""children"":{""BLOCK_SELECT@18a645fd"":{""id"":""BLOCK_SELECT@18a645fd"",""parentId"":""BLOCK_SELECT@1dab9dd6"",""alias"":""B"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@8ed9cf"",""value"":""NS_SELECT@21fdfefc.BEER"",""pos"":{""lineNum"":3,""columnNum"":9,""endLineNum"":3,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@377008df"",""value"":""MAX"",""pos"":{""lineNum"":3,""columnNum"":17,""endLineNum"":3,""endColumnNum"":28,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@f72203"",""value"":""NS_SELECT@21fdfefc.PRICE"",""pos"":{""lineNum"":3,""columnNum"":21,""endLineNum"":3,""endColumnNum"":27,""quoted"":false},""children"":[]}],""alias"":""PRICE""}],""fromItemIds"":[""NS_SELECT@21fdfefc""],""fromNode"":{""id"":""JOIN_OPERAND@f9b5552"",""value"":""BLOCK_SELECT@f9b5552"",""pos"":{""lineNum"":4,""columnNum"":2,""endLineNum"":7,""endColumnNum"":45,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@7b3315a5"",""value"":""NS_SELECT@21fdfefc.BEER"",""pos"":{""lineNum"":9,""columnNum"":10,""endLineNum"":9,""endColumnNum"":15,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@7b3315a5"",""value"":""NS_SELECT@21fdfefc.BEER"",""pos"":{""lineNum"":9,""columnNum"":10,""endLineNum"":9,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@8ed9cf"",""value"":""NS_SELECT@21fdfefc.BEER"",""pos"":{""lineNum"":3,""columnNum"":9,""endLineNum"":3,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@f72203"",""value"":""NS_SELECT@21fdfefc.PRICE"",""pos"":{""lineNum"":3,""columnNum"":21,""endLineNum"":3,""endColumnNum"":27,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":2,""endLineNum"":9,""endColumnNum"":15,""quoted"":false},""children"":{""BLOCK_SELECT@f9b5552"":{""id"":""BLOCK_SELECT@f9b5552"",""parentId"":""BLOCK_SELECT@18a645fd"",""alias"":""A"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@2b556bb2"",""value"":""NS_IDENT@3daa82be.BEER"",""pos"":{""lineNum"":4,""columnNum"":9,""endLineNum"":4,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2e3cdec2"",""value"":""NS_IDENT@e344ad3.BAR"",""pos"":{""lineNum"":4,""columnNum"":21,""endLineNum"":4,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1f52eb6f"",""value"":""NS_IDENT@e344ad3.PRICE"",""pos"":{""lineNum"":4,""columnNum"":26,""endLineNum"":4,""endColumnNum"":30,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@3daa82be"",""NS_IDENT@e344ad3""],""fromNode"":{""id"":""OP_JOIN@6872f9c8"",""value"":""COMMA"",""pos"":{""lineNum"":5,""columnNum"":11,""endLineNum"":5,""endColumnNum"":11,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@6df7988f"",""value"":""NS_IDENT@3daa82be"",""pos"":{""lineNum"":5,""columnNum"":6,""endLineNum"":5,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@2fe88a09"",""value"":""NS_IDENT@e344ad3"",""pos"":{""lineNum"":5,""columnNum"":13,""endLineNum"":5,""endColumnNum"":18,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@4a9486c0"",""value"":""AND"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":50,""quoted"":false},""children"":[{""id"":""OP_BINARY@2571066a"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4455f57d"",""value"":""NS_IDENT@3daa82be.drinker"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@5cf8edcf"",""value"":""'Dan'"",""pos"":{""lineNum"":6,""columnNum"":17,""endLineNum"":6,""endColumnNum"":21,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@677b8e13"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":27,""endLineNum"":6,""endColumnNum"":50,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@74fe5966"",""value"":""NS_IDENT@3daa82be.beer"",""pos"":{""lineNum"":6,""columnNum"":27,""endLineNum"":6,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4fe875be"",""value"":""NS_IDENT@e344ad3.beer"",""pos"":{""lineNum"":6,""columnNum"":40,""endLineNum"":6,""endColumnNum"":50,""quoted"":false},""children"":[]}]}]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@7ca0863b"",""value"":""NS_IDENT@3daa82be.beer"",""pos"":{""lineNum"":7,""columnNum"":10,""endLineNum"":7,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@319854f0"",""value"":""NS_IDENT@e344ad3.bar"",""pos"":{""lineNum"":7,""columnNum"":22,""endLineNum"":7,""endColumnNum"":31,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@748fe51d"",""value"":""NS_IDENT@e344ad3.price"",""pos"":{""lineNum"":7,""columnNum"":34,""endLineNum"":7,""endColumnNum"":45,""quoted"":false},""children"":[]}],""orderByList"":[{""id"":""OP_POSTFIX@bdc8014"",""value"":""DESC"",""pos"":{""lineNum"":8,""columnNum"":10,""endLineNum"":8,""endColumnNum"":19,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@736f3e9e"",""value"":""NS_IDENT@e344ad3.PRICE"",""pos"":{""lineNum"":8,""columnNum"":10,""endLineNum"":8,""endColumnNum"":14,""quoted"":false},""children"":[]}]}],""identifiers"":[{""id"":""COLUMN_LOCAL@7ca0863b"",""value"":""NS_IDENT@3daa82be.beer"",""pos"":{""lineNum"":7,""columnNum"":10,""endLineNum"":7,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2b556bb2"",""value"":""NS_IDENT@3daa82be.BEER"",""pos"":{""lineNum"":4,""columnNum"":9,""endLineNum"":4,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@736f3e9e"",""value"":""NS_IDENT@e344ad3.PRICE"",""pos"":{""lineNum"":8,""columnNum"":10,""endLineNum"":8,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4455f57d"",""value"":""NS_IDENT@3daa82be.drinker"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1f52eb6f"",""value"":""NS_IDENT@e344ad3.PRICE"",""pos"":{""lineNum"":4,""columnNum"":26,""endLineNum"":4,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2e3cdec2"",""value"":""NS_IDENT@e344ad3.BAR"",""pos"":{""lineNum"":4,""columnNum"":21,""endLineNum"":4,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4fe875be"",""value"":""NS_IDENT@e344ad3.beer"",""pos"":{""lineNum"":6,""columnNum"":40,""endLineNum"":6,""endColumnNum"":50,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@748fe51d"",""value"":""NS_IDENT@e344ad3.price"",""pos"":{""lineNum"":7,""columnNum"":34,""endLineNum"":7,""endColumnNum"":45,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@74fe5966"",""value"":""NS_IDENT@3daa82be.beer"",""pos"":{""lineNum"":6,""columnNum"":27,""endLineNum"":6,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@319854f0"",""value"":""NS_IDENT@e344ad3.bar"",""pos"":{""lineNum"":7,""columnNum"":22,""endLineNum"":7,""endColumnNum"":31,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":4,""columnNum"":2,""endLineNum"":7,""endColumnNum"":45,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@58a4a74d"":{""tableId"":""NS_IDENT@58a4a74d"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":9,""columnNum"":21,""endLineNum"":9,""endColumnNum"":26,""quoted"":false}},""NS_IDENT@3daa82be"":{""tableId"":""NS_IDENT@3daa82be"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":6,""endLineNum"":5,""endColumnNum"":10,""quoted"":false}},""NS_SELECT@21fdfefc"":{""tableId"":""NS_SELECT@21fdfefc"",""identifier"":""A"",""blockId"":""BLOCK_SELECT@f9b5552"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":16,""endLineNum"":8,""endColumnNum"":22,""quoted"":false}},""NS_SELECT@5c0f79f0"":{""tableId"":""NS_SELECT@5c0f79f0"",""identifier"":""B"",""blockId"":""BLOCK_SELECT@18a645fd"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":2,""endLineNum"":9,""endColumnNum"":18,""quoted"":false}},""NS_IDENT@e344ad3"":{""tableId"":""NS_IDENT@e344ad3"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":13,""endLineNum"":5,""endColumnNum"":18,""quoted"":false}}},""corrTables"":[]}
"
"WITH beers AS (SELECT beer
			   FROM likes
			   WHERE drinker = 'Dan'),
     options AS (Select s.beer, s.bar, s.price
	 			 FROM serves s, beers b
	 			 WHERE s.beer = b.beer)
SELECT o1.beer, o1.bar
FROM options o1
WHERE price = (SELECT MAX(o2.price)
	 		   FROM options o2
	           where o1.beer = o2.beer);","{""blocks"":{""id"":""BLOCK_SELECT@5226e402"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@13047d7d"",""value"":""NS_IDENT@56303475.BEER"",""pos"":{""lineNum"":7,""columnNum"":8,""endLineNum"":7,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3c7cfcbb"",""value"":""NS_IDENT@56303475.BAR"",""pos"":{""lineNum"":7,""columnNum"":17,""endLineNum"":7,""endColumnNum"":22,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@56303475""],""fromNode"":{""id"":""JOIN_OPERAND@512d4583"",""value"":""NS_IDENT@56303475"",""pos"":{""lineNum"":8,""columnNum"":6,""endLineNum"":8,""endColumnNum"":12,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@2bfbffb2"",""value"":""="",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":11,""endColumnNum"":35,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4912d525"",""value"":""NS_IDENT@56303475.PRICE"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT_SCALAR@765df79d"",""value"":""BLOCK_SELECT@1440c311"",""pos"":{""lineNum"":9,""columnNum"":16,""endLineNum"":11,""endColumnNum"":35,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@4912d525"",""value"":""NS_IDENT@56303475.PRICE"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@13047d7d"",""value"":""NS_IDENT@56303475.BEER"",""pos"":{""lineNum"":7,""columnNum"":8,""endLineNum"":7,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3c7cfcbb"",""value"":""NS_IDENT@56303475.BAR"",""pos"":{""lineNum"":7,""columnNum"":17,""endLineNum"":7,""endColumnNum"":22,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@56303475.BEER""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":7,""columnNum"":1,""endLineNum"":11,""endColumnNum"":36,""quoted"":false},""children"":{""BLOCK_SELECT@1440c311"":{""id"":""BLOCK_SELECT@1440c311"",""parentId"":""BLOCK_SELECT@5226e402"",""fields"":[""EXPR$0 DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""OP_AGG_FUNC@3e850122"",""value"":""MAX"",""pos"":{""lineNum"":9,""columnNum"":23,""endLineNum"":9,""endColumnNum"":35,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@27fde870"",""value"":""NS_IDENT@52a70627.PRICE"",""pos"":{""lineNum"":9,""columnNum"":27,""endLineNum"":9,""endColumnNum"":34,""quoted"":false},""children"":[]}]}],""fromItemIds"":[""NS_IDENT@52a70627""],""fromNode"":{""id"":""JOIN_OPERAND@189b5fb1"",""value"":""NS_IDENT@52a70627"",""pos"":{""lineNum"":10,""columnNum"":13,""endLineNum"":10,""endColumnNum"":19,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@5ac7aa18"",""value"":""="",""pos"":{""lineNum"":11,""columnNum"":19,""endLineNum"":11,""endColumnNum"":35,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@4cdd2c73"",""value"":""NS_IDENT@56303475.BEER"",""pos"":{""lineNum"":11,""columnNum"":19,""endLineNum"":11,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4abf3f0"",""value"":""NS_IDENT@52a70627.BEER"",""pos"":{""lineNum"":11,""columnNum"":29,""endLineNum"":11,""endColumnNum"":35,""quoted"":false},""children"":[]}]},""isAggregate"":true,""identifiers"":[{""id"":""COLUMN_CORRELATE@4cdd2c73"",""value"":""NS_IDENT@56303475.BEER"",""pos"":{""lineNum"":11,""columnNum"":19,""endLineNum"":11,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@27fde870"",""value"":""NS_IDENT@52a70627.PRICE"",""pos"":{""lineNum"":9,""columnNum"":27,""endLineNum"":9,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4abf3f0"",""value"":""NS_IDENT@52a70627.BEER"",""pos"":{""lineNum"":11,""columnNum"":29,""endLineNum"":11,""endColumnNum"":35,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@56303475""],""corrCtxIds"":[""BLOCK_SELECT@5226e402""],""pos"":{""lineNum"":9,""columnNum"":16,""endLineNum"":11,""endColumnNum"":35,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@77bd7fe7"":{""tableId"":""NS_IDENT@77bd7fe7"",""identifier"":""B"",""dbTableName"":""BEERS"",""fields"":[""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":22,""endLineNum"":5,""endColumnNum"":28,""quoted"":false}},""NS_IDENT@60dd3c23"":{""tableId"":""NS_IDENT@60dd3c23"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":12,""endLineNum"":2,""endColumnNum"":16,""quoted"":false}},""NS_IDENT@56303475"":{""tableId"":""NS_IDENT@56303475"",""identifier"":""O1"",""dbTableName"":""OPTIONS"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":6,""endLineNum"":8,""endColumnNum"":15,""quoted"":false}},""NS_IDENT@52a70627"":{""tableId"":""NS_IDENT@52a70627"",""identifier"":""O2"",""dbTableName"":""OPTIONS"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":10,""columnNum"":13,""endLineNum"":10,""endColumnNum"":22,""quoted"":false}},""NS_IDENT@215a34b4"":{""tableId"":""NS_IDENT@215a34b4"",""identifier"":""S"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":12,""endLineNum"":5,""endColumnNum"":19,""quoted"":false}}},""corrTables"":[""NS_IDENT@56303475""],""withBlocks"":[{""id"":""BLOCK_SELECT@2d66530f"",""alias"":""BEERS"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@7c455e96"",""value"":""NS_IDENT@60dd3c23.BEER"",""pos"":{""lineNum"":1,""columnNum"":23,""endLineNum"":1,""endColumnNum"":26,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@60dd3c23""],""fromNode"":{""id"":""JOIN_OPERAND@6d2d99fc"",""value"":""NS_IDENT@60dd3c23"",""pos"":{""lineNum"":2,""columnNum"":12,""endLineNum"":2,""endColumnNum"":16,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@7a24eb3"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":13,""endLineNum"":3,""endColumnNum"":27,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@74971ed9"",""value"":""NS_IDENT@60dd3c23.drinker"",""pos"":{""lineNum"":3,""columnNum"":13,""endLineNum"":3,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@677b8e13"",""value"":""'Dan'"",""pos"":{""lineNum"":3,""columnNum"":23,""endLineNum"":3,""endColumnNum"":27,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@74971ed9"",""value"":""NS_IDENT@60dd3c23.drinker"",""pos"":{""lineNum"":3,""columnNum"":13,""endLineNum"":3,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7c455e96"",""value"":""NS_IDENT@60dd3c23.BEER"",""pos"":{""lineNum"":1,""columnNum"":23,""endLineNum"":1,""endColumnNum"":26,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":3,""endColumnNum"":27,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@7e8a46b7"",""alias"":""OPTIONS"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@35d3ab60"",""value"":""NS_IDENT@215a34b4.BEER"",""pos"":{""lineNum"":4,""columnNum"":25,""endLineNum"":4,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@71870da7"",""value"":""NS_IDENT@215a34b4.BAR"",""pos"":{""lineNum"":4,""columnNum"":33,""endLineNum"":4,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@45792847"",""value"":""NS_IDENT@215a34b4.PRICE"",""pos"":{""lineNum"":4,""columnNum"":40,""endLineNum"":4,""endColumnNum"":46,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@215a34b4"",""NS_IDENT@77bd7fe7""],""fromNode"":{""id"":""OP_JOIN@4aac85fa"",""value"":""COMMA"",""pos"":{""lineNum"":5,""columnNum"":20,""endLineNum"":5,""endColumnNum"":20,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@6079cf5"",""value"":""NS_IDENT@215a34b4"",""pos"":{""lineNum"":5,""columnNum"":12,""endLineNum"":5,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@1e6308a9"",""value"":""NS_IDENT@77bd7fe7"",""pos"":{""lineNum"":5,""columnNum"":22,""endLineNum"":5,""endColumnNum"":26,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@4a55a6e8"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":13,""endLineNum"":6,""endColumnNum"":27,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@55cff952"",""value"":""NS_IDENT@215a34b4.beer"",""pos"":{""lineNum"":6,""columnNum"":13,""endLineNum"":6,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@660591fb"",""value"":""NS_IDENT@77bd7fe7.BEER"",""pos"":{""lineNum"":6,""columnNum"":22,""endLineNum"":6,""endColumnNum"":27,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@35d3ab60"",""value"":""NS_IDENT@215a34b4.BEER"",""pos"":{""lineNum"":4,""columnNum"":25,""endLineNum"":4,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@71870da7"",""value"":""NS_IDENT@215a34b4.BAR"",""pos"":{""lineNum"":4,""columnNum"":33,""endLineNum"":4,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@45792847"",""value"":""NS_IDENT@215a34b4.PRICE"",""pos"":{""lineNum"":4,""columnNum"":40,""endLineNum"":4,""endColumnNum"":46,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@55cff952"",""value"":""NS_IDENT@215a34b4.beer"",""pos"":{""lineNum"":6,""columnNum"":13,""endLineNum"":6,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@660591fb"",""value"":""NS_IDENT@77bd7fe7.BEER"",""pos"":{""lineNum"":6,""columnNum"":22,""endLineNum"":6,""endColumnNum"":27,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":4,""columnNum"":18,""endLineNum"":6,""endColumnNum"":27,""quoted"":false},""children"":{}}]}
"
"Select A.beer, A.bar
From serves as A, 
(select distinct beer 
from likes
where drinker = 'Dan') AS B 
Where A.beer = B.beer and A.price >= ALL(select price from serves where beer = A.beer)
","{""blocks"":{""id"":""BLOCK_SELECT@19593091"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@55ecbafe"",""value"":""NS_IDENT@35ff8fc9.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@37c2eacb"",""value"":""NS_IDENT@35ff8fc9.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@35ff8fc9"",""NS_SELECT@16c8b7bd""],""fromNode"":{""id"":""OP_JOIN@21f9277b"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":17,""endLineNum"":2,""endColumnNum"":17,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@5d58c727"",""value"":""NS_IDENT@35ff8fc9"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@52a36910"",""value"":""BLOCK_SELECT@52a36910"",""pos"":{""lineNum"":3,""columnNum"":2,""endLineNum"":5,""endColumnNum"":21,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@3c0fbd3a"",""value"":""AND"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":85,""quoted"":false},""children"":[{""id"":""OP_BINARY@5e268ce6"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4074023c"",""value"":""NS_IDENT@35ff8fc9.beer"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3ed0918d"",""value"":""NS_SELECT@16c8b7bd.BEER"",""pos"":{""lineNum"":6,""columnNum"":16,""endLineNum"":6,""endColumnNum"":21,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@6e91893"",""value"":"">= ALL"",""pos"":{""lineNum"":6,""columnNum"":27,""endLineNum"":6,""endColumnNum"":85,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@66ec9390"",""value"":""NS_IDENT@35ff8fc9.price"",""pos"":{""lineNum"":6,""columnNum"":27,""endLineNum"":6,""endColumnNum"":33,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@7fedfe27"",""value"":""BLOCK_SELECT@7fedfe27"",""pos"":{""lineNum"":6,""columnNum"":42,""endLineNum"":6,""endColumnNum"":85,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@37c2eacb"",""value"":""NS_IDENT@35ff8fc9.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3ed0918d"",""value"":""NS_SELECT@16c8b7bd.BEER"",""pos"":{""lineNum"":6,""columnNum"":16,""endLineNum"":6,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@55ecbafe"",""value"":""NS_IDENT@35ff8fc9.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4074023c"",""value"":""NS_IDENT@35ff8fc9.beer"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@66ec9390"",""value"":""NS_IDENT@35ff8fc9.price"",""pos"":{""lineNum"":6,""columnNum"":27,""endLineNum"":6,""endColumnNum"":33,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@35ff8fc9.beer""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":6,""endColumnNum"":86,""quoted"":false},""children"":{""BLOCK_SELECT@52a36910"":{""id"":""BLOCK_SELECT@52a36910"",""parentId"":""BLOCK_SELECT@19593091"",""alias"":""B"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":true,""selectList"":[{""id"":""COLUMN_LOCAL@3db64bd4"",""value"":""NS_IDENT@7159139f.BEER"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":21,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@7159139f""],""fromNode"":{""id"":""JOIN_OPERAND@3a095ec0"",""value"":""NS_IDENT@7159139f"",""pos"":{""lineNum"":4,""columnNum"":6,""endLineNum"":4,""endColumnNum"":10,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@5af97169"",""value"":""="",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":5,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@e4d2696"",""value"":""NS_IDENT@7159139f.drinker"",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":5,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@121c54fa"",""value"":""'Dan'"",""pos"":{""lineNum"":5,""columnNum"":17,""endLineNum"":5,""endColumnNum"":21,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@3db64bd4"",""value"":""NS_IDENT@7159139f.BEER"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@e4d2696"",""value"":""NS_IDENT@7159139f.drinker"",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":5,""endColumnNum"":13,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":2,""endLineNum"":5,""endColumnNum"":21,""quoted"":false},""children"":{}},""BLOCK_SELECT@7fedfe27"":{""id"":""BLOCK_SELECT@7fedfe27"",""parentId"":""BLOCK_SELECT@19593091"",""fields"":[""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@1a35993f"",""value"":""NS_IDENT@15bc339.PRICE"",""pos"":{""lineNum"":6,""columnNum"":49,""endLineNum"":6,""endColumnNum"":53,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@15bc339""],""fromNode"":{""id"":""JOIN_OPERAND@47b2e9e1"",""value"":""NS_IDENT@15bc339"",""pos"":{""lineNum"":6,""columnNum"":60,""endLineNum"":6,""endColumnNum"":65,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@2b4786dd"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":73,""endLineNum"":6,""endColumnNum"":85,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@63718b93"",""value"":""NS_IDENT@15bc339.beer"",""pos"":{""lineNum"":6,""columnNum"":73,""endLineNum"":6,""endColumnNum"":76,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@14e2e1c3"",""value"":""NS_IDENT@35ff8fc9.beer"",""pos"":{""lineNum"":6,""columnNum"":80,""endLineNum"":6,""endColumnNum"":85,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_CORRELATE@14e2e1c3"",""value"":""NS_IDENT@35ff8fc9.beer"",""pos"":{""lineNum"":6,""columnNum"":80,""endLineNum"":6,""endColumnNum"":85,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1a35993f"",""value"":""NS_IDENT@15bc339.PRICE"",""pos"":{""lineNum"":6,""columnNum"":49,""endLineNum"":6,""endColumnNum"":53,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@63718b93"",""value"":""NS_IDENT@15bc339.beer"",""pos"":{""lineNum"":6,""columnNum"":73,""endLineNum"":6,""endColumnNum"":76,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@35ff8fc9""],""corrCtxIds"":[""BLOCK_SELECT@19593091""],""pos"":{""lineNum"":6,""columnNum"":42,""endLineNum"":6,""endColumnNum"":85,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@7159139f"":{""tableId"":""NS_IDENT@7159139f"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":6,""endLineNum"":4,""endColumnNum"":10,""quoted"":false}},""NS_IDENT@15bc339"":{""tableId"":""NS_IDENT@15bc339"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":60,""endLineNum"":6,""endColumnNum"":65,""quoted"":false}},""NS_IDENT@35ff8fc9"":{""tableId"":""NS_IDENT@35ff8fc9"",""identifier"":""A"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":16,""quoted"":false}},""NS_SELECT@16c8b7bd"":{""tableId"":""NS_SELECT@16c8b7bd"",""identifier"":""B"",""blockId"":""BLOCK_SELECT@52a36910"",""fields"":[""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":2,""endLineNum"":5,""endColumnNum"":27,""quoted"":false}}},""corrTables"":[""NS_IDENT@35ff8fc9""]}
"
"SELECT likes.beer, bar 
FROM likes JOIN 
(SELECT bar, serves.beer, price, prices.maximum
FROM serves
RIGHT JOIN (SELECT max(price) as maximum, beer
FROM serves
GROUP BY beer) AS prices
ON serves.beer = prices.beer
WHERE price = prices.maximum) AS bar_maxes
ON bar_maxes.beer = likes.beer
WHERE drinker = 'Dan'
","{""blocks"":{""id"":""BLOCK_SELECT@2b9b7f1f"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@2b8bd14b"",""value"":""NS_IDENT@4e25147a.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5f303ecd"",""value"":""NS_SELECT@30506c0d.BAR"",""pos"":{""lineNum"":1,""columnNum"":20,""endLineNum"":1,""endColumnNum"":22,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@4e25147a"",""NS_SELECT@30506c0d""],""fromNode"":{""id"":""OP_JOIN@5c20ffa8"",""value"":""INNER"",""pos"":{""lineNum"":2,""columnNum"":12,""endLineNum"":2,""endColumnNum"":15,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@59712875"",""value"":""NS_IDENT@4e25147a"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@25b865b5"",""value"":""BLOCK_SELECT@25b865b5"",""pos"":{""lineNum"":3,""columnNum"":2,""endLineNum"":9,""endColumnNum"":28,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@6093d508"",""value"":""="",""pos"":{""lineNum"":10,""columnNum"":4,""endLineNum"":10,""endColumnNum"":30,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@29f0c4f2"",""value"":""NS_SELECT@30506c0d.BEER"",""pos"":{""lineNum"":10,""columnNum"":4,""endLineNum"":10,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7435a578"",""value"":""NS_IDENT@4e25147a.beer"",""pos"":{""lineNum"":10,""columnNum"":21,""endLineNum"":10,""endColumnNum"":30,""quoted"":false},""children"":[]}]}},""whereNode"":{""id"":""OP_BINARY@3c7cfcbb"",""value"":""="",""pos"":{""lineNum"":11,""columnNum"":7,""endLineNum"":11,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@13047d7d"",""value"":""NS_IDENT@4e25147a.drinker"",""pos"":{""lineNum"":11,""columnNum"":7,""endLineNum"":11,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@65bb9029"",""value"":""'Dan'"",""pos"":{""lineNum"":11,""columnNum"":17,""endLineNum"":11,""endColumnNum"":21,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@2b8bd14b"",""value"":""NS_IDENT@4e25147a.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7435a578"",""value"":""NS_IDENT@4e25147a.beer"",""pos"":{""lineNum"":10,""columnNum"":21,""endLineNum"":10,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@29f0c4f2"",""value"":""NS_SELECT@30506c0d.BEER"",""pos"":{""lineNum"":10,""columnNum"":4,""endLineNum"":10,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@13047d7d"",""value"":""NS_IDENT@4e25147a.drinker"",""pos"":{""lineNum"":11,""columnNum"":7,""endLineNum"":11,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5f303ecd"",""value"":""NS_SELECT@30506c0d.BAR"",""pos"":{""lineNum"":1,""columnNum"":20,""endLineNum"":1,""endColumnNum"":22,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":11,""endColumnNum"":21,""quoted"":false},""children"":{""BLOCK_SELECT@25b865b5"":{""id"":""BLOCK_SELECT@25b865b5"",""parentId"":""BLOCK_SELECT@2b9b7f1f"",""alias"":""BAR_MAXES"",""fields"":[""BAR VARCHAR(100)"",""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)"",""MAXIMUM DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@c81fd12"",""value"":""NS_IDENT@1dcca8d3.BAR"",""pos"":{""lineNum"":3,""columnNum"":9,""endLineNum"":3,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5754de72"",""value"":""NS_IDENT@1dcca8d3.BEER"",""pos"":{""lineNum"":3,""columnNum"":14,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@320494b6"",""value"":""NS_IDENT@1dcca8d3.PRICE"",""pos"":{""lineNum"":3,""columnNum"":27,""endLineNum"":3,""endColumnNum"":31,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@bdc8014"",""value"":""NS_SELECT@5631962.MAXIMUM"",""pos"":{""lineNum"":3,""columnNum"":34,""endLineNum"":3,""endColumnNum"":47,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@1dcca8d3"",""NS_SELECT@5631962""],""fromNode"":{""id"":""OP_JOIN@f9b5552"",""value"":""RIGHT"",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":5,""endColumnNum"":10,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@6872f9c8"",""value"":""NS_IDENT@1dcca8d3"",""pos"":{""lineNum"":4,""columnNum"":6,""endLineNum"":4,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@6d2d99fc"",""value"":""BLOCK_SELECT@6d2d99fc"",""pos"":{""lineNum"":5,""columnNum"":13,""endLineNum"":7,""endColumnNum"":13,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@1603dc2f"",""value"":""="",""pos"":{""lineNum"":8,""columnNum"":4,""endLineNum"":8,""endColumnNum"":28,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@37fdfb05"",""value"":""NS_IDENT@1dcca8d3.beer"",""pos"":{""lineNum"":8,""columnNum"":4,""endLineNum"":8,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5e39850"",""value"":""NS_SELECT@5631962.BEER"",""pos"":{""lineNum"":8,""columnNum"":18,""endLineNum"":8,""endColumnNum"":28,""quoted"":false},""children"":[]}]}},""whereNode"":{""id"":""OP_BINARY@a64e035"",""value"":""="",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":28,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_IDENT@1dcca8d3.price"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7fab4be7"",""value"":""NS_SELECT@5631962.MAXIMUM"",""pos"":{""lineNum"":9,""columnNum"":15,""endLineNum"":9,""endColumnNum"":28,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@320494b6"",""value"":""NS_IDENT@1dcca8d3.PRICE"",""pos"":{""lineNum"":3,""columnNum"":27,""endLineNum"":3,""endColumnNum"":31,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7fab4be7"",""value"":""NS_SELECT@5631962.MAXIMUM"",""pos"":{""lineNum"":9,""columnNum"":15,""endLineNum"":9,""endColumnNum"":28,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@37fdfb05"",""value"":""NS_IDENT@1dcca8d3.beer"",""pos"":{""lineNum"":8,""columnNum"":4,""endLineNum"":8,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@c81fd12"",""value"":""NS_IDENT@1dcca8d3.BAR"",""pos"":{""lineNum"":3,""columnNum"":9,""endLineNum"":3,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5754de72"",""value"":""NS_IDENT@1dcca8d3.BEER"",""pos"":{""lineNum"":3,""columnNum"":14,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@bdc8014"",""value"":""NS_SELECT@5631962.MAXIMUM"",""pos"":{""lineNum"":3,""columnNum"":34,""endLineNum"":3,""endColumnNum"":47,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_IDENT@1dcca8d3.price"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5e39850"",""value"":""NS_SELECT@5631962.BEER"",""pos"":{""lineNum"":8,""columnNum"":18,""endLineNum"":8,""endColumnNum"":28,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":2,""endLineNum"":9,""endColumnNum"":28,""quoted"":false},""children"":{""BLOCK_SELECT@6d2d99fc"":{""id"":""BLOCK_SELECT@6d2d99fc"",""parentId"":""BLOCK_SELECT@25b865b5"",""alias"":""PRICES"",""fields"":[""MAXIMUM DECIMAL(5, 2)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""OP_AGG_FUNC@19569ebd"",""value"":""MAX"",""pos"":{""lineNum"":5,""columnNum"":20,""endLineNum"":5,""endColumnNum"":29,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4632cfc"",""value"":""NS_IDENT@52a70627.PRICE"",""pos"":{""lineNum"":5,""columnNum"":24,""endLineNum"":5,""endColumnNum"":28,""quoted"":false},""children"":[]}],""alias"":""MAXIMUM""},{""id"":""COLUMN_LOCAL@2e380628"",""value"":""NS_IDENT@52a70627.BEER"",""pos"":{""lineNum"":5,""columnNum"":43,""endLineNum"":5,""endColumnNum"":46,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@52a70627""],""fromNode"":{""id"":""JOIN_OPERAND@bdecc21"",""value"":""NS_IDENT@52a70627"",""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":11,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@4c98a6d5"",""value"":""NS_IDENT@52a70627.beer"",""pos"":{""lineNum"":7,""columnNum"":10,""endLineNum"":7,""endColumnNum"":13,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@2e380628"",""value"":""NS_IDENT@52a70627.BEER"",""pos"":{""lineNum"":5,""columnNum"":43,""endLineNum"":5,""endColumnNum"":46,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4632cfc"",""value"":""NS_IDENT@52a70627.PRICE"",""pos"":{""lineNum"":5,""columnNum"":24,""endLineNum"":5,""endColumnNum"":28,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4c98a6d5"",""value"":""NS_IDENT@52a70627.beer"",""pos"":{""lineNum"":7,""columnNum"":10,""endLineNum"":7,""endColumnNum"":13,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":5,""columnNum"":13,""endLineNum"":7,""endColumnNum"":13,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@1dcca8d3"":{""tableId"":""NS_IDENT@1dcca8d3"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":6,""endLineNum"":4,""endColumnNum"":11,""quoted"":false}},""NS_IDENT@4e25147a"":{""tableId"":""NS_IDENT@4e25147a"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":10,""quoted"":false}},""NS_IDENT@52a70627"":{""tableId"":""NS_IDENT@52a70627"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":11,""quoted"":false}},""NS_SELECT@30506c0d"":{""tableId"":""NS_SELECT@30506c0d"",""identifier"":""BAR_MAXES"",""blockId"":""BLOCK_SELECT@25b865b5"",""fields"":[""BAR VARCHAR(100)"",""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)"",""MAXIMUM DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":2,""endLineNum"":9,""endColumnNum"":42,""quoted"":false}},""NS_SELECT@5631962"":{""tableId"":""NS_SELECT@5631962"",""identifier"":""PRICES"",""blockId"":""BLOCK_SELECT@6d2d99fc"",""fields"":[""MAXIMUM DECIMAL(5, 2)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":13,""endLineNum"":7,""endColumnNum"":24,""quoted"":false}}},""corrTables"":[]}
"
"WITH BeerMax AS 
  (SELECT beer, MAX(price) 
  FROM serves 
  GROUP BY beer)
SELECT S1.beer, S1.bar
FROM serves S1, likes L, BeerMax B
WHERE S1.beer = B.beer AND S1.price = B.max AND S1.beer = L.beer AND L.drinker = 'Dan';","{""failed"":true,""errorMsg"":""Parsing error at line 7, column 40. Query syntax may be incorrect""}
"
"Select B.beer as beer, bar from (Select beer from likes where drinker='Dan') as B, ((select beer, bar from serves) except (select s1.beer as beer, s1.bar as bar from serves as s1, serves as s2 where s1.beer=s2.beer and s1.price<s2.price)) as C where B.beer = C.beer","{""failed"":true}
"
"SELECT S.beer, S.bar FROM Serves S, (SELECT beer, MAX(price) as price FROM serves GROUP BY(beer) HAVING beer IN (SELECT beer from likes WHERE drinker = 'Dan')) as T WHERE S.beer = T.beer AND  T.price = S.price","{""blocks"":{""id"":""BLOCK_SELECT@2b9b7f1f"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@770b3be0"",""value"":""NS_IDENT@52a70627.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@51dbd6e4"",""value"":""NS_IDENT@52a70627.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@52a70627"",""NS_SELECT@6e1f8469""],""fromNode"":{""id"":""OP_JOIN@5c20ffa8"",""value"":""COMMA"",""pos"":{""lineNum"":1,""columnNum"":35,""endLineNum"":1,""endColumnNum"":35,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@6bcbf05b"",""value"":""NS_IDENT@52a70627"",""pos"":{""lineNum"":1,""columnNum"":27,""endLineNum"":1,""endColumnNum"":32,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@59942b48"",""value"":""BLOCK_SELECT@59942b48"",""pos"":{""lineNum"":1,""columnNum"":38,""endLineNum"":1,""endColumnNum"":158,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@250b236d"",""value"":""AND"",""pos"":{""lineNum"":1,""columnNum"":172,""endLineNum"":1,""endColumnNum"":209,""quoted"":false},""children"":[{""id"":""OP_BINARY@23e44287"",""value"":""="",""pos"":{""lineNum"":1,""columnNum"":172,""endLineNum"":1,""endColumnNum"":186,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@70e3f36f"",""value"":""NS_IDENT@52a70627.beer"",""pos"":{""lineNum"":1,""columnNum"":172,""endLineNum"":1,""endColumnNum"":177,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@49601f82"",""value"":""NS_SELECT@6e1f8469.BEER"",""pos"":{""lineNum"":1,""columnNum"":181,""endLineNum"":1,""endColumnNum"":186,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@24fabd0f"",""value"":""="",""pos"":{""lineNum"":1,""columnNum"":193,""endLineNum"":1,""endColumnNum"":209,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@2b8d084"",""value"":""NS_SELECT@6e1f8469.PRICE"",""pos"":{""lineNum"":1,""columnNum"":193,""endLineNum"":1,""endColumnNum"":199,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6daf2337"",""value"":""NS_IDENT@52a70627.price"",""pos"":{""lineNum"":1,""columnNum"":203,""endLineNum"":1,""endColumnNum"":209,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@51dbd6e4"",""value"":""NS_IDENT@52a70627.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@70e3f36f"",""value"":""NS_IDENT@52a70627.beer"",""pos"":{""lineNum"":1,""columnNum"":172,""endLineNum"":1,""endColumnNum"":177,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6daf2337"",""value"":""NS_IDENT@52a70627.price"",""pos"":{""lineNum"":1,""columnNum"":203,""endLineNum"":1,""endColumnNum"":209,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@770b3be0"",""value"":""NS_IDENT@52a70627.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2b8d084"",""value"":""NS_SELECT@6e1f8469.PRICE"",""pos"":{""lineNum"":1,""columnNum"":193,""endLineNum"":1,""endColumnNum"":199,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@49601f82"",""value"":""NS_SELECT@6e1f8469.BEER"",""pos"":{""lineNum"":1,""columnNum"":181,""endLineNum"":1,""endColumnNum"":186,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":1,""endColumnNum"":209,""quoted"":false},""children"":{""BLOCK_SELECT@59942b48"":{""id"":""BLOCK_SELECT@59942b48"",""parentId"":""BLOCK_SELECT@2b9b7f1f"",""alias"":""T"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@1eaf1e62"",""value"":""NS_IDENT@2e380628.BEER"",""pos"":{""lineNum"":1,""columnNum"":45,""endLineNum"":1,""endColumnNum"":48,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@62e6a3ec"",""value"":""MAX"",""pos"":{""lineNum"":1,""columnNum"":51,""endLineNum"":1,""endColumnNum"":60,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5754de72"",""value"":""NS_IDENT@2e380628.PRICE"",""pos"":{""lineNum"":1,""columnNum"":55,""endLineNum"":1,""endColumnNum"":59,""quoted"":false},""children"":[]}],""alias"":""PRICE""}],""fromItemIds"":[""NS_IDENT@2e380628""],""fromNode"":{""id"":""JOIN_OPERAND@f9b5552"",""value"":""NS_IDENT@2e380628"",""pos"":{""lineNum"":1,""columnNum"":76,""endLineNum"":1,""endColumnNum"":81,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@4c98a6d5"",""value"":""NS_IDENT@2e380628.beer"",""pos"":{""lineNum"":1,""columnNum"":92,""endLineNum"":1,""endColumnNum"":95,""quoted"":false},""children"":[]}],""havingNode"":{""id"":""OP_BINARY@1a5f7e7c"",""value"":""IN"",""pos"":{""lineNum"":1,""columnNum"":105,""endLineNum"":1,""endColumnNum"":157,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5b22b970"",""value"":""NS_IDENT@2e380628.beer"",""pos"":{""lineNum"":1,""columnNum"":105,""endLineNum"":1,""endColumnNum"":108,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@22fba58c"",""value"":""BLOCK_SELECT@22fba58c"",""pos"":{""lineNum"":1,""columnNum"":114,""endLineNum"":1,""endColumnNum"":157,""quoted"":false},""children"":[]}]},""identifiers"":[{""id"":""COLUMN_LOCAL@4c98a6d5"",""value"":""NS_IDENT@2e380628.beer"",""pos"":{""lineNum"":1,""columnNum"":92,""endLineNum"":1,""endColumnNum"":95,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1eaf1e62"",""value"":""NS_IDENT@2e380628.BEER"",""pos"":{""lineNum"":1,""columnNum"":45,""endLineNum"":1,""endColumnNum"":48,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5b22b970"",""value"":""NS_IDENT@2e380628.beer"",""pos"":{""lineNum"":1,""columnNum"":105,""endLineNum"":1,""endColumnNum"":108,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5754de72"",""value"":""NS_IDENT@2e380628.PRICE"",""pos"":{""lineNum"":1,""columnNum"":55,""endLineNum"":1,""endColumnNum"":59,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":38,""endLineNum"":1,""endColumnNum"":158,""quoted"":false},""children"":{""BLOCK_SELECT@22fba58c"":{""id"":""BLOCK_SELECT@22fba58c"",""parentId"":""BLOCK_SELECT@59942b48"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@529cfee5"",""value"":""NS_IDENT@14fc5d40.BEER"",""pos"":{""lineNum"":1,""columnNum"":121,""endLineNum"":1,""endColumnNum"":124,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@14fc5d40""],""fromNode"":{""id"":""JOIN_OPERAND@7e8a46b7"",""value"":""NS_IDENT@14fc5d40"",""pos"":{""lineNum"":1,""columnNum"":131,""endLineNum"":1,""endColumnNum"":135,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@773dab28"",""value"":""="",""pos"":{""lineNum"":1,""columnNum"":143,""endLineNum"":1,""endColumnNum"":157,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@af78c87"",""value"":""NS_IDENT@14fc5d40.drinker"",""pos"":{""lineNum"":1,""columnNum"":143,""endLineNum"":1,""endColumnNum"":149,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@415156bf"",""value"":""'Dan'"",""pos"":{""lineNum"":1,""columnNum"":153,""endLineNum"":1,""endColumnNum"":157,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@af78c87"",""value"":""NS_IDENT@14fc5d40.drinker"",""pos"":{""lineNum"":1,""columnNum"":143,""endLineNum"":1,""endColumnNum"":149,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@529cfee5"",""value"":""NS_IDENT@14fc5d40.BEER"",""pos"":{""lineNum"":1,""columnNum"":121,""endLineNum"":1,""endColumnNum"":124,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":114,""endLineNum"":1,""endColumnNum"":157,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@2e380628"":{""tableId"":""NS_IDENT@2e380628"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":76,""endLineNum"":1,""endColumnNum"":81,""quoted"":false}},""NS_IDENT@14fc5d40"":{""tableId"":""NS_IDENT@14fc5d40"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":131,""endLineNum"":1,""endColumnNum"":135,""quoted"":false}},""NS_IDENT@52a70627"":{""tableId"":""NS_IDENT@52a70627"",""identifier"":""S"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":27,""endLineNum"":1,""endColumnNum"":34,""quoted"":false}},""NS_SELECT@6e1f8469"":{""tableId"":""NS_SELECT@6e1f8469"",""identifier"":""T"",""blockId"":""BLOCK_SELECT@59942b48"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":38,""endLineNum"":1,""endColumnNum"":164,""quoted"":false}}},""corrTables"":[]}
"
"with danbeers as (select likes.beer from likes where likes.drinker = 'Dan'),
  maxes as (select serves.beer, max(price) as price from serves where serves.beer in (select danbeers.beer from danbeers) group by serves.beer)
select maxes.beer, serves.bar
from danbeers, maxes, serves
where maxes.beer = danbeers.beer and serves.beer = maxes.beer and serves.price = maxes.price;","{""blocks"":{""id"":""BLOCK_SELECT@43cf6ea3"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@4e25147a"",""value"":""NS_IDENT@26f96b85.BEER"",""pos"":{""lineNum"":3,""columnNum"":8,""endLineNum"":3,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@17814b1c"",""value"":""NS_IDENT@46d8f407.BAR"",""pos"":{""lineNum"":3,""columnNum"":20,""endLineNum"":3,""endColumnNum"":29,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@58399d82"",""NS_IDENT@26f96b85"",""NS_IDENT@46d8f407""],""fromNode"":{""id"":""OP_JOIN@68809cc7"",""value"":""COMMA"",""pos"":{""lineNum"":4,""columnNum"":21,""endLineNum"":4,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""OP_JOIN@703feacd"",""value"":""COMMA"",""pos"":{""lineNum"":4,""columnNum"":14,""endLineNum"":4,""endColumnNum"":14,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@7051777c"",""value"":""NS_IDENT@58399d82"",""pos"":{""lineNum"":4,""columnNum"":6,""endLineNum"":4,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@3241713e"",""value"":""NS_IDENT@26f96b85"",""pos"":{""lineNum"":4,""columnNum"":16,""endLineNum"":4,""endColumnNum"":20,""quoted"":false},""children"":[]}],""natural"":false},{""id"":""JOIN_OPERAND@13cd7ea5"",""value"":""NS_IDENT@46d8f407"",""pos"":{""lineNum"":4,""columnNum"":23,""endLineNum"":4,""endColumnNum"":28,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@706cb08"",""value"":""AND"",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":5,""endColumnNum"":92,""quoted"":false},""children"":[{""id"":""OP_BINARY@10876a6"",""value"":""AND"",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":5,""endColumnNum"":61,""quoted"":false},""children"":[{""id"":""OP_BINARY@5bcde458"",""value"":""="",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":5,""endColumnNum"":32,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7c455e96"",""value"":""NS_IDENT@26f96b85.BEER"",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":5,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@985696"",""value"":""NS_IDENT@58399d82.BEER"",""pos"":{""lineNum"":5,""columnNum"":20,""endLineNum"":5,""endColumnNum"":32,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@35d3ab60"",""value"":""="",""pos"":{""lineNum"":5,""columnNum"":38,""endLineNum"":5,""endColumnNum"":61,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@215a34b4"",""value"":""NS_IDENT@46d8f407.beer"",""pos"":{""lineNum"":5,""columnNum"":38,""endLineNum"":5,""endColumnNum"":48,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@77bd7fe7"",""value"":""NS_IDENT@26f96b85.BEER"",""pos"":{""lineNum"":5,""columnNum"":52,""endLineNum"":5,""endColumnNum"":61,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@45792847"",""value"":""="",""pos"":{""lineNum"":5,""columnNum"":67,""endLineNum"":5,""endColumnNum"":92,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@71870da7"",""value"":""NS_IDENT@46d8f407.price"",""pos"":{""lineNum"":5,""columnNum"":67,""endLineNum"":5,""endColumnNum"":78,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6dd91637"",""value"":""NS_IDENT@26f96b85.PRICE"",""pos"":{""lineNum"":5,""columnNum"":82,""endLineNum"":5,""endColumnNum"":92,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@17814b1c"",""value"":""NS_IDENT@46d8f407.BAR"",""pos"":{""lineNum"":3,""columnNum"":20,""endLineNum"":3,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@985696"",""value"":""NS_IDENT@58399d82.BEER"",""pos"":{""lineNum"":5,""columnNum"":20,""endLineNum"":5,""endColumnNum"":32,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7c455e96"",""value"":""NS_IDENT@26f96b85.BEER"",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":5,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@215a34b4"",""value"":""NS_IDENT@46d8f407.beer"",""pos"":{""lineNum"":5,""columnNum"":38,""endLineNum"":5,""endColumnNum"":48,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@71870da7"",""value"":""NS_IDENT@46d8f407.price"",""pos"":{""lineNum"":5,""columnNum"":67,""endLineNum"":5,""endColumnNum"":78,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4e25147a"",""value"":""NS_IDENT@26f96b85.BEER"",""pos"":{""lineNum"":3,""columnNum"":8,""endLineNum"":3,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6dd91637"",""value"":""NS_IDENT@26f96b85.PRICE"",""pos"":{""lineNum"":5,""columnNum"":82,""endLineNum"":5,""endColumnNum"":92,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@77bd7fe7"",""value"":""NS_IDENT@26f96b85.BEER"",""pos"":{""lineNum"":5,""columnNum"":52,""endLineNum"":5,""endColumnNum"":61,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":1,""endLineNum"":5,""endColumnNum"":92,""quoted"":false},""children"":{}},""tables"":{""NS_IDENT@771db12c"":{""tableId"":""NS_IDENT@771db12c"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":58,""endLineNum"":2,""endColumnNum"":63,""quoted"":false}},""NS_IDENT@58399d82"":{""tableId"":""NS_IDENT@58399d82"",""identifier"":""DANBEERS"",""dbTableName"":""DANBEERS"",""fields"":[""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":6,""endLineNum"":4,""endColumnNum"":13,""quoted"":false}},""NS_IDENT@46d8f407"":{""tableId"":""NS_IDENT@46d8f407"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":23,""endLineNum"":4,""endColumnNum"":28,""quoted"":false}},""NS_IDENT@1eb6e1c"":{""tableId"":""NS_IDENT@1eb6e1c"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":42,""endLineNum"":1,""endColumnNum"":46,""quoted"":false}},""NS_IDENT@26f96b85"":{""tableId"":""NS_IDENT@26f96b85"",""identifier"":""MAXES"",""dbTableName"":""MAXES"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":16,""endLineNum"":4,""endColumnNum"":20,""quoted"":false}},""NS_IDENT@5c645b43"":{""tableId"":""NS_IDENT@5c645b43"",""identifier"":""DANBEERS"",""dbTableName"":""DANBEERS"",""fields"":[""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":113,""endLineNum"":2,""endColumnNum"":120,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@2d66530f"",""alias"":""DANBEERS"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@50d3bf39"",""value"":""NS_IDENT@1eb6e1c.BEER"",""pos"":{""lineNum"":1,""columnNum"":26,""endLineNum"":1,""endColumnNum"":35,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@1eb6e1c""],""fromNode"":{""id"":""JOIN_OPERAND@6d2d99fc"",""value"":""NS_IDENT@1eb6e1c"",""pos"":{""lineNum"":1,""columnNum"":42,""endLineNum"":1,""endColumnNum"":46,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@30331109"",""value"":""="",""pos"":{""lineNum"":1,""columnNum"":54,""endLineNum"":1,""endColumnNum"":74,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@878537d"",""value"":""NS_IDENT@1eb6e1c.drinker"",""pos"":{""lineNum"":1,""columnNum"":54,""endLineNum"":1,""endColumnNum"":66,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@40ee0a22"",""value"":""'Dan'"",""pos"":{""lineNum"":1,""columnNum"":70,""endLineNum"":1,""endColumnNum"":74,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@878537d"",""value"":""NS_IDENT@1eb6e1c.drinker"",""pos"":{""lineNum"":1,""columnNum"":54,""endLineNum"":1,""endColumnNum"":66,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@50d3bf39"",""value"":""NS_IDENT@1eb6e1c.BEER"",""pos"":{""lineNum"":1,""columnNum"":26,""endLineNum"":1,""endColumnNum"":35,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":19,""endLineNum"":1,""endColumnNum"":74,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@7e8a46b7"",""alias"":""MAXES"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@3afae281"",""value"":""NS_IDENT@771db12c.BEER"",""pos"":{""lineNum"":2,""columnNum"":20,""endLineNum"":2,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@260f2144"",""value"":""MAX"",""pos"":{""lineNum"":2,""columnNum"":33,""endLineNum"":2,""endColumnNum"":42,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@3c017078"",""value"":""NS_IDENT@771db12c.PRICE"",""pos"":{""lineNum"":2,""columnNum"":37,""endLineNum"":2,""endColumnNum"":41,""quoted"":false},""children"":[]}],""alias"":""PRICE""}],""fromItemIds"":[""NS_IDENT@771db12c""],""fromNode"":{""id"":""JOIN_OPERAND@66bfd864"",""value"":""NS_IDENT@771db12c"",""pos"":{""lineNum"":2,""columnNum"":58,""endLineNum"":2,""endColumnNum"":63,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@1ecfcbc9"",""value"":""IN"",""pos"":{""lineNum"":2,""columnNum"":71,""endLineNum"":2,""endColumnNum"":120,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@773dab28"",""value"":""NS_IDENT@771db12c.beer"",""pos"":{""lineNum"":2,""columnNum"":71,""endLineNum"":2,""endColumnNum"":81,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@2fe88a09"",""value"":""BLOCK_SELECT@2fe88a09"",""pos"":{""lineNum"":2,""columnNum"":87,""endLineNum"":2,""endColumnNum"":120,""quoted"":false},""children"":[]}]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@4912d525"",""value"":""NS_IDENT@771db12c.beer"",""pos"":{""lineNum"":2,""columnNum"":132,""endLineNum"":2,""endColumnNum"":142,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@3c017078"",""value"":""NS_IDENT@771db12c.PRICE"",""pos"":{""lineNum"":2,""columnNum"":37,""endLineNum"":2,""endColumnNum"":41,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3afae281"",""value"":""NS_IDENT@771db12c.BEER"",""pos"":{""lineNum"":2,""columnNum"":20,""endLineNum"":2,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4912d525"",""value"":""NS_IDENT@771db12c.beer"",""pos"":{""lineNum"":2,""columnNum"":132,""endLineNum"":2,""endColumnNum"":142,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@773dab28"",""value"":""NS_IDENT@771db12c.beer"",""pos"":{""lineNum"":2,""columnNum"":71,""endLineNum"":2,""endColumnNum"":81,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":13,""endLineNum"":2,""endColumnNum"":142,""quoted"":false},""children"":{""BLOCK_SELECT@2fe88a09"":{""id"":""BLOCK_SELECT@2fe88a09"",""parentId"":""BLOCK_SELECT@7e8a46b7"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@353efdbf"",""value"":""NS_IDENT@5c645b43.BEER"",""pos"":{""lineNum"":2,""columnNum"":94,""endLineNum"":2,""endColumnNum"":106,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@5c645b43""],""fromNode"":{""id"":""JOIN_OPERAND@1917d90f"",""value"":""NS_IDENT@5c645b43"",""pos"":{""lineNum"":2,""columnNum"":113,""endLineNum"":2,""endColumnNum"":120,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@353efdbf"",""value"":""NS_IDENT@5c645b43.BEER"",""pos"":{""lineNum"":2,""columnNum"":94,""endLineNum"":2,""endColumnNum"":106,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":87,""endLineNum"":2,""endColumnNum"":120,""quoted"":false},""children"":{}}}}]}
"
"SELECT beer, bar
FROM serves
WHERE (beer, price) IN (SELECT DISTINCT beer, max(price)
FROM serves
WHERE beer IN (SELECT DISTINCT beer
FROM likes
WHERE drinker = 'Dan')
GROUP BY beer);
","{""failed"":true}
"
"SELECT S.beer, S.bar 
FROM Serves S, (
        SELECT beer, MAX(price) as price 
        FROM serves 
        GROUP BY beer
        HAVING beer IN (
            SELECT beer 
            FROM likes 
            WHERE drinker = 'Dan')
    ) as T 
WHERE S.beer = T.beer AND T.price = S.price","{""blocks"":{""id"":""BLOCK_SELECT@61d01788"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@47d7bfb3"",""value"":""NS_IDENT@5631962.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1eb6e1c"",""value"":""NS_IDENT@5631962.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@5631962"",""NS_SELECT@4632cfc""],""fromNode"":{""id"":""OP_JOIN@4bff2185"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":14,""endLineNum"":2,""endColumnNum"":14,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@458544e0"",""value"":""NS_IDENT@5631962"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@47b2e9e1"",""value"":""BLOCK_SELECT@47b2e9e1"",""pos"":{""lineNum"":3,""columnNum"":9,""endLineNum"":9,""endColumnNum"":34,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@24fabd0f"",""value"":""AND"",""pos"":{""lineNum"":11,""columnNum"":7,""endLineNum"":11,""endColumnNum"":43,""quoted"":false},""children"":[{""id"":""OP_BINARY@49601f82"",""value"":""="",""pos"":{""lineNum"":11,""columnNum"":7,""endLineNum"":11,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@2b214b94"",""value"":""NS_IDENT@5631962.beer"",""pos"":{""lineNum"":11,""columnNum"":7,""endLineNum"":11,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@70e3f36f"",""value"":""NS_SELECT@4632cfc.BEER"",""pos"":{""lineNum"":11,""columnNum"":16,""endLineNum"":11,""endColumnNum"":21,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@6daf2337"",""value"":""="",""pos"":{""lineNum"":11,""columnNum"":27,""endLineNum"":11,""endColumnNum"":43,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@23e44287"",""value"":""NS_SELECT@4632cfc.PRICE"",""pos"":{""lineNum"":11,""columnNum"":27,""endLineNum"":11,""endColumnNum"":33,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2b8d084"",""value"":""NS_IDENT@5631962.price"",""pos"":{""lineNum"":11,""columnNum"":37,""endLineNum"":11,""endColumnNum"":43,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@2b214b94"",""value"":""NS_IDENT@5631962.beer"",""pos"":{""lineNum"":11,""columnNum"":7,""endLineNum"":11,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@70e3f36f"",""value"":""NS_SELECT@4632cfc.BEER"",""pos"":{""lineNum"":11,""columnNum"":16,""endLineNum"":11,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2b8d084"",""value"":""NS_IDENT@5631962.price"",""pos"":{""lineNum"":11,""columnNum"":37,""endLineNum"":11,""endColumnNum"":43,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@47d7bfb3"",""value"":""NS_IDENT@5631962.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@23e44287"",""value"":""NS_SELECT@4632cfc.PRICE"",""pos"":{""lineNum"":11,""columnNum"":27,""endLineNum"":11,""endColumnNum"":33,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1eb6e1c"",""value"":""NS_IDENT@5631962.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":11,""endColumnNum"":43,""quoted"":false},""children"":{""BLOCK_SELECT@47b2e9e1"":{""id"":""BLOCK_SELECT@47b2e9e1"",""parentId"":""BLOCK_SELECT@61d01788"",""alias"":""T"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@3b6c624"",""value"":""NS_IDENT@6e1f8469.BEER"",""pos"":{""lineNum"":3,""columnNum"":16,""endLineNum"":3,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@c81fd12"",""value"":""MAX"",""pos"":{""lineNum"":3,""columnNum"":22,""endLineNum"":3,""endColumnNum"":31,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@62e6a3ec"",""value"":""NS_IDENT@6e1f8469.PRICE"",""pos"":{""lineNum"":3,""columnNum"":26,""endLineNum"":3,""endColumnNum"":30,""quoted"":false},""children"":[]}],""alias"":""PRICE""}],""fromItemIds"":[""NS_IDENT@6e1f8469""],""fromNode"":{""id"":""JOIN_OPERAND@25b865b5"",""value"":""NS_IDENT@6e1f8469"",""pos"":{""lineNum"":4,""columnNum"":14,""endLineNum"":4,""endColumnNum"":19,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@aa004a0"",""value"":""NS_IDENT@6e1f8469.beer"",""pos"":{""lineNum"":5,""columnNum"":18,""endLineNum"":5,""endColumnNum"":21,""quoted"":false},""children"":[]}],""havingNode"":{""id"":""OP_BINARY@31ddd4a4"",""value"":""IN"",""pos"":{""lineNum"":6,""columnNum"":16,""endLineNum"":9,""endColumnNum"":33,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1a5f7e7c"",""value"":""NS_IDENT@6e1f8469.beer"",""pos"":{""lineNum"":6,""columnNum"":16,""endLineNum"":6,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@27b22f74"",""value"":""BLOCK_SELECT@27b22f74"",""pos"":{""lineNum"":7,""columnNum"":13,""endLineNum"":9,""endColumnNum"":33,""quoted"":false},""children"":[]}]},""identifiers"":[{""id"":""COLUMN_LOCAL@1a5f7e7c"",""value"":""NS_IDENT@6e1f8469.beer"",""pos"":{""lineNum"":6,""columnNum"":16,""endLineNum"":6,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@62e6a3ec"",""value"":""NS_IDENT@6e1f8469.PRICE"",""pos"":{""lineNum"":3,""columnNum"":26,""endLineNum"":3,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@aa004a0"",""value"":""NS_IDENT@6e1f8469.beer"",""pos"":{""lineNum"":5,""columnNum"":18,""endLineNum"":5,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3b6c624"",""value"":""NS_IDENT@6e1f8469.BEER"",""pos"":{""lineNum"":3,""columnNum"":16,""endLineNum"":3,""endColumnNum"":19,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":9,""endLineNum"":9,""endColumnNum"":34,""quoted"":false},""children"":{""BLOCK_SELECT@27b22f74"":{""id"":""BLOCK_SELECT@27b22f74"",""parentId"":""BLOCK_SELECT@47b2e9e1"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@1cbb3d3b"",""value"":""NS_IDENT@652ab8d9.BEER"",""pos"":{""lineNum"":7,""columnNum"":20,""endLineNum"":7,""endColumnNum"":23,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@652ab8d9""],""fromNode"":{""id"":""JOIN_OPERAND@22fba58c"",""value"":""NS_IDENT@652ab8d9"",""pos"":{""lineNum"":8,""columnNum"":18,""endLineNum"":8,""endColumnNum"":22,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@af78c87"",""value"":""="",""pos"":{""lineNum"":9,""columnNum"":19,""endLineNum"":9,""endColumnNum"":33,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4158debd"",""value"":""NS_IDENT@652ab8d9.drinker"",""pos"":{""lineNum"":9,""columnNum"":19,""endLineNum"":9,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@748fe51d"",""value"":""'Dan'"",""pos"":{""lineNum"":9,""columnNum"":29,""endLineNum"":9,""endColumnNum"":33,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@1cbb3d3b"",""value"":""NS_IDENT@652ab8d9.BEER"",""pos"":{""lineNum"":7,""columnNum"":20,""endLineNum"":7,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4158debd"",""value"":""NS_IDENT@652ab8d9.drinker"",""pos"":{""lineNum"":9,""columnNum"":19,""endLineNum"":9,""endColumnNum"":25,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":7,""columnNum"":13,""endLineNum"":9,""endColumnNum"":33,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@5631962"":{""tableId"":""NS_IDENT@5631962"",""identifier"":""S"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":13,""quoted"":false}},""NS_IDENT@6e1f8469"":{""tableId"":""NS_IDENT@6e1f8469"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":14,""endLineNum"":4,""endColumnNum"":19,""quoted"":false}},""NS_IDENT@652ab8d9"":{""tableId"":""NS_IDENT@652ab8d9"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":18,""endLineNum"":8,""endColumnNum"":22,""quoted"":false}},""NS_SELECT@4632cfc"":{""tableId"":""NS_SELECT@4632cfc"",""identifier"":""T"",""blockId"":""BLOCK_SELECT@47b2e9e1"",""fields"":[""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":9,""endLineNum"":10,""endColumnNum"":10,""quoted"":false}}},""corrTables"":[]}
"
"SELECT DISTINCT serves.beer, serves.bar FROM serves, likes WHERE likes.drinker = 'Dan' AND likes.beer = serves.beer AND (serves.bar, serves.beer) IN (SELECT s.bar, s.beer
FROM (
   SELECT beer, MAX(price) as maxprice
   FROM serves GROUP BY beer
) as x inner join serves as s on s.beer = x.beer and s.price = x.maxprice);","{""failed"":true}
"
"SELECT beer, bar
FROM serves AS s
WHERE NOT exists
(SELECT s.bar,s.beer,s.price
FROM serves AS s1
WHERE (s1.beer= s.beer)
      and s1.beer In
      (SELECT beer FROM likes
      WHERE drinker = 'Dan') 
      and s.price < s1.price)
and s.beer In
      (SELECT beer FROM likes
      WHERE drinker = 'Dan');","{""blocks"":{""id"":""BLOCK_SELECT@40021799"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@281f23f2"",""value"":""NS_IDENT@bdc8014.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@28d79cba"",""value"":""NS_IDENT@bdc8014.BAR"",""pos"":{""lineNum"":1,""columnNum"":14,""endLineNum"":1,""endColumnNum"":16,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@bdc8014""],""fromNode"":{""id"":""JOIN_OPERAND@6090f3ca"",""value"":""NS_IDENT@bdc8014"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":11,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@4b2a30d"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":13,""endColumnNum"":27,""quoted"":false},""children"":[{""id"":""OP_PREFIX@489543a6"",""value"":""NOT"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":10,""endColumnNum"":28,""quoted"":false},""children"":[{""id"":""OP_PREFIX@21325036"",""value"":""EXISTS"",""pos"":{""lineNum"":3,""columnNum"":11,""endLineNum"":10,""endColumnNum"":28,""quoted"":false},""children"":[{""id"":""BLOCK_SELECT@4e868ef5"",""value"":""BLOCK_SELECT@4e868ef5"",""pos"":{""lineNum"":4,""columnNum"":2,""endLineNum"":10,""endColumnNum"":28,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@1bc425e7"",""value"":""IN"",""pos"":{""lineNum"":11,""columnNum"":5,""endLineNum"":13,""endColumnNum"":27,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@659a2455"",""value"":""NS_IDENT@bdc8014.beer"",""pos"":{""lineNum"":11,""columnNum"":5,""endLineNum"":11,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@488b50ec"",""value"":""BLOCK_SELECT@488b50ec"",""pos"":{""lineNum"":12,""columnNum"":8,""endLineNum"":13,""endColumnNum"":27,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@281f23f2"",""value"":""NS_IDENT@bdc8014.BEER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@28d79cba"",""value"":""NS_IDENT@bdc8014.BAR"",""pos"":{""lineNum"":1,""columnNum"":14,""endLineNum"":1,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@659a2455"",""value"":""NS_IDENT@bdc8014.beer"",""pos"":{""lineNum"":11,""columnNum"":5,""endLineNum"":11,""endColumnNum"":10,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@bdc8014.BEER"",""NS_IDENT@bdc8014.beer"",""NS_IDENT@bdc8014.BAR"",""NS_IDENT@bdc8014.PRICE"",""NS_IDENT@bdc8014.price""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":13,""endColumnNum"":28,""quoted"":false},""children"":{""BLOCK_SELECT@488b50ec"":{""id"":""BLOCK_SELECT@488b50ec"",""parentId"":""BLOCK_SELECT@40021799"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@6c37bd27"",""value"":""NS_IDENT@24fabd0f.BEER"",""pos"":{""lineNum"":12,""columnNum"":15,""endLineNum"":12,""endColumnNum"":18,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@24fabd0f""],""fromNode"":{""id"":""JOIN_OPERAND@18a645fd"",""value"":""NS_IDENT@24fabd0f"",""pos"":{""lineNum"":12,""columnNum"":25,""endLineNum"":12,""endColumnNum"":29,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@27fde870"",""value"":""="",""pos"":{""lineNum"":13,""columnNum"":13,""endLineNum"":13,""endColumnNum"":27,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@3e850122"",""value"":""NS_IDENT@24fabd0f.drinker"",""pos"":{""lineNum"":13,""columnNum"":13,""endLineNum"":13,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@74fe5966"",""value"":""'Dan'"",""pos"":{""lineNum"":13,""columnNum"":23,""endLineNum"":13,""endColumnNum"":27,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@6c37bd27"",""value"":""NS_IDENT@24fabd0f.BEER"",""pos"":{""lineNum"":12,""columnNum"":15,""endLineNum"":12,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3e850122"",""value"":""NS_IDENT@24fabd0f.drinker"",""pos"":{""lineNum"":13,""columnNum"":13,""endLineNum"":13,""endColumnNum"":19,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":12,""columnNum"":8,""endLineNum"":13,""endColumnNum"":27,""quoted"":false},""children"":{}},""BLOCK_SELECT@4e868ef5"":{""id"":""BLOCK_SELECT@4e868ef5"",""parentId"":""BLOCK_SELECT@40021799"",""fields"":[""BAR VARCHAR(100)"",""BEER VARCHAR(100)"",""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_CORRELATE@d176a31"",""value"":""NS_IDENT@bdc8014.BAR"",""pos"":{""lineNum"":4,""columnNum"":9,""endLineNum"":4,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@3a91d146"",""value"":""NS_IDENT@bdc8014.BEER"",""pos"":{""lineNum"":4,""columnNum"":15,""endLineNum"":4,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@4784013e"",""value"":""NS_IDENT@bdc8014.PRICE"",""pos"":{""lineNum"":4,""columnNum"":22,""endLineNum"":4,""endColumnNum"":28,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@29f0c4f2""],""fromNode"":{""id"":""JOIN_OPERAND@1869f114"",""value"":""NS_IDENT@29f0c4f2"",""pos"":{""lineNum"":5,""columnNum"":6,""endLineNum"":5,""endColumnNum"":11,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@629f066f"",""value"":""AND"",""pos"":{""lineNum"":6,""columnNum"":8,""endLineNum"":10,""endColumnNum"":28,""quoted"":false},""children"":[{""id"":""OP_BINARY@67dba613"",""value"":""AND"",""pos"":{""lineNum"":6,""columnNum"":8,""endLineNum"":9,""endColumnNum"":27,""quoted"":false},""children"":[{""id"":""OP_BINARY@40ee0a22"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":8,""endLineNum"":6,""endColumnNum"":22,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4a9486c0"",""value"":""NS_IDENT@29f0c4f2.beer"",""pos"":{""lineNum"":6,""columnNum"":8,""endLineNum"":6,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@4c27d39d"",""value"":""NS_IDENT@bdc8014.beer"",""pos"":{""lineNum"":6,""columnNum"":17,""endLineNum"":6,""endColumnNum"":22,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@15923407"",""value"":""IN"",""pos"":{""lineNum"":7,""columnNum"":11,""endLineNum"":9,""endColumnNum"":27,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7bde1f3a"",""value"":""NS_IDENT@29f0c4f2.beer"",""pos"":{""lineNum"":7,""columnNum"":11,""endLineNum"":7,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@71c905a3"",""value"":""BLOCK_SELECT@71c905a3"",""pos"":{""lineNum"":8,""columnNum"":8,""endLineNum"":9,""endColumnNum"":27,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@58cec85b"",""value"":""<"",""pos"":{""lineNum"":10,""columnNum"":11,""endLineNum"":10,""endColumnNum"":28,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@57540fd0"",""value"":""NS_IDENT@bdc8014.price"",""pos"":{""lineNum"":10,""columnNum"":11,""endLineNum"":10,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5cf8edcf"",""value"":""NS_IDENT@29f0c4f2.price"",""pos"":{""lineNum"":10,""columnNum"":21,""endLineNum"":10,""endColumnNum"":28,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_CORRELATE@4c27d39d"",""value"":""NS_IDENT@bdc8014.beer"",""pos"":{""lineNum"":6,""columnNum"":17,""endLineNum"":6,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@57540fd0"",""value"":""NS_IDENT@bdc8014.price"",""pos"":{""lineNum"":10,""columnNum"":11,""endLineNum"":10,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4a9486c0"",""value"":""NS_IDENT@29f0c4f2.beer"",""pos"":{""lineNum"":6,""columnNum"":8,""endLineNum"":6,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@4784013e"",""value"":""NS_IDENT@bdc8014.PRICE"",""pos"":{""lineNum"":4,""columnNum"":22,""endLineNum"":4,""endColumnNum"":28,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@3a91d146"",""value"":""NS_IDENT@bdc8014.BEER"",""pos"":{""lineNum"":4,""columnNum"":15,""endLineNum"":4,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5cf8edcf"",""value"":""NS_IDENT@29f0c4f2.price"",""pos"":{""lineNum"":10,""columnNum"":21,""endLineNum"":10,""endColumnNum"":28,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@d176a31"",""value"":""NS_IDENT@bdc8014.BAR"",""pos"":{""lineNum"":4,""columnNum"":9,""endLineNum"":4,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7bde1f3a"",""value"":""NS_IDENT@29f0c4f2.beer"",""pos"":{""lineNum"":7,""columnNum"":11,""endLineNum"":7,""endColumnNum"":17,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@bdc8014""],""corrCtxIds"":[""BLOCK_SELECT@40021799""],""pos"":{""lineNum"":4,""columnNum"":2,""endLineNum"":10,""endColumnNum"":28,""quoted"":false},""children"":{""BLOCK_SELECT@71c905a3"":{""id"":""BLOCK_SELECT@71c905a3"",""parentId"":""BLOCK_SELECT@4e868ef5"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@1bbae752"",""value"":""NS_IDENT@2b214b94.BEER"",""pos"":{""lineNum"":8,""columnNum"":15,""endLineNum"":8,""endColumnNum"":18,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@2b214b94""],""fromNode"":{""id"":""JOIN_OPERAND@46c00568"",""value"":""NS_IDENT@2b214b94"",""pos"":{""lineNum"":8,""columnNum"":25,""endLineNum"":8,""endColumnNum"":29,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@5b22b970"",""value"":""="",""pos"":{""lineNum"":9,""columnNum"":13,""endLineNum"":9,""endColumnNum"":27,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1a5f7e7c"",""value"":""NS_IDENT@2b214b94.drinker"",""pos"":{""lineNum"":9,""columnNum"":13,""endLineNum"":9,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@3a4ba480"",""value"":""'Dan'"",""pos"":{""lineNum"":9,""columnNum"":23,""endLineNum"":9,""endColumnNum"":27,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@1a5f7e7c"",""value"":""NS_IDENT@2b214b94.drinker"",""pos"":{""lineNum"":9,""columnNum"":13,""endLineNum"":9,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1bbae752"",""value"":""NS_IDENT@2b214b94.BEER"",""pos"":{""lineNum"":8,""columnNum"":15,""endLineNum"":8,""endColumnNum"":18,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":8,""columnNum"":8,""endLineNum"":9,""endColumnNum"":27,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@29f0c4f2"":{""tableId"":""NS_IDENT@29f0c4f2"",""identifier"":""S1"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":6,""endLineNum"":5,""endColumnNum"":17,""quoted"":false}},""NS_IDENT@24fabd0f"":{""tableId"":""NS_IDENT@24fabd0f"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":12,""columnNum"":25,""endLineNum"":12,""endColumnNum"":29,""quoted"":false}},""NS_IDENT@2b214b94"":{""tableId"":""NS_IDENT@2b214b94"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":25,""endLineNum"":8,""endColumnNum"":29,""quoted"":false}},""NS_IDENT@bdc8014"":{""tableId"":""NS_IDENT@bdc8014"",""identifier"":""S"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":16,""quoted"":false}}},""corrTables"":[""NS_IDENT@bdc8014""]}
"
"WITH ExpensiveBeer AS
(SELECT x.beer, max(y.price)
FROM likes x, serves y
WHERE x.drinker = 'Dan' and x.beer=y.beer
GROUP BY x.beer)

SELECT ExpensiveBeer.beer, bar
FROM ExpensiveBeer, serves
WHERE ExpensiveBeer.max = serves.price and ExpensiveBeer.beer = serves.beer","{""failed"":true,""errorMsg"":""Parsing error at line 9, column 20. Query syntax may be incorrect""}
"
"WITH lowerPrice AS (
(SELECT beer, bar
FROM serves)
EXCEPT
(SELECT s1.beer, s1.bar
FROM serves s1, serves s2, likes l1 
WHERE l1.drinker='Dan' and l1.beer=s1.beer and s1.beer=s2.beer and s1.price<s2.price))

SELECT l2.beer, t1.bar
FROM likes l2, lowerPrice t1
WHERE l2.beer=t1.beer and l2.drinker='Dan';","{""blocks"":{""id"":""BLOCK_SELECT@2b4c3c29"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@377008df"",""value"":""NS_IDENT@8ed9cf.BEER"",""pos"":{""lineNum"":9,""columnNum"":8,""endLineNum"":9,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7e75bf2d"",""value"":""NS_IDENT@f72203.BAR"",""pos"":{""lineNum"":9,""columnNum"":17,""endLineNum"":9,""endColumnNum"":22,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@8ed9cf"",""NS_IDENT@f72203""],""fromNode"":{""id"":""OP_JOIN@5ac7aa18"",""value"":""COMMA"",""pos"":{""lineNum"":10,""columnNum"":14,""endLineNum"":10,""endColumnNum"":14,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@4cdd2c73"",""value"":""NS_IDENT@8ed9cf"",""pos"":{""lineNum"":10,""columnNum"":6,""endLineNum"":10,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@4abf3f0"",""value"":""NS_IDENT@f72203"",""pos"":{""lineNum"":10,""columnNum"":16,""endLineNum"":10,""endColumnNum"":25,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@32b9bd12"",""value"":""AND"",""pos"":{""lineNum"":11,""columnNum"":7,""endLineNum"":11,""endColumnNum"":42,""quoted"":false},""children"":[{""id"":""OP_BINARY@5a8ba37c"",""value"":""="",""pos"":{""lineNum"":11,""columnNum"":7,""endLineNum"":11,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@576c5536"",""value"":""NS_IDENT@8ed9cf.beer"",""pos"":{""lineNum"":11,""columnNum"":7,""endLineNum"":11,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@55ecbafe"",""value"":""NS_IDENT@f72203.BEER"",""pos"":{""lineNum"":11,""columnNum"":15,""endLineNum"":11,""endColumnNum"":21,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@232cce0"",""value"":""="",""pos"":{""lineNum"":11,""columnNum"":27,""endLineNum"":11,""endColumnNum"":42,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@37c2eacb"",""value"":""NS_IDENT@8ed9cf.drinker"",""pos"":{""lineNum"":11,""columnNum"":27,""endLineNum"":11,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@352e787a"",""value"":""'Dan'"",""pos"":{""lineNum"":11,""columnNum"":38,""endLineNum"":11,""endColumnNum"":42,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@377008df"",""value"":""NS_IDENT@8ed9cf.BEER"",""pos"":{""lineNum"":9,""columnNum"":8,""endLineNum"":9,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@37c2eacb"",""value"":""NS_IDENT@8ed9cf.drinker"",""pos"":{""lineNum"":11,""columnNum"":27,""endLineNum"":11,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7e75bf2d"",""value"":""NS_IDENT@f72203.BAR"",""pos"":{""lineNum"":9,""columnNum"":17,""endLineNum"":9,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@576c5536"",""value"":""NS_IDENT@8ed9cf.beer"",""pos"":{""lineNum"":11,""columnNum"":7,""endLineNum"":11,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@55ecbafe"",""value"":""NS_IDENT@f72203.BEER"",""pos"":{""lineNum"":11,""columnNum"":15,""endLineNum"":11,""endColumnNum"":21,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":9,""columnNum"":1,""endLineNum"":11,""endColumnNum"":42,""quoted"":false},""children"":{}},""tables"":{""NS_IDENT@8ed9cf"":{""tableId"":""NS_IDENT@8ed9cf"",""identifier"":""L2"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":10,""columnNum"":6,""endLineNum"":10,""endColumnNum"":13,""quoted"":false}},""NS_IDENT@f72203"":{""tableId"":""NS_IDENT@f72203"",""identifier"":""T1"",""dbTableName"":""LOWERPRICE"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":10,""columnNum"":16,""endLineNum"":10,""endColumnNum"":28,""quoted"":false}},""NS_IDENT@2e34384c"":{""tableId"":""NS_IDENT@2e34384c"",""identifier"":""S1"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":14,""quoted"":false}},""NS_IDENT@1f52eb6f"":{""tableId"":""NS_IDENT@1f52eb6f"",""identifier"":""L1"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":28,""endLineNum"":6,""endColumnNum"":35,""quoted"":false}},""NS_IDENT@3051e0b2"":{""tableId"":""NS_IDENT@3051e0b2"",""identifier"":""S2"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":17,""endLineNum"":6,""endColumnNum"":25,""quoted"":false}},""NS_IDENT@57b75756"":{""tableId"":""NS_IDENT@57b75756"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":6,""endLineNum"":3,""endColumnNum"":11,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SETOP@3e48e859"",""alias"":""LOWERPRICE"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@22d1886d"",""rightBlockId"":""BLOCK_SELECT@5eb97ced"",""pos"":{""lineNum"":2,""columnNum"":2,""endLineNum"":7,""endColumnNum"":84,""quoted"":false},""children"":{""BLOCK_SELECT@5eb97ced"":{""id"":""BLOCK_SELECT@5eb97ced"",""parentId"":""BLOCK_SETOP@3e48e859"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@57d0fc89"",""value"":""NS_IDENT@2e34384c.BEER"",""pos"":{""lineNum"":5,""columnNum"":9,""endLineNum"":5,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@67c277a0"",""value"":""NS_IDENT@2e34384c.BAR"",""pos"":{""lineNum"":5,""columnNum"":18,""endLineNum"":5,""endColumnNum"":23,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@2e34384c"",""NS_IDENT@3051e0b2"",""NS_IDENT@1f52eb6f""],""fromNode"":{""id"":""OP_JOIN@6f667ad1"",""value"":""COMMA"",""pos"":{""lineNum"":6,""columnNum"":26,""endLineNum"":6,""endColumnNum"":26,""quoted"":false},""children"":[{""id"":""OP_JOIN@566d0c69"",""value"":""COMMA"",""pos"":{""lineNum"":6,""columnNum"":15,""endLineNum"":6,""endColumnNum"":15,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@2bcec6a6"",""value"":""NS_IDENT@2e34384c"",""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@77a281fc"",""value"":""NS_IDENT@3051e0b2"",""pos"":{""lineNum"":6,""columnNum"":17,""endLineNum"":6,""endColumnNum"":22,""quoted"":false},""children"":[]}],""natural"":false},{""id"":""JOIN_OPERAND@151335cb"",""value"":""NS_IDENT@1f52eb6f"",""pos"":{""lineNum"":6,""columnNum"":28,""endLineNum"":6,""endColumnNum"":32,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@5b12012e"",""value"":""AND"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":84,""quoted"":false},""children"":[{""id"":""OP_BINARY@3c0fbd3a"",""value"":""AND"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":62,""quoted"":false},""children"":[{""id"":""OP_BINARY@3ed0918d"",""value"":""AND"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":42,""quoted"":false},""children"":[{""id"":""OP_BINARY@7351a16e"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":22,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4567e53d"",""value"":""NS_IDENT@1f52eb6f.drinker"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@2f7dcef2"",""value"":""'Dan'"",""pos"":{""lineNum"":7,""columnNum"":18,""endLineNum"":7,""endColumnNum"":22,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@4074023c"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":28,""endLineNum"":7,""endColumnNum"":42,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5bb7643d"",""value"":""NS_IDENT@1f52eb6f.beer"",""pos"":{""lineNum"":7,""columnNum"":28,""endLineNum"":7,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3ac04654"",""value"":""NS_IDENT@2e34384c.beer"",""pos"":{""lineNum"":7,""columnNum"":36,""endLineNum"":7,""endColumnNum"":42,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@6e91893"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":48,""endLineNum"":7,""endColumnNum"":62,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5e268ce6"",""value"":""NS_IDENT@2e34384c.beer"",""pos"":{""lineNum"":7,""columnNum"":48,""endLineNum"":7,""endColumnNum"":54,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@66ec9390"",""value"":""NS_IDENT@3051e0b2.beer"",""pos"":{""lineNum"":7,""columnNum"":56,""endLineNum"":7,""endColumnNum"":62,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@1a35993f"",""value"":""<"",""pos"":{""lineNum"":7,""columnNum"":68,""endLineNum"":7,""endColumnNum"":84,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@562457e1"",""value"":""NS_IDENT@2e34384c.price"",""pos"":{""lineNum"":7,""columnNum"":68,""endLineNum"":7,""endColumnNum"":75,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@54562ea6"",""value"":""NS_IDENT@3051e0b2.price"",""pos"":{""lineNum"":7,""columnNum"":77,""endLineNum"":7,""endColumnNum"":84,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@562457e1"",""value"":""NS_IDENT@2e34384c.price"",""pos"":{""lineNum"":7,""columnNum"":68,""endLineNum"":7,""endColumnNum"":75,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@66ec9390"",""value"":""NS_IDENT@3051e0b2.beer"",""pos"":{""lineNum"":7,""columnNum"":56,""endLineNum"":7,""endColumnNum"":62,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4567e53d"",""value"":""NS_IDENT@1f52eb6f.drinker"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@67c277a0"",""value"":""NS_IDENT@2e34384c.BAR"",""pos"":{""lineNum"":5,""columnNum"":18,""endLineNum"":5,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3ac04654"",""value"":""NS_IDENT@2e34384c.beer"",""pos"":{""lineNum"":7,""columnNum"":36,""endLineNum"":7,""endColumnNum"":42,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5e268ce6"",""value"":""NS_IDENT@2e34384c.beer"",""pos"":{""lineNum"":7,""columnNum"":48,""endLineNum"":7,""endColumnNum"":54,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5bb7643d"",""value"":""NS_IDENT@1f52eb6f.beer"",""pos"":{""lineNum"":7,""columnNum"":28,""endLineNum"":7,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@57d0fc89"",""value"":""NS_IDENT@2e34384c.BEER"",""pos"":{""lineNum"":5,""columnNum"":9,""endLineNum"":5,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@54562ea6"",""value"":""NS_IDENT@3051e0b2.price"",""pos"":{""lineNum"":7,""columnNum"":77,""endLineNum"":7,""endColumnNum"":84,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":5,""columnNum"":2,""endLineNum"":7,""endColumnNum"":84,""quoted"":false},""children"":{}},""BLOCK_SELECT@22d1886d"":{""id"":""BLOCK_SELECT@22d1886d"",""parentId"":""BLOCK_SETOP@3e48e859"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@2b556bb2"",""value"":""NS_IDENT@57b75756.BEER"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@17271176"",""value"":""NS_IDENT@57b75756.BAR"",""pos"":{""lineNum"":2,""columnNum"":15,""endLineNum"":2,""endColumnNum"":17,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@57b75756""],""fromNode"":{""id"":""JOIN_OPERAND@2fc07784"",""value"":""NS_IDENT@57b75756"",""pos"":{""lineNum"":3,""columnNum"":6,""endLineNum"":3,""endColumnNum"":11,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@2b556bb2"",""value"":""NS_IDENT@57b75756.BEER"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@17271176"",""value"":""NS_IDENT@57b75756.BAR"",""pos"":{""lineNum"":2,""columnNum"":15,""endLineNum"":2,""endColumnNum"":17,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":2,""endLineNum"":3,""endColumnNum"":11,""quoted"":false},""children"":{}}}}]}
"
"select s1.beer, s1.bar from serves s1, (select l.beer, max(s.price) from likes l, serves s where s.beer = l.beer and l.drinker = 'Dan' group by l.beer) s2 where s2.max = price and s1.beer = s2.beer","{""failed"":true,""errorMsg"":""Parsing error at line 1, column 164. Query syntax may be incorrect""}
"
"select distinct l.beer, bar from likes as l, serves as s where l.drinker='Dan' and l.beer = s.beer and s.price >= all(select price from serves where l.beer = beer)","{""blocks"":{""id"":""BLOCK_SELECT@19593091"",""fields"":[""BEER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":true,""selectList"":[{""id"":""COLUMN_LOCAL@5fb7183b"",""value"":""NS_IDENT@7e9da981.BEER"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5f80fa43"",""value"":""NS_IDENT@676ff3b0.BAR"",""pos"":{""lineNum"":1,""columnNum"":25,""endLineNum"":1,""endColumnNum"":27,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@7e9da981"",""NS_IDENT@676ff3b0""],""fromNode"":{""id"":""OP_JOIN@21f9277b"",""value"":""COMMA"",""pos"":{""lineNum"":1,""columnNum"":44,""endLineNum"":1,""endColumnNum"":44,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@5d58c727"",""value"":""NS_IDENT@7e9da981"",""pos"":{""lineNum"":1,""columnNum"":34,""endLineNum"":1,""endColumnNum"":38,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@52a36910"",""value"":""NS_IDENT@676ff3b0"",""pos"":{""lineNum"":1,""columnNum"":46,""endLineNum"":1,""endColumnNum"":51,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@47e4d9d0"",""value"":""AND"",""pos"":{""lineNum"":1,""columnNum"":64,""endLineNum"":1,""endColumnNum"":162,""quoted"":false},""children"":[{""id"":""OP_BINARY@2d746ce4"",""value"":""AND"",""pos"":{""lineNum"":1,""columnNum"":64,""endLineNum"":1,""endColumnNum"":98,""quoted"":false},""children"":[{""id"":""OP_BINARY@48c3205a"",""value"":""="",""pos"":{""lineNum"":1,""columnNum"":64,""endLineNum"":1,""endColumnNum"":78,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1949309d"",""value"":""NS_IDENT@7e9da981.drinker"",""pos"":{""lineNum"":1,""columnNum"":64,""endLineNum"":1,""endColumnNum"":72,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@27c04377"",""value"":""'Dan'"",""pos"":{""lineNum"":1,""columnNum"":74,""endLineNum"":1,""endColumnNum"":78,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@7c6442c2"",""value"":""="",""pos"":{""lineNum"":1,""columnNum"":84,""endLineNum"":1,""endColumnNum"":98,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@121c54fa"",""value"":""NS_IDENT@7e9da981.beer"",""pos"":{""lineNum"":1,""columnNum"":84,""endLineNum"":1,""endColumnNum"":89,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4390f46e"",""value"":""NS_IDENT@676ff3b0.beer"",""pos"":{""lineNum"":1,""columnNum"":93,""endLineNum"":1,""endColumnNum"":98,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@1948ea69"",""value"":"">= ALL"",""pos"":{""lineNum"":1,""columnNum"":104,""endLineNum"":1,""endColumnNum"":162,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5dbf5634"",""value"":""NS_IDENT@676ff3b0.price"",""pos"":{""lineNum"":1,""columnNum"":104,""endLineNum"":1,""endColumnNum"":110,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@7fedfe27"",""value"":""BLOCK_SELECT@7fedfe27"",""pos"":{""lineNum"":1,""columnNum"":119,""endLineNum"":1,""endColumnNum"":162,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@5dbf5634"",""value"":""NS_IDENT@676ff3b0.price"",""pos"":{""lineNum"":1,""columnNum"":104,""endLineNum"":1,""endColumnNum"":110,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4390f46e"",""value"":""NS_IDENT@676ff3b0.beer"",""pos"":{""lineNum"":1,""columnNum"":93,""endLineNum"":1,""endColumnNum"":98,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5f80fa43"",""value"":""NS_IDENT@676ff3b0.BAR"",""pos"":{""lineNum"":1,""columnNum"":25,""endLineNum"":1,""endColumnNum"":27,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1949309d"",""value"":""NS_IDENT@7e9da981.drinker"",""pos"":{""lineNum"":1,""columnNum"":64,""endLineNum"":1,""endColumnNum"":72,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5fb7183b"",""value"":""NS_IDENT@7e9da981.BEER"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@121c54fa"",""value"":""NS_IDENT@7e9da981.beer"",""pos"":{""lineNum"":1,""columnNum"":84,""endLineNum"":1,""endColumnNum"":89,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@7e9da981.beer""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":1,""endColumnNum"":163,""quoted"":false},""children"":{""BLOCK_SELECT@7fedfe27"":{""id"":""BLOCK_SELECT@7fedfe27"",""parentId"":""BLOCK_SELECT@19593091"",""fields"":[""PRICE DECIMAL(5, 2)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@5a6482a9"",""value"":""NS_IDENT@576c5536.PRICE"",""pos"":{""lineNum"":1,""columnNum"":126,""endLineNum"":1,""endColumnNum"":130,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@576c5536""],""fromNode"":{""id"":""JOIN_OPERAND@47b2e9e1"",""value"":""NS_IDENT@576c5536"",""pos"":{""lineNum"":1,""columnNum"":137,""endLineNum"":1,""endColumnNum"":142,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@3c0fbd3a"",""value"":""="",""pos"":{""lineNum"":1,""columnNum"":150,""endLineNum"":1,""endColumnNum"":162,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@66ec9390"",""value"":""NS_IDENT@7e9da981.beer"",""pos"":{""lineNum"":1,""columnNum"":150,""endLineNum"":1,""endColumnNum"":155,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6e91893"",""value"":""NS_IDENT@576c5536.beer"",""pos"":{""lineNum"":1,""columnNum"":159,""endLineNum"":1,""endColumnNum"":162,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@5a6482a9"",""value"":""NS_IDENT@576c5536.PRICE"",""pos"":{""lineNum"":1,""columnNum"":126,""endLineNum"":1,""endColumnNum"":130,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@66ec9390"",""value"":""NS_IDENT@7e9da981.beer"",""pos"":{""lineNum"":1,""columnNum"":150,""endLineNum"":1,""endColumnNum"":155,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6e91893"",""value"":""NS_IDENT@576c5536.beer"",""pos"":{""lineNum"":1,""columnNum"":159,""endLineNum"":1,""endColumnNum"":162,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@7e9da981""],""corrCtxIds"":[""BLOCK_SELECT@19593091""],""pos"":{""lineNum"":1,""columnNum"":119,""endLineNum"":1,""endColumnNum"":162,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@676ff3b0"":{""tableId"":""NS_IDENT@676ff3b0"",""identifier"":""S"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":46,""endLineNum"":1,""endColumnNum"":56,""quoted"":false}},""NS_IDENT@7e9da981"":{""tableId"":""NS_IDENT@7e9da981"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":34,""endLineNum"":1,""endColumnNum"":43,""quoted"":false}},""NS_IDENT@576c5536"":{""tableId"":""NS_IDENT@576c5536"",""identifier"":""SERVES"",""dbTableName"":""SERVES"",""fields"":[""bar VARCHAR(100)"",""beer VARCHAR(100)"",""price DECIMAL(5, 2)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":137,""endLineNum"":1,""endColumnNum"":142,""quoted"":false}}},""corrTables"":[""NS_IDENT@7e9da981""]}
"
