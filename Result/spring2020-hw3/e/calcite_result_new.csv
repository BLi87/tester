"-- for each drinker the bar(s) they frequent the most  
-- output (drinker, bar)
WITH drinkers as (SELECT name as drinker FROM drinker),
  result as (SELECT DISTINCT drinker, bar
    FROM frequents f2
    WHERE NOT EXISTS (SELECT *
      FROM frequents
      WHERE times_a_week > f2.times_a_week and drinker = f2.drinker))
SELECT drinkers.drinker as drinker, bar
FROM drinkers LEFT OUTER JOIN result ON drinkers.drinker = result.drinker;","{""failed"":true,""errorMsg"":""Parsing error at line 4, column 3. Query syntax may be incorrect""}
"
"WITH 
maxTimes AS
(SELECT drinker, MAX(times_a_week) AS times_a_week
FROM frequents
GROUP BY drinker),

drinkerBar AS
(SELECT F.drinker, bar
FROM frequents F, maxTimes M
WHERE F.drinker = M.drinker AND F.times_a_week = M.times_a_week)

SELECT name, bar
FROM drinkerBar FULL OUTER JOIN drinker
ON drinker.name = drinkerBar.drinker;","{""blocks"":{""id"":""BLOCK_SELECT@43cf6ea3"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@51dbd6e4"",""value"":""NS_IDENT@1eb6e1c.NAME"",""pos"":{""lineNum"":12,""columnNum"":8,""endLineNum"":12,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5f13be1"",""value"":""NS_IDENT@770b3be0.BAR"",""pos"":{""lineNum"":12,""columnNum"":14,""endLineNum"":12,""endColumnNum"":16,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@770b3be0"",""NS_IDENT@1eb6e1c""],""fromNode"":{""id"":""OP_JOIN@37c5fc56"",""value"":""FULL"",""pos"":{""lineNum"":13,""columnNum"":28,""endLineNum"":13,""endColumnNum"":31,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@1c025cb"",""value"":""NS_IDENT@770b3be0"",""pos"":{""lineNum"":13,""columnNum"":6,""endLineNum"":13,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@50825a02"",""value"":""NS_IDENT@1eb6e1c"",""pos"":{""lineNum"":13,""columnNum"":33,""endLineNum"":13,""endColumnNum"":39,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@250b236d"",""value"":""="",""pos"":{""lineNum"":14,""columnNum"":4,""endLineNum"":14,""endColumnNum"":36,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@6daf2337"",""value"":""NS_IDENT@1eb6e1c.name"",""pos"":{""lineNum"":14,""columnNum"":4,""endLineNum"":14,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@24fabd0f"",""value"":""NS_IDENT@770b3be0.DRINKER"",""pos"":{""lineNum"":14,""columnNum"":19,""endLineNum"":14,""endColumnNum"":36,""quoted"":false},""children"":[]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@51dbd6e4"",""value"":""NS_IDENT@1eb6e1c.NAME"",""pos"":{""lineNum"":12,""columnNum"":8,""endLineNum"":12,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6daf2337"",""value"":""NS_IDENT@1eb6e1c.name"",""pos"":{""lineNum"":14,""columnNum"":4,""endLineNum"":14,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@24fabd0f"",""value"":""NS_IDENT@770b3be0.DRINKER"",""pos"":{""lineNum"":14,""columnNum"":19,""endLineNum"":14,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5f13be1"",""value"":""NS_IDENT@770b3be0.BAR"",""pos"":{""lineNum"":12,""columnNum"":14,""endLineNum"":12,""endColumnNum"":16,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":12,""columnNum"":1,""endLineNum"":14,""endColumnNum"":36,""quoted"":false},""children"":{}},""tables"":{""NS_IDENT@3b6c624"":{""tableId"":""NS_IDENT@3b6c624"",""identifier"":""F"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":9,""columnNum"":6,""endLineNum"":9,""endColumnNum"":16,""quoted"":false}},""NS_IDENT@770b3be0"":{""tableId"":""NS_IDENT@770b3be0"",""identifier"":""DRINKERBAR"",""dbTableName"":""DRINKERBAR"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":13,""columnNum"":6,""endLineNum"":13,""endColumnNum"":15,""quoted"":false}},""NS_IDENT@675ffd1d"":{""tableId"":""NS_IDENT@675ffd1d"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":6,""endLineNum"":4,""endColumnNum"":14,""quoted"":false}},""NS_IDENT@1eaf1e62"":{""tableId"":""NS_IDENT@1eaf1e62"",""identifier"":""M"",""dbTableName"":""MAXTIMES"",""fields"":[""DRINKER VARCHAR(100)"",""TIMES_A_WEEK INTEGER""],""cursor"":[0],""pos"":{""lineNum"":9,""columnNum"":19,""endLineNum"":9,""endColumnNum"":28,""quoted"":false}},""NS_IDENT@1eb6e1c"":{""tableId"":""NS_IDENT@1eb6e1c"",""identifier"":""DRINKER"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":13,""columnNum"":33,""endLineNum"":13,""endColumnNum"":39,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@7fedfe27"",""alias"":""MAXTIMES"",""fields"":[""DRINKER VARCHAR(100)"",""TIMES_A_WEEK INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@52a70627"",""value"":""NS_IDENT@675ffd1d.DRINKER"",""pos"":{""lineNum"":3,""columnNum"":9,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@19569ebd"",""value"":""MAX"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":34,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4632cfc"",""value"":""NS_IDENT@675ffd1d.TIMES_A_WEEK"",""pos"":{""lineNum"":3,""columnNum"":22,""endLineNum"":3,""endColumnNum"":33,""quoted"":false},""children"":[]}],""alias"":""TIMES_A_WEEK""}],""fromItemIds"":[""NS_IDENT@675ffd1d""],""fromNode"":{""id"":""JOIN_OPERAND@488b50ec"",""value"":""NS_IDENT@675ffd1d"",""pos"":{""lineNum"":4,""columnNum"":6,""endLineNum"":4,""endColumnNum"":14,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@76075d65"",""value"":""NS_IDENT@675ffd1d.drinker"",""pos"":{""lineNum"":5,""columnNum"":10,""endLineNum"":5,""endColumnNum"":16,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@76075d65"",""value"":""NS_IDENT@675ffd1d.drinker"",""pos"":{""lineNum"":5,""columnNum"":10,""endLineNum"":5,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4632cfc"",""value"":""NS_IDENT@675ffd1d.TIMES_A_WEEK"",""pos"":{""lineNum"":3,""columnNum"":22,""endLineNum"":3,""endColumnNum"":33,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@52a70627"",""value"":""NS_IDENT@675ffd1d.DRINKER"",""pos"":{""lineNum"":3,""columnNum"":9,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":2,""endLineNum"":5,""endColumnNum"":16,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@4aac85fa"",""alias"":""DRINKERBAR"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@c81fd12"",""value"":""NS_IDENT@3b6c624.DRINKER"",""pos"":{""lineNum"":8,""columnNum"":9,""endLineNum"":8,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5754de72"",""value"":""NS_IDENT@3b6c624.BAR"",""pos"":{""lineNum"":8,""columnNum"":20,""endLineNum"":8,""endColumnNum"":22,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@3b6c624"",""NS_IDENT@1eaf1e62""],""fromNode"":{""id"":""OP_JOIN@30cecdca"",""value"":""COMMA"",""pos"":{""lineNum"":9,""columnNum"":17,""endLineNum"":9,""endColumnNum"":17,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@5486887b"",""value"":""NS_IDENT@3b6c624"",""pos"":{""lineNum"":9,""columnNum"":6,""endLineNum"":9,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@5226e402"",""value"":""NS_IDENT@1eaf1e62"",""pos"":{""lineNum"":9,""columnNum"":19,""endLineNum"":9,""endColumnNum"":26,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@64138b0c"",""value"":""AND"",""pos"":{""lineNum"":10,""columnNum"":7,""endLineNum"":10,""endColumnNum"":63,""quoted"":false},""children"":[{""id"":""OP_BINARY@7fab4be7"",""value"":""="",""pos"":{""lineNum"":10,""columnNum"":7,""endLineNum"":10,""endColumnNum"":27,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@15fa55a6"",""value"":""NS_IDENT@3b6c624.drinker"",""pos"":{""lineNum"":10,""columnNum"":7,""endLineNum"":10,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_IDENT@1eaf1e62.DRINKER"",""pos"":{""lineNum"":10,""columnNum"":19,""endLineNum"":10,""endColumnNum"":27,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@41c204a0"",""value"":""="",""pos"":{""lineNum"":10,""columnNum"":33,""endLineNum"":10,""endColumnNum"":63,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@a64e035"",""value"":""NS_IDENT@3b6c624.times_a_week"",""pos"":{""lineNum"":10,""columnNum"":33,""endLineNum"":10,""endColumnNum"":46,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4d74c3ba"",""value"":""NS_IDENT@1eaf1e62.TIMES_A_WEEK"",""pos"":{""lineNum"":10,""columnNum"":50,""endLineNum"":10,""endColumnNum"":63,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@15fa55a6"",""value"":""NS_IDENT@3b6c624.drinker"",""pos"":{""lineNum"":10,""columnNum"":7,""endLineNum"":10,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_IDENT@1eaf1e62.DRINKER"",""pos"":{""lineNum"":10,""columnNum"":19,""endLineNum"":10,""endColumnNum"":27,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@c81fd12"",""value"":""NS_IDENT@3b6c624.DRINKER"",""pos"":{""lineNum"":8,""columnNum"":9,""endLineNum"":8,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5754de72"",""value"":""NS_IDENT@3b6c624.BAR"",""pos"":{""lineNum"":8,""columnNum"":20,""endLineNum"":8,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@a64e035"",""value"":""NS_IDENT@3b6c624.times_a_week"",""pos"":{""lineNum"":10,""columnNum"":33,""endLineNum"":10,""endColumnNum"":46,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4d74c3ba"",""value"":""NS_IDENT@1eaf1e62.TIMES_A_WEEK"",""pos"":{""lineNum"":10,""columnNum"":50,""endLineNum"":10,""endColumnNum"":63,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":8,""columnNum"":2,""endLineNum"":10,""endColumnNum"":63,""quoted"":false},""children"":{}}]}
"
"WITH m as (select * from frequents as f where not exists (select * from frequents where times_a_week > f.times_a_week and f.drinker = drinker)), d as (select name from drinker) select name, bar from m RIGHT OUTER JOIN d ON m.drinker = d.name;","{""blocks"":{""id"":""BLOCK_SELECT@21fff664"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@77bd7fe7"",""value"":""NS_IDENT@215a34b4.NAME"",""pos"":{""lineNum"":1,""columnNum"":185,""endLineNum"":1,""endColumnNum"":188,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@10876a6"",""value"":""NS_IDENT@5bcde458.BAR"",""pos"":{""lineNum"":1,""columnNum"":191,""endLineNum"":1,""endColumnNum"":193,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@5bcde458"",""NS_IDENT@215a34b4""],""fromNode"":{""id"":""OP_JOIN@6edc4161"",""value"":""RIGHT"",""pos"":{""lineNum"":1,""columnNum"":214,""endLineNum"":1,""endColumnNum"":217,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@5486887b"",""value"":""NS_IDENT@5bcde458"",""pos"":{""lineNum"":1,""columnNum"":200,""endLineNum"":1,""endColumnNum"":200,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@5226e402"",""value"":""NS_IDENT@215a34b4"",""pos"":{""lineNum"":1,""columnNum"":219,""endLineNum"":1,""endColumnNum"":219,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@a64e035"",""value"":""="",""pos"":{""lineNum"":1,""columnNum"":224,""endLineNum"":1,""endColumnNum"":241,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_IDENT@5bcde458.drinker"",""pos"":{""lineNum"":1,""columnNum"":224,""endLineNum"":1,""endColumnNum"":232,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7fab4be7"",""value"":""NS_IDENT@215a34b4.NAME"",""pos"":{""lineNum"":1,""columnNum"":236,""endLineNum"":1,""endColumnNum"":241,""quoted"":false},""children"":[]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@10876a6"",""value"":""NS_IDENT@5bcde458.BAR"",""pos"":{""lineNum"":1,""columnNum"":191,""endLineNum"":1,""endColumnNum"":193,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@77bd7fe7"",""value"":""NS_IDENT@215a34b4.NAME"",""pos"":{""lineNum"":1,""columnNum"":185,""endLineNum"":1,""endColumnNum"":188,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_IDENT@5bcde458.drinker"",""pos"":{""lineNum"":1,""columnNum"":224,""endLineNum"":1,""endColumnNum"":232,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7fab4be7"",""value"":""NS_IDENT@215a34b4.NAME"",""pos"":{""lineNum"":1,""columnNum"":236,""endLineNum"":1,""endColumnNum"":241,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":178,""endLineNum"":1,""endColumnNum"":241,""quoted"":false},""children"":{}},""tables"":{""NS_IDENT@40d10481"":{""tableId"":""NS_IDENT@40d10481"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":73,""endLineNum"":1,""endColumnNum"":81,""quoted"":false}},""NS_IDENT@5bcde458"":{""tableId"":""NS_IDENT@5bcde458"",""identifier"":""M"",""dbTableName"":""M"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":200,""endLineNum"":1,""endColumnNum"":200,""quoted"":false}},""NS_IDENT@1f1cae23"":{""tableId"":""NS_IDENT@1f1cae23"",""identifier"":""DRINKER"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":169,""endLineNum"":1,""endColumnNum"":175,""quoted"":false}},""NS_IDENT@215a34b4"":{""tableId"":""NS_IDENT@215a34b4"",""identifier"":""D"",""dbTableName"":""D"",""fields"":[""NAME VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":219,""endLineNum"":1,""endColumnNum"":219,""quoted"":false}},""NS_IDENT@78de58ea"":{""tableId"":""NS_IDENT@78de58ea"",""identifier"":""F"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":26,""endLineNum"":1,""endColumnNum"":39,""quoted"":false}}},""corrTables"":[""NS_IDENT@78de58ea""],""withBlocks"":[{""id"":""BLOCK_SELECT@2d66530f"",""alias"":""M"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@173373b4"",""value"":""*"",""pos"":{""lineNum"":1,""columnNum"":19,""endLineNum"":1,""endColumnNum"":19,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@78de58ea""],""fromNode"":{""id"":""JOIN_OPERAND@27b22f74"",""value"":""NS_IDENT@78de58ea"",""pos"":{""lineNum"":1,""columnNum"":26,""endLineNum"":1,""endColumnNum"":34,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_PREFIX@4784013e"",""value"":""NOT"",""pos"":{""lineNum"":1,""columnNum"":47,""endLineNum"":1,""endColumnNum"":141,""quoted"":false},""children"":[{""id"":""OP_PREFIX@3a91d146"",""value"":""EXISTS"",""pos"":{""lineNum"":1,""columnNum"":51,""endLineNum"":1,""endColumnNum"":141,""quoted"":false},""children"":[{""id"":""BLOCK_SELECT@59712875"",""value"":""BLOCK_SELECT@59712875"",""pos"":{""lineNum"":1,""columnNum"":59,""endLineNum"":1,""endColumnNum"":141,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[""NS_IDENT@78de58ea.times_a_week"",""NS_IDENT@78de58ea.drinker""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":12,""endLineNum"":1,""endColumnNum"":142,""quoted"":false},""children"":{""BLOCK_SELECT@59712875"":{""id"":""BLOCK_SELECT@59712875"",""parentId"":""BLOCK_SELECT@2d66530f"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@392a04e7"",""value"":""*"",""pos"":{""lineNum"":1,""columnNum"":66,""endLineNum"":1,""endColumnNum"":66,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@40d10481""],""fromNode"":{""id"":""JOIN_OPERAND@bdecc21"",""value"":""NS_IDENT@40d10481"",""pos"":{""lineNum"":1,""columnNum"":73,""endLineNum"":1,""endColumnNum"":81,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@ecfbe91"",""value"":""AND"",""pos"":{""lineNum"":1,""columnNum"":89,""endLineNum"":1,""endColumnNum"":141,""quoted"":false},""children"":[{""id"":""OP_BINARY@5cf8edcf"",""value"":"">"",""pos"":{""lineNum"":1,""columnNum"":89,""endLineNum"":1,""endColumnNum"":117,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@40ee0a22"",""value"":""NS_IDENT@40d10481.times_a_week"",""pos"":{""lineNum"":1,""columnNum"":89,""endLineNum"":1,""endColumnNum"":100,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@57540fd0"",""value"":""NS_IDENT@78de58ea.times_a_week"",""pos"":{""lineNum"":1,""columnNum"":104,""endLineNum"":1,""endColumnNum"":117,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@1542af63"",""value"":""="",""pos"":{""lineNum"":1,""columnNum"":123,""endLineNum"":1,""endColumnNum"":141,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@58cec85b"",""value"":""NS_IDENT@78de58ea.drinker"",""pos"":{""lineNum"":1,""columnNum"":123,""endLineNum"":1,""endColumnNum"":131,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@629f066f"",""value"":""NS_IDENT@40d10481.drinker"",""pos"":{""lineNum"":1,""columnNum"":135,""endLineNum"":1,""endColumnNum"":141,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@629f066f"",""value"":""NS_IDENT@40d10481.drinker"",""pos"":{""lineNum"":1,""columnNum"":135,""endLineNum"":1,""endColumnNum"":141,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@57540fd0"",""value"":""NS_IDENT@78de58ea.times_a_week"",""pos"":{""lineNum"":1,""columnNum"":104,""endLineNum"":1,""endColumnNum"":117,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@58cec85b"",""value"":""NS_IDENT@78de58ea.drinker"",""pos"":{""lineNum"":1,""columnNum"":123,""endLineNum"":1,""endColumnNum"":131,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@40ee0a22"",""value"":""NS_IDENT@40d10481.times_a_week"",""pos"":{""lineNum"":1,""columnNum"":89,""endLineNum"":1,""endColumnNum"":100,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@78de58ea""],""corrCtxIds"":[""BLOCK_SELECT@2d66530f""],""pos"":{""lineNum"":1,""columnNum"":59,""endLineNum"":1,""endColumnNum"":141,""quoted"":false},""children"":{}}}},{""id"":""BLOCK_SELECT@66bfd864"",""alias"":""D"",""fields"":[""NAME VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@7c455e96"",""value"":""NS_IDENT@1f1cae23.NAME"",""pos"":{""lineNum"":1,""columnNum"":159,""endLineNum"":1,""endColumnNum"":162,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@1f1cae23""],""fromNode"":{""id"":""JOIN_OPERAND@4aac85fa"",""value"":""NS_IDENT@1f1cae23"",""pos"":{""lineNum"":1,""columnNum"":169,""endLineNum"":1,""endColumnNum"":175,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@7c455e96"",""value"":""NS_IDENT@1f1cae23.NAME"",""pos"":{""lineNum"":1,""columnNum"":159,""endLineNum"":1,""endColumnNum"":162,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":152,""endLineNum"":1,""endColumnNum"":175,""quoted"":false},""children"":{}}]}
"
"


WITH drinkers AS
	(SELECT DISTINCT name
	FROM drinker),

joined AS
	(SELECT drinkers.name AS drinker, frequents.times_a_week AS f, frequents.bar AS b
	FROM drinkers
		LEFT OUTER JOIN frequents ON drinkers.name = frequents.drinker
	GROUP BY frequents.bar, drinkers.name, frequents.times_a_week),

max AS
	(SELECT MAX(f) as f, drinker
	FROM joined
	GROUP BY drinker)

SELECT max.drinker, frequents.bar
FROM max LEFT OUTER JOIN frequents ON frequents.drinker = max.drinker and frequents.times_a_week = max.f;
 ","{""failed"":true,""errorMsg"":""Parsing error at line 14, column 1. Query syntax may be incorrect""}
"
"WITH myMax AS
(SELECT frequents.drinker as drinker, frequents.bar as bar
FROM
  (SELECT drinker, MAX(times_a_week) as maxTime
FROM frequents
GROUP BY drinker) AS Times
INNER JOIN frequents ON frequents.drinker = Times.drinker AND frequents.times_a_week = Times.maxTime)

SELECT drinker.name, myMax.bar
FROM drinker
LEFT OUTER JOIN myMax
ON myMax.drinker = drinker.name;","{""blocks"":{""id"":""BLOCK_SELECT@f973499"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@14fc5d40"",""value"":""NS_IDENT@320494b6.NAME"",""pos"":{""lineNum"":9,""columnNum"":8,""endLineNum"":9,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@61f3fbb8"",""value"":""NS_IDENT@652ab8d9.BAR"",""pos"":{""lineNum"":9,""columnNum"":22,""endLineNum"":9,""endColumnNum"":30,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@320494b6"",""NS_IDENT@652ab8d9""],""fromNode"":{""id"":""OP_JOIN@4d33940d"",""value"":""LEFT"",""pos"":{""lineNum"":11,""columnNum"":12,""endLineNum"":11,""endColumnNum"":15,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@43cf6ea3"",""value"":""NS_IDENT@320494b6"",""pos"":{""lineNum"":10,""columnNum"":6,""endLineNum"":10,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@37c5fc56"",""value"":""NS_IDENT@652ab8d9"",""pos"":{""lineNum"":11,""columnNum"":17,""endLineNum"":11,""endColumnNum"":21,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@2b8d084"",""value"":""="",""pos"":{""lineNum"":12,""columnNum"":4,""endLineNum"":12,""endColumnNum"":31,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@49601f82"",""value"":""NS_IDENT@652ab8d9.DRINKER"",""pos"":{""lineNum"":12,""columnNum"":4,""endLineNum"":12,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@23e44287"",""value"":""NS_IDENT@320494b6.name"",""pos"":{""lineNum"":12,""columnNum"":20,""endLineNum"":12,""endColumnNum"":31,""quoted"":false},""children"":[]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@61f3fbb8"",""value"":""NS_IDENT@652ab8d9.BAR"",""pos"":{""lineNum"":9,""columnNum"":22,""endLineNum"":9,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@23e44287"",""value"":""NS_IDENT@320494b6.name"",""pos"":{""lineNum"":12,""columnNum"":20,""endLineNum"":12,""endColumnNum"":31,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@14fc5d40"",""value"":""NS_IDENT@320494b6.NAME"",""pos"":{""lineNum"":9,""columnNum"":8,""endLineNum"":9,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@49601f82"",""value"":""NS_IDENT@652ab8d9.DRINKER"",""pos"":{""lineNum"":12,""columnNum"":4,""endLineNum"":12,""endColumnNum"":16,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":9,""columnNum"":1,""endLineNum"":12,""endColumnNum"":31,""quoted"":false},""children"":{}},""tables"":{""NS_IDENT@45792847"":{""tableId"":""NS_IDENT@45792847"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":6,""endLineNum"":5,""endColumnNum"":14,""quoted"":false}},""NS_SELECT@6dd91637"":{""tableId"":""NS_SELECT@6dd91637"",""identifier"":""TIMES"",""blockId"":""BLOCK_SELECT@72ed9aad"",""fields"":[""DRINKER VARCHAR(100)"",""MAXTIME INTEGER""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":4,""endLineNum"":6,""endColumnNum"":26,""quoted"":false}},""NS_IDENT@320494b6"":{""tableId"":""NS_IDENT@320494b6"",""identifier"":""DRINKER"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":10,""columnNum"":6,""endLineNum"":10,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@652ab8d9"":{""tableId"":""NS_IDENT@652ab8d9"",""identifier"":""MYMAX"",""dbTableName"":""MYMAX"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":11,""columnNum"":17,""endLineNum"":11,""endColumnNum"":21,""quoted"":false}},""NS_IDENT@19569ebd"":{""tableId"":""NS_IDENT@19569ebd"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":12,""endLineNum"":7,""endColumnNum"":20,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@7fedfe27"",""alias"":""MYMAX"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@4632cfc"",""value"":""NS_IDENT@19569ebd.DRINKER"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":25,""quoted"":false},""children"":[],""alias"":""DRINKER""},{""id"":""COLUMN_LOCAL@2e380628"",""value"":""NS_IDENT@19569ebd.BAR"",""pos"":{""lineNum"":2,""columnNum"":39,""endLineNum"":2,""endColumnNum"":51,""quoted"":false},""children"":[],""alias"":""BAR""}],""fromItemIds"":[""NS_SELECT@6dd91637"",""NS_IDENT@19569ebd""],""fromNode"":{""id"":""OP_JOIN@2d66530f"",""value"":""INNER"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":10,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@72ed9aad"",""value"":""BLOCK_SELECT@72ed9aad"",""pos"":{""lineNum"":4,""columnNum"":4,""endLineNum"":6,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@6079cf5"",""value"":""NS_IDENT@19569ebd"",""pos"":{""lineNum"":7,""columnNum"":12,""endLineNum"":7,""endColumnNum"":20,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@43effd89"",""value"":""AND"",""pos"":{""lineNum"":7,""columnNum"":25,""endLineNum"":7,""endColumnNum"":100,""quoted"":false},""children"":[{""id"":""OP_BINARY@476ec9d0"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":25,""endLineNum"":7,""endColumnNum"":57,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@70abf9b0"",""value"":""NS_IDENT@19569ebd.drinker"",""pos"":{""lineNum"":7,""columnNum"":25,""endLineNum"":7,""endColumnNum"":41,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6a10b263"",""value"":""NS_SELECT@6dd91637.DRINKER"",""pos"":{""lineNum"":7,""columnNum"":45,""endLineNum"":7,""endColumnNum"":57,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@72fe8a4f"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":63,""endLineNum"":7,""endColumnNum"":100,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@325bb9a6"",""value"":""NS_IDENT@19569ebd.times_a_week"",""pos"":{""lineNum"":7,""columnNum"":63,""endLineNum"":7,""endColumnNum"":84,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1d12b024"",""value"":""NS_SELECT@6dd91637.MAXTIME"",""pos"":{""lineNum"":7,""columnNum"":88,""endLineNum"":7,""endColumnNum"":100,""quoted"":false},""children"":[]}]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@2e380628"",""value"":""NS_IDENT@19569ebd.BAR"",""pos"":{""lineNum"":2,""columnNum"":39,""endLineNum"":2,""endColumnNum"":51,""quoted"":false},""children"":[],""alias"":""BAR""},{""id"":""COLUMN_LOCAL@70abf9b0"",""value"":""NS_IDENT@19569ebd.drinker"",""pos"":{""lineNum"":7,""columnNum"":25,""endLineNum"":7,""endColumnNum"":41,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4632cfc"",""value"":""NS_IDENT@19569ebd.DRINKER"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":25,""quoted"":false},""children"":[],""alias"":""DRINKER""},{""id"":""COLUMN_LOCAL@325bb9a6"",""value"":""NS_IDENT@19569ebd.times_a_week"",""pos"":{""lineNum"":7,""columnNum"":63,""endLineNum"":7,""endColumnNum"":84,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6a10b263"",""value"":""NS_SELECT@6dd91637.DRINKER"",""pos"":{""lineNum"":7,""columnNum"":45,""endLineNum"":7,""endColumnNum"":57,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1d12b024"",""value"":""NS_SELECT@6dd91637.MAXTIME"",""pos"":{""lineNum"":7,""columnNum"":88,""endLineNum"":7,""endColumnNum"":100,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":2,""endLineNum"":7,""endColumnNum"":100,""quoted"":false},""children"":{""BLOCK_SELECT@72ed9aad"":{""id"":""BLOCK_SELECT@72ed9aad"",""parentId"":""BLOCK_SELECT@7fedfe27"",""alias"":""TIMES"",""fields"":[""DRINKER VARCHAR(100)"",""MAXTIME INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@56303475"",""value"":""NS_IDENT@45792847.DRINKER"",""pos"":{""lineNum"":4,""columnNum"":11,""endLineNum"":4,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@1dcca8d3"",""value"":""MAX"",""pos"":{""lineNum"":4,""columnNum"":20,""endLineNum"":4,""endColumnNum"":36,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5631962"",""value"":""NS_IDENT@45792847.TIMES_A_WEEK"",""pos"":{""lineNum"":4,""columnNum"":24,""endLineNum"":4,""endColumnNum"":35,""quoted"":false},""children"":[]}],""alias"":""MAXTIME""}],""fromItemIds"":[""NS_IDENT@45792847""],""fromNode"":{""id"":""JOIN_OPERAND@5e3a39cd"",""value"":""NS_IDENT@45792847"",""pos"":{""lineNum"":5,""columnNum"":6,""endLineNum"":5,""endColumnNum"":14,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@460b6d54"",""value"":""NS_IDENT@45792847.drinker"",""pos"":{""lineNum"":6,""columnNum"":10,""endLineNum"":6,""endColumnNum"":16,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@5631962"",""value"":""NS_IDENT@45792847.TIMES_A_WEEK"",""pos"":{""lineNum"":4,""columnNum"":24,""endLineNum"":4,""endColumnNum"":35,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@56303475"",""value"":""NS_IDENT@45792847.DRINKER"",""pos"":{""lineNum"":4,""columnNum"":11,""endLineNum"":4,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@460b6d54"",""value"":""NS_IDENT@45792847.drinker"",""pos"":{""lineNum"":6,""columnNum"":10,""endLineNum"":6,""endColumnNum"":16,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":4,""columnNum"":4,""endLineNum"":6,""endColumnNum"":16,""quoted"":false},""children"":{}}}}]}
"
"select D.name, F.bar
from drinker D left outer join frequents F
on D.name = F.drinker
and F.times_a_week = (select max(times_a_week)
                      from frequents F1
                      where F1.drinker = D.name)","{""blocks"":{""id"":""BLOCK_SELECT@3f36b447"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@1698d7c0"",""value"":""NS_IDENT@22d9c961.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@87abc48"",""value"":""NS_IDENT@73ba6fe6.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@22d9c961"",""NS_IDENT@73ba6fe6""],""fromNode"":{""id"":""OP_JOIN@4e868ef5"",""value"":""LEFT"",""pos"":{""lineNum"":2,""columnNum"":27,""endLineNum"":2,""endColumnNum"":30,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@afb5821"",""value"":""NS_IDENT@22d9c961"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@56ccd751"",""value"":""NS_IDENT@73ba6fe6"",""pos"":{""lineNum"":2,""columnNum"":32,""endLineNum"":2,""endColumnNum"":40,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@6b587673"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":4,""endLineNum"":6,""endColumnNum"":47,""quoted"":false},""children"":[{""id"":""OP_BINARY@7f02251"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":4,""endLineNum"":3,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@322803db"",""value"":""NS_IDENT@22d9c961.name"",""pos"":{""lineNum"":3,""columnNum"":4,""endLineNum"":3,""endColumnNum"":9,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@392a04e7"",""value"":""NS_IDENT@73ba6fe6.drinker"",""pos"":{""lineNum"":3,""columnNum"":13,""endLineNum"":3,""endColumnNum"":21,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@6d3c232f"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":6,""endColumnNum"":47,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4d8126f"",""value"":""NS_IDENT@73ba6fe6.times_a_week"",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":4,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT_SCALAR@5cf87cfd"",""value"":""BLOCK_SELECT@458544e0"",""pos"":{""lineNum"":4,""columnNum"":23,""endLineNum"":6,""endColumnNum"":47,""quoted"":false},""children"":[]}]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@322803db"",""value"":""NS_IDENT@22d9c961.name"",""pos"":{""lineNum"":3,""columnNum"":4,""endLineNum"":3,""endColumnNum"":9,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4d8126f"",""value"":""NS_IDENT@73ba6fe6.times_a_week"",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":4,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1698d7c0"",""value"":""NS_IDENT@22d9c961.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@87abc48"",""value"":""NS_IDENT@73ba6fe6.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@392a04e7"",""value"":""NS_IDENT@73ba6fe6.drinker"",""pos"":{""lineNum"":3,""columnNum"":13,""endLineNum"":3,""endColumnNum"":21,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@22d9c961.name""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":6,""endColumnNum"":48,""quoted"":false},""children"":{""BLOCK_SELECT@458544e0"":{""id"":""BLOCK_SELECT@458544e0"",""parentId"":""BLOCK_SELECT@3f36b447"",""fields"":[""EXPR$0 INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""OP_AGG_FUNC@27b71f50"",""value"":""MAX"",""pos"":{""lineNum"":4,""columnNum"":30,""endLineNum"":4,""endColumnNum"":46,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@383790cf"",""value"":""NS_IDENT@13047d7d.TIMES_A_WEEK"",""pos"":{""lineNum"":4,""columnNum"":34,""endLineNum"":4,""endColumnNum"":45,""quoted"":false},""children"":[]}]}],""fromItemIds"":[""NS_IDENT@13047d7d""],""fromNode"":{""id"":""JOIN_OPERAND@6bcbf05b"",""value"":""NS_IDENT@13047d7d"",""pos"":{""lineNum"":5,""columnNum"":28,""endLineNum"":5,""endColumnNum"":36,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@2032e725"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":29,""endLineNum"":6,""endColumnNum"":47,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@3eed0f5"",""value"":""NS_IDENT@13047d7d.drinker"",""pos"":{""lineNum"":6,""columnNum"":29,""endLineNum"":6,""endColumnNum"":38,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@64030b91"",""value"":""NS_IDENT@22d9c961.name"",""pos"":{""lineNum"":6,""columnNum"":42,""endLineNum"":6,""endColumnNum"":47,""quoted"":false},""children"":[]}]},""isAggregate"":true,""identifiers"":[{""id"":""COLUMN_LOCAL@3eed0f5"",""value"":""NS_IDENT@13047d7d.drinker"",""pos"":{""lineNum"":6,""columnNum"":29,""endLineNum"":6,""endColumnNum"":38,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@383790cf"",""value"":""NS_IDENT@13047d7d.TIMES_A_WEEK"",""pos"":{""lineNum"":4,""columnNum"":34,""endLineNum"":4,""endColumnNum"":45,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@64030b91"",""value"":""NS_IDENT@22d9c961.name"",""pos"":{""lineNum"":6,""columnNum"":42,""endLineNum"":6,""endColumnNum"":47,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@22d9c961""],""corrCtxIds"":[""BLOCK_SELECT@3f36b447""],""pos"":{""lineNum"":4,""columnNum"":23,""endLineNum"":6,""endColumnNum"":47,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@22d9c961"":{""tableId"":""NS_IDENT@22d9c961"",""identifier"":""D"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":14,""quoted"":false}},""NS_IDENT@73ba6fe6"":{""tableId"":""NS_IDENT@73ba6fe6"",""identifier"":""F"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":32,""endLineNum"":2,""endColumnNum"":42,""quoted"":false}},""NS_IDENT@13047d7d"":{""tableId"":""NS_IDENT@13047d7d"",""identifier"":""F1"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":28,""endLineNum"":5,""endColumnNum"":39,""quoted"":false}}},""corrTables"":[""NS_IDENT@22d9c961""]}
"
"SELECT name,bar FROM Drinker FULL OUTER JOIN
(SELECT Frequents.drinker,Frequents.bar FROM (SELECT drinker, MAX(times_a_week) FROM Frequents GROUP BY drinker)AS drinkerFrequencies,
 Frequents WHERE drinkerFrequencies.drinker=Frequents.drinker AND drinkerFrequencies.max=Frequents.times_a_week) AS B ON Drinker.name=B.drinker

","{""failed"":true,""errorMsg"":""Parsing error at line 3, column 85. Query syntax may be incorrect""}
"
"WITH drinkerLOJfrequents as
  (SELECT *
  FROM drinker LEFT OUTER JOIN frequents ON drinker.name = frequents.drinker)
SELECT name, bar
FROM drinkerLOJfrequents
WHERE drinkerLOJfrequents.times_a_week >= ALL(SELECT times_a_week
                                              FROM frequents
                                              WHERE drinkerLOJfrequents.drinker = frequents.drinker)
    OR drinkerLOJfrequents.drinker IS NULL","{""blocks"":{""id"":""BLOCK_SELECT@2fe88a09"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@69c93ca4"",""value"":""NS_IDENT@7d755813.NAME"",""pos"":{""lineNum"":4,""columnNum"":8,""endLineNum"":4,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@173373b4"",""value"":""NS_IDENT@7d755813.BAR"",""pos"":{""lineNum"":4,""columnNum"":14,""endLineNum"":4,""endColumnNum"":16,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@7d755813""],""fromNode"":{""id"":""JOIN_OPERAND@4aac85fa"",""value"":""NS_IDENT@7d755813"",""pos"":{""lineNum"":5,""columnNum"":6,""endLineNum"":5,""endColumnNum"":24,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@78faea5f"",""value"":""OR"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":9,""endColumnNum"":42,""quoted"":false},""children"":[{""id"":""OP_BINARY@293cde83"",""value"":"">= ALL"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":8,""endColumnNum"":99,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4e4c3a38"",""value"":""NS_IDENT@7d755813.times_a_week"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":38,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@1917d90f"",""value"":""BLOCK_SELECT@1917d90f"",""pos"":{""lineNum"":6,""columnNum"":47,""endLineNum"":8,""endColumnNum"":99,""quoted"":false},""children"":[]}]},{""id"":""OP_POSTFIX@57c88764"",""value"":""IS NULL"",""pos"":{""lineNum"":9,""columnNum"":8,""endLineNum"":9,""endColumnNum"":42,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@c27d163"",""value"":""NS_IDENT@7d755813.drinker"",""pos"":{""lineNum"":9,""columnNum"":8,""endLineNum"":9,""endColumnNum"":34,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@173373b4"",""value"":""NS_IDENT@7d755813.BAR"",""pos"":{""lineNum"":4,""columnNum"":14,""endLineNum"":4,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@c27d163"",""value"":""NS_IDENT@7d755813.drinker"",""pos"":{""lineNum"":9,""columnNum"":8,""endLineNum"":9,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@69c93ca4"",""value"":""NS_IDENT@7d755813.NAME"",""pos"":{""lineNum"":4,""columnNum"":8,""endLineNum"":4,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4e4c3a38"",""value"":""NS_IDENT@7d755813.times_a_week"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":38,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@7d755813.drinker""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":4,""columnNum"":1,""endLineNum"":9,""endColumnNum"":42,""quoted"":false},""children"":{""BLOCK_SELECT@1917d90f"":{""id"":""BLOCK_SELECT@1917d90f"",""parentId"":""BLOCK_SELECT@2fe88a09"",""fields"":[""TIMES_A_WEEK INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@1603dc2f"",""value"":""NS_IDENT@52b6319f.TIMES_A_WEEK"",""pos"":{""lineNum"":6,""columnNum"":54,""endLineNum"":6,""endColumnNum"":65,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@52b6319f""],""fromNode"":{""id"":""JOIN_OPERAND@66bfd864"",""value"":""NS_IDENT@52b6319f"",""pos"":{""lineNum"":7,""columnNum"":52,""endLineNum"":7,""endColumnNum"":60,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@72fe8a4f"",""value"":""="",""pos"":{""lineNum"":8,""columnNum"":53,""endLineNum"":8,""endColumnNum"":99,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@325bb9a6"",""value"":""NS_IDENT@7d755813.drinker"",""pos"":{""lineNum"":8,""columnNum"":53,""endLineNum"":8,""endColumnNum"":79,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1d12b024"",""value"":""NS_IDENT@52b6319f.drinker"",""pos"":{""lineNum"":8,""columnNum"":83,""endLineNum"":8,""endColumnNum"":99,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_CORRELATE@325bb9a6"",""value"":""NS_IDENT@7d755813.drinker"",""pos"":{""lineNum"":8,""columnNum"":53,""endLineNum"":8,""endColumnNum"":79,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1603dc2f"",""value"":""NS_IDENT@52b6319f.TIMES_A_WEEK"",""pos"":{""lineNum"":6,""columnNum"":54,""endLineNum"":6,""endColumnNum"":65,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1d12b024"",""value"":""NS_IDENT@52b6319f.drinker"",""pos"":{""lineNum"":8,""columnNum"":83,""endLineNum"":8,""endColumnNum"":99,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@7d755813""],""corrCtxIds"":[""BLOCK_SELECT@2fe88a09""],""pos"":{""lineNum"":6,""columnNum"":47,""endLineNum"":8,""endColumnNum"":99,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@7d755813"":{""tableId"":""NS_IDENT@7d755813"",""identifier"":""DRINKERLOJFREQUENTS"",""dbTableName"":""DRINKERLOJFREQUENTS"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)"",""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":6,""endLineNum"":5,""endColumnNum"":24,""quoted"":false}},""NS_IDENT@23e44287"":{""tableId"":""NS_IDENT@23e44287"",""identifier"":""DRINKER"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":8,""endLineNum"":3,""endColumnNum"":14,""quoted"":false}},""NS_IDENT@250b236d"":{""tableId"":""NS_IDENT@250b236d"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":32,""endLineNum"":3,""endColumnNum"":40,""quoted"":false}},""NS_IDENT@52b6319f"":{""tableId"":""NS_IDENT@52b6319f"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":52,""endLineNum"":7,""endColumnNum"":60,""quoted"":false}}},""corrTables"":[""NS_IDENT@7d755813""],""withBlocks"":[{""id"":""BLOCK_SELECT@2f879bab"",""alias"":""DRINKERLOJFREQUENTS"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)"",""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@7551da2a"",""value"":""*"",""pos"":{""lineNum"":2,""columnNum"":11,""endLineNum"":2,""endColumnNum"":11,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@23e44287"",""NS_IDENT@250b236d""],""fromNode"":{""id"":""OP_JOIN@1d207fad"",""value"":""LEFT"",""pos"":{""lineNum"":3,""columnNum"":27,""endLineNum"":3,""endColumnNum"":30,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@f9b5552"",""value"":""NS_IDENT@23e44287"",""pos"":{""lineNum"":3,""columnNum"":8,""endLineNum"":3,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@5d58c727"",""value"":""NS_IDENT@250b236d"",""pos"":{""lineNum"":3,""columnNum"":32,""endLineNum"":3,""endColumnNum"":40,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@76075d65"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":45,""endLineNum"":3,""endColumnNum"":76,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4c98a6d5"",""value"":""NS_IDENT@23e44287.name"",""pos"":{""lineNum"":3,""columnNum"":45,""endLineNum"":3,""endColumnNum"":56,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5cf87cfd"",""value"":""NS_IDENT@250b236d.drinker"",""pos"":{""lineNum"":3,""columnNum"":60,""endLineNum"":3,""endColumnNum"":76,""quoted"":false},""children"":[]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@4c98a6d5"",""value"":""NS_IDENT@23e44287.name"",""pos"":{""lineNum"":3,""columnNum"":45,""endLineNum"":3,""endColumnNum"":56,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5cf87cfd"",""value"":""NS_IDENT@250b236d.drinker"",""pos"":{""lineNum"":3,""columnNum"":60,""endLineNum"":3,""endColumnNum"":76,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":4,""endLineNum"":3,""endColumnNum"":76,""quoted"":false},""children"":{}}]}
"
"
with most_frequent as (
  select f.drinker, max(f.times_a_week) as times_a_week
    from frequents f
    group by f.drinker
),

drinkers_favorite as (
  select f.drinker, f.bar
    from frequents f
    where f.times_a_week in (
      select mf.times_a_week
        from most_frequent mf
        where mf.drinker = f.drinker
    )
)

select drinker.name, drinkers_favorite.bar
  from drinker left join drinkers_favorite
  on drinker.name = drinkers_favorite.drinker","{""blocks"":{""id"":""BLOCK_SELECT@6079cf5"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@3c0036b"",""value"":""NS_IDENT@26f96b85.NAME"",""pos"":{""lineNum"":18,""columnNum"":8,""endLineNum"":18,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4e25147a"",""value"":""NS_IDENT@46d8f407.BAR"",""pos"":{""lineNum"":18,""columnNum"":22,""endLineNum"":18,""endColumnNum"":42,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@26f96b85"",""NS_IDENT@46d8f407""],""fromNode"":{""id"":""OP_JOIN@5486887b"",""value"":""LEFT"",""pos"":{""lineNum"":19,""columnNum"":21,""endLineNum"":19,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@4d33940d"",""value"":""NS_IDENT@26f96b85"",""pos"":{""lineNum"":19,""columnNum"":8,""endLineNum"":19,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@43cf6ea3"",""value"":""NS_IDENT@46d8f407"",""pos"":{""lineNum"":19,""columnNum"":26,""endLineNum"":19,""endColumnNum"":42,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@5bcde458"",""value"":""="",""pos"":{""lineNum"":20,""columnNum"":6,""endLineNum"":20,""endColumnNum"":45,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5e9456ae"",""value"":""NS_IDENT@26f96b85.name"",""pos"":{""lineNum"":20,""columnNum"":6,""endLineNum"":20,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@985696"",""value"":""NS_IDENT@46d8f407.DRINKER"",""pos"":{""lineNum"":20,""columnNum"":21,""endLineNum"":20,""endColumnNum"":45,""quoted"":false},""children"":[]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@4e25147a"",""value"":""NS_IDENT@46d8f407.BAR"",""pos"":{""lineNum"":18,""columnNum"":22,""endLineNum"":18,""endColumnNum"":42,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5e9456ae"",""value"":""NS_IDENT@26f96b85.name"",""pos"":{""lineNum"":20,""columnNum"":6,""endLineNum"":20,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3c0036b"",""value"":""NS_IDENT@26f96b85.NAME"",""pos"":{""lineNum"":18,""columnNum"":8,""endLineNum"":18,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@985696"",""value"":""NS_IDENT@46d8f407.DRINKER"",""pos"":{""lineNum"":20,""columnNum"":21,""endLineNum"":20,""endColumnNum"":45,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":18,""columnNum"":1,""endLineNum"":20,""endColumnNum"":45,""quoted"":false},""children"":{}},""tables"":{""NS_IDENT@47d7bfb3"":{""tableId"":""NS_IDENT@47d7bfb3"",""identifier"":""F"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":10,""endLineNum"":4,""endColumnNum"":20,""quoted"":false}},""NS_IDENT@46d8f407"":{""tableId"":""NS_IDENT@46d8f407"",""identifier"":""DRINKERS_FAVORITE"",""dbTableName"":""DRINKERS_FAVORITE"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":19,""columnNum"":26,""endLineNum"":19,""endColumnNum"":42,""quoted"":false}},""NS_IDENT@26f96b85"":{""tableId"":""NS_IDENT@26f96b85"",""identifier"":""DRINKER"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":19,""columnNum"":8,""endLineNum"":19,""endColumnNum"":14,""quoted"":false}},""NS_IDENT@3afae281"":{""tableId"":""NS_IDENT@3afae281"",""identifier"":""F"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":10,""columnNum"":10,""endLineNum"":10,""endColumnNum"":20,""quoted"":false}},""NS_IDENT@5c645b43"":{""tableId"":""NS_IDENT@5c645b43"",""identifier"":""MF"",""dbTableName"":""MOST_FREQUENT"",""fields"":[""DRINKER VARCHAR(100)"",""TIMES_A_WEEK INTEGER""],""cursor"":[0],""pos"":{""lineNum"":13,""columnNum"":14,""endLineNum"":13,""endColumnNum"":29,""quoted"":false}}},""corrTables"":[""NS_IDENT@3afae281""],""withBlocks"":[{""id"":""BLOCK_SELECT@7fedfe27"",""alias"":""MOST_FREQUENT"",""fields"":[""DRINKER VARCHAR(100)"",""TIMES_A_WEEK INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@5f13be1"",""value"":""NS_IDENT@47d7bfb3.DRINKER"",""pos"":{""lineNum"":3,""columnNum"":10,""endLineNum"":3,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@50d3bf39"",""value"":""MAX"",""pos"":{""lineNum"":3,""columnNum"":21,""endLineNum"":3,""endColumnNum"":39,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@25a73de1"",""value"":""NS_IDENT@47d7bfb3.TIMES_A_WEEK"",""pos"":{""lineNum"":3,""columnNum"":25,""endLineNum"":3,""endColumnNum"":38,""quoted"":false},""children"":[]}],""alias"":""TIMES_A_WEEK""}],""fromItemIds"":[""NS_IDENT@47d7bfb3""],""fromNode"":{""id"":""JOIN_OPERAND@4690f583"",""value"":""NS_IDENT@47d7bfb3"",""pos"":{""lineNum"":4,""columnNum"":10,""endLineNum"":4,""endColumnNum"":18,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@3a4ba480"",""value"":""NS_IDENT@47d7bfb3.drinker"",""pos"":{""lineNum"":5,""columnNum"":14,""endLineNum"":5,""endColumnNum"":22,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@3a4ba480"",""value"":""NS_IDENT@47d7bfb3.drinker"",""pos"":{""lineNum"":5,""columnNum"":14,""endLineNum"":5,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@25a73de1"",""value"":""NS_IDENT@47d7bfb3.TIMES_A_WEEK"",""pos"":{""lineNum"":3,""columnNum"":25,""endLineNum"":3,""endColumnNum"":38,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5f13be1"",""value"":""NS_IDENT@47d7bfb3.DRINKER"",""pos"":{""lineNum"":3,""columnNum"":10,""endLineNum"":3,""endColumnNum"":18,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":3,""endLineNum"":5,""endColumnNum"":22,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@22fba58c"",""alias"":""DRINKERS_FAVORITE"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@26ae880a"",""value"":""NS_IDENT@3afae281.DRINKER"",""pos"":{""lineNum"":9,""columnNum"":10,""endLineNum"":9,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3c017078"",""value"":""NS_IDENT@3afae281.BAR"",""pos"":{""lineNum"":9,""columnNum"":21,""endLineNum"":9,""endColumnNum"":25,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@3afae281""],""fromNode"":{""id"":""JOIN_OPERAND@21fff664"",""value"":""NS_IDENT@3afae281"",""pos"":{""lineNum"":10,""columnNum"":10,""endLineNum"":10,""endColumnNum"":18,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@1e9804b9"",""value"":""IN"",""pos"":{""lineNum"":11,""columnNum"":11,""endLineNum"":14,""endColumnNum"":36,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@2227a6c1"",""value"":""NS_IDENT@3afae281.times_a_week"",""pos"":{""lineNum"":11,""columnNum"":11,""endLineNum"":11,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@7e8a46b7"",""value"":""BLOCK_SELECT@7e8a46b7"",""pos"":{""lineNum"":12,""columnNum"":7,""endLineNum"":14,""endColumnNum"":36,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@3c017078"",""value"":""NS_IDENT@3afae281.BAR"",""pos"":{""lineNum"":9,""columnNum"":21,""endLineNum"":9,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@26ae880a"",""value"":""NS_IDENT@3afae281.DRINKER"",""pos"":{""lineNum"":9,""columnNum"":10,""endLineNum"":9,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2227a6c1"",""value"":""NS_IDENT@3afae281.times_a_week"",""pos"":{""lineNum"":11,""columnNum"":11,""endLineNum"":11,""endColumnNum"":24,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@3afae281.drinker""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":9,""columnNum"":3,""endLineNum"":15,""endColumnNum"":5,""quoted"":false},""children"":{""BLOCK_SELECT@7e8a46b7"":{""id"":""BLOCK_SELECT@7e8a46b7"",""parentId"":""BLOCK_SELECT@22fba58c"",""fields"":[""TIMES_A_WEEK INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@51ec2df1"",""value"":""NS_IDENT@5c645b43.TIMES_A_WEEK"",""pos"":{""lineNum"":12,""columnNum"":14,""endLineNum"":12,""endColumnNum"":28,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@5c645b43""],""fromNode"":{""id"":""JOIN_OPERAND@2fe88a09"",""value"":""NS_IDENT@5c645b43"",""pos"":{""lineNum"":13,""columnNum"":14,""endLineNum"":13,""endColumnNum"":26,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@64138b0c"",""value"":""="",""pos"":{""lineNum"":14,""columnNum"":15,""endLineNum"":14,""endColumnNum"":36,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_IDENT@5c645b43.DRINKER"",""pos"":{""lineNum"":14,""columnNum"":15,""endLineNum"":14,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@41c204a0"",""value"":""NS_IDENT@3afae281.drinker"",""pos"":{""lineNum"":14,""columnNum"":28,""endLineNum"":14,""endColumnNum"":36,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@51ec2df1"",""value"":""NS_IDENT@5c645b43.TIMES_A_WEEK"",""pos"":{""lineNum"":12,""columnNum"":14,""endLineNum"":12,""endColumnNum"":28,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_IDENT@5c645b43.DRINKER"",""pos"":{""lineNum"":14,""columnNum"":15,""endLineNum"":14,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@41c204a0"",""value"":""NS_IDENT@3afae281.drinker"",""pos"":{""lineNum"":14,""columnNum"":28,""endLineNum"":14,""endColumnNum"":36,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@3afae281""],""corrCtxIds"":[""BLOCK_SELECT@22fba58c""],""pos"":{""lineNum"":12,""columnNum"":7,""endLineNum"":14,""endColumnNum"":36,""quoted"":false},""children"":{}}}}]}
"
"SELECT D.name, F.bar
FROM drinker D
LEFT JOIN frequents F ON D.name = F.drinker
WHERE F.times_a_week >= ALL(SELECT times_a_week FROM frequents WHERE drinker = D.name)","{""blocks"":{""id"":""BLOCK_SELECT@5eeedb60"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@77a281fc"",""value"":""NS_IDENT@153f66e7.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2bfbffb2"",""value"":""NS_IDENT@388b401d.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@153f66e7"",""NS_IDENT@388b401d""],""fromNode"":{""id"":""OP_JOIN@1869f114"",""value"":""LEFT"",""pos"":{""lineNum"":3,""columnNum"":6,""endLineNum"":3,""endColumnNum"":9,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@18a645fd"",""value"":""NS_IDENT@153f66e7"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@6090f3ca"",""value"":""NS_IDENT@388b401d"",""pos"":{""lineNum"":3,""columnNum"":11,""endLineNum"":3,""endColumnNum"":19,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@4784013e"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":26,""endLineNum"":3,""endColumnNum"":43,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@426e505c"",""value"":""NS_IDENT@153f66e7.name"",""pos"":{""lineNum"":3,""columnNum"":26,""endLineNum"":3,""endColumnNum"":31,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3a91d146"",""value"":""NS_IDENT@388b401d.drinker"",""pos"":{""lineNum"":3,""columnNum"":35,""endLineNum"":3,""endColumnNum"":43,""quoted"":false},""children"":[]}]}},""whereNode"":{""id"":""OP_BINARY@58cec85b"",""value"":"">= ALL"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":85,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5cf8edcf"",""value"":""NS_IDENT@388b401d.times_a_week"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@4a03bb68"",""value"":""BLOCK_SELECT@4a03bb68"",""pos"":{""lineNum"":4,""columnNum"":29,""endLineNum"":4,""endColumnNum"":85,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@2bfbffb2"",""value"":""NS_IDENT@388b401d.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@77a281fc"",""value"":""NS_IDENT@153f66e7.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5cf8edcf"",""value"":""NS_IDENT@388b401d.times_a_week"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3a91d146"",""value"":""NS_IDENT@388b401d.drinker"",""pos"":{""lineNum"":3,""columnNum"":35,""endLineNum"":3,""endColumnNum"":43,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@426e505c"",""value"":""NS_IDENT@153f66e7.name"",""pos"":{""lineNum"":3,""columnNum"":26,""endLineNum"":3,""endColumnNum"":31,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@153f66e7.name""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":4,""endColumnNum"":86,""quoted"":false},""children"":{""BLOCK_SELECT@4a03bb68"":{""id"":""BLOCK_SELECT@4a03bb68"",""parentId"":""BLOCK_SELECT@5eeedb60"",""fields"":[""TIMES_A_WEEK INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@ecfbe91"",""value"":""NS_IDENT@4a7761b1.TIMES_A_WEEK"",""pos"":{""lineNum"":4,""columnNum"":36,""endLineNum"":4,""endColumnNum"":47,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@4a7761b1""],""fromNode"":{""id"":""JOIN_OPERAND@2f879bab"",""value"":""NS_IDENT@4a7761b1"",""pos"":{""lineNum"":4,""columnNum"":54,""endLineNum"":4,""endColumnNum"":62,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@67001148"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":70,""endLineNum"":4,""endColumnNum"":85,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4cafa9aa"",""value"":""NS_IDENT@4a7761b1.drinker"",""pos"":{""lineNum"":4,""columnNum"":70,""endLineNum"":4,""endColumnNum"":76,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@562c877a"",""value"":""NS_IDENT@153f66e7.name"",""pos"":{""lineNum"":4,""columnNum"":80,""endLineNum"":4,""endColumnNum"":85,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_CORRELATE@562c877a"",""value"":""NS_IDENT@153f66e7.name"",""pos"":{""lineNum"":4,""columnNum"":80,""endLineNum"":4,""endColumnNum"":85,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@ecfbe91"",""value"":""NS_IDENT@4a7761b1.TIMES_A_WEEK"",""pos"":{""lineNum"":4,""columnNum"":36,""endLineNum"":4,""endColumnNum"":47,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4cafa9aa"",""value"":""NS_IDENT@4a7761b1.drinker"",""pos"":{""lineNum"":4,""columnNum"":70,""endLineNum"":4,""endColumnNum"":76,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@153f66e7""],""corrCtxIds"":[""BLOCK_SELECT@5eeedb60""],""pos"":{""lineNum"":4,""columnNum"":29,""endLineNum"":4,""endColumnNum"":85,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@388b401d"":{""tableId"":""NS_IDENT@388b401d"",""identifier"":""F"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":11,""endLineNum"":3,""endColumnNum"":21,""quoted"":false}},""NS_IDENT@153f66e7"":{""tableId"":""NS_IDENT@153f66e7"",""identifier"":""D"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":14,""quoted"":false}},""NS_IDENT@4a7761b1"":{""tableId"":""NS_IDENT@4a7761b1"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":54,""endLineNum"":4,""endColumnNum"":62,""quoted"":false}}},""corrTables"":[""NS_IDENT@153f66e7""]}
"
"WITH maxrecorded AS
(SELECT drinker, MAX(times_a_week) as maxTAW
FROM frequents
GROUP BY drinker),
simplified AS
(SELECT name, maxTAW FROM
((SELECT name FROM drinker) AS uniqueNames
LEFT OUTER JOIN
maxRecorded ON (uniqueNames.name = maxRecorded.drinker)) AS Q1)

SELECT name, bar
FROM simplified
LEFT OUTER JOIN
frequents ON (simplified.name = frequents.drinker AND maxTAW = frequents.times_a_week);
","{""failed"":true,""errorMsg"":""Parsing error at line 7, column 29. Query syntax may be incorrect""}
"
"with alldrinkers as (
select name
from drinker
),

frequents_max as (
select drinker, max(times_a_week)
from frequents
group by drinker
),

max_bar as (
select frequents_max.drinker, frequents_max.max, frequents.bar
from frequents_max, frequents
where frequents_max.max = frequents.times_a_week
and frequents_max.drinker = frequents.drinker
)

select name, bar
from alldrinkers
left join max_bar
on max_bar.drinker = alldrinkers.name

","{""failed"":true,""errorMsg"":""Parsing error at line 13, column 44. Query syntax may be incorrect""}
"
"with DF as
(select name, MAX(times_a_week) from drinker left outer join frequents
on drinker.name = frequents.drinker
group by name)
select name, bar from DF left outer join frequents
on frequents.drinker = DF.name and frequents.times_a_week = DF.max","{""failed"":true,""errorMsg"":""Parsing error at line 6, column 63. Query syntax may be incorrect""}
"
"Select d1.name, f1.bar
From drinker d1
Left outer join frequents f1 on f1.drinker=d1.name
Where exists (Select name from drinker 
Left outer join frequents on drinker.name=frequents.drinker
Where d1.name=drinker.name
Group by name having f1.times_a_week=max(times_a_week) or f1.times_a_week is Null);
","{""failed"":true,""errorMsg"":""From line 7, column 22 to line 7, column 36: Expression 'F1.TIMES_A_WEEK' is not being grouped""}
"
"with drinkerTimes(drinker, times) as (
  select
    drinker,
    MAX(times_a_week)
  from
    Frequents
  group by
    drinker
),
freqMax (drinker, bar) as (
  select
    Frequents.drinker,
    Frequents.bar
  from
    drinkerTimes DT,
    Frequents
  where
    DT.drinker = Frequents.drinker
    and DT.times = Frequents.times_a_week
)
select
  D1.name,
  bar
from
  Drinker D1 full
  join freqMax on D1.name = freqMax.drinker","{""blocks"":{""id"":""BLOCK_SELECT@43cf6ea3"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@50d3bf39"",""value"":""NS_IDENT@5f13be1.NAME"",""pos"":{""lineNum"":22,""columnNum"":3,""endLineNum"":22,""endColumnNum"":9,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@29852487"",""value"":""NS_IDENT@5f303ecd.BAR"",""pos"":{""lineNum"":23,""columnNum"":3,""endLineNum"":23,""endColumnNum"":5,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@5f13be1"",""NS_IDENT@5f303ecd""],""fromNode"":{""id"":""OP_JOIN@37c5fc56"",""value"":""FULL"",""pos"":{""lineNum"":26,""columnNum"":3,""endLineNum"":26,""endColumnNum"":6,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@1c025cb"",""value"":""NS_IDENT@5f13be1"",""pos"":{""lineNum"":25,""columnNum"":3,""endLineNum"":25,""endColumnNum"":9,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@50825a02"",""value"":""NS_IDENT@5f303ecd"",""pos"":{""lineNum"":26,""columnNum"":8,""endLineNum"":26,""endColumnNum"":14,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@78de58ea"",""value"":""="",""pos"":{""lineNum"":26,""columnNum"":19,""endLineNum"":26,""endColumnNum"":43,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7551da2a"",""value"":""NS_IDENT@5f13be1.name"",""pos"":{""lineNum"":26,""columnNum"":19,""endLineNum"":26,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@432034a"",""value"":""NS_IDENT@5f303ecd.DRINKER"",""pos"":{""lineNum"":26,""columnNum"":29,""endLineNum"":26,""endColumnNum"":43,""quoted"":false},""children"":[]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@29852487"",""value"":""NS_IDENT@5f303ecd.BAR"",""pos"":{""lineNum"":23,""columnNum"":3,""endLineNum"":23,""endColumnNum"":5,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@432034a"",""value"":""NS_IDENT@5f303ecd.DRINKER"",""pos"":{""lineNum"":26,""columnNum"":29,""endLineNum"":26,""endColumnNum"":43,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@50d3bf39"",""value"":""NS_IDENT@5f13be1.NAME"",""pos"":{""lineNum"":22,""columnNum"":3,""endLineNum"":22,""endColumnNum"":9,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7551da2a"",""value"":""NS_IDENT@5f13be1.name"",""pos"":{""lineNum"":26,""columnNum"":19,""endLineNum"":26,""endColumnNum"":25,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":21,""columnNum"":1,""endLineNum"":26,""endColumnNum"":43,""quoted"":false},""children"":{}},""tables"":{""NS_IDENT@5f303ecd"":{""tableId"":""NS_IDENT@5f303ecd"",""identifier"":""FREQMAX"",""dbTableName"":""FREQMAX"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":26,""columnNum"":8,""endLineNum"":26,""endColumnNum"":14,""quoted"":false}},""NS_IDENT@5631962"":{""tableId"":""NS_IDENT@5631962"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":5,""endLineNum"":6,""endColumnNum"":13,""quoted"":false}},""NS_IDENT@5f13be1"":{""tableId"":""NS_IDENT@5f13be1"",""identifier"":""D1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":25,""columnNum"":3,""endLineNum"":25,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@31ee96f4"":{""tableId"":""NS_IDENT@31ee96f4"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":16,""columnNum"":5,""endLineNum"":16,""endColumnNum"":13,""quoted"":false}},""NS_IDENT@5754de72"":{""tableId"":""NS_IDENT@5754de72"",""identifier"":""DT"",""dbTableName"":""DRINKERTIMES"",""fields"":[""DRINKER VARCHAR(100)"",""TIMES INTEGER""],""cursor"":[0],""pos"":{""lineNum"":15,""columnNum"":5,""endLineNum"":15,""endColumnNum"":19,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@7fedfe27"",""alias"":""DRINKERTIMES"",""fields"":[""DRINKER VARCHAR(100)"",""EXPR$1 INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@6e1f8469"",""value"":""NS_IDENT@5631962.DRINKER"",""pos"":{""lineNum"":3,""columnNum"":5,""endLineNum"":3,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@3b6c624"",""value"":""MAX"",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":4,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1eaf1e62"",""value"":""NS_IDENT@5631962.TIMES_A_WEEK"",""pos"":{""lineNum"":4,""columnNum"":9,""endLineNum"":4,""endColumnNum"":20,""quoted"":false},""children"":[]}]}],""fromItemIds"":[""NS_IDENT@5631962""],""fromNode"":{""id"":""JOIN_OPERAND@488b50ec"",""value"":""NS_IDENT@5631962"",""pos"":{""lineNum"":6,""columnNum"":5,""endLineNum"":6,""endColumnNum"":13,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@76075d65"",""value"":""NS_IDENT@5631962.drinker"",""pos"":{""lineNum"":8,""columnNum"":5,""endLineNum"":8,""endColumnNum"":11,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@6e1f8469"",""value"":""NS_IDENT@5631962.DRINKER"",""pos"":{""lineNum"":3,""columnNum"":5,""endLineNum"":3,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1eaf1e62"",""value"":""NS_IDENT@5631962.TIMES_A_WEEK"",""pos"":{""lineNum"":4,""columnNum"":9,""endLineNum"":4,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@76075d65"",""value"":""NS_IDENT@5631962.drinker"",""pos"":{""lineNum"":8,""columnNum"":5,""endLineNum"":8,""endColumnNum"":11,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":3,""endLineNum"":8,""endColumnNum"":11,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@4aac85fa"",""alias"":""FREQMAX"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@320494b6"",""value"":""NS_IDENT@31ee96f4.DRINKER"",""pos"":{""lineNum"":12,""columnNum"":5,""endLineNum"":12,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@14fc5d40"",""value"":""NS_IDENT@31ee96f4.BAR"",""pos"":{""lineNum"":13,""columnNum"":5,""endLineNum"":13,""endColumnNum"":17,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@5754de72"",""NS_IDENT@31ee96f4""],""fromNode"":{""id"":""OP_JOIN@30cecdca"",""value"":""COMMA"",""pos"":{""lineNum"":15,""columnNum"":20,""endLineNum"":15,""endColumnNum"":20,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@5486887b"",""value"":""NS_IDENT@5754de72"",""pos"":{""lineNum"":15,""columnNum"":5,""endLineNum"":15,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@5226e402"",""value"":""NS_IDENT@31ee96f4"",""pos"":{""lineNum"":16,""columnNum"":5,""endLineNum"":16,""endColumnNum"":13,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@64138b0c"",""value"":""AND"",""pos"":{""lineNum"":18,""columnNum"":5,""endLineNum"":19,""endColumnNum"":41,""quoted"":false},""children"":[{""id"":""OP_BINARY@7fab4be7"",""value"":""="",""pos"":{""lineNum"":18,""columnNum"":5,""endLineNum"":18,""endColumnNum"":34,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@15fa55a6"",""value"":""NS_IDENT@5754de72.DRINKER"",""pos"":{""lineNum"":18,""columnNum"":5,""endLineNum"":18,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_IDENT@31ee96f4.drinker"",""pos"":{""lineNum"":18,""columnNum"":18,""endLineNum"":18,""endColumnNum"":34,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@41c204a0"",""value"":""="",""pos"":{""lineNum"":19,""columnNum"":9,""endLineNum"":19,""endColumnNum"":41,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@a64e035"",""value"":""NS_IDENT@5754de72.TIMES"",""pos"":{""lineNum"":19,""columnNum"":9,""endLineNum"":19,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4d74c3ba"",""value"":""NS_IDENT@31ee96f4.times_a_week"",""pos"":{""lineNum"":19,""columnNum"":20,""endLineNum"":19,""endColumnNum"":41,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@320494b6"",""value"":""NS_IDENT@31ee96f4.DRINKER"",""pos"":{""lineNum"":12,""columnNum"":5,""endLineNum"":12,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@15fa55a6"",""value"":""NS_IDENT@5754de72.DRINKER"",""pos"":{""lineNum"":18,""columnNum"":5,""endLineNum"":18,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@a64e035"",""value"":""NS_IDENT@5754de72.TIMES"",""pos"":{""lineNum"":19,""columnNum"":9,""endLineNum"":19,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_IDENT@31ee96f4.drinker"",""pos"":{""lineNum"":18,""columnNum"":18,""endLineNum"":18,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@14fc5d40"",""value"":""NS_IDENT@31ee96f4.BAR"",""pos"":{""lineNum"":13,""columnNum"":5,""endLineNum"":13,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4d74c3ba"",""value"":""NS_IDENT@31ee96f4.times_a_week"",""pos"":{""lineNum"":19,""columnNum"":20,""endLineNum"":19,""endColumnNum"":41,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":11,""columnNum"":3,""endLineNum"":19,""endColumnNum"":41,""quoted"":false},""children"":{}}]}
"
"with mostvisits as
(select d.name, max(f.times_a_week)
from drinker d left outer join frequents f on d.name = f.drinker
group by d.name)

select m.name, f.bar
from mostvisits m left outer join frequents f on m.max = f.times_a_week and m.name = f.drinker
","{""failed"":true,""errorMsg"":""Parsing error at line 7, column 51. Query syntax may be incorrect""}
"
"

WITH 
	drinkerfreq(drinker, bar, times) AS
	(SELECT drinker.name, frequents.bar, frequents.times_a_week
	FROM drinker
	LEFT OUTER JOIN frequents ON drinker.name = frequents.drinker),

	drinkerbars(drinker, bar, times) AS
	(SELECT a.drinker, a.bar, a.times
	FROM drinkerfreq a, drinkerfreq b
	WHERE a.drinker = b.drinker AND a.bar <> b.bar AND a.times < b.times)

	(SELECT drinker, bar FROM drinkerfreq)
	EXCEPT
	(SELECT drinker, bar FROM drinkerbars);
","{""blocks"":{""id"":""BLOCK_SETOP@4912d525"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@2bfbffb2"",""rightBlockId"":""BLOCK_SELECT@151335cb"",""pos"":{""lineNum"":14,""columnNum"":3,""endLineNum"":16,""endColumnNum"":38,""quoted"":false},""children"":{""BLOCK_SELECT@151335cb"":{""id"":""BLOCK_SELECT@151335cb"",""parentId"":""BLOCK_SETOP@4912d525"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@540dbda9"",""value"":""NS_IDENT@377008df.DRINKER"",""pos"":{""lineNum"":16,""columnNum"":10,""endLineNum"":16,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1be59f28"",""value"":""NS_IDENT@377008df.BAR"",""pos"":{""lineNum"":16,""columnNum"":19,""endLineNum"":16,""endColumnNum"":21,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@377008df""],""fromNode"":{""id"":""JOIN_OPERAND@4a7761b1"",""value"":""NS_IDENT@377008df"",""pos"":{""lineNum"":16,""columnNum"":28,""endLineNum"":16,""endColumnNum"":38,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@540dbda9"",""value"":""NS_IDENT@377008df.DRINKER"",""pos"":{""lineNum"":16,""columnNum"":10,""endLineNum"":16,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1be59f28"",""value"":""NS_IDENT@377008df.BAR"",""pos"":{""lineNum"":16,""columnNum"":19,""endLineNum"":16,""endColumnNum"":21,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":16,""columnNum"":3,""endLineNum"":16,""endColumnNum"":38,""quoted"":false},""children"":{}},""BLOCK_SELECT@2bfbffb2"":{""id"":""BLOCK_SELECT@2bfbffb2"",""parentId"":""BLOCK_SETOP@4912d525"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@1e6dad8"",""value"":""NS_IDENT@7baf6acf.DRINKER"",""pos"":{""lineNum"":14,""columnNum"":10,""endLineNum"":14,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@8ed9cf"",""value"":""NS_IDENT@7baf6acf.BAR"",""pos"":{""lineNum"":14,""columnNum"":19,""endLineNum"":14,""endColumnNum"":21,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@7baf6acf""],""fromNode"":{""id"":""JOIN_OPERAND@765df79d"",""value"":""NS_IDENT@7baf6acf"",""pos"":{""lineNum"":14,""columnNum"":28,""endLineNum"":14,""endColumnNum"":38,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@8ed9cf"",""value"":""NS_IDENT@7baf6acf.BAR"",""pos"":{""lineNum"":14,""columnNum"":19,""endLineNum"":14,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1e6dad8"",""value"":""NS_IDENT@7baf6acf.DRINKER"",""pos"":{""lineNum"":14,""columnNum"":10,""endLineNum"":14,""endColumnNum"":16,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":14,""columnNum"":3,""endLineNum"":14,""endColumnNum"":38,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@22bd2039"":{""tableId"":""NS_IDENT@22bd2039"",""identifier"":""DRINKER"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":13,""quoted"":false}},""NS_IDENT@256a1825"":{""tableId"":""NS_IDENT@256a1825"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":18,""endLineNum"":7,""endColumnNum"":26,""quoted"":false}},""NS_IDENT@7baf6acf"":{""tableId"":""NS_IDENT@7baf6acf"",""identifier"":""DRINKERFREQ"",""dbTableName"":""DRINKERFREQ"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)"",""TIMES INTEGER""],""cursor"":[0],""pos"":{""lineNum"":14,""columnNum"":28,""endLineNum"":14,""endColumnNum"":38,""quoted"":false}},""NS_IDENT@377008df"":{""tableId"":""NS_IDENT@377008df"",""identifier"":""DRINKERBARS"",""dbTableName"":""DRINKERBARS"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)"",""TIMES INTEGER""],""cursor"":[0],""pos"":{""lineNum"":16,""columnNum"":28,""endLineNum"":16,""endColumnNum"":38,""quoted"":false}},""NS_IDENT@2e34384c"":{""tableId"":""NS_IDENT@2e34384c"",""identifier"":""A"",""dbTableName"":""DRINKERFREQ"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)"",""TIMES INTEGER""],""cursor"":[0],""pos"":{""lineNum"":11,""columnNum"":7,""endLineNum"":11,""endColumnNum"":19,""quoted"":false}},""NS_IDENT@3051e0b2"":{""tableId"":""NS_IDENT@3051e0b2"",""identifier"":""B"",""dbTableName"":""DRINKERFREQ"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)"",""TIMES INTEGER""],""cursor"":[0],""pos"":{""lineNum"":11,""columnNum"":22,""endLineNum"":11,""endColumnNum"":34,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@5c20ffa8"",""alias"":""DRINKERFREQ"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)"",""TIMES_A_WEEK INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@57b75756"",""value"":""NS_IDENT@22bd2039.NAME"",""pos"":{""lineNum"":5,""columnNum"":10,""endLineNum"":5,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2679311f"",""value"":""NS_IDENT@256a1825.BAR"",""pos"":{""lineNum"":5,""columnNum"":24,""endLineNum"":5,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@451f87af"",""value"":""NS_IDENT@256a1825.TIMES_A_WEEK"",""pos"":{""lineNum"":5,""columnNum"":39,""endLineNum"":5,""endColumnNum"":60,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@22bd2039"",""NS_IDENT@256a1825""],""fromNode"":{""id"":""OP_JOIN@6bcbf05b"",""value"":""LEFT"",""pos"":{""lineNum"":7,""columnNum"":13,""endLineNum"":7,""endColumnNum"":16,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@37a64f9d"",""value"":""NS_IDENT@22bd2039"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@21f9277b"",""value"":""NS_IDENT@256a1825"",""pos"":{""lineNum"":7,""columnNum"":18,""endLineNum"":7,""endColumnNum"":26,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@12f8b1d8"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":31,""endLineNum"":7,""endColumnNum"":62,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5dbf5634"",""value"":""NS_IDENT@22bd2039.name"",""pos"":{""lineNum"":7,""columnNum"":31,""endLineNum"":7,""endColumnNum"":42,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7f9ab969"",""value"":""NS_IDENT@256a1825.drinker"",""pos"":{""lineNum"":7,""columnNum"":46,""endLineNum"":7,""endColumnNum"":62,""quoted"":false},""children"":[]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@5dbf5634"",""value"":""NS_IDENT@22bd2039.name"",""pos"":{""lineNum"":7,""columnNum"":31,""endLineNum"":7,""endColumnNum"":42,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@451f87af"",""value"":""NS_IDENT@256a1825.TIMES_A_WEEK"",""pos"":{""lineNum"":5,""columnNum"":39,""endLineNum"":5,""endColumnNum"":60,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@57b75756"",""value"":""NS_IDENT@22bd2039.NAME"",""pos"":{""lineNum"":5,""columnNum"":10,""endLineNum"":5,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2679311f"",""value"":""NS_IDENT@256a1825.BAR"",""pos"":{""lineNum"":5,""columnNum"":24,""endLineNum"":5,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7f9ab969"",""value"":""NS_IDENT@256a1825.drinker"",""pos"":{""lineNum"":7,""columnNum"":46,""endLineNum"":7,""endColumnNum"":62,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":5,""columnNum"":3,""endLineNum"":7,""endColumnNum"":62,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@7e8a46b7"",""alias"":""DRINKERBARS"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)"",""TIMES INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@f339eae"",""value"":""NS_IDENT@2e34384c.DRINKER"",""pos"":{""lineNum"":10,""columnNum"":10,""endLineNum"":10,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2822c6ff"",""value"":""NS_IDENT@2e34384c.BAR"",""pos"":{""lineNum"":10,""columnNum"":21,""endLineNum"":10,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4dafba3e"",""value"":""NS_IDENT@2e34384c.TIMES"",""pos"":{""lineNum"":10,""columnNum"":28,""endLineNum"":10,""endColumnNum"":34,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@2e34384c"",""NS_IDENT@3051e0b2""],""fromNode"":{""id"":""OP_JOIN@2fe88a09"",""value"":""COMMA"",""pos"":{""lineNum"":11,""columnNum"":20,""endLineNum"":11,""endColumnNum"":20,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@66bfd864"",""value"":""NS_IDENT@2e34384c"",""pos"":{""lineNum"":11,""columnNum"":7,""endLineNum"":11,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@4aac85fa"",""value"":""NS_IDENT@3051e0b2"",""pos"":{""lineNum"":11,""columnNum"":22,""endLineNum"":11,""endColumnNum"":32,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@621f89b8"",""value"":""AND"",""pos"":{""lineNum"":12,""columnNum"":8,""endLineNum"":12,""endColumnNum"":69,""quoted"":false},""children"":[{""id"":""OP_BINARY@ae7950d"",""value"":""AND"",""pos"":{""lineNum"":12,""columnNum"":8,""endLineNum"":12,""endColumnNum"":47,""quoted"":false},""children"":[{""id"":""OP_BINARY@5e8604bf"",""value"":""="",""pos"":{""lineNum"":12,""columnNum"":8,""endLineNum"":12,""endColumnNum"":28,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@6fd1660"",""value"":""NS_IDENT@2e34384c.DRINKER"",""pos"":{""lineNum"":12,""columnNum"":8,""endLineNum"":12,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4a6c18ad"",""value"":""NS_IDENT@3051e0b2.DRINKER"",""pos"":{""lineNum"":12,""columnNum"":20,""endLineNum"":12,""endColumnNum"":28,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@64aad6db"",""value"":""<>"",""pos"":{""lineNum"":12,""columnNum"":34,""endLineNum"":12,""endColumnNum"":47,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@20095ab4"",""value"":""NS_IDENT@2e34384c.BAR"",""pos"":{""lineNum"":12,""columnNum"":34,""endLineNum"":12,""endColumnNum"":38,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4e2916c3"",""value"":""NS_IDENT@3051e0b2.BAR"",""pos"":{""lineNum"":12,""columnNum"":43,""endLineNum"":12,""endColumnNum"":47,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@546621c4"",""value"":""<"",""pos"":{""lineNum"":12,""columnNum"":53,""endLineNum"":12,""endColumnNum"":69,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@60d1b21f"",""value"":""NS_IDENT@2e34384c.TIMES"",""pos"":{""lineNum"":12,""columnNum"":53,""endLineNum"":12,""endColumnNum"":59,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@66c83fc8"",""value"":""NS_IDENT@3051e0b2.TIMES"",""pos"":{""lineNum"":12,""columnNum"":63,""endLineNum"":12,""endColumnNum"":69,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@6fd1660"",""value"":""NS_IDENT@2e34384c.DRINKER"",""pos"":{""lineNum"":12,""columnNum"":8,""endLineNum"":12,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@20095ab4"",""value"":""NS_IDENT@2e34384c.BAR"",""pos"":{""lineNum"":12,""columnNum"":34,""endLineNum"":12,""endColumnNum"":38,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4a6c18ad"",""value"":""NS_IDENT@3051e0b2.DRINKER"",""pos"":{""lineNum"":12,""columnNum"":20,""endLineNum"":12,""endColumnNum"":28,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2822c6ff"",""value"":""NS_IDENT@2e34384c.BAR"",""pos"":{""lineNum"":10,""columnNum"":21,""endLineNum"":10,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@60d1b21f"",""value"":""NS_IDENT@2e34384c.TIMES"",""pos"":{""lineNum"":12,""columnNum"":53,""endLineNum"":12,""endColumnNum"":59,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@66c83fc8"",""value"":""NS_IDENT@3051e0b2.TIMES"",""pos"":{""lineNum"":12,""columnNum"":63,""endLineNum"":12,""endColumnNum"":69,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@f339eae"",""value"":""NS_IDENT@2e34384c.DRINKER"",""pos"":{""lineNum"":10,""columnNum"":10,""endLineNum"":10,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4e2916c3"",""value"":""NS_IDENT@3051e0b2.BAR"",""pos"":{""lineNum"":12,""columnNum"":43,""endLineNum"":12,""endColumnNum"":47,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4dafba3e"",""value"":""NS_IDENT@2e34384c.TIMES"",""pos"":{""lineNum"":10,""columnNum"":28,""endLineNum"":10,""endColumnNum"":34,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":10,""columnNum"":3,""endLineNum"":12,""endColumnNum"":69,""quoted"":false},""children"":{}}]}
"
"WITH Temp1 as
  (
    SELECT name, bar, times_a_week as times
    FROM drinker
    LEFT OUTER JOIN frequents on drinker.name = frequents.drinker
  ),
  hello as
  (
    SELECT name, max(times) as f
    FROM Temp1
    GROUP BY name
  )

SELECT Temp1.name, bar
FROM Temp1
FULL OUTER JOIN hello on Temp1.name = hello.name
WHERE times = f or f IS NULL","{""blocks"":{""id"":""BLOCK_SELECT@4d33940d"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@60e5272"",""value"":""NS_IDENT@770b3be0.NAME"",""pos"":{""lineNum"":14,""columnNum"":8,""endLineNum"":14,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2b8bd14b"",""value"":""NS_IDENT@770b3be0.BAR"",""pos"":{""lineNum"":14,""columnNum"":20,""endLineNum"":14,""endColumnNum"":22,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@770b3be0"",""NS_IDENT@1eb6e1c""],""fromNode"":{""id"":""OP_JOIN@43cf6ea3"",""value"":""FULL"",""pos"":{""lineNum"":16,""columnNum"":12,""endLineNum"":16,""endColumnNum"":15,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@37c5fc56"",""value"":""NS_IDENT@770b3be0"",""pos"":{""lineNum"":15,""columnNum"":6,""endLineNum"":15,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@1c025cb"",""value"":""NS_IDENT@1eb6e1c"",""pos"":{""lineNum"":16,""columnNum"":17,""endLineNum"":16,""endColumnNum"":21,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@6daf2337"",""value"":""="",""pos"":{""lineNum"":16,""columnNum"":26,""endLineNum"":16,""endColumnNum"":48,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@23e44287"",""value"":""NS_IDENT@770b3be0.NAME"",""pos"":{""lineNum"":16,""columnNum"":26,""endLineNum"":16,""endColumnNum"":35,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2b8d084"",""value"":""NS_IDENT@1eb6e1c.NAME"",""pos"":{""lineNum"":16,""columnNum"":39,""endLineNum"":16,""endColumnNum"":48,""quoted"":false},""children"":[]}]}},""whereNode"":{""id"":""OP_BINARY@78de58ea"",""value"":""OR"",""pos"":{""lineNum"":17,""columnNum"":7,""endLineNum"":17,""endColumnNum"":28,""quoted"":false},""children"":[{""id"":""OP_BINARY@61f3fbb8"",""value"":""="",""pos"":{""lineNum"":17,""columnNum"":7,""endLineNum"":17,""endColumnNum"":15,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@24fabd0f"",""value"":""NS_IDENT@770b3be0.TIMES"",""pos"":{""lineNum"":17,""columnNum"":7,""endLineNum"":17,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@250b236d"",""value"":""NS_IDENT@1eb6e1c.F"",""pos"":{""lineNum"":17,""columnNum"":15,""endLineNum"":17,""endColumnNum"":15,""quoted"":false},""children"":[]}]},{""id"":""OP_POSTFIX@432034a"",""value"":""IS NULL"",""pos"":{""lineNum"":17,""columnNum"":20,""endLineNum"":17,""endColumnNum"":28,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7551da2a"",""value"":""NS_IDENT@1eb6e1c.F"",""pos"":{""lineNum"":17,""columnNum"":20,""endLineNum"":17,""endColumnNum"":20,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@2b8bd14b"",""value"":""NS_IDENT@770b3be0.BAR"",""pos"":{""lineNum"":14,""columnNum"":20,""endLineNum"":14,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2b8d084"",""value"":""NS_IDENT@1eb6e1c.NAME"",""pos"":{""lineNum"":16,""columnNum"":39,""endLineNum"":16,""endColumnNum"":48,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@23e44287"",""value"":""NS_IDENT@770b3be0.NAME"",""pos"":{""lineNum"":16,""columnNum"":26,""endLineNum"":16,""endColumnNum"":35,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7551da2a"",""value"":""NS_IDENT@1eb6e1c.F"",""pos"":{""lineNum"":17,""columnNum"":20,""endLineNum"":17,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@250b236d"",""value"":""NS_IDENT@1eb6e1c.F"",""pos"":{""lineNum"":17,""columnNum"":15,""endLineNum"":17,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@24fabd0f"",""value"":""NS_IDENT@770b3be0.TIMES"",""pos"":{""lineNum"":17,""columnNum"":7,""endLineNum"":17,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@60e5272"",""value"":""NS_IDENT@770b3be0.NAME"",""pos"":{""lineNum"":14,""columnNum"":8,""endLineNum"":14,""endColumnNum"":17,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":14,""columnNum"":1,""endLineNum"":17,""endColumnNum"":28,""quoted"":false},""children"":{}},""tables"":{""NS_IDENT@770b3be0"":{""tableId"":""NS_IDENT@770b3be0"",""identifier"":""TEMP1"",""dbTableName"":""TEMP1"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)"",""TIMES INTEGER""],""cursor"":[0],""pos"":{""lineNum"":15,""columnNum"":6,""endLineNum"":15,""endColumnNum"":10,""quoted"":false}},""NS_IDENT@675ffd1d"":{""tableId"":""NS_IDENT@675ffd1d"",""identifier"":""DRINKER"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":10,""endLineNum"":4,""endColumnNum"":16,""quoted"":false}},""NS_IDENT@5631962"":{""tableId"":""NS_IDENT@5631962"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":21,""endLineNum"":5,""endColumnNum"":29,""quoted"":false}},""NS_IDENT@1eb6e1c"":{""tableId"":""NS_IDENT@1eb6e1c"",""identifier"":""HELLO"",""dbTableName"":""HELLO"",""fields"":[""NAME VARCHAR(100)"",""F INTEGER""],""cursor"":[0],""pos"":{""lineNum"":16,""columnNum"":17,""endLineNum"":16,""endColumnNum"":21,""quoted"":false}},""NS_IDENT@5754de72"":{""tableId"":""NS_IDENT@5754de72"",""identifier"":""TEMP1"",""dbTableName"":""TEMP1"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)"",""TIMES INTEGER""],""cursor"":[0],""pos"":{""lineNum"":10,""columnNum"":10,""endLineNum"":10,""endColumnNum"":14,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@7fedfe27"",""alias"":""TEMP1"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)"",""TIMES INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@6124287a"",""value"":""NS_IDENT@675ffd1d.NAME"",""pos"":{""lineNum"":3,""columnNum"":12,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4632cfc"",""value"":""NS_IDENT@5631962.BAR"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2e380628"",""value"":""NS_IDENT@5631962.TIMES_A_WEEK"",""pos"":{""lineNum"":3,""columnNum"":23,""endLineNum"":3,""endColumnNum"":34,""quoted"":false},""children"":[],""alias"":""TIMES""}],""fromItemIds"":[""NS_IDENT@675ffd1d"",""NS_IDENT@5631962""],""fromNode"":{""id"":""OP_JOIN@2d66530f"",""value"":""LEFT"",""pos"":{""lineNum"":5,""columnNum"":16,""endLineNum"":5,""endColumnNum"":19,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@25b865b5"",""value"":""NS_IDENT@675ffd1d"",""pos"":{""lineNum"":4,""columnNum"":10,""endLineNum"":4,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@201aa8c1"",""value"":""NS_IDENT@5631962"",""pos"":{""lineNum"":5,""columnNum"":21,""endLineNum"":5,""endColumnNum"":29,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@6c37bd27"",""value"":""="",""pos"":{""lineNum"":5,""columnNum"":34,""endLineNum"":5,""endColumnNum"":65,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@460b6d54"",""value"":""NS_IDENT@675ffd1d.name"",""pos"":{""lineNum"":5,""columnNum"":34,""endLineNum"":5,""endColumnNum"":45,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7a24eb3"",""value"":""NS_IDENT@5631962.drinker"",""pos"":{""lineNum"":5,""columnNum"":49,""endLineNum"":5,""endColumnNum"":65,""quoted"":false},""children"":[]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@2e380628"",""value"":""NS_IDENT@5631962.TIMES_A_WEEK"",""pos"":{""lineNum"":3,""columnNum"":23,""endLineNum"":3,""endColumnNum"":34,""quoted"":false},""children"":[],""alias"":""TIMES""},{""id"":""COLUMN_LOCAL@460b6d54"",""value"":""NS_IDENT@675ffd1d.name"",""pos"":{""lineNum"":5,""columnNum"":34,""endLineNum"":5,""endColumnNum"":45,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4632cfc"",""value"":""NS_IDENT@5631962.BAR"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7a24eb3"",""value"":""NS_IDENT@5631962.drinker"",""pos"":{""lineNum"":5,""columnNum"":49,""endLineNum"":5,""endColumnNum"":65,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6124287a"",""value"":""NS_IDENT@675ffd1d.NAME"",""pos"":{""lineNum"":3,""columnNum"":12,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":5,""endLineNum"":5,""endColumnNum"":65,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@2fe88a09"",""alias"":""HELLO"",""fields"":[""NAME VARCHAR(100)"",""F INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@31ee96f4"",""value"":""NS_IDENT@5754de72.NAME"",""pos"":{""lineNum"":9,""columnNum"":12,""endLineNum"":9,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@652ab8d9"",""value"":""MAX"",""pos"":{""lineNum"":9,""columnNum"":18,""endLineNum"":9,""endColumnNum"":27,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@14fc5d40"",""value"":""NS_IDENT@5754de72.TIMES"",""pos"":{""lineNum"":9,""columnNum"":22,""endLineNum"":9,""endColumnNum"":26,""quoted"":false},""children"":[]}],""alias"":""F""}],""fromItemIds"":[""NS_IDENT@5754de72""],""fromNode"":{""id"":""JOIN_OPERAND@1917d90f"",""value"":""NS_IDENT@5754de72"",""pos"":{""lineNum"":10,""columnNum"":10,""endLineNum"":10,""endColumnNum"":14,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@226b143b"",""value"":""NS_IDENT@5754de72.NAME"",""pos"":{""lineNum"":11,""columnNum"":14,""endLineNum"":11,""endColumnNum"":17,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@31ee96f4"",""value"":""NS_IDENT@5754de72.NAME"",""pos"":{""lineNum"":9,""columnNum"":12,""endLineNum"":9,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@226b143b"",""value"":""NS_IDENT@5754de72.NAME"",""pos"":{""lineNum"":11,""columnNum"":14,""endLineNum"":11,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@14fc5d40"",""value"":""NS_IDENT@5754de72.TIMES"",""pos"":{""lineNum"":9,""columnNum"":22,""endLineNum"":9,""endColumnNum"":26,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":9,""columnNum"":5,""endLineNum"":11,""endColumnNum"":17,""quoted"":false},""children"":{}}]}
"
"SELECT name, bar
FROM (frequents RIGHT OUTER JOIN drinker
  ON frequents.drinker = drinker.name) F1
WHERE NOT EXISTS 
  (SELECT *
  FROM frequents F2 
  WHERE F2.times_a_week > F1.times_a_week and F1.name = F2.drinker)","{""failed"":true,""errorMsg"":""Parsing error at line 2, column 7. Query syntax may be incorrect""}
"
"SELECT f.drinker, f.bar
FROM frequents f, (SELECT frequents.drinker, MAX(frequents.times_a_week) maxFreq FROM frequents GROUP BY frequents.drinker) maxFrequents
WHERE f.drinker = maxFrequents.drinker AND maxFrequents.maxFreq = f.times_a_week
UNION
(SELECT noBarDrinkers.name, NULL FROM (
SELECT drinker.name FROM drinker WHERE drinker.name NOT IN (SELECT frequents.drinker from frequents) 
) noBarDrinkers )","{""blocks"":{""id"":""BLOCK_SETOP@3f36b447"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""opName"":""UNION"",""all"":false,""leftBlockId"":""BLOCK_SELECT@5d39f2d8"",""rightBlockId"":""BLOCK_SELECT@7e8a46b7"",""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":7,""endColumnNum"":15,""quoted"":false},""children"":{""BLOCK_SELECT@7e8a46b7"":{""id"":""BLOCK_SELECT@7e8a46b7"",""parentId"":""BLOCK_SETOP@3f36b447"",""fields"":[""NAME VARCHAR(100)"",""EXPR$1 NULL""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@2b8d084"",""value"":""NS_SELECT@5f303ecd.NAME"",""pos"":{""lineNum"":5,""columnNum"":9,""endLineNum"":5,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""LITERAL_KEYWORD@6daf2337"",""pos"":{""lineNum"":5,""columnNum"":29,""endLineNum"":5,""endColumnNum"":32,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_SELECT@5f303ecd""],""fromNode"":{""id"":""JOIN_OPERAND@2fe88a09"",""value"":""BLOCK_SELECT@2fe88a09"",""pos"":{""lineNum"":6,""columnNum"":1,""endLineNum"":6,""endColumnNum"":100,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@2b8d084"",""value"":""NS_SELECT@5f303ecd.NAME"",""pos"":{""lineNum"":5,""columnNum"":9,""endLineNum"":5,""endColumnNum"":26,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":5,""columnNum"":2,""endLineNum"":7,""endColumnNum"":15,""quoted"":false},""children"":{""BLOCK_SELECT@2fe88a09"":{""id"":""BLOCK_SELECT@2fe88a09"",""parentId"":""BLOCK_SELECT@7e8a46b7"",""alias"":""NOBARDRINKERS"",""fields"":[""NAME VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@25a73de1"",""value"":""NS_IDENT@50d3bf39.NAME"",""pos"":{""lineNum"":6,""columnNum"":8,""endLineNum"":6,""endColumnNum"":19,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@50d3bf39""],""fromNode"":{""id"":""JOIN_OPERAND@4aac85fa"",""value"":""NS_IDENT@50d3bf39"",""pos"":{""lineNum"":6,""columnNum"":26,""endLineNum"":6,""endColumnNum"":32,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@736f3e9e"",""value"":""NOT IN"",""pos"":{""lineNum"":6,""columnNum"":40,""endLineNum"":6,""endColumnNum"":99,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@22d9c961"",""value"":""NS_IDENT@50d3bf39.name"",""pos"":{""lineNum"":6,""columnNum"":40,""endLineNum"":6,""endColumnNum"":51,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@1917d90f"",""value"":""BLOCK_SELECT@1917d90f"",""pos"":{""lineNum"":6,""columnNum"":61,""endLineNum"":6,""endColumnNum"":99,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@22d9c961"",""value"":""NS_IDENT@50d3bf39.name"",""pos"":{""lineNum"":6,""columnNum"":40,""endLineNum"":6,""endColumnNum"":51,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@25a73de1"",""value"":""NS_IDENT@50d3bf39.NAME"",""pos"":{""lineNum"":6,""columnNum"":8,""endLineNum"":6,""endColumnNum"":19,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":6,""columnNum"":1,""endLineNum"":6,""endColumnNum"":100,""quoted"":false},""children"":{""BLOCK_SELECT@1917d90f"":{""id"":""BLOCK_SELECT@1917d90f"",""parentId"":""BLOCK_SELECT@2fe88a09"",""fields"":[""DRINKER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@73ba6fe6"",""value"":""NS_IDENT@3afae281.DRINKER"",""pos"":{""lineNum"":6,""columnNum"":68,""endLineNum"":6,""endColumnNum"":84,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@3afae281""],""fromNode"":{""id"":""JOIN_OPERAND@66bfd864"",""value"":""NS_IDENT@3afae281"",""pos"":{""lineNum"":6,""columnNum"":91,""endLineNum"":6,""endColumnNum"":99,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@73ba6fe6"",""value"":""NS_IDENT@3afae281.DRINKER"",""pos"":{""lineNum"":6,""columnNum"":68,""endLineNum"":6,""endColumnNum"":84,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":6,""columnNum"":61,""endLineNum"":6,""endColumnNum"":99,""quoted"":false},""children"":{}}}}}},""BLOCK_SELECT@5d39f2d8"":{""id"":""BLOCK_SELECT@5d39f2d8"",""parentId"":""BLOCK_SETOP@3f36b447"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@652ab8d9"",""value"":""NS_IDENT@52a70627.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@51e0301d"",""value"":""NS_IDENT@52a70627.BAR"",""pos"":{""lineNum"":1,""columnNum"":19,""endLineNum"":1,""endColumnNum"":23,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@52a70627"",""NS_SELECT@6e1f8469""],""fromNode"":{""id"":""OP_JOIN@1dab9dd6"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":17,""endLineNum"":2,""endColumnNum"":17,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@2f879bab"",""value"":""NS_IDENT@52a70627"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@1d207fad"",""value"":""BLOCK_SELECT@1d207fad"",""pos"":{""lineNum"":2,""columnNum"":20,""endLineNum"":2,""endColumnNum"":122,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@6a10b263"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":80,""quoted"":false},""children"":[{""id"":""OP_BINARY@398474a2"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":38,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5e39850"",""value"":""NS_IDENT@52a70627.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1603dc2f"",""value"":""NS_SELECT@6e1f8469.DRINKER"",""pos"":{""lineNum"":3,""columnNum"":19,""endLineNum"":3,""endColumnNum"":38,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@70abf9b0"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":44,""endLineNum"":3,""endColumnNum"":80,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@61799544"",""value"":""NS_SELECT@6e1f8469.MAXFREQ"",""pos"":{""lineNum"":3,""columnNum"":44,""endLineNum"":3,""endColumnNum"":63,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@78c1a023"",""value"":""NS_IDENT@52a70627.times_a_week"",""pos"":{""lineNum"":3,""columnNum"":67,""endLineNum"":3,""endColumnNum"":80,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@78c1a023"",""value"":""NS_IDENT@52a70627.times_a_week"",""pos"":{""lineNum"":3,""columnNum"":67,""endLineNum"":3,""endColumnNum"":80,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@51e0301d"",""value"":""NS_IDENT@52a70627.BAR"",""pos"":{""lineNum"":1,""columnNum"":19,""endLineNum"":1,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1603dc2f"",""value"":""NS_SELECT@6e1f8469.DRINKER"",""pos"":{""lineNum"":3,""columnNum"":19,""endLineNum"":3,""endColumnNum"":38,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5e39850"",""value"":""NS_IDENT@52a70627.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@652ab8d9"",""value"":""NS_IDENT@52a70627.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@61799544"",""value"":""NS_SELECT@6e1f8469.MAXFREQ"",""pos"":{""lineNum"":3,""columnNum"":44,""endLineNum"":3,""endColumnNum"":63,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":3,""endColumnNum"":80,""quoted"":false},""children"":{""BLOCK_SELECT@1d207fad"":{""id"":""BLOCK_SELECT@1d207fad"",""parentId"":""BLOCK_SELECT@5d39f2d8"",""alias"":""MAXFREQUENTS"",""fields"":[""DRINKER VARCHAR(100)"",""MAXFREQ INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@1eaf1e62"",""value"":""NS_IDENT@2e380628.DRINKER"",""pos"":{""lineNum"":2,""columnNum"":27,""endLineNum"":2,""endColumnNum"":43,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@62e6a3ec"",""value"":""MAX"",""pos"":{""lineNum"":2,""columnNum"":46,""endLineNum"":2,""endColumnNum"":72,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5754de72"",""value"":""NS_IDENT@2e380628.TIMES_A_WEEK"",""pos"":{""lineNum"":2,""columnNum"":50,""endLineNum"":2,""endColumnNum"":71,""quoted"":false},""children"":[]}],""alias"":""MAXFREQ""}],""fromItemIds"":[""NS_IDENT@2e380628""],""fromNode"":{""id"":""JOIN_OPERAND@488b50ec"",""value"":""NS_IDENT@2e380628"",""pos"":{""lineNum"":2,""columnNum"":87,""endLineNum"":2,""endColumnNum"":95,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@392a04e7"",""value"":""NS_IDENT@2e380628.drinker"",""pos"":{""lineNum"":2,""columnNum"":106,""endLineNum"":2,""endColumnNum"":122,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@392a04e7"",""value"":""NS_IDENT@2e380628.drinker"",""pos"":{""lineNum"":2,""columnNum"":106,""endLineNum"":2,""endColumnNum"":122,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1eaf1e62"",""value"":""NS_IDENT@2e380628.DRINKER"",""pos"":{""lineNum"":2,""columnNum"":27,""endLineNum"":2,""endColumnNum"":43,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5754de72"",""value"":""NS_IDENT@2e380628.TIMES_A_WEEK"",""pos"":{""lineNum"":2,""columnNum"":50,""endLineNum"":2,""endColumnNum"":71,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":20,""endLineNum"":2,""endColumnNum"":122,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@2e380628"":{""tableId"":""NS_IDENT@2e380628"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":87,""endLineNum"":2,""endColumnNum"":95,""quoted"":false}},""NS_IDENT@50d3bf39"":{""tableId"":""NS_IDENT@50d3bf39"",""identifier"":""DRINKER"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":26,""endLineNum"":6,""endColumnNum"":32,""quoted"":false}},""NS_IDENT@52a70627"":{""tableId"":""NS_IDENT@52a70627"",""identifier"":""F"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":16,""quoted"":false}},""NS_SELECT@5f303ecd"":{""tableId"":""NS_SELECT@5f303ecd"",""identifier"":""NOBARDRINKERS"",""blockId"":""BLOCK_SELECT@2fe88a09"",""fields"":[""NAME VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":1,""endLineNum"":7,""endColumnNum"":15,""quoted"":false}},""NS_SELECT@6e1f8469"":{""tableId"":""NS_SELECT@6e1f8469"",""identifier"":""MAXFREQUENTS"",""blockId"":""BLOCK_SELECT@1d207fad"",""fields"":[""DRINKER VARCHAR(100)"",""MAXFREQ INTEGER""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":20,""endLineNum"":2,""endColumnNum"":136,""quoted"":false}},""NS_IDENT@3afae281"":{""tableId"":""NS_IDENT@3afae281"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":91,""endLineNum"":6,""endColumnNum"":99,""quoted"":false}}},""corrTables"":[]}
"
"select drinker.name as drinker, people.bar as bar
from
drinker left join
(select first.drinker, f2.bar
from
(select f.drinker as drinker, max(f.times_a_week) as largest
from frequents f
--where f.drinker <> 'Richard'
group by f.drinker ) as first
left join frequents f2
on first.drinker = f2.drinker and first.largest = f2.times_a_week) as people
on drinker.name = people.drinker","{""blocks"":{""id"":""BLOCK_SELECT@3f36b447"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@675ffd1d"",""value"":""NS_IDENT@7d755813.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":19,""quoted"":false},""children"":[],""alias"":""DRINKER""},{""id"":""COLUMN_LOCAL@bdc8014"",""value"":""NS_SELECT@40d10481.BAR"",""pos"":{""lineNum"":1,""columnNum"":33,""endLineNum"":1,""endColumnNum"":42,""quoted"":false},""children"":[],""alias"":""BAR""}],""fromItemIds"":[""NS_IDENT@7d755813"",""NS_SELECT@40d10481""],""fromNode"":{""id"":""OP_JOIN@4e868ef5"",""value"":""LEFT"",""pos"":{""lineNum"":3,""columnNum"":14,""endLineNum"":3,""endColumnNum"":17,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@1d4664d7"",""value"":""NS_IDENT@7d755813"",""pos"":{""lineNum"":3,""columnNum"":1,""endLineNum"":3,""endColumnNum"":7,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@4690f583"",""value"":""BLOCK_SELECT@4690f583"",""pos"":{""lineNum"":4,""columnNum"":2,""endLineNum"":11,""endColumnNum"":65,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@49dbaaf3"",""value"":""="",""pos"":{""lineNum"":12,""columnNum"":4,""endLineNum"":12,""endColumnNum"":32,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@41c204a0"",""value"":""NS_IDENT@7d755813.name"",""pos"":{""lineNum"":12,""columnNum"":4,""endLineNum"":12,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@64138b0c"",""value"":""NS_SELECT@40d10481.DRINKER"",""pos"":{""lineNum"":12,""columnNum"":19,""endLineNum"":12,""endColumnNum"":32,""quoted"":false},""children"":[]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@675ffd1d"",""value"":""NS_IDENT@7d755813.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":19,""quoted"":false},""children"":[],""alias"":""DRINKER""},{""id"":""COLUMN_LOCAL@64138b0c"",""value"":""NS_SELECT@40d10481.DRINKER"",""pos"":{""lineNum"":12,""columnNum"":19,""endLineNum"":12,""endColumnNum"":32,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@bdc8014"",""value"":""NS_SELECT@40d10481.BAR"",""pos"":{""lineNum"":1,""columnNum"":33,""endLineNum"":1,""endColumnNum"":42,""quoted"":false},""children"":[],""alias"":""BAR""},{""id"":""COLUMN_LOCAL@41c204a0"",""value"":""NS_IDENT@7d755813.name"",""pos"":{""lineNum"":12,""columnNum"":4,""endLineNum"":12,""endColumnNum"":15,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":12,""endColumnNum"":32,""quoted"":false},""children"":{""BLOCK_SELECT@4690f583"":{""id"":""BLOCK_SELECT@4690f583"",""parentId"":""BLOCK_SELECT@3f36b447"",""alias"":""PEOPLE"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@51ec2df1"",""value"":""NS_SELECT@60dd3c23.DRINKER"",""pos"":{""lineNum"":4,""columnNum"":9,""endLineNum"":4,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@10876a6"",""value"":""NS_IDENT@77bd7fe7.BAR"",""pos"":{""lineNum"":4,""columnNum"":24,""endLineNum"":4,""endColumnNum"":29,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_SELECT@60dd3c23"",""NS_IDENT@77bd7fe7""],""fromNode"":{""id"":""OP_JOIN@59712875"",""value"":""LEFT"",""pos"":{""lineNum"":10,""columnNum"":6,""endLineNum"":10,""endColumnNum"":9,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@47b2e9e1"",""value"":""BLOCK_SELECT@47b2e9e1"",""pos"":{""lineNum"":6,""columnNum"":2,""endLineNum"":9,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@52a36910"",""value"":""NS_IDENT@77bd7fe7"",""pos"":{""lineNum"":10,""columnNum"":11,""endLineNum"":10,""endColumnNum"":19,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@37fdfb05"",""value"":""AND"",""pos"":{""lineNum"":11,""columnNum"":4,""endLineNum"":11,""endColumnNum"":65,""quoted"":false},""children"":[{""id"":""OP_BINARY@4e4c3a38"",""value"":""="",""pos"":{""lineNum"":11,""columnNum"":4,""endLineNum"":11,""endColumnNum"":29,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@151335cb"",""value"":""NS_SELECT@60dd3c23.DRINKER"",""pos"":{""lineNum"":11,""columnNum"":4,""endLineNum"":11,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4abf3f0"",""value"":""NS_IDENT@77bd7fe7.drinker"",""pos"":{""lineNum"":11,""columnNum"":20,""endLineNum"":11,""endColumnNum"":29,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@78faea5f"",""value"":""="",""pos"":{""lineNum"":11,""columnNum"":35,""endLineNum"":11,""endColumnNum"":65,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@293cde83"",""value"":""NS_SELECT@60dd3c23.LARGEST"",""pos"":{""lineNum"":11,""columnNum"":35,""endLineNum"":11,""endColumnNum"":47,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@57c88764"",""value"":""NS_IDENT@77bd7fe7.times_a_week"",""pos"":{""lineNum"":11,""columnNum"":51,""endLineNum"":11,""endColumnNum"":65,""quoted"":false},""children"":[]}]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@10876a6"",""value"":""NS_IDENT@77bd7fe7.BAR"",""pos"":{""lineNum"":4,""columnNum"":24,""endLineNum"":4,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@51ec2df1"",""value"":""NS_SELECT@60dd3c23.DRINKER"",""pos"":{""lineNum"":4,""columnNum"":9,""endLineNum"":4,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@151335cb"",""value"":""NS_SELECT@60dd3c23.DRINKER"",""pos"":{""lineNum"":11,""columnNum"":4,""endLineNum"":11,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4abf3f0"",""value"":""NS_IDENT@77bd7fe7.drinker"",""pos"":{""lineNum"":11,""columnNum"":20,""endLineNum"":11,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@293cde83"",""value"":""NS_SELECT@60dd3c23.LARGEST"",""pos"":{""lineNum"":11,""columnNum"":35,""endLineNum"":11,""endColumnNum"":47,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@57c88764"",""value"":""NS_IDENT@77bd7fe7.times_a_week"",""pos"":{""lineNum"":11,""columnNum"":51,""endLineNum"":11,""endColumnNum"":65,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":4,""columnNum"":2,""endLineNum"":11,""endColumnNum"":65,""quoted"":false},""children"":{""BLOCK_SELECT@47b2e9e1"":{""id"":""BLOCK_SELECT@47b2e9e1"",""parentId"":""BLOCK_SELECT@4690f583"",""alias"":""FIRST"",""fields"":[""DRINKER VARCHAR(100)"",""LARGEST INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@16a9a4f1"",""value"":""NS_IDENT@52b6319f.DRINKER"",""pos"":{""lineNum"":6,""columnNum"":9,""endLineNum"":6,""endColumnNum"":17,""quoted"":false},""children"":[],""alias"":""DRINKER""},{""id"":""OP_AGG_FUNC@7c455e96"",""value"":""MAX"",""pos"":{""lineNum"":6,""columnNum"":31,""endLineNum"":6,""endColumnNum"":49,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@985696"",""value"":""NS_IDENT@52b6319f.TIMES_A_WEEK"",""pos"":{""lineNum"":6,""columnNum"":35,""endLineNum"":6,""endColumnNum"":48,""quoted"":false},""children"":[]}],""alias"":""LARGEST""}],""fromItemIds"":[""NS_IDENT@52b6319f""],""fromNode"":{""id"":""JOIN_OPERAND@59942b48"",""value"":""NS_IDENT@52b6319f"",""pos"":{""lineNum"":7,""columnNum"":6,""endLineNum"":7,""endColumnNum"":14,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@f14e5bf"",""value"":""NS_IDENT@52b6319f.drinker"",""pos"":{""lineNum"":9,""columnNum"":10,""endLineNum"":9,""endColumnNum"":18,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@985696"",""value"":""NS_IDENT@52b6319f.TIMES_A_WEEK"",""pos"":{""lineNum"":6,""columnNum"":35,""endLineNum"":6,""endColumnNum"":48,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@f14e5bf"",""value"":""NS_IDENT@52b6319f.drinker"",""pos"":{""lineNum"":9,""columnNum"":10,""endLineNum"":9,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@16a9a4f1"",""value"":""NS_IDENT@52b6319f.DRINKER"",""pos"":{""lineNum"":6,""columnNum"":9,""endLineNum"":6,""endColumnNum"":17,""quoted"":false},""children"":[],""alias"":""DRINKER""}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":6,""columnNum"":2,""endLineNum"":9,""endColumnNum"":18,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@7d755813"":{""tableId"":""NS_IDENT@7d755813"",""identifier"":""DRINKER"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":1,""endLineNum"":3,""endColumnNum"":7,""quoted"":false}},""NS_IDENT@77bd7fe7"":{""tableId"":""NS_IDENT@77bd7fe7"",""identifier"":""F2"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":10,""columnNum"":11,""endLineNum"":10,""endColumnNum"":22,""quoted"":false}},""NS_SELECT@60dd3c23"":{""tableId"":""NS_SELECT@60dd3c23"",""identifier"":""FIRST"",""blockId"":""BLOCK_SELECT@47b2e9e1"",""fields"":[""DRINKER VARCHAR(100)"",""LARGEST INTEGER""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":2,""endLineNum"":9,""endColumnNum"":29,""quoted"":false}},""NS_IDENT@52b6319f"":{""tableId"":""NS_IDENT@52b6319f"",""identifier"":""F"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":6,""endLineNum"":7,""endColumnNum"":16,""quoted"":false}},""NS_SELECT@40d10481"":{""tableId"":""NS_SELECT@40d10481"",""identifier"":""PEOPLE"",""blockId"":""BLOCK_SELECT@4690f583"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":2,""endLineNum"":11,""endColumnNum"":76,""quoted"":false}}},""corrTables"":[]}
"
"select d.name, f.bar from drinker d left join frequents f on d.name = f.drinker where not exists (select times_a_week from frequents where drinker = f.drinker and times_a_week > f.times_a_week)","{""blocks"":{""id"":""BLOCK_SELECT@4b1abd11"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@2bfbffb2"",""value"":""NS_IDENT@6f667ad1.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@151335cb"",""value"":""NS_IDENT@77a281fc.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@6f667ad1"",""NS_IDENT@77a281fc""],""fromNode"":{""id"":""OP_JOIN@59712875"",""value"":""LEFT"",""pos"":{""lineNum"":1,""columnNum"":42,""endLineNum"":1,""endColumnNum"":45,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@59942b48"",""value"":""NS_IDENT@6f667ad1"",""pos"":{""lineNum"":1,""columnNum"":27,""endLineNum"":1,""endColumnNum"":33,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@1869f114"",""value"":""NS_IDENT@77a281fc"",""pos"":{""lineNum"":1,""columnNum"":47,""endLineNum"":1,""endColumnNum"":55,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@f14e5bf"",""value"":""="",""pos"":{""lineNum"":1,""columnNum"":62,""endLineNum"":1,""endColumnNum"":79,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@2787de58"",""value"":""NS_IDENT@6f667ad1.name"",""pos"":{""lineNum"":1,""columnNum"":62,""endLineNum"":1,""endColumnNum"":67,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7dd00705"",""value"":""NS_IDENT@77a281fc.drinker"",""pos"":{""lineNum"":1,""columnNum"":71,""endLineNum"":1,""endColumnNum"":79,""quoted"":false},""children"":[]}]}},""whereNode"":{""id"":""OP_PREFIX@67dba613"",""value"":""NOT"",""pos"":{""lineNum"":1,""columnNum"":87,""endLineNum"":1,""endColumnNum"":192,""quoted"":false},""children"":[{""id"":""OP_PREFIX@15923407"",""value"":""EXISTS"",""pos"":{""lineNum"":1,""columnNum"":91,""endLineNum"":1,""endColumnNum"":192,""quoted"":false},""children"":[{""id"":""BLOCK_SELECT@55ea2d70"",""value"":""BLOCK_SELECT@55ea2d70"",""pos"":{""lineNum"":1,""columnNum"":99,""endLineNum"":1,""endColumnNum"":192,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@2bfbffb2"",""value"":""NS_IDENT@6f667ad1.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7dd00705"",""value"":""NS_IDENT@77a281fc.drinker"",""pos"":{""lineNum"":1,""columnNum"":71,""endLineNum"":1,""endColumnNum"":79,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@151335cb"",""value"":""NS_IDENT@77a281fc.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2787de58"",""value"":""NS_IDENT@6f667ad1.name"",""pos"":{""lineNum"":1,""columnNum"":62,""endLineNum"":1,""endColumnNum"":67,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@77a281fc.times_a_week"",""NS_IDENT@77a281fc.drinker""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":1,""endColumnNum"":193,""quoted"":false},""children"":{""BLOCK_SELECT@55ea2d70"":{""id"":""BLOCK_SELECT@55ea2d70"",""parentId"":""BLOCK_SELECT@4b1abd11"",""fields"":[""TIMES_A_WEEK INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@58cec85b"",""value"":""NS_IDENT@3e850122.TIMES_A_WEEK"",""pos"":{""lineNum"":1,""columnNum"":106,""endLineNum"":1,""endColumnNum"":117,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@3e850122""],""fromNode"":{""id"":""JOIN_OPERAND@4bff2185"",""value"":""NS_IDENT@3e850122"",""pos"":{""lineNum"":1,""columnNum"":124,""endLineNum"":1,""endColumnNum"":132,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@4d23015c"",""value"":""AND"",""pos"":{""lineNum"":1,""columnNum"":140,""endLineNum"":1,""endColumnNum"":192,""quoted"":false},""children"":[{""id"":""OP_BINARY@31cb96e1"",""value"":""="",""pos"":{""lineNum"":1,""columnNum"":140,""endLineNum"":1,""endColumnNum"":158,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@67001148"",""value"":""NS_IDENT@3e850122.drinker"",""pos"":{""lineNum"":1,""columnNum"":140,""endLineNum"":1,""endColumnNum"":146,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@989da1"",""value"":""NS_IDENT@77a281fc.drinker"",""pos"":{""lineNum"":1,""columnNum"":150,""endLineNum"":1,""endColumnNum"":158,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@2032e725"",""value"":"">"",""pos"":{""lineNum"":1,""columnNum"":164,""endLineNum"":1,""endColumnNum"":192,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@3eed0f5"",""value"":""NS_IDENT@3e850122.times_a_week"",""pos"":{""lineNum"":1,""columnNum"":164,""endLineNum"":1,""endColumnNum"":175,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@64030b91"",""value"":""NS_IDENT@77a281fc.times_a_week"",""pos"":{""lineNum"":1,""columnNum"":179,""endLineNum"":1,""endColumnNum"":192,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@67001148"",""value"":""NS_IDENT@3e850122.drinker"",""pos"":{""lineNum"":1,""columnNum"":140,""endLineNum"":1,""endColumnNum"":146,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@64030b91"",""value"":""NS_IDENT@77a281fc.times_a_week"",""pos"":{""lineNum"":1,""columnNum"":179,""endLineNum"":1,""endColumnNum"":192,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@58cec85b"",""value"":""NS_IDENT@3e850122.TIMES_A_WEEK"",""pos"":{""lineNum"":1,""columnNum"":106,""endLineNum"":1,""endColumnNum"":117,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3eed0f5"",""value"":""NS_IDENT@3e850122.times_a_week"",""pos"":{""lineNum"":1,""columnNum"":164,""endLineNum"":1,""endColumnNum"":175,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@989da1"",""value"":""NS_IDENT@77a281fc.drinker"",""pos"":{""lineNum"":1,""columnNum"":150,""endLineNum"":1,""endColumnNum"":158,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@77a281fc""],""corrCtxIds"":[""BLOCK_SELECT@4b1abd11""],""pos"":{""lineNum"":1,""columnNum"":99,""endLineNum"":1,""endColumnNum"":192,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@77a281fc"":{""tableId"":""NS_IDENT@77a281fc"",""identifier"":""F"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":47,""endLineNum"":1,""endColumnNum"":57,""quoted"":false}},""NS_IDENT@3e850122"":{""tableId"":""NS_IDENT@3e850122"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":124,""endLineNum"":1,""endColumnNum"":132,""quoted"":false}},""NS_IDENT@6f667ad1"":{""tableId"":""NS_IDENT@6f667ad1"",""identifier"":""D"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":27,""endLineNum"":1,""endColumnNum"":35,""quoted"":false}}},""corrTables"":[""NS_IDENT@77a281fc""]}
"
"SELECT name, bar
FROM (drinker LEFT OUTER JOIN frequents ON name = drinker)
WHERE times_a_week >= ALL(SELECT times_a_week FROM frequents F WHERE name = F.drinker);","{""failed"":true,""errorMsg"":""Parsing error at line 2, column 7. Query syntax may be incorrect""}
"
"SELECT D1.name, bar
FROM drinker D1
LEFT OUTER JOIN frequents F1
ON D1.name = F1.drinker
WHERE times_a_week = (
SELECT MAX(times_a_week)
FROM drinker D2
LEFT OUTER JOIN frequents F2
ON D2.name = F2.drinker
WHERE D2.name = D1.name
) OR times_a_week IS NULL
","{""blocks"":{""id"":""BLOCK_SELECT@6443b128"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@2b8d084"",""value"":""NS_IDENT@65bb9029.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@24fabd0f"",""value"":""NS_IDENT@49601f82.BAR"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":19,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@65bb9029"",""NS_IDENT@49601f82""],""fromNode"":{""id"":""OP_JOIN@bdecc21"",""value"":""LEFT"",""pos"":{""lineNum"":3,""columnNum"":12,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@5e3a39cd"",""value"":""NS_IDENT@65bb9029"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@21f9277b"",""value"":""NS_IDENT@49601f82"",""pos"":{""lineNum"":3,""columnNum"":17,""endLineNum"":3,""endColumnNum"":25,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@6d3c232f"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":4,""endLineNum"":4,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7dd00705"",""value"":""NS_IDENT@65bb9029.name"",""pos"":{""lineNum"":4,""columnNum"":4,""endLineNum"":4,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4d8126f"",""value"":""NS_IDENT@49601f82.drinker"",""pos"":{""lineNum"":4,""columnNum"":14,""endLineNum"":4,""endColumnNum"":23,""quoted"":false},""children"":[]}]}},""whereNode"":{""id"":""OP_BINARY@989da1"",""value"":""OR"",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":11,""endColumnNum"":25,""quoted"":false},""children"":[{""id"":""OP_BINARY@4cafa9aa"",""value"":""="",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":10,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@65004ff6"",""value"":""NS_IDENT@49601f82.times_a_week"",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":5,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT_SCALAR@31cb96e1"",""value"":""BLOCK_SELECT@175acfb2"",""pos"":{""lineNum"":6,""columnNum"":1,""endLineNum"":10,""endColumnNum"":23,""quoted"":false},""children"":[]}]},{""id"":""OP_POSTFIX@67001148"",""value"":""IS NULL"",""pos"":{""lineNum"":11,""columnNum"":6,""endLineNum"":11,""endColumnNum"":25,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@562c877a"",""value"":""NS_IDENT@49601f82.times_a_week"",""pos"":{""lineNum"":11,""columnNum"":6,""endLineNum"":11,""endColumnNum"":17,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@562c877a"",""value"":""NS_IDENT@49601f82.times_a_week"",""pos"":{""lineNum"":11,""columnNum"":6,""endLineNum"":11,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@24fabd0f"",""value"":""NS_IDENT@49601f82.BAR"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2b8d084"",""value"":""NS_IDENT@65bb9029.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4d8126f"",""value"":""NS_IDENT@49601f82.drinker"",""pos"":{""lineNum"":4,""columnNum"":14,""endLineNum"":4,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@65004ff6"",""value"":""NS_IDENT@49601f82.times_a_week"",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":5,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7dd00705"",""value"":""NS_IDENT@65bb9029.name"",""pos"":{""lineNum"":4,""columnNum"":4,""endLineNum"":4,""endColumnNum"":10,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@65bb9029.name""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":11,""endColumnNum"":25,""quoted"":false},""children"":{""BLOCK_SELECT@175acfb2"":{""id"":""BLOCK_SELECT@175acfb2"",""parentId"":""BLOCK_SELECT@6443b128"",""fields"":[""EXPR$0 INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""OP_AGG_FUNC@2032e725"",""value"":""MAX"",""pos"":{""lineNum"":6,""columnNum"":8,""endLineNum"":6,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4d23015c"",""value"":""NS_IDENT@432034a.TIMES_A_WEEK"",""pos"":{""lineNum"":6,""columnNum"":12,""endLineNum"":6,""endColumnNum"":23,""quoted"":false},""children"":[]}]}],""fromItemIds"":[""NS_IDENT@7551da2a"",""NS_IDENT@432034a""],""fromNode"":{""id"":""OP_JOIN@30af7377"",""value"":""LEFT"",""pos"":{""lineNum"":8,""columnNum"":12,""endLineNum"":8,""endColumnNum"":15,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@5c20ffa8"",""value"":""NS_IDENT@7551da2a"",""pos"":{""lineNum"":7,""columnNum"":6,""endLineNum"":7,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@6bcbf05b"",""value"":""NS_IDENT@432034a"",""pos"":{""lineNum"":8,""columnNum"":17,""endLineNum"":8,""endColumnNum"":25,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@7df60067"",""value"":""="",""pos"":{""lineNum"":9,""columnNum"":4,""endLineNum"":9,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5b22b970"",""value"":""NS_IDENT@7551da2a.name"",""pos"":{""lineNum"":9,""columnNum"":4,""endLineNum"":9,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@22d1886d"",""value"":""NS_IDENT@432034a.drinker"",""pos"":{""lineNum"":9,""columnNum"":14,""endLineNum"":9,""endColumnNum"":23,""quoted"":false},""children"":[]}]}},""whereNode"":{""id"":""OP_BINARY@7ca0863b"",""value"":""="",""pos"":{""lineNum"":10,""columnNum"":7,""endLineNum"":10,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1cbb3d3b"",""value"":""NS_IDENT@7551da2a.name"",""pos"":{""lineNum"":10,""columnNum"":7,""endLineNum"":10,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@529cfee5"",""value"":""NS_IDENT@65bb9029.name"",""pos"":{""lineNum"":10,""columnNum"":17,""endLineNum"":10,""endColumnNum"":23,""quoted"":false},""children"":[]}]},""isAggregate"":true,""identifiers"":[{""id"":""COLUMN_LOCAL@4d23015c"",""value"":""NS_IDENT@432034a.TIMES_A_WEEK"",""pos"":{""lineNum"":6,""columnNum"":12,""endLineNum"":6,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5b22b970"",""value"":""NS_IDENT@7551da2a.name"",""pos"":{""lineNum"":9,""columnNum"":4,""endLineNum"":9,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@529cfee5"",""value"":""NS_IDENT@65bb9029.name"",""pos"":{""lineNum"":10,""columnNum"":17,""endLineNum"":10,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@22d1886d"",""value"":""NS_IDENT@432034a.drinker"",""pos"":{""lineNum"":9,""columnNum"":14,""endLineNum"":9,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1cbb3d3b"",""value"":""NS_IDENT@7551da2a.name"",""pos"":{""lineNum"":10,""columnNum"":7,""endLineNum"":10,""endColumnNum"":13,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@65bb9029""],""corrCtxIds"":[""BLOCK_SELECT@6443b128""],""pos"":{""lineNum"":6,""columnNum"":1,""endLineNum"":10,""endColumnNum"":23,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@49601f82"":{""tableId"":""NS_IDENT@49601f82"",""identifier"":""F1"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":17,""endLineNum"":3,""endColumnNum"":28,""quoted"":false}},""NS_IDENT@7551da2a"":{""tableId"":""NS_IDENT@7551da2a"",""identifier"":""D2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":6,""endLineNum"":7,""endColumnNum"":15,""quoted"":false}},""NS_IDENT@65bb9029"":{""tableId"":""NS_IDENT@65bb9029"",""identifier"":""D1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":15,""quoted"":false}},""NS_IDENT@432034a"":{""tableId"":""NS_IDENT@432034a"",""identifier"":""F2"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":17,""endLineNum"":8,""endColumnNum"":28,""quoted"":false}}},""corrTables"":[""NS_IDENT@65bb9029""]}
"
"SELECT drinker.name AS name, a.bar AS bar
FROM drinker LEFT OUTER JOIN 

((SELECT drinker, bar
FROM Frequents f)

EXCEPT

(SELECT f.drinker, f.bar
FROM Frequents f, Frequents sec
WHERE f.times_a_week < sec.times_a_week AND f.drinker = sec.drinker)) AS a ON name = drinker","{""failed"":true}
"
"WITH freqA AS
(SELECT drinker as name, max(times_a_week)
FROM frequents f RIGHT OUTER JOIN drinker d on f.drinker = d.name
GROUP BY drinker)
SELECT drinker as name, f.bar as bar
FROM freqA a, frequents f
WHERE  a.name = f.drinker AND a.max = f.times_a_week","{""failed"":true,""errorMsg"":""Parsing error at line 7, column 32. Query syntax may be incorrect""}
"
"select name, bar from drinker left outer join frequents a on drinker.name = a.drinker where a.times_a_week = (SELECT max(times_a_week) from frequents b where a.drinker = b.drinker) or a.times_a_week is null","{""blocks"":{""id"":""BLOCK_SELECT@6443b128"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@87abc48"",""value"":""NS_IDENT@bdc8014.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@782168b7"",""value"":""NS_IDENT@1698d7c0.BAR"",""pos"":{""lineNum"":1,""columnNum"":14,""endLineNum"":1,""endColumnNum"":16,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@bdc8014"",""NS_IDENT@1698d7c0""],""fromNode"":{""id"":""OP_JOIN@37a64f9d"",""value"":""LEFT"",""pos"":{""lineNum"":1,""columnNum"":42,""endLineNum"":1,""endColumnNum"":45,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@21f9277b"",""value"":""NS_IDENT@bdc8014"",""pos"":{""lineNum"":1,""columnNum"":23,""endLineNum"":1,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@201aa8c1"",""value"":""NS_IDENT@1698d7c0"",""pos"":{""lineNum"":1,""columnNum"":47,""endLineNum"":1,""endColumnNum"":55,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@7f02251"",""value"":""="",""pos"":{""lineNum"":1,""columnNum"":62,""endLineNum"":1,""endColumnNum"":85,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@322803db"",""value"":""NS_IDENT@bdc8014.name"",""pos"":{""lineNum"":1,""columnNum"":62,""endLineNum"":1,""endColumnNum"":73,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@392a04e7"",""value"":""NS_IDENT@1698d7c0.drinker"",""pos"":{""lineNum"":1,""columnNum"":77,""endLineNum"":1,""endColumnNum"":85,""quoted"":false},""children"":[]}]}},""whereNode"":{""id"":""OP_BINARY@4cafa9aa"",""value"":""OR"",""pos"":{""lineNum"":1,""columnNum"":93,""endLineNum"":1,""endColumnNum"":206,""quoted"":false},""children"":[{""id"":""OP_BINARY@49aa766b"",""value"":""="",""pos"":{""lineNum"":1,""columnNum"":93,""endLineNum"":1,""endColumnNum"":179,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@3a627c80"",""value"":""NS_IDENT@1698d7c0.times_a_week"",""pos"":{""lineNum"":1,""columnNum"":93,""endLineNum"":1,""endColumnNum"":106,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT_SCALAR@562c877a"",""value"":""BLOCK_SELECT@175acfb2"",""pos"":{""lineNum"":1,""columnNum"":111,""endLineNum"":1,""endColumnNum"":179,""quoted"":false},""children"":[]}]},{""id"":""OP_POSTFIX@65004ff6"",""value"":""IS NULL"",""pos"":{""lineNum"":1,""columnNum"":185,""endLineNum"":1,""endColumnNum"":206,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@963176"",""value"":""NS_IDENT@1698d7c0.times_a_week"",""pos"":{""lineNum"":1,""columnNum"":185,""endLineNum"":1,""endColumnNum"":198,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@782168b7"",""value"":""NS_IDENT@1698d7c0.BAR"",""pos"":{""lineNum"":1,""columnNum"":14,""endLineNum"":1,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@322803db"",""value"":""NS_IDENT@bdc8014.name"",""pos"":{""lineNum"":1,""columnNum"":62,""endLineNum"":1,""endColumnNum"":73,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@392a04e7"",""value"":""NS_IDENT@1698d7c0.drinker"",""pos"":{""lineNum"":1,""columnNum"":77,""endLineNum"":1,""endColumnNum"":85,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@963176"",""value"":""NS_IDENT@1698d7c0.times_a_week"",""pos"":{""lineNum"":1,""columnNum"":185,""endLineNum"":1,""endColumnNum"":198,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@87abc48"",""value"":""NS_IDENT@bdc8014.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3a627c80"",""value"":""NS_IDENT@1698d7c0.times_a_week"",""pos"":{""lineNum"":1,""columnNum"":93,""endLineNum"":1,""endColumnNum"":106,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@1698d7c0.drinker""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":1,""endColumnNum"":206,""quoted"":false},""children"":{""BLOCK_SELECT@175acfb2"":{""id"":""BLOCK_SELECT@175acfb2"",""parentId"":""BLOCK_SELECT@6443b128"",""fields"":[""EXPR$0 INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""OP_AGG_FUNC@31cb96e1"",""value"":""MAX"",""pos"":{""lineNum"":1,""columnNum"":118,""endLineNum"":1,""endColumnNum"":134,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@3eed0f5"",""value"":""NS_IDENT@6093d508.TIMES_A_WEEK"",""pos"":{""lineNum"":1,""columnNum"":122,""endLineNum"":1,""endColumnNum"":133,""quoted"":false},""children"":[]}]}],""fromItemIds"":[""NS_IDENT@6093d508""],""fromNode"":{""id"":""JOIN_OPERAND@247667dd"",""value"":""NS_IDENT@6093d508"",""pos"":{""lineNum"":1,""columnNum"":141,""endLineNum"":1,""endColumnNum"":149,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@3766c667"",""value"":""="",""pos"":{""lineNum"":1,""columnNum"":159,""endLineNum"":1,""endColumnNum"":179,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@66e889df"",""value"":""NS_IDENT@1698d7c0.drinker"",""pos"":{""lineNum"":1,""columnNum"":159,""endLineNum"":1,""endColumnNum"":167,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@444548a0"",""value"":""NS_IDENT@6093d508.drinker"",""pos"":{""lineNum"":1,""columnNum"":171,""endLineNum"":1,""endColumnNum"":179,""quoted"":false},""children"":[]}]},""isAggregate"":true,""identifiers"":[{""id"":""COLUMN_CORRELATE@66e889df"",""value"":""NS_IDENT@1698d7c0.drinker"",""pos"":{""lineNum"":1,""columnNum"":159,""endLineNum"":1,""endColumnNum"":167,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@444548a0"",""value"":""NS_IDENT@6093d508.drinker"",""pos"":{""lineNum"":1,""columnNum"":171,""endLineNum"":1,""endColumnNum"":179,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3eed0f5"",""value"":""NS_IDENT@6093d508.TIMES_A_WEEK"",""pos"":{""lineNum"":1,""columnNum"":122,""endLineNum"":1,""endColumnNum"":133,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@1698d7c0""],""corrCtxIds"":[""BLOCK_SELECT@6443b128""],""pos"":{""lineNum"":1,""columnNum"":111,""endLineNum"":1,""endColumnNum"":179,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@6093d508"":{""tableId"":""NS_IDENT@6093d508"",""identifier"":""B"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":141,""endLineNum"":1,""endColumnNum"":151,""quoted"":false}},""NS_IDENT@1698d7c0"":{""tableId"":""NS_IDENT@1698d7c0"",""identifier"":""A"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":47,""endLineNum"":1,""endColumnNum"":57,""quoted"":false}},""NS_IDENT@bdc8014"":{""tableId"":""NS_IDENT@bdc8014"",""identifier"":""DRINKER"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":23,""endLineNum"":1,""endColumnNum"":29,""quoted"":false}}},""corrTables"":[""NS_IDENT@1698d7c0""]}
"
"SELECT frequents.drinker, frequents.bar
FROM frequents, 
(SELECT F.drinker, max(F.times_a_week) maximum
 FROM frequents F
 GROUP BY F.drinker) maxfreqs
WHERE maxfreqs.maximum = frequents.times_a_week
AND frequents.drinker = maxfreqs.drinker

UNION

(SELECT nodrinkers.name, NULL
FROM (SELECT drinker.name
FROM drinker
WHERE drinker.name NOT IN (SELECT frequents.drinker FROM frequents)) nodrinkers)","{""blocks"":{""id"":""BLOCK_SETOP@6443b128"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""opName"":""UNION"",""all"":false,""leftBlockId"":""BLOCK_SELECT@6ad6fa53"",""rightBlockId"":""BLOCK_SELECT@2fe88a09"",""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":14,""endColumnNum"":79,""quoted"":false},""children"":{""BLOCK_SELECT@6ad6fa53"":{""id"":""BLOCK_SELECT@6ad6fa53"",""parentId"":""BLOCK_SETOP@6443b128"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@14fc5d40"",""value"":""NS_IDENT@6124287a.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@47d7bfb3"",""value"":""NS_IDENT@6124287a.BAR"",""pos"":{""lineNum"":1,""columnNum"":27,""endLineNum"":1,""endColumnNum"":39,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@6124287a"",""NS_SELECT@2e380628""],""fromNode"":{""id"":""OP_JOIN@247667dd"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":15,""endLineNum"":2,""endColumnNum"":15,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@2d66530f"",""value"":""NS_IDENT@6124287a"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@488b50ec"",""value"":""BLOCK_SELECT@488b50ec"",""pos"":{""lineNum"":3,""columnNum"":2,""endLineNum"":5,""endColumnNum"":19,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@476ec9d0"",""value"":""AND"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":7,""endColumnNum"":40,""quoted"":false},""children"":[{""id"":""OP_BINARY@61799544"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":47,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1603dc2f"",""value"":""NS_SELECT@2e380628.MAXIMUM"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@398474a2"",""value"":""NS_IDENT@6124287a.times_a_week"",""pos"":{""lineNum"":6,""columnNum"":26,""endLineNum"":6,""endColumnNum"":47,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@6a10b263"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":5,""endLineNum"":7,""endColumnNum"":40,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@78c1a023"",""value"":""NS_IDENT@6124287a.drinker"",""pos"":{""lineNum"":7,""columnNum"":5,""endLineNum"":7,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@70abf9b0"",""value"":""NS_SELECT@2e380628.DRINKER"",""pos"":{""lineNum"":7,""columnNum"":25,""endLineNum"":7,""endColumnNum"":40,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@78c1a023"",""value"":""NS_IDENT@6124287a.drinker"",""pos"":{""lineNum"":7,""columnNum"":5,""endLineNum"":7,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@70abf9b0"",""value"":""NS_SELECT@2e380628.DRINKER"",""pos"":{""lineNum"":7,""columnNum"":25,""endLineNum"":7,""endColumnNum"":40,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1603dc2f"",""value"":""NS_SELECT@2e380628.MAXIMUM"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@47d7bfb3"",""value"":""NS_IDENT@6124287a.BAR"",""pos"":{""lineNum"":1,""columnNum"":27,""endLineNum"":1,""endColumnNum"":39,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@14fc5d40"",""value"":""NS_IDENT@6124287a.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@398474a2"",""value"":""NS_IDENT@6124287a.times_a_week"",""pos"":{""lineNum"":6,""columnNum"":26,""endLineNum"":6,""endColumnNum"":47,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":7,""endColumnNum"":40,""quoted"":false},""children"":{""BLOCK_SELECT@488b50ec"":{""id"":""BLOCK_SELECT@488b50ec"",""parentId"":""BLOCK_SELECT@6ad6fa53"",""alias"":""MAXFREQS"",""fields"":[""DRINKER VARCHAR(100)"",""MAXIMUM INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@c81fd12"",""value"":""NS_IDENT@3b6c624.DRINKER"",""pos"":{""lineNum"":3,""columnNum"":9,""endLineNum"":3,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@5754de72"",""value"":""MAX"",""pos"":{""lineNum"":3,""columnNum"":20,""endLineNum"":3,""endColumnNum"":38,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@31ee96f4"",""value"":""NS_IDENT@3b6c624.TIMES_A_WEEK"",""pos"":{""lineNum"":3,""columnNum"":24,""endLineNum"":3,""endColumnNum"":37,""quoted"":false},""children"":[]}],""alias"":""MAXIMUM""}],""fromItemIds"":[""NS_IDENT@3b6c624""],""fromNode"":{""id"":""JOIN_OPERAND@18a645fd"",""value"":""NS_IDENT@3b6c624"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":15,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@7f02251"",""value"":""NS_IDENT@3b6c624.drinker"",""pos"":{""lineNum"":5,""columnNum"":11,""endLineNum"":5,""endColumnNum"":19,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@31ee96f4"",""value"":""NS_IDENT@3b6c624.TIMES_A_WEEK"",""pos"":{""lineNum"":3,""columnNum"":24,""endLineNum"":3,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7f02251"",""value"":""NS_IDENT@3b6c624.drinker"",""pos"":{""lineNum"":5,""columnNum"":11,""endLineNum"":5,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@c81fd12"",""value"":""NS_IDENT@3b6c624.DRINKER"",""pos"":{""lineNum"":3,""columnNum"":9,""endLineNum"":3,""endColumnNum"":17,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":2,""endLineNum"":5,""endColumnNum"":19,""quoted"":false},""children"":{}}}},""BLOCK_SELECT@2fe88a09"":{""id"":""BLOCK_SELECT@2fe88a09"",""parentId"":""BLOCK_SETOP@6443b128"",""fields"":[""NAME VARCHAR(100)"",""EXPR$1 NULL""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@6daf2337"",""value"":""NS_SELECT@50d3bf39.NAME"",""pos"":{""lineNum"":11,""columnNum"":9,""endLineNum"":11,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""LITERAL_KEYWORD@24fabd0f"",""pos"":{""lineNum"":11,""columnNum"":26,""endLineNum"":11,""endColumnNum"":29,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_SELECT@50d3bf39""],""fromNode"":{""id"":""JOIN_OPERAND@1917d90f"",""value"":""BLOCK_SELECT@1917d90f"",""pos"":{""lineNum"":12,""columnNum"":7,""endLineNum"":14,""endColumnNum"":67,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@6daf2337"",""value"":""NS_SELECT@50d3bf39.NAME"",""pos"":{""lineNum"":11,""columnNum"":9,""endLineNum"":11,""endColumnNum"":23,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":11,""columnNum"":2,""endLineNum"":14,""endColumnNum"":79,""quoted"":false},""children"":{""BLOCK_SELECT@1917d90f"":{""id"":""BLOCK_SELECT@1917d90f"",""parentId"":""BLOCK_SELECT@2fe88a09"",""alias"":""NODRINKERS"",""fields"":[""NAME VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@29852487"",""value"":""NS_IDENT@25a73de1.NAME"",""pos"":{""lineNum"":12,""columnNum"":14,""endLineNum"":12,""endColumnNum"":25,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@25a73de1""],""fromNode"":{""id"":""JOIN_OPERAND@21fff664"",""value"":""NS_IDENT@25a73de1"",""pos"":{""lineNum"":13,""columnNum"":6,""endLineNum"":13,""endColumnNum"":12,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@bdc8014"",""value"":""NOT IN"",""pos"":{""lineNum"":14,""columnNum"":7,""endLineNum"":14,""endColumnNum"":66,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@736f3e9e"",""value"":""NS_IDENT@25a73de1.name"",""pos"":{""lineNum"":14,""columnNum"":7,""endLineNum"":14,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@66bfd864"",""value"":""BLOCK_SELECT@66bfd864"",""pos"":{""lineNum"":14,""columnNum"":28,""endLineNum"":14,""endColumnNum"":66,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@29852487"",""value"":""NS_IDENT@25a73de1.NAME"",""pos"":{""lineNum"":12,""columnNum"":14,""endLineNum"":12,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@736f3e9e"",""value"":""NS_IDENT@25a73de1.name"",""pos"":{""lineNum"":14,""columnNum"":7,""endLineNum"":14,""endColumnNum"":18,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":12,""columnNum"":7,""endLineNum"":14,""endColumnNum"":67,""quoted"":false},""children"":{""BLOCK_SELECT@66bfd864"":{""id"":""BLOCK_SELECT@66bfd864"",""parentId"":""BLOCK_SELECT@1917d90f"",""fields"":[""DRINKER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@79ab34c1"",""value"":""NS_IDENT@26ae880a.DRINKER"",""pos"":{""lineNum"":14,""columnNum"":35,""endLineNum"":14,""endColumnNum"":51,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@26ae880a""],""fromNode"":{""id"":""JOIN_OPERAND@4aac85fa"",""value"":""NS_IDENT@26ae880a"",""pos"":{""lineNum"":14,""columnNum"":58,""endLineNum"":14,""endColumnNum"":66,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@79ab34c1"",""value"":""NS_IDENT@26ae880a.DRINKER"",""pos"":{""lineNum"":14,""columnNum"":35,""endLineNum"":14,""endColumnNum"":51,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":14,""columnNum"":28,""endLineNum"":14,""endColumnNum"":66,""quoted"":false},""children"":{}}}}}}}},""tables"":{""NS_IDENT@3b6c624"":{""tableId"":""NS_IDENT@3b6c624"",""identifier"":""F"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":17,""quoted"":false}},""NS_SELECT@2e380628"":{""tableId"":""NS_SELECT@2e380628"",""identifier"":""MAXFREQS"",""blockId"":""BLOCK_SELECT@488b50ec"",""fields"":[""DRINKER VARCHAR(100)"",""MAXIMUM INTEGER""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":2,""endLineNum"":5,""endColumnNum"":29,""quoted"":false}},""NS_IDENT@25a73de1"":{""tableId"":""NS_IDENT@25a73de1"",""identifier"":""DRINKER"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":13,""columnNum"":6,""endLineNum"":13,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@6124287a"":{""tableId"":""NS_IDENT@6124287a"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":14,""quoted"":false}},""NS_IDENT@26ae880a"":{""tableId"":""NS_IDENT@26ae880a"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":14,""columnNum"":58,""endLineNum"":14,""endColumnNum"":66,""quoted"":false}},""NS_SELECT@50d3bf39"":{""tableId"":""NS_SELECT@50d3bf39"",""identifier"":""NODRINKERS"",""blockId"":""BLOCK_SELECT@1917d90f"",""fields"":[""NAME VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":12,""columnNum"":7,""endLineNum"":14,""endColumnNum"":79,""quoted"":false}}},""corrTables"":[]}
"
"SELECT DISTINCT f1.n1, bar
from ( SELECT d1.name as n1, MAX(times_a_week) as time from frequents f2 right join drinker d1 on f2.drinker = d1.name GROUP BY d1.name ) as f1 left join frequents    
on frequents.times_a_week = time  and f1.n1 = frequents.drinker ","{""failed"":true,""errorMsg"":""Parsing error at line 2, column 51. Query syntax may be incorrect""}
"
"WITH temp1 as(select max(times_a_week), drinker.name
from drinker left join frequents on frequents.drinker = drinker.name
group by drinker.name)
select temp1.name, frequents.bar
from temp1 left join frequents on temp1.name = frequents.drinker and temp1.max = frequents.times_a_week","{""failed"":true,""errorMsg"":""Parsing error at line 5, column 75. Query syntax may be incorrect""}
"
"SELECT d.name, f.bar 
FROM drinker d 
LEFT OUTER JOIN frequents f
ON f.drinker = d.name
AND (f.drinker, f.times_a_week) IN
(
	SELECT drinker, MAX(times_a_week)
	FROM frequents
	GROUP BY drinker
)

","{""failed"":true}
"
"With hold AS (SELECT drinker.name, max(times_a_week) AS times_a_week FROM frequents FULL OUTER JOIN drinker ON frequents.drinker = name Group By drinker.name),
hold2 AS (SELECT drinker.name, frequents.times_a_week, frequents.bar FROM frequents FULL OUTER JOIN drinker ON frequents.drinker = name)
Select hold.name, hold2.bar
From hold, hold2
Where hold.name = hold2.name AND (hold.times_a_week = hold2.times_a_week OR hold2.times_a_week IS NULL);","{""failed"":true,""errorMsg"":""Parsing error at line 1, column 6. Query syntax may be incorrect""}
"
"SELECT ntemp.name, maxfreq.bar
FROM 
(SELECT d.name, MAX(times_a_week)
FROM frequents f 
RIGHT JOIN drinker d ON d.name = f.drinker
GROUP BY d.name) AS ntemp
LEFT JOIN frequents maxfreq ON ntemp.name = maxfreq.drinker AND maxfreq.times_a_week = ntemp.max


","{""failed"":true,""errorMsg"":""Parsing error at line 7, column 93. Query syntax may be incorrect""}
"
"SELECT NT.name, FF.bar
FROM 
(SELECT D.name, MAX(times_a_week)
FROM frequents F
RIGHT JOIN drinker D ON D.name = F.drinker
GROUP BY D.name) AS NT
LEFT JOIN frequents FF ON NT.name = FF.drinker AND FF.times_a_week = NT.max","{""failed"":true,""errorMsg"":""Parsing error at line 7, column 72. Query syntax may be incorrect""}
"
"SELECT name, bar
FROM drinker
FULL OUTER JOIN frequents
ON name = drinker
WHERE times_a_week >= ALL(
SELECT times_a_week
FROM frequents
WHERE drinker = name);

","{""blocks"":{""id"":""BLOCK_SELECT@40021799"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@2bcec6a6"",""value"":""NS_IDENT@68ba310d.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4912d525"",""value"":""NS_IDENT@566d0c69.BAR"",""pos"":{""lineNum"":1,""columnNum"":14,""endLineNum"":1,""endColumnNum"":16,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@68ba310d"",""NS_IDENT@566d0c69""],""fromNode"":{""id"":""OP_JOIN@488b50ec"",""value"":""FULL"",""pos"":{""lineNum"":3,""columnNum"":12,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@18a645fd"",""value"":""NS_IDENT@68ba310d"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@6090f3ca"",""value"":""NS_IDENT@566d0c69"",""pos"":{""lineNum"":3,""columnNum"":17,""endLineNum"":3,""endColumnNum"":25,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@3a91d146"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":4,""endLineNum"":4,""endColumnNum"":17,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1bc425e7"",""value"":""NS_IDENT@68ba310d.name"",""pos"":{""lineNum"":4,""columnNum"":4,""endLineNum"":4,""endColumnNum"":7,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@d176a31"",""value"":""NS_IDENT@566d0c69.drinker"",""pos"":{""lineNum"":4,""columnNum"":11,""endLineNum"":4,""endColumnNum"":17,""quoted"":false},""children"":[]}]}},""whereNode"":{""id"":""OP_BINARY@5cf8edcf"",""value"":"">= ALL"",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":8,""endColumnNum"":20,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@57540fd0"",""value"":""NS_IDENT@566d0c69.times_a_week"",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":5,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@4e868ef5"",""value"":""BLOCK_SELECT@4e868ef5"",""pos"":{""lineNum"":6,""columnNum"":1,""endLineNum"":8,""endColumnNum"":20,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@57540fd0"",""value"":""NS_IDENT@566d0c69.times_a_week"",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":5,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4912d525"",""value"":""NS_IDENT@566d0c69.BAR"",""pos"":{""lineNum"":1,""columnNum"":14,""endLineNum"":1,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2bcec6a6"",""value"":""NS_IDENT@68ba310d.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@d176a31"",""value"":""NS_IDENT@566d0c69.drinker"",""pos"":{""lineNum"":4,""columnNum"":11,""endLineNum"":4,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1bc425e7"",""value"":""NS_IDENT@68ba310d.name"",""pos"":{""lineNum"":4,""columnNum"":4,""endLineNum"":4,""endColumnNum"":7,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@68ba310d.name""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":8,""endColumnNum"":21,""quoted"":false},""children"":{""BLOCK_SELECT@4e868ef5"":{""id"":""BLOCK_SELECT@4e868ef5"",""parentId"":""BLOCK_SELECT@40021799"",""fields"":[""TIMES_A_WEEK INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@1542af63"",""value"":""NS_IDENT@151335cb.TIMES_A_WEEK"",""pos"":{""lineNum"":6,""columnNum"":8,""endLineNum"":6,""endColumnNum"":19,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@151335cb""],""fromNode"":{""id"":""JOIN_OPERAND@1d4664d7"",""value"":""NS_IDENT@151335cb"",""pos"":{""lineNum"":7,""columnNum"":6,""endLineNum"":7,""endColumnNum"":14,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@562c877a"",""value"":""="",""pos"":{""lineNum"":8,""columnNum"":7,""endLineNum"":8,""endColumnNum"":20,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@65004ff6"",""value"":""NS_IDENT@151335cb.drinker"",""pos"":{""lineNum"":8,""columnNum"":7,""endLineNum"":8,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@4cafa9aa"",""value"":""NS_IDENT@68ba310d.name"",""pos"":{""lineNum"":8,""columnNum"":17,""endLineNum"":8,""endColumnNum"":20,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@1542af63"",""value"":""NS_IDENT@151335cb.TIMES_A_WEEK"",""pos"":{""lineNum"":6,""columnNum"":8,""endLineNum"":6,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@65004ff6"",""value"":""NS_IDENT@151335cb.drinker"",""pos"":{""lineNum"":8,""columnNum"":7,""endLineNum"":8,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@4cafa9aa"",""value"":""NS_IDENT@68ba310d.name"",""pos"":{""lineNum"":8,""columnNum"":17,""endLineNum"":8,""endColumnNum"":20,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@68ba310d""],""corrCtxIds"":[""BLOCK_SELECT@40021799""],""pos"":{""lineNum"":6,""columnNum"":1,""endLineNum"":8,""endColumnNum"":20,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@151335cb"":{""tableId"":""NS_IDENT@151335cb"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":6,""endLineNum"":7,""endColumnNum"":14,""quoted"":false}},""NS_IDENT@566d0c69"":{""tableId"":""NS_IDENT@566d0c69"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":17,""endLineNum"":3,""endColumnNum"":25,""quoted"":false}},""NS_IDENT@68ba310d"":{""tableId"":""NS_IDENT@68ba310d"",""identifier"":""DRINKER"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false}}},""corrTables"":[""NS_IDENT@68ba310d""]}
"
"with temp1 as(
select name, max(times_a_week)
from frequents right  join drinker
on frequents.drinker = drinker.name
group by name)

select temp1.name, bar
from temp1 left join frequents
on temp1.name=frequents.drinker and temp1.max=frequents.times_a_week
","{""failed"":true,""errorMsg"":""Parsing error at line 9, column 42. Query syntax may be incorrect""}
"
"(SELECT F1.drinker, F1.bar
FROM frequents F1
WHERE F1.times_a_week = 
    (SELECT MAX(F2.times_a_week)
    FROM frequents F2
    WHERE F1.drinker = F2.drinker))
UNION
(SELECT J.name AS drinker, null AS bar
FROM ((SELECT D.name
        FROM drinker D) 
        EXCEPT (SELECT DISTINCT F.drinker FROM frequents F)) AS J)","{""failed"":true}
"
"(SELECT F1.drinker, F1.bar
FROM frequents F1
WHERE F1.times_a_week = (SELECT MAX(F2.times_a_week)
FROM frequents F2
WHERE F1.drinker = F2.drinker))
UNION
(SELECT S.name AS drinker, null AS bar
FROM ((SELECT D.name
FROM drinker D) EXCEPT (SELECT DISTINCT F.drinker
FROM frequents F)) AS S)","{""failed"":true}
"
"select name, bar 
from drinker left outer join
(select frequents.drinker, frequents.bar 
from (select drinker, MAX(times_a_week) from frequents group by drinker) t1,
      frequents where t1.drinker = frequents.drinker AND t1.max = frequents.times_a_week) t2 
on Drinker.name = t2.drinker;","{""failed"":true,""errorMsg"":""Parsing error at line 5, column 60. Query syntax may be incorrect""}
"
"select D.name, F.bar
from drinker D
left join frequents F on D.name = F.drinker
where F.times_a_week >= all(select times_a_week from frequents where drinker = D.name)","{""blocks"":{""id"":""BLOCK_SELECT@40021799"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@4912d525"",""value"":""NS_IDENT@7aad3f7d.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@765df79d"",""value"":""NS_IDENT@2bcec6a6.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@7aad3f7d"",""NS_IDENT@2bcec6a6""],""fromNode"":{""id"":""OP_JOIN@488b50ec"",""value"":""LEFT"",""pos"":{""lineNum"":3,""columnNum"":6,""endLineNum"":3,""endColumnNum"":9,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@6090f3ca"",""value"":""NS_IDENT@7aad3f7d"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@37a64f9d"",""value"":""NS_IDENT@2bcec6a6"",""pos"":{""lineNum"":3,""columnNum"":11,""endLineNum"":3,""endColumnNum"":19,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@6f952d6c"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":26,""endLineNum"":3,""endColumnNum"":43,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5b022357"",""value"":""NS_IDENT@7aad3f7d.name"",""pos"":{""lineNum"":3,""columnNum"":26,""endLineNum"":3,""endColumnNum"":31,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4784013e"",""value"":""NS_IDENT@2bcec6a6.drinker"",""pos"":{""lineNum"":3,""columnNum"":35,""endLineNum"":3,""endColumnNum"":43,""quoted"":false},""children"":[]}]}},""whereNode"":{""id"":""OP_BINARY@629f066f"",""value"":"">= ALL"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":85,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@58cec85b"",""value"":""NS_IDENT@2bcec6a6.times_a_week"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@4e868ef5"",""value"":""BLOCK_SELECT@4e868ef5"",""pos"":{""lineNum"":4,""columnNum"":29,""endLineNum"":4,""endColumnNum"":85,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@4784013e"",""value"":""NS_IDENT@2bcec6a6.drinker"",""pos"":{""lineNum"":3,""columnNum"":35,""endLineNum"":3,""endColumnNum"":43,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@58cec85b"",""value"":""NS_IDENT@2bcec6a6.times_a_week"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@765df79d"",""value"":""NS_IDENT@2bcec6a6.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4912d525"",""value"":""NS_IDENT@7aad3f7d.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5b022357"",""value"":""NS_IDENT@7aad3f7d.name"",""pos"":{""lineNum"":3,""columnNum"":26,""endLineNum"":3,""endColumnNum"":31,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@7aad3f7d.name""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":4,""endColumnNum"":86,""quoted"":false},""children"":{""BLOCK_SELECT@4e868ef5"":{""id"":""BLOCK_SELECT@4e868ef5"",""parentId"":""BLOCK_SELECT@40021799"",""fields"":[""TIMES_A_WEEK INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@20ed3303"",""value"":""NS_IDENT@3e850122.TIMES_A_WEEK"",""pos"":{""lineNum"":4,""columnNum"":36,""endLineNum"":4,""endColumnNum"":47,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@3e850122""],""fromNode"":{""id"":""JOIN_OPERAND@1d4664d7"",""value"":""NS_IDENT@3e850122"",""pos"":{""lineNum"":4,""columnNum"":54,""endLineNum"":4,""endColumnNum"":62,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@989da1"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":70,""endLineNum"":4,""endColumnNum"":85,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@562c877a"",""value"":""NS_IDENT@3e850122.drinker"",""pos"":{""lineNum"":4,""columnNum"":70,""endLineNum"":4,""endColumnNum"":76,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@67001148"",""value"":""NS_IDENT@7aad3f7d.name"",""pos"":{""lineNum"":4,""columnNum"":80,""endLineNum"":4,""endColumnNum"":85,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@562c877a"",""value"":""NS_IDENT@3e850122.drinker"",""pos"":{""lineNum"":4,""columnNum"":70,""endLineNum"":4,""endColumnNum"":76,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@20ed3303"",""value"":""NS_IDENT@3e850122.TIMES_A_WEEK"",""pos"":{""lineNum"":4,""columnNum"":36,""endLineNum"":4,""endColumnNum"":47,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@67001148"",""value"":""NS_IDENT@7aad3f7d.name"",""pos"":{""lineNum"":4,""columnNum"":80,""endLineNum"":4,""endColumnNum"":85,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@7aad3f7d""],""corrCtxIds"":[""BLOCK_SELECT@40021799""],""pos"":{""lineNum"":4,""columnNum"":29,""endLineNum"":4,""endColumnNum"":85,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@7aad3f7d"":{""tableId"":""NS_IDENT@7aad3f7d"",""identifier"":""D"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":14,""quoted"":false}},""NS_IDENT@2bcec6a6"":{""tableId"":""NS_IDENT@2bcec6a6"",""identifier"":""F"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":11,""endLineNum"":3,""endColumnNum"":21,""quoted"":false}},""NS_IDENT@3e850122"":{""tableId"":""NS_IDENT@3e850122"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":54,""endLineNum"":4,""endColumnNum"":62,""quoted"":false}}},""corrTables"":[""NS_IDENT@7aad3f7d""]}
"
"select distinct(c.drinker), c.bar from ((select l.drinker, f.bar from likes l, frequents f where l.drinker = f.drinker)
except all (select a.drinker, a.bar from (select likes.drinker, frequents.bar, frequents.times_a_week from likes, frequents where likes.drinker = frequents.drinker) as a, (select likes.drinker, frequents.bar, frequents.times_a_week from likes, frequents where likes.drinker = frequents.drinker) as b where a.times_a_week < b.times_a_week and a.drinker = b.drinker)) as c;","{""failed"":true}
"
"(with maxes as (select drinker, MAX(times_a_week) from frequents group by drinker) select f.drinker as name, bar from frequents f JOIN maxes ON maxes.drinker=f.drinker and f.times_a_week=maxes.max) union (select name, bar from drinker LEFT OUTER JOIN frequents ON drinker.name=frequents.drinker where frequents.bar IS NULL)
","{""failed"":true,""errorMsg"":""Parsing error at line 1, column 193. Query syntax may be incorrect""}
"
"select drinker.name, b.bar

from drinker

left join
(select a.drinker, max_times, bar
from frequents,

(select frequents.drinker, max(times_a_week) as max_times
from frequents
group by frequents.drinker) as a

where a.drinker = frequents.drinker
and times_a_week = max_times) as b
on drinker.name = b.drinker","{""blocks"":{""id"":""BLOCK_SELECT@6443b128"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@1dcca8d3"",""value"":""NS_IDENT@69c93ca4.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@73ba6fe6"",""value"":""NS_SELECT@60dd3c23.BAR"",""pos"":{""lineNum"":1,""columnNum"":22,""endLineNum"":1,""endColumnNum"":26,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@69c93ca4"",""NS_SELECT@60dd3c23""],""fromNode"":{""id"":""OP_JOIN@71c905a3"",""value"":""LEFT"",""pos"":{""lineNum"":5,""columnNum"":6,""endLineNum"":5,""endColumnNum"":9,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@46c00568"",""value"":""NS_IDENT@69c93ca4"",""pos"":{""lineNum"":3,""columnNum"":6,""endLineNum"":3,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@59712875"",""value"":""BLOCK_SELECT@59712875"",""pos"":{""lineNum"":6,""columnNum"":2,""endLineNum"":14,""endColumnNum"":28,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@22d9c961"",""value"":""="",""pos"":{""lineNum"":15,""columnNum"":4,""endLineNum"":15,""endColumnNum"":27,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@15fa55a6"",""value"":""NS_IDENT@69c93ca4.name"",""pos"":{""lineNum"":15,""columnNum"":4,""endLineNum"":15,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@49dbaaf3"",""value"":""NS_SELECT@60dd3c23.DRINKER"",""pos"":{""lineNum"":15,""columnNum"":19,""endLineNum"":15,""endColumnNum"":27,""quoted"":false},""children"":[]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@73ba6fe6"",""value"":""NS_SELECT@60dd3c23.BAR"",""pos"":{""lineNum"":1,""columnNum"":22,""endLineNum"":1,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1dcca8d3"",""value"":""NS_IDENT@69c93ca4.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@49dbaaf3"",""value"":""NS_SELECT@60dd3c23.DRINKER"",""pos"":{""lineNum"":15,""columnNum"":19,""endLineNum"":15,""endColumnNum"":27,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@15fa55a6"",""value"":""NS_IDENT@69c93ca4.name"",""pos"":{""lineNum"":15,""columnNum"":4,""endLineNum"":15,""endColumnNum"":15,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":15,""endColumnNum"":27,""quoted"":false},""children"":{""BLOCK_SELECT@59712875"":{""id"":""BLOCK_SELECT@59712875"",""parentId"":""BLOCK_SELECT@6443b128"",""alias"":""B"",""fields"":[""DRINKER VARCHAR(100)"",""MAX_TIMES INTEGER"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@72fe8a4f"",""value"":""NS_SELECT@5e9456ae.DRINKER"",""pos"":{""lineNum"":6,""columnNum"":9,""endLineNum"":6,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@71870da7"",""value"":""NS_SELECT@5e9456ae.MAX_TIMES"",""pos"":{""lineNum"":6,""columnNum"":20,""endLineNum"":6,""endColumnNum"":28,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@45792847"",""value"":""NS_IDENT@52b6319f.BAR"",""pos"":{""lineNum"":6,""columnNum"":31,""endLineNum"":6,""endColumnNum"":33,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@52b6319f"",""NS_SELECT@5e9456ae""],""fromNode"":{""id"":""OP_JOIN@47b2e9e1"",""value"":""COMMA"",""pos"":{""lineNum"":7,""columnNum"":15,""endLineNum"":7,""endColumnNum"":15,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@59942b48"",""value"":""NS_IDENT@52b6319f"",""pos"":{""lineNum"":7,""columnNum"":6,""endLineNum"":7,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@1869f114"",""value"":""BLOCK_SELECT@1869f114"",""pos"":{""lineNum"":9,""columnNum"":2,""endLineNum"":11,""endColumnNum"":26,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@57c88764"",""value"":""AND"",""pos"":{""lineNum"":13,""columnNum"":7,""endLineNum"":14,""endColumnNum"":28,""quoted"":false},""children"":[{""id"":""OP_BINARY@4abf3f0"",""value"":""="",""pos"":{""lineNum"":13,""columnNum"":7,""endLineNum"":13,""endColumnNum"":35,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5ac7aa18"",""value"":""NS_SELECT@5e9456ae.DRINKER"",""pos"":{""lineNum"":13,""columnNum"":7,""endLineNum"":13,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4cdd2c73"",""value"":""NS_IDENT@52b6319f.drinker"",""pos"":{""lineNum"":13,""columnNum"":19,""endLineNum"":13,""endColumnNum"":35,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@c27d163"",""value"":""="",""pos"":{""lineNum"":14,""columnNum"":5,""endLineNum"":14,""endColumnNum"":28,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4e4c3a38"",""value"":""NS_IDENT@52b6319f.times_a_week"",""pos"":{""lineNum"":14,""columnNum"":5,""endLineNum"":14,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@293cde83"",""value"":""NS_SELECT@5e9456ae.MAX_TIMES"",""pos"":{""lineNum"":14,""columnNum"":20,""endLineNum"":14,""endColumnNum"":28,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@4e4c3a38"",""value"":""NS_IDENT@52b6319f.times_a_week"",""pos"":{""lineNum"":14,""columnNum"":5,""endLineNum"":14,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@293cde83"",""value"":""NS_SELECT@5e9456ae.MAX_TIMES"",""pos"":{""lineNum"":14,""columnNum"":20,""endLineNum"":14,""endColumnNum"":28,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@72fe8a4f"",""value"":""NS_SELECT@5e9456ae.DRINKER"",""pos"":{""lineNum"":6,""columnNum"":9,""endLineNum"":6,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@71870da7"",""value"":""NS_SELECT@5e9456ae.MAX_TIMES"",""pos"":{""lineNum"":6,""columnNum"":20,""endLineNum"":6,""endColumnNum"":28,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@45792847"",""value"":""NS_IDENT@52b6319f.BAR"",""pos"":{""lineNum"":6,""columnNum"":31,""endLineNum"":6,""endColumnNum"":33,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5ac7aa18"",""value"":""NS_SELECT@5e9456ae.DRINKER"",""pos"":{""lineNum"":13,""columnNum"":7,""endLineNum"":13,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4cdd2c73"",""value"":""NS_IDENT@52b6319f.drinker"",""pos"":{""lineNum"":13,""columnNum"":19,""endLineNum"":13,""endColumnNum"":35,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":6,""columnNum"":2,""endLineNum"":14,""endColumnNum"":28,""quoted"":false},""children"":{""BLOCK_SELECT@1869f114"":{""id"":""BLOCK_SELECT@1869f114"",""parentId"":""BLOCK_SELECT@59712875"",""alias"":""A"",""fields"":[""DRINKER VARCHAR(100)"",""MAX_TIMES INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@7c455e96"",""value"":""NS_IDENT@16a9a4f1.DRINKER"",""pos"":{""lineNum"":9,""columnNum"":9,""endLineNum"":9,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@5bcde458"",""value"":""MAX"",""pos"":{""lineNum"":9,""columnNum"":28,""endLineNum"":9,""endColumnNum"":44,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@215a34b4"",""value"":""NS_IDENT@16a9a4f1.TIMES_A_WEEK"",""pos"":{""lineNum"":9,""columnNum"":32,""endLineNum"":9,""endColumnNum"":43,""quoted"":false},""children"":[]}],""alias"":""MAX_TIMES""}],""fromItemIds"":[""NS_IDENT@16a9a4f1""],""fromNode"":{""id"":""JOIN_OPERAND@488b50ec"",""value"":""NS_IDENT@16a9a4f1"",""pos"":{""lineNum"":10,""columnNum"":6,""endLineNum"":10,""endColumnNum"":14,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@f14e5bf"",""value"":""NS_IDENT@16a9a4f1.drinker"",""pos"":{""lineNum"":11,""columnNum"":10,""endLineNum"":11,""endColumnNum"":26,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@f14e5bf"",""value"":""NS_IDENT@16a9a4f1.drinker"",""pos"":{""lineNum"":11,""columnNum"":10,""endLineNum"":11,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@215a34b4"",""value"":""NS_IDENT@16a9a4f1.TIMES_A_WEEK"",""pos"":{""lineNum"":9,""columnNum"":32,""endLineNum"":9,""endColumnNum"":43,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7c455e96"",""value"":""NS_IDENT@16a9a4f1.DRINKER"",""pos"":{""lineNum"":9,""columnNum"":9,""endLineNum"":9,""endColumnNum"":25,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":9,""columnNum"":2,""endLineNum"":11,""endColumnNum"":26,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_SELECT@60dd3c23"":{""tableId"":""NS_SELECT@60dd3c23"",""identifier"":""B"",""blockId"":""BLOCK_SELECT@59712875"",""fields"":[""DRINKER VARCHAR(100)"",""MAX_TIMES INTEGER"",""BAR VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":2,""endLineNum"":14,""endColumnNum"":34,""quoted"":false}},""NS_SELECT@5e9456ae"":{""tableId"":""NS_SELECT@5e9456ae"",""identifier"":""A"",""blockId"":""BLOCK_SELECT@1869f114"",""fields"":[""DRINKER VARCHAR(100)"",""MAX_TIMES INTEGER""],""cursor"":[0],""pos"":{""lineNum"":9,""columnNum"":2,""endLineNum"":11,""endColumnNum"":32,""quoted"":false}},""NS_IDENT@52b6319f"":{""tableId"":""NS_IDENT@52b6319f"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":6,""endLineNum"":7,""endColumnNum"":14,""quoted"":false}},""NS_IDENT@69c93ca4"":{""tableId"":""NS_IDENT@69c93ca4"",""identifier"":""DRINKER"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":6,""endLineNum"":3,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@16a9a4f1"":{""tableId"":""NS_IDENT@16a9a4f1"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":10,""columnNum"":6,""endLineNum"":10,""endColumnNum"":14,""quoted"":false}}},""corrTables"":[]}
"
"with firstjoin as(SELECT name, max(times_a_week) as max2
from drinker left join frequents on drinker.name = frequents.drinker
group by name)
select firstjoin.name as drinker, frequents.bar as bar
from frequents right join firstjoin on frequents.drinker = firstjoin.name and firstjoin.max2 = frequents.times_a_week","{""blocks"":{""id"":""BLOCK_SELECT@5486887b"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@7435a578"",""value"":""NS_IDENT@675ffd1d.NAME"",""pos"":{""lineNum"":4,""columnNum"":8,""endLineNum"":4,""endColumnNum"":21,""quoted"":false},""children"":[],""alias"":""DRINKER""},{""id"":""COLUMN_LOCAL@30506c0d"",""value"":""NS_IDENT@6b68cb27.BAR"",""pos"":{""lineNum"":4,""columnNum"":35,""endLineNum"":4,""endColumnNum"":47,""quoted"":false},""children"":[],""alias"":""BAR""}],""fromItemIds"":[""NS_IDENT@6b68cb27"",""NS_IDENT@675ffd1d""],""fromNode"":{""id"":""OP_JOIN@5226e402"",""value"":""RIGHT"",""pos"":{""lineNum"":5,""columnNum"":22,""endLineNum"":5,""endColumnNum"":25,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@1440c311"",""value"":""NS_IDENT@6b68cb27"",""pos"":{""lineNum"":5,""columnNum"":6,""endLineNum"":5,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@189b5fb1"",""value"":""NS_IDENT@675ffd1d"",""pos"":{""lineNum"":5,""columnNum"":27,""endLineNum"":5,""endColumnNum"":35,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@29f0c4f2"",""value"":""AND"",""pos"":{""lineNum"":5,""columnNum"":40,""endLineNum"":5,""endColumnNum"":117,""quoted"":false},""children"":[{""id"":""OP_BINARY@281f23f2"",""value"":""="",""pos"":{""lineNum"":5,""columnNum"":40,""endLineNum"":5,""endColumnNum"":73,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@79ab34c1"",""value"":""NS_IDENT@6b68cb27.drinker"",""pos"":{""lineNum"":5,""columnNum"":40,""endLineNum"":5,""endColumnNum"":56,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1698d7c0"",""value"":""NS_IDENT@675ffd1d.NAME"",""pos"":{""lineNum"":5,""columnNum"":60,""endLineNum"":5,""endColumnNum"":73,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@782168b7"",""value"":""="",""pos"":{""lineNum"":5,""columnNum"":79,""endLineNum"":5,""endColumnNum"":117,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@87abc48"",""value"":""NS_IDENT@675ffd1d.MAX2"",""pos"":{""lineNum"":5,""columnNum"":79,""endLineNum"":5,""endColumnNum"":92,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@28d79cba"",""value"":""NS_IDENT@6b68cb27.times_a_week"",""pos"":{""lineNum"":5,""columnNum"":96,""endLineNum"":5,""endColumnNum"":117,""quoted"":false},""children"":[]}]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@1698d7c0"",""value"":""NS_IDENT@675ffd1d.NAME"",""pos"":{""lineNum"":5,""columnNum"":60,""endLineNum"":5,""endColumnNum"":73,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@79ab34c1"",""value"":""NS_IDENT@6b68cb27.drinker"",""pos"":{""lineNum"":5,""columnNum"":40,""endLineNum"":5,""endColumnNum"":56,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7435a578"",""value"":""NS_IDENT@675ffd1d.NAME"",""pos"":{""lineNum"":4,""columnNum"":8,""endLineNum"":4,""endColumnNum"":21,""quoted"":false},""children"":[],""alias"":""DRINKER""},{""id"":""COLUMN_LOCAL@28d79cba"",""value"":""NS_IDENT@6b68cb27.times_a_week"",""pos"":{""lineNum"":5,""columnNum"":96,""endLineNum"":5,""endColumnNum"":117,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@87abc48"",""value"":""NS_IDENT@675ffd1d.MAX2"",""pos"":{""lineNum"":5,""columnNum"":79,""endLineNum"":5,""endColumnNum"":92,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@30506c0d"",""value"":""NS_IDENT@6b68cb27.BAR"",""pos"":{""lineNum"":4,""columnNum"":35,""endLineNum"":4,""endColumnNum"":47,""quoted"":false},""children"":[],""alias"":""BAR""}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":4,""columnNum"":1,""endLineNum"":5,""endColumnNum"":117,""quoted"":false},""children"":{}},""tables"":{""NS_IDENT@675ffd1d"":{""tableId"":""NS_IDENT@675ffd1d"",""identifier"":""FIRSTJOIN"",""dbTableName"":""FIRSTJOIN"",""fields"":[""NAME VARCHAR(100)"",""MAX2 INTEGER""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":27,""endLineNum"":5,""endColumnNum"":35,""quoted"":false}},""NS_IDENT@985696"":{""tableId"":""NS_IDENT@985696"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":24,""endLineNum"":2,""endColumnNum"":32,""quoted"":false}},""NS_IDENT@6b68cb27"":{""tableId"":""NS_IDENT@6b68cb27"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":6,""endLineNum"":5,""endColumnNum"":14,""quoted"":false}},""NS_IDENT@5e9456ae"":{""tableId"":""NS_IDENT@5e9456ae"",""identifier"":""DRINKER"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@5c20ffa8"",""alias"":""FIRSTJOIN"",""fields"":[""NAME VARCHAR(100)"",""MAX2 INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@215a34b4"",""value"":""NS_IDENT@5e9456ae.NAME"",""pos"":{""lineNum"":1,""columnNum"":26,""endLineNum"":1,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@35d3ab60"",""value"":""MAX"",""pos"":{""lineNum"":1,""columnNum"":32,""endLineNum"":1,""endColumnNum"":48,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@10876a6"",""value"":""NS_IDENT@985696.TIMES_A_WEEK"",""pos"":{""lineNum"":1,""columnNum"":36,""endLineNum"":1,""endColumnNum"":47,""quoted"":false},""children"":[]}],""alias"":""MAX2""}],""fromItemIds"":[""NS_IDENT@5e9456ae"",""NS_IDENT@985696""],""fromNode"":{""id"":""OP_JOIN@6bcbf05b"",""value"":""LEFT"",""pos"":{""lineNum"":2,""columnNum"":19,""endLineNum"":2,""endColumnNum"":22,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@37a64f9d"",""value"":""NS_IDENT@5e9456ae"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@21f9277b"",""value"":""NS_IDENT@985696"",""pos"":{""lineNum"":2,""columnNum"":24,""endLineNum"":2,""endColumnNum"":32,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@4455f57d"",""value"":""="",""pos"":{""lineNum"":2,""columnNum"":37,""endLineNum"":2,""endColumnNum"":68,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5f404594"",""value"":""NS_IDENT@5e9456ae.name"",""pos"":{""lineNum"":2,""columnNum"":37,""endLineNum"":2,""endColumnNum"":48,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@878537d"",""value"":""NS_IDENT@985696.drinker"",""pos"":{""lineNum"":2,""columnNum"":52,""endLineNum"":2,""endColumnNum"":68,""quoted"":false},""children"":[]}]}},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@3a022576"",""value"":""NS_IDENT@5e9456ae.name"",""pos"":{""lineNum"":3,""columnNum"":10,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@10876a6"",""value"":""NS_IDENT@985696.TIMES_A_WEEK"",""pos"":{""lineNum"":1,""columnNum"":36,""endLineNum"":1,""endColumnNum"":47,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@215a34b4"",""value"":""NS_IDENT@5e9456ae.NAME"",""pos"":{""lineNum"":1,""columnNum"":26,""endLineNum"":1,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3a022576"",""value"":""NS_IDENT@5e9456ae.name"",""pos"":{""lineNum"":3,""columnNum"":10,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5f404594"",""value"":""NS_IDENT@5e9456ae.name"",""pos"":{""lineNum"":2,""columnNum"":37,""endLineNum"":2,""endColumnNum"":48,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@878537d"",""value"":""NS_IDENT@985696.drinker"",""pos"":{""lineNum"":2,""columnNum"":52,""endLineNum"":2,""endColumnNum"":68,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":19,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":{}}]}
"
"WITH maxTimesAWeek AS (SELECT drinker, MAX(times_a_week) as mostVisits FROM frequents GROUP BY drinker),
barMaxTimesAWeek AS (SELECT frequents.drinker, frequents.bar FROM maxTimesAWeek, frequents 
WHERE maxTimesAWeek.drinker=frequents.drinker AND maxTimesAWeek.mostVisits=frequents.times_a_week)

SELECT name,bar FROM drinker FULL OUTER JOIN
barMaxTimesAWeek  
ON drinker.name=barMaxTimesAWeek.drinker
 ","{""blocks"":{""id"":""BLOCK_SELECT@4d33940d"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@770b3be0"",""value"":""NS_IDENT@51e0301d.NAME"",""pos"":{""lineNum"":5,""columnNum"":8,""endLineNum"":5,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@51dbd6e4"",""value"":""NS_IDENT@47d7bfb3.BAR"",""pos"":{""lineNum"":5,""columnNum"":13,""endLineNum"":5,""endColumnNum"":15,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@51e0301d"",""NS_IDENT@47d7bfb3""],""fromNode"":{""id"":""OP_JOIN@43cf6ea3"",""value"":""FULL"",""pos"":{""lineNum"":5,""columnNum"":41,""endLineNum"":5,""endColumnNum"":44,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@37c5fc56"",""value"":""NS_IDENT@51e0301d"",""pos"":{""lineNum"":5,""columnNum"":22,""endLineNum"":5,""endColumnNum"":28,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@1c025cb"",""value"":""NS_IDENT@47d7bfb3"",""pos"":{""lineNum"":6,""columnNum"":1,""endLineNum"":6,""endColumnNum"":16,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@6daf2337"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":4,""endLineNum"":7,""endColumnNum"":40,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@23e44287"",""value"":""NS_IDENT@51e0301d.name"",""pos"":{""lineNum"":7,""columnNum"":4,""endLineNum"":7,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2b8d084"",""value"":""NS_IDENT@47d7bfb3.DRINKER"",""pos"":{""lineNum"":7,""columnNum"":17,""endLineNum"":7,""endColumnNum"":40,""quoted"":false},""children"":[]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@51dbd6e4"",""value"":""NS_IDENT@47d7bfb3.BAR"",""pos"":{""lineNum"":5,""columnNum"":13,""endLineNum"":5,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@23e44287"",""value"":""NS_IDENT@51e0301d.name"",""pos"":{""lineNum"":7,""columnNum"":4,""endLineNum"":7,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@770b3be0"",""value"":""NS_IDENT@51e0301d.NAME"",""pos"":{""lineNum"":5,""columnNum"":8,""endLineNum"":5,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2b8d084"",""value"":""NS_IDENT@47d7bfb3.DRINKER"",""pos"":{""lineNum"":7,""columnNum"":17,""endLineNum"":7,""endColumnNum"":40,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":5,""columnNum"":1,""endLineNum"":7,""endColumnNum"":40,""quoted"":false},""children"":{}},""tables"":{""NS_IDENT@47d7bfb3"":{""tableId"":""NS_IDENT@47d7bfb3"",""identifier"":""BARMAXTIMESAWEEK"",""dbTableName"":""BARMAXTIMESAWEEK"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":1,""endLineNum"":6,""endColumnNum"":16,""quoted"":false}},""NS_IDENT@2e380628"":{""tableId"":""NS_IDENT@2e380628"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":82,""endLineNum"":2,""endColumnNum"":90,""quoted"":false}},""NS_IDENT@6e1f8469"":{""tableId"":""NS_IDENT@6e1f8469"",""identifier"":""MAXTIMESAWEEK"",""dbTableName"":""MAXTIMESAWEEK"",""fields"":[""DRINKER VARCHAR(100)"",""MOSTVISITS INTEGER""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":67,""endLineNum"":2,""endColumnNum"":79,""quoted"":false}},""NS_IDENT@4e25147a"":{""tableId"":""NS_IDENT@4e25147a"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":77,""endLineNum"":1,""endColumnNum"":85,""quoted"":false}},""NS_IDENT@51e0301d"":{""tableId"":""NS_IDENT@51e0301d"",""identifier"":""DRINKER"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":22,""endLineNum"":5,""endColumnNum"":28,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@7fedfe27"",""alias"":""MAXTIMESAWEEK"",""fields"":[""DRINKER VARCHAR(100)"",""MOSTVISITS INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@1dcca8d3"",""value"":""NS_IDENT@4e25147a.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":31,""endLineNum"":1,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@52a70627"",""value"":""MAX"",""pos"":{""lineNum"":1,""columnNum"":40,""endLineNum"":1,""endColumnNum"":56,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@6124287a"",""value"":""NS_IDENT@4e25147a.TIMES_A_WEEK"",""pos"":{""lineNum"":1,""columnNum"":44,""endLineNum"":1,""endColumnNum"":55,""quoted"":false},""children"":[]}],""alias"":""MOSTVISITS""}],""fromItemIds"":[""NS_IDENT@4e25147a""],""fromNode"":{""id"":""JOIN_OPERAND@488b50ec"",""value"":""NS_IDENT@4e25147a"",""pos"":{""lineNum"":1,""columnNum"":77,""endLineNum"":1,""endColumnNum"":85,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@76075d65"",""value"":""NS_IDENT@4e25147a.drinker"",""pos"":{""lineNum"":1,""columnNum"":96,""endLineNum"":1,""endColumnNum"":102,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@1dcca8d3"",""value"":""NS_IDENT@4e25147a.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":31,""endLineNum"":1,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6124287a"",""value"":""NS_IDENT@4e25147a.TIMES_A_WEEK"",""pos"":{""lineNum"":1,""columnNum"":44,""endLineNum"":1,""endColumnNum"":55,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@76075d65"",""value"":""NS_IDENT@4e25147a.drinker"",""pos"":{""lineNum"":1,""columnNum"":96,""endLineNum"":1,""endColumnNum"":102,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":24,""endLineNum"":1,""endColumnNum"":102,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@4aac85fa"",""alias"":""BARMAXTIMESAWEEK"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@3b6c624"",""value"":""NS_IDENT@2e380628.DRINKER"",""pos"":{""lineNum"":2,""columnNum"":29,""endLineNum"":2,""endColumnNum"":45,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@c81fd12"",""value"":""NS_IDENT@2e380628.BAR"",""pos"":{""lineNum"":2,""columnNum"":48,""endLineNum"":2,""endColumnNum"":60,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@6e1f8469"",""NS_IDENT@2e380628""],""fromNode"":{""id"":""OP_JOIN@30cecdca"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":80,""endLineNum"":2,""endColumnNum"":80,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@6edc4161"",""value"":""NS_IDENT@6e1f8469"",""pos"":{""lineNum"":2,""columnNum"":67,""endLineNum"":2,""endColumnNum"":79,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@5486887b"",""value"":""NS_IDENT@2e380628"",""pos"":{""lineNum"":2,""columnNum"":82,""endLineNum"":2,""endColumnNum"":90,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@4d74c3ba"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":97,""quoted"":false},""children"":[{""id"":""OP_BINARY@15fa55a6"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":45,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@51ec2df1"",""value"":""NS_IDENT@6e1f8469.DRINKER"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":27,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@f8f56b9"",""value"":""NS_IDENT@2e380628.drinker"",""pos"":{""lineNum"":3,""columnNum"":29,""endLineNum"":3,""endColumnNum"":45,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@a64e035"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":51,""endLineNum"":3,""endColumnNum"":97,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_IDENT@6e1f8469.MOSTVISITS"",""pos"":{""lineNum"":3,""columnNum"":51,""endLineNum"":3,""endColumnNum"":74,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7fab4be7"",""value"":""NS_IDENT@2e380628.times_a_week"",""pos"":{""lineNum"":3,""columnNum"":76,""endLineNum"":3,""endColumnNum"":97,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_IDENT@6e1f8469.MOSTVISITS"",""pos"":{""lineNum"":3,""columnNum"":51,""endLineNum"":3,""endColumnNum"":74,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7fab4be7"",""value"":""NS_IDENT@2e380628.times_a_week"",""pos"":{""lineNum"":3,""columnNum"":76,""endLineNum"":3,""endColumnNum"":97,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@51ec2df1"",""value"":""NS_IDENT@6e1f8469.DRINKER"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":27,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@c81fd12"",""value"":""NS_IDENT@2e380628.BAR"",""pos"":{""lineNum"":2,""columnNum"":48,""endLineNum"":2,""endColumnNum"":60,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@f8f56b9"",""value"":""NS_IDENT@2e380628.drinker"",""pos"":{""lineNum"":3,""columnNum"":29,""endLineNum"":3,""endColumnNum"":45,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3b6c624"",""value"":""NS_IDENT@2e380628.DRINKER"",""pos"":{""lineNum"":2,""columnNum"":29,""endLineNum"":2,""endColumnNum"":45,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":22,""endLineNum"":3,""endColumnNum"":97,""quoted"":false},""children"":{}}]}
"
"SELECT d.name, tab2.bar
FROM Drinker d
LEFT OUTER JOIN 
(Select * 
FROM Frequents f2
EXCEPT ALL 
SELECT tab1.drinker, tab1.bar, tab1.times_a_week
FROM Frequents f1
LEFT JOIN 
(SELECT f2.drinker, f2.bar, f2.times_a_week
FROM Frequents f2) tab1
ON tab1.drinker= f1.drinker and f1.times_a_week > tab1.times_a_week) tab2
ON d.name = tab2.drinker;

","{""failed"":true}
"
"with temp as (SELECT drinker, MAX(times_a_week) FROM frequents GROUP BY drinker),
freq as (SELECT  f.drinker, bar FROM frequents f, temp WHERE f.drinker = temp.drinker AND times_a_week = temp.max)

SELECT drinker.name, freq.bar FROM drinker LEFT JOIN freq ON freq.drinker = drinker.name","{""failed"":true,""errorMsg"":""Parsing error at line 2, column 110. Query syntax may be incorrect""}
"
"WITH freq AS (
        SELECT drinker, MAX(times_a_week) frequents_most
        FROM frequents
        GROUP BY drinker
), frequents_the_most AS (
        SELECT freq.drinker, freq_2.bar
        FROM freq, frequents freq_2
        WHERE freq.drinker = freq_2.drinker 
        AND freq.frequents_most = freq_2.times_a_week
)

SELECT drinker.name, frequents_the_most.bar
FROM drinker
LEFT JOIN frequents_the_most
ON frequents_the_most.drinker = drinker.name;","{""blocks"":{""id"":""BLOCK_SELECT@4d33940d"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@31ee96f4"",""value"":""NS_IDENT@62e6a3ec.NAME"",""pos"":{""lineNum"":12,""columnNum"":8,""endLineNum"":12,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@24fabd0f"",""value"":""NS_IDENT@5754de72.BAR"",""pos"":{""lineNum"":12,""columnNum"":22,""endLineNum"":12,""endColumnNum"":43,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@62e6a3ec"",""NS_IDENT@5754de72""],""fromNode"":{""id"":""OP_JOIN@43cf6ea3"",""value"":""LEFT"",""pos"":{""lineNum"":14,""columnNum"":6,""endLineNum"":14,""endColumnNum"":9,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@37c5fc56"",""value"":""NS_IDENT@62e6a3ec"",""pos"":{""lineNum"":13,""columnNum"":6,""endLineNum"":13,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@1c025cb"",""value"":""NS_IDENT@5754de72"",""pos"":{""lineNum"":14,""columnNum"":11,""endLineNum"":14,""endColumnNum"":28,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@49601f82"",""value"":""="",""pos"":{""lineNum"":15,""columnNum"":4,""endLineNum"":15,""endColumnNum"":44,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@2b214b94"",""value"":""NS_IDENT@5754de72.DRINKER"",""pos"":{""lineNum"":15,""columnNum"":4,""endLineNum"":15,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@70e3f36f"",""value"":""NS_IDENT@62e6a3ec.name"",""pos"":{""lineNum"":15,""columnNum"":33,""endLineNum"":15,""endColumnNum"":44,""quoted"":false},""children"":[]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@70e3f36f"",""value"":""NS_IDENT@62e6a3ec.name"",""pos"":{""lineNum"":15,""columnNum"":33,""endLineNum"":15,""endColumnNum"":44,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@31ee96f4"",""value"":""NS_IDENT@62e6a3ec.NAME"",""pos"":{""lineNum"":12,""columnNum"":8,""endLineNum"":12,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@24fabd0f"",""value"":""NS_IDENT@5754de72.BAR"",""pos"":{""lineNum"":12,""columnNum"":22,""endLineNum"":12,""endColumnNum"":43,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2b214b94"",""value"":""NS_IDENT@5754de72.DRINKER"",""pos"":{""lineNum"":15,""columnNum"":4,""endLineNum"":15,""endColumnNum"":29,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":12,""columnNum"":1,""endLineNum"":15,""endColumnNum"":44,""quoted"":false},""children"":{}},""tables"":{""NS_IDENT@5631962"":{""tableId"":""NS_IDENT@5631962"",""identifier"":""FREQ"",""dbTableName"":""FREQ"",""fields"":[""DRINKER VARCHAR(100)"",""FREQUENTS_MOST INTEGER""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":14,""endLineNum"":7,""endColumnNum"":17,""quoted"":false}},""NS_IDENT@62e6a3ec"":{""tableId"":""NS_IDENT@62e6a3ec"",""identifier"":""DRINKER"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":13,""columnNum"":6,""endLineNum"":13,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@52a70627"":{""tableId"":""NS_IDENT@52a70627"",""identifier"":""FREQ_2"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":20,""endLineNum"":7,""endColumnNum"":35,""quoted"":false}},""NS_IDENT@5754de72"":{""tableId"":""NS_IDENT@5754de72"",""identifier"":""FREQUENTS_THE_MOST"",""dbTableName"":""FREQUENTS_THE_MOST"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":14,""columnNum"":11,""endLineNum"":14,""endColumnNum"":28,""quoted"":false}},""NS_IDENT@10876a6"":{""tableId"":""NS_IDENT@10876a6"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":14,""endLineNum"":3,""endColumnNum"":22,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@5c20ffa8"",""alias"":""FREQ"",""fields"":[""DRINKER VARCHAR(100)"",""FREQUENTS_MOST INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@4e25147a"",""value"":""NS_IDENT@10876a6.DRINKER"",""pos"":{""lineNum"":2,""columnNum"":16,""endLineNum"":2,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@675ffd1d"",""value"":""MAX"",""pos"":{""lineNum"":2,""columnNum"":25,""endLineNum"":2,""endColumnNum"":41,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@56303475"",""value"":""NS_IDENT@10876a6.TIMES_A_WEEK"",""pos"":{""lineNum"":2,""columnNum"":29,""endLineNum"":2,""endColumnNum"":40,""quoted"":false},""children"":[]}],""alias"":""FREQUENTS_MOST""}],""fromItemIds"":[""NS_IDENT@10876a6""],""fromNode"":{""id"":""JOIN_OPERAND@1869f114"",""value"":""NS_IDENT@10876a6"",""pos"":{""lineNum"":3,""columnNum"":14,""endLineNum"":3,""endColumnNum"":22,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@5cf87cfd"",""value"":""NS_IDENT@10876a6.drinker"",""pos"":{""lineNum"":4,""columnNum"":18,""endLineNum"":4,""endColumnNum"":24,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@56303475"",""value"":""NS_IDENT@10876a6.TIMES_A_WEEK"",""pos"":{""lineNum"":2,""columnNum"":29,""endLineNum"":2,""endColumnNum"":40,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4e25147a"",""value"":""NS_IDENT@10876a6.DRINKER"",""pos"":{""lineNum"":2,""columnNum"":16,""endLineNum"":2,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5cf87cfd"",""value"":""NS_IDENT@10876a6.drinker"",""pos"":{""lineNum"":4,""columnNum"":18,""endLineNum"":4,""endColumnNum"":24,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":4,""endColumnNum"":24,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@66bfd864"",""alias"":""FREQUENTS_THE_MOST"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@28d79cba"",""value"":""NS_IDENT@5631962.DRINKER"",""pos"":{""lineNum"":6,""columnNum"":16,""endLineNum"":6,""endColumnNum"":27,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@19569ebd"",""value"":""NS_IDENT@52a70627.BAR"",""pos"":{""lineNum"":6,""columnNum"":30,""endLineNum"":6,""endColumnNum"":39,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@5631962"",""NS_IDENT@52a70627""],""fromNode"":{""id"":""OP_JOIN@1e6308a9"",""value"":""COMMA"",""pos"":{""lineNum"":7,""columnNum"":18,""endLineNum"":7,""endColumnNum"":18,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@30cecdca"",""value"":""NS_IDENT@5631962"",""pos"":{""lineNum"":7,""columnNum"":14,""endLineNum"":7,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@5486887b"",""value"":""NS_IDENT@52a70627"",""pos"":{""lineNum"":7,""columnNum"":20,""endLineNum"":7,""endColumnNum"":28,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@4d74c3ba"",""value"":""AND"",""pos"":{""lineNum"":8,""columnNum"":15,""endLineNum"":9,""endColumnNum"":53,""quoted"":false},""children"":[{""id"":""OP_BINARY@15fa55a6"",""value"":""="",""pos"":{""lineNum"":8,""columnNum"":15,""endLineNum"":8,""endColumnNum"":43,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@51ec2df1"",""value"":""NS_IDENT@5631962.DRINKER"",""pos"":{""lineNum"":8,""columnNum"":15,""endLineNum"":8,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@f8f56b9"",""value"":""NS_IDENT@52a70627.drinker"",""pos"":{""lineNum"":8,""columnNum"":30,""endLineNum"":8,""endColumnNum"":43,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@a64e035"",""value"":""="",""pos"":{""lineNum"":9,""columnNum"":13,""endLineNum"":9,""endColumnNum"":53,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_IDENT@5631962.FREQUENTS_MOST"",""pos"":{""lineNum"":9,""columnNum"":13,""endLineNum"":9,""endColumnNum"":31,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7fab4be7"",""value"":""NS_IDENT@52a70627.times_a_week"",""pos"":{""lineNum"":9,""columnNum"":35,""endLineNum"":9,""endColumnNum"":53,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@f8f56b9"",""value"":""NS_IDENT@52a70627.drinker"",""pos"":{""lineNum"":8,""columnNum"":30,""endLineNum"":8,""endColumnNum"":43,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_IDENT@5631962.FREQUENTS_MOST"",""pos"":{""lineNum"":9,""columnNum"":13,""endLineNum"":9,""endColumnNum"":31,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@51ec2df1"",""value"":""NS_IDENT@5631962.DRINKER"",""pos"":{""lineNum"":8,""columnNum"":15,""endLineNum"":8,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7fab4be7"",""value"":""NS_IDENT@52a70627.times_a_week"",""pos"":{""lineNum"":9,""columnNum"":35,""endLineNum"":9,""endColumnNum"":53,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@28d79cba"",""value"":""NS_IDENT@5631962.DRINKER"",""pos"":{""lineNum"":6,""columnNum"":16,""endLineNum"":6,""endColumnNum"":27,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@19569ebd"",""value"":""NS_IDENT@52a70627.BAR"",""pos"":{""lineNum"":6,""columnNum"":30,""endLineNum"":6,""endColumnNum"":39,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":6,""columnNum"":9,""endLineNum"":9,""endColumnNum"":53,""quoted"":false},""children"":{}}]}
"
"SELECT fq.drinker, fq.bar
FROM Frequents fq,
(SELECT F.drinker, max(F.times_a_week) maximum
FROM frequents F
GROUP BY F.drinker) maxfq
WHERE maxfq.maximum = fq.times_a_week
AND fq.drinker = maxfq.drinker

UNION

(SELECT non.name, NULL
FROM 
(SELECT d.name
FROM Drinker d
WHERE d.name NOT IN 
(SELECT frequents.drinker 
FROM frequents)) non)","{""blocks"":{""id"":""BLOCK_SETOP@3f36b447"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""opName"":""UNION"",""all"":false,""leftBlockId"":""BLOCK_SELECT@5d39f2d8"",""rightBlockId"":""BLOCK_SELECT@4f20a5e0"",""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":17,""endColumnNum"":20,""quoted"":false},""children"":{""BLOCK_SELECT@4f20a5e0"":{""id"":""BLOCK_SELECT@4f20a5e0"",""parentId"":""BLOCK_SETOP@3f36b447"",""fields"":[""NAME VARCHAR(100)"",""EXPR$1 NULL""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@24fabd0f"",""value"":""NS_SELECT@25a73de1.NAME"",""pos"":{""lineNum"":11,""columnNum"":9,""endLineNum"":11,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""LITERAL_KEYWORD@250b236d"",""pos"":{""lineNum"":11,""columnNum"":19,""endLineNum"":11,""endColumnNum"":22,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_SELECT@25a73de1""],""fromNode"":{""id"":""JOIN_OPERAND@54da32dc"",""value"":""BLOCK_SELECT@54da32dc"",""pos"":{""lineNum"":13,""columnNum"":2,""endLineNum"":17,""endColumnNum"":15,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@24fabd0f"",""value"":""NS_SELECT@25a73de1.NAME"",""pos"":{""lineNum"":11,""columnNum"":9,""endLineNum"":11,""endColumnNum"":16,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":11,""columnNum"":2,""endLineNum"":17,""endColumnNum"":20,""quoted"":false},""children"":{""BLOCK_SELECT@54da32dc"":{""id"":""BLOCK_SELECT@54da32dc"",""parentId"":""BLOCK_SELECT@4f20a5e0"",""alias"":""NON"",""fields"":[""NAME VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@771db12c"",""value"":""NS_IDENT@29852487.NAME"",""pos"":{""lineNum"":13,""columnNum"":9,""endLineNum"":13,""endColumnNum"":14,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@29852487""],""fromNode"":{""id"":""JOIN_OPERAND@4aac85fa"",""value"":""NS_IDENT@29852487"",""pos"":{""lineNum"":14,""columnNum"":6,""endLineNum"":14,""endColumnNum"":12,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@1f443fae"",""value"":""NOT IN"",""pos"":{""lineNum"":15,""columnNum"":7,""endLineNum"":17,""endColumnNum"":14,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@bdc8014"",""value"":""NS_IDENT@29852487.name"",""pos"":{""lineNum"":15,""columnNum"":7,""endLineNum"":15,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@1d782abe"",""value"":""BLOCK_SELECT@1d782abe"",""pos"":{""lineNum"":16,""columnNum"":2,""endLineNum"":17,""endColumnNum"":14,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@bdc8014"",""value"":""NS_IDENT@29852487.name"",""pos"":{""lineNum"":15,""columnNum"":7,""endLineNum"":15,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@771db12c"",""value"":""NS_IDENT@29852487.NAME"",""pos"":{""lineNum"":13,""columnNum"":9,""endLineNum"":13,""endColumnNum"":14,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":13,""columnNum"":2,""endLineNum"":17,""endColumnNum"":15,""quoted"":false},""children"":{""BLOCK_SELECT@1d782abe"":{""id"":""BLOCK_SELECT@1d782abe"",""parentId"":""BLOCK_SELECT@54da32dc"",""fields"":[""DRINKER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@1698d7c0"",""value"":""NS_IDENT@260f2144.DRINKER"",""pos"":{""lineNum"":16,""columnNum"":9,""endLineNum"":16,""endColumnNum"":25,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@260f2144""],""fromNode"":{""id"":""JOIN_OPERAND@66bfd864"",""value"":""NS_IDENT@260f2144"",""pos"":{""lineNum"":17,""columnNum"":6,""endLineNum"":17,""endColumnNum"":14,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@1698d7c0"",""value"":""NS_IDENT@260f2144.DRINKER"",""pos"":{""lineNum"":16,""columnNum"":9,""endLineNum"":16,""endColumnNum"":25,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":16,""columnNum"":2,""endLineNum"":17,""endColumnNum"":14,""quoted"":false},""children"":{}}}}}},""BLOCK_SELECT@5d39f2d8"":{""id"":""BLOCK_SELECT@5d39f2d8"",""parentId"":""BLOCK_SETOP@3f36b447"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@51e0301d"",""value"":""NS_IDENT@19569ebd.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@770b3be0"",""value"":""NS_IDENT@19569ebd.BAR"",""pos"":{""lineNum"":1,""columnNum"":20,""endLineNum"":1,""endColumnNum"":25,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@19569ebd"",""NS_SELECT@3b6c624""],""fromNode"":{""id"":""OP_JOIN@1dab9dd6"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":18,""endLineNum"":2,""endColumnNum"":18,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@2f879bab"",""value"":""NS_IDENT@19569ebd"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@1d207fad"",""value"":""BLOCK_SELECT@1d207fad"",""pos"":{""lineNum"":3,""columnNum"":2,""endLineNum"":5,""endColumnNum"":18,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@476ec9d0"",""value"":""AND"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":7,""endColumnNum"":30,""quoted"":false},""children"":[{""id"":""OP_BINARY@61799544"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":37,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1603dc2f"",""value"":""NS_SELECT@3b6c624.MAXIMUM"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@398474a2"",""value"":""NS_IDENT@19569ebd.times_a_week"",""pos"":{""lineNum"":6,""columnNum"":23,""endLineNum"":6,""endColumnNum"":37,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@6a10b263"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":5,""endLineNum"":7,""endColumnNum"":30,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@78c1a023"",""value"":""NS_IDENT@19569ebd.drinker"",""pos"":{""lineNum"":7,""columnNum"":5,""endLineNum"":7,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@70abf9b0"",""value"":""NS_SELECT@3b6c624.DRINKER"",""pos"":{""lineNum"":7,""columnNum"":18,""endLineNum"":7,""endColumnNum"":30,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@398474a2"",""value"":""NS_IDENT@19569ebd.times_a_week"",""pos"":{""lineNum"":6,""columnNum"":23,""endLineNum"":6,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@78c1a023"",""value"":""NS_IDENT@19569ebd.drinker"",""pos"":{""lineNum"":7,""columnNum"":5,""endLineNum"":7,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@51e0301d"",""value"":""NS_IDENT@19569ebd.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@770b3be0"",""value"":""NS_IDENT@19569ebd.BAR"",""pos"":{""lineNum"":1,""columnNum"":20,""endLineNum"":1,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@70abf9b0"",""value"":""NS_SELECT@3b6c624.DRINKER"",""pos"":{""lineNum"":7,""columnNum"":18,""endLineNum"":7,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1603dc2f"",""value"":""NS_SELECT@3b6c624.MAXIMUM"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":19,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":7,""endColumnNum"":30,""quoted"":false},""children"":{""BLOCK_SELECT@1d207fad"":{""id"":""BLOCK_SELECT@1d207fad"",""parentId"":""BLOCK_SELECT@5d39f2d8"",""alias"":""MAXFQ"",""fields"":[""DRINKER VARCHAR(100)"",""MAXIMUM INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@62e6a3ec"",""value"":""NS_IDENT@1eaf1e62.DRINKER"",""pos"":{""lineNum"":3,""columnNum"":9,""endLineNum"":3,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@31ee96f4"",""value"":""MAX"",""pos"":{""lineNum"":3,""columnNum"":20,""endLineNum"":3,""endColumnNum"":38,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@320494b6"",""value"":""NS_IDENT@1eaf1e62.TIMES_A_WEEK"",""pos"":{""lineNum"":3,""columnNum"":24,""endLineNum"":3,""endColumnNum"":37,""quoted"":false},""children"":[]}],""alias"":""MAXIMUM""}],""fromItemIds"":[""NS_IDENT@1eaf1e62""],""fromNode"":{""id"":""JOIN_OPERAND@72ed9aad"",""value"":""NS_IDENT@1eaf1e62"",""pos"":{""lineNum"":4,""columnNum"":6,""endLineNum"":4,""endColumnNum"":14,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@7f02251"",""value"":""NS_IDENT@1eaf1e62.drinker"",""pos"":{""lineNum"":5,""columnNum"":10,""endLineNum"":5,""endColumnNum"":18,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@320494b6"",""value"":""NS_IDENT@1eaf1e62.TIMES_A_WEEK"",""pos"":{""lineNum"":3,""columnNum"":24,""endLineNum"":3,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@62e6a3ec"",""value"":""NS_IDENT@1eaf1e62.DRINKER"",""pos"":{""lineNum"":3,""columnNum"":9,""endLineNum"":3,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7f02251"",""value"":""NS_IDENT@1eaf1e62.drinker"",""pos"":{""lineNum"":5,""columnNum"":10,""endLineNum"":5,""endColumnNum"":18,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":2,""endLineNum"":5,""endColumnNum"":18,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@260f2144"":{""tableId"":""NS_IDENT@260f2144"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":17,""columnNum"":6,""endLineNum"":17,""endColumnNum"":14,""quoted"":false}},""NS_SELECT@25a73de1"":{""tableId"":""NS_SELECT@25a73de1"",""identifier"":""NON"",""blockId"":""BLOCK_SELECT@54da32dc"",""fields"":[""NAME VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":13,""columnNum"":2,""endLineNum"":17,""endColumnNum"":20,""quoted"":false}},""NS_IDENT@29852487"":{""tableId"":""NS_IDENT@29852487"",""identifier"":""D"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":14,""columnNum"":6,""endLineNum"":14,""endColumnNum"":14,""quoted"":false}},""NS_IDENT@1eaf1e62"":{""tableId"":""NS_IDENT@1eaf1e62"",""identifier"":""F"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":6,""endLineNum"":4,""endColumnNum"":16,""quoted"":false}},""NS_SELECT@3b6c624"":{""tableId"":""NS_SELECT@3b6c624"",""identifier"":""MAXFQ"",""blockId"":""BLOCK_SELECT@1d207fad"",""fields"":[""DRINKER VARCHAR(100)"",""MAXIMUM INTEGER""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":2,""endLineNum"":5,""endColumnNum"":25,""quoted"":false}},""NS_IDENT@19569ebd"":{""tableId"":""NS_IDENT@19569ebd"",""identifier"":""FQ"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":17,""quoted"":false}}},""corrTables"":[]}
"
"SELECT frequents.drinker, frequents.bar
FROM frequents, 
(SELECT f.drinker, max(f.times_a_week) maximum
 FROM frequents f
 GROUP BY f.drinker) mf
WHERE mf.maximum = frequents.times_a_week
AND frequents.drinker = mf.drinker

UNION

(SELECT nd.name, NULL
FROM (SELECT drinker.name
FROM drinker
WHERE drinker.name NOT IN (SELECT frequents.drinker FROM frequents)) nd)","{""blocks"":{""id"":""BLOCK_SETOP@6443b128"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""opName"":""UNION"",""all"":false,""leftBlockId"":""BLOCK_SELECT@6ad6fa53"",""rightBlockId"":""BLOCK_SELECT@2fe88a09"",""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":14,""endColumnNum"":71,""quoted"":false},""children"":{""BLOCK_SELECT@6ad6fa53"":{""id"":""BLOCK_SELECT@6ad6fa53"",""parentId"":""BLOCK_SETOP@6443b128"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@14fc5d40"",""value"":""NS_IDENT@6124287a.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@47d7bfb3"",""value"":""NS_IDENT@6124287a.BAR"",""pos"":{""lineNum"":1,""columnNum"":27,""endLineNum"":1,""endColumnNum"":39,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@6124287a"",""NS_SELECT@2e380628""],""fromNode"":{""id"":""OP_JOIN@247667dd"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":15,""endLineNum"":2,""endColumnNum"":15,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@2d66530f"",""value"":""NS_IDENT@6124287a"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@488b50ec"",""value"":""BLOCK_SELECT@488b50ec"",""pos"":{""lineNum"":3,""columnNum"":2,""endLineNum"":5,""endColumnNum"":19,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@476ec9d0"",""value"":""AND"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":7,""endColumnNum"":34,""quoted"":false},""children"":[{""id"":""OP_BINARY@61799544"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":41,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1603dc2f"",""value"":""NS_SELECT@2e380628.MAXIMUM"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@398474a2"",""value"":""NS_IDENT@6124287a.times_a_week"",""pos"":{""lineNum"":6,""columnNum"":20,""endLineNum"":6,""endColumnNum"":41,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@6a10b263"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":5,""endLineNum"":7,""endColumnNum"":34,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@78c1a023"",""value"":""NS_IDENT@6124287a.drinker"",""pos"":{""lineNum"":7,""columnNum"":5,""endLineNum"":7,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@70abf9b0"",""value"":""NS_SELECT@2e380628.DRINKER"",""pos"":{""lineNum"":7,""columnNum"":25,""endLineNum"":7,""endColumnNum"":34,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@78c1a023"",""value"":""NS_IDENT@6124287a.drinker"",""pos"":{""lineNum"":7,""columnNum"":5,""endLineNum"":7,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@70abf9b0"",""value"":""NS_SELECT@2e380628.DRINKER"",""pos"":{""lineNum"":7,""columnNum"":25,""endLineNum"":7,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1603dc2f"",""value"":""NS_SELECT@2e380628.MAXIMUM"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@47d7bfb3"",""value"":""NS_IDENT@6124287a.BAR"",""pos"":{""lineNum"":1,""columnNum"":27,""endLineNum"":1,""endColumnNum"":39,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@14fc5d40"",""value"":""NS_IDENT@6124287a.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@398474a2"",""value"":""NS_IDENT@6124287a.times_a_week"",""pos"":{""lineNum"":6,""columnNum"":20,""endLineNum"":6,""endColumnNum"":41,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":7,""endColumnNum"":34,""quoted"":false},""children"":{""BLOCK_SELECT@488b50ec"":{""id"":""BLOCK_SELECT@488b50ec"",""parentId"":""BLOCK_SELECT@6ad6fa53"",""alias"":""MF"",""fields"":[""DRINKER VARCHAR(100)"",""MAXIMUM INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@c81fd12"",""value"":""NS_IDENT@3b6c624.DRINKER"",""pos"":{""lineNum"":3,""columnNum"":9,""endLineNum"":3,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@5754de72"",""value"":""MAX"",""pos"":{""lineNum"":3,""columnNum"":20,""endLineNum"":3,""endColumnNum"":38,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@31ee96f4"",""value"":""NS_IDENT@3b6c624.TIMES_A_WEEK"",""pos"":{""lineNum"":3,""columnNum"":24,""endLineNum"":3,""endColumnNum"":37,""quoted"":false},""children"":[]}],""alias"":""MAXIMUM""}],""fromItemIds"":[""NS_IDENT@3b6c624""],""fromNode"":{""id"":""JOIN_OPERAND@18a645fd"",""value"":""NS_IDENT@3b6c624"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":15,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@7f02251"",""value"":""NS_IDENT@3b6c624.drinker"",""pos"":{""lineNum"":5,""columnNum"":11,""endLineNum"":5,""endColumnNum"":19,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@31ee96f4"",""value"":""NS_IDENT@3b6c624.TIMES_A_WEEK"",""pos"":{""lineNum"":3,""columnNum"":24,""endLineNum"":3,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7f02251"",""value"":""NS_IDENT@3b6c624.drinker"",""pos"":{""lineNum"":5,""columnNum"":11,""endLineNum"":5,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@c81fd12"",""value"":""NS_IDENT@3b6c624.DRINKER"",""pos"":{""lineNum"":3,""columnNum"":9,""endLineNum"":3,""endColumnNum"":17,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":2,""endLineNum"":5,""endColumnNum"":19,""quoted"":false},""children"":{}}}},""BLOCK_SELECT@2fe88a09"":{""id"":""BLOCK_SELECT@2fe88a09"",""parentId"":""BLOCK_SETOP@6443b128"",""fields"":[""NAME VARCHAR(100)"",""EXPR$1 NULL""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@6daf2337"",""value"":""NS_SELECT@50d3bf39.NAME"",""pos"":{""lineNum"":11,""columnNum"":9,""endLineNum"":11,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""LITERAL_KEYWORD@24fabd0f"",""pos"":{""lineNum"":11,""columnNum"":18,""endLineNum"":11,""endColumnNum"":21,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_SELECT@50d3bf39""],""fromNode"":{""id"":""JOIN_OPERAND@1917d90f"",""value"":""BLOCK_SELECT@1917d90f"",""pos"":{""lineNum"":12,""columnNum"":7,""endLineNum"":14,""endColumnNum"":67,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@6daf2337"",""value"":""NS_SELECT@50d3bf39.NAME"",""pos"":{""lineNum"":11,""columnNum"":9,""endLineNum"":11,""endColumnNum"":15,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":11,""columnNum"":2,""endLineNum"":14,""endColumnNum"":71,""quoted"":false},""children"":{""BLOCK_SELECT@1917d90f"":{""id"":""BLOCK_SELECT@1917d90f"",""parentId"":""BLOCK_SELECT@2fe88a09"",""alias"":""ND"",""fields"":[""NAME VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@29852487"",""value"":""NS_IDENT@25a73de1.NAME"",""pos"":{""lineNum"":12,""columnNum"":14,""endLineNum"":12,""endColumnNum"":25,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@25a73de1""],""fromNode"":{""id"":""JOIN_OPERAND@21fff664"",""value"":""NS_IDENT@25a73de1"",""pos"":{""lineNum"":13,""columnNum"":6,""endLineNum"":13,""endColumnNum"":12,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@bdc8014"",""value"":""NOT IN"",""pos"":{""lineNum"":14,""columnNum"":7,""endLineNum"":14,""endColumnNum"":66,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@736f3e9e"",""value"":""NS_IDENT@25a73de1.name"",""pos"":{""lineNum"":14,""columnNum"":7,""endLineNum"":14,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@66bfd864"",""value"":""BLOCK_SELECT@66bfd864"",""pos"":{""lineNum"":14,""columnNum"":28,""endLineNum"":14,""endColumnNum"":66,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@29852487"",""value"":""NS_IDENT@25a73de1.NAME"",""pos"":{""lineNum"":12,""columnNum"":14,""endLineNum"":12,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@736f3e9e"",""value"":""NS_IDENT@25a73de1.name"",""pos"":{""lineNum"":14,""columnNum"":7,""endLineNum"":14,""endColumnNum"":18,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":12,""columnNum"":7,""endLineNum"":14,""endColumnNum"":67,""quoted"":false},""children"":{""BLOCK_SELECT@66bfd864"":{""id"":""BLOCK_SELECT@66bfd864"",""parentId"":""BLOCK_SELECT@1917d90f"",""fields"":[""DRINKER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@79ab34c1"",""value"":""NS_IDENT@26ae880a.DRINKER"",""pos"":{""lineNum"":14,""columnNum"":35,""endLineNum"":14,""endColumnNum"":51,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@26ae880a""],""fromNode"":{""id"":""JOIN_OPERAND@4aac85fa"",""value"":""NS_IDENT@26ae880a"",""pos"":{""lineNum"":14,""columnNum"":58,""endLineNum"":14,""endColumnNum"":66,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@79ab34c1"",""value"":""NS_IDENT@26ae880a.DRINKER"",""pos"":{""lineNum"":14,""columnNum"":35,""endLineNum"":14,""endColumnNum"":51,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":14,""columnNum"":28,""endLineNum"":14,""endColumnNum"":66,""quoted"":false},""children"":{}}}}}}}},""tables"":{""NS_IDENT@3b6c624"":{""tableId"":""NS_IDENT@3b6c624"",""identifier"":""F"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":17,""quoted"":false}},""NS_SELECT@2e380628"":{""tableId"":""NS_SELECT@2e380628"",""identifier"":""MF"",""blockId"":""BLOCK_SELECT@488b50ec"",""fields"":[""DRINKER VARCHAR(100)"",""MAXIMUM INTEGER""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":2,""endLineNum"":5,""endColumnNum"":23,""quoted"":false}},""NS_IDENT@25a73de1"":{""tableId"":""NS_IDENT@25a73de1"",""identifier"":""DRINKER"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":13,""columnNum"":6,""endLineNum"":13,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@6124287a"":{""tableId"":""NS_IDENT@6124287a"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":14,""quoted"":false}},""NS_IDENT@26ae880a"":{""tableId"":""NS_IDENT@26ae880a"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":14,""columnNum"":58,""endLineNum"":14,""endColumnNum"":66,""quoted"":false}},""NS_SELECT@50d3bf39"":{""tableId"":""NS_SELECT@50d3bf39"",""identifier"":""ND"",""blockId"":""BLOCK_SELECT@1917d90f"",""fields"":[""NAME VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":12,""columnNum"":7,""endLineNum"":14,""endColumnNum"":71,""quoted"":false}}},""corrTables"":[]}
"
"select f.drinker, f.bar
from frequents f, 
(select F.drinker, max(F.times_a_week) maximum
from frequents F
group by F.drinker) maxfreqs
where maxfreqs.maximum = f.times_a_week
and f.drinker = maxfreqs.drinker

union

(select nodrinkers.name, null
from (select drinker.name
from drinker
where drinker.name not in (select frequents.drinker from frequents)) nodrinkers)","{""blocks"":{""id"":""BLOCK_SETOP@3f36b447"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""opName"":""UNION"",""all"":false,""leftBlockId"":""BLOCK_SELECT@5d39f2d8"",""rightBlockId"":""BLOCK_SELECT@4f20a5e0"",""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":14,""endColumnNum"":79,""quoted"":false},""children"":{""BLOCK_SELECT@4f20a5e0"":{""id"":""BLOCK_SELECT@4f20a5e0"",""parentId"":""BLOCK_SETOP@3f36b447"",""fields"":[""NAME VARCHAR(100)"",""EXPR$1 NULL""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@6daf2337"",""value"":""NS_SELECT@50d3bf39.NAME"",""pos"":{""lineNum"":11,""columnNum"":9,""endLineNum"":11,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""LITERAL_KEYWORD@24fabd0f"",""pos"":{""lineNum"":11,""columnNum"":26,""endLineNum"":11,""endColumnNum"":29,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_SELECT@50d3bf39""],""fromNode"":{""id"":""JOIN_OPERAND@54da32dc"",""value"":""BLOCK_SELECT@54da32dc"",""pos"":{""lineNum"":12,""columnNum"":7,""endLineNum"":14,""endColumnNum"":67,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@6daf2337"",""value"":""NS_SELECT@50d3bf39.NAME"",""pos"":{""lineNum"":11,""columnNum"":9,""endLineNum"":11,""endColumnNum"":23,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":11,""columnNum"":2,""endLineNum"":14,""endColumnNum"":79,""quoted"":false},""children"":{""BLOCK_SELECT@54da32dc"":{""id"":""BLOCK_SELECT@54da32dc"",""parentId"":""BLOCK_SELECT@4f20a5e0"",""alias"":""NODRINKERS"",""fields"":[""NAME VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@29852487"",""value"":""NS_IDENT@25a73de1.NAME"",""pos"":{""lineNum"":12,""columnNum"":14,""endLineNum"":12,""endColumnNum"":25,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@25a73de1""],""fromNode"":{""id"":""JOIN_OPERAND@4aac85fa"",""value"":""NS_IDENT@25a73de1"",""pos"":{""lineNum"":13,""columnNum"":6,""endLineNum"":13,""endColumnNum"":12,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@bdc8014"",""value"":""NOT IN"",""pos"":{""lineNum"":14,""columnNum"":7,""endLineNum"":14,""endColumnNum"":66,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@736f3e9e"",""value"":""NS_IDENT@25a73de1.name"",""pos"":{""lineNum"":14,""columnNum"":7,""endLineNum"":14,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@1d782abe"",""value"":""BLOCK_SELECT@1d782abe"",""pos"":{""lineNum"":14,""columnNum"":28,""endLineNum"":14,""endColumnNum"":66,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@29852487"",""value"":""NS_IDENT@25a73de1.NAME"",""pos"":{""lineNum"":12,""columnNum"":14,""endLineNum"":12,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@736f3e9e"",""value"":""NS_IDENT@25a73de1.name"",""pos"":{""lineNum"":14,""columnNum"":7,""endLineNum"":14,""endColumnNum"":18,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":12,""columnNum"":7,""endLineNum"":14,""endColumnNum"":67,""quoted"":false},""children"":{""BLOCK_SELECT@1d782abe"":{""id"":""BLOCK_SELECT@1d782abe"",""parentId"":""BLOCK_SELECT@54da32dc"",""fields"":[""DRINKER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@79ab34c1"",""value"":""NS_IDENT@26ae880a.DRINKER"",""pos"":{""lineNum"":14,""columnNum"":35,""endLineNum"":14,""endColumnNum"":51,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@26ae880a""],""fromNode"":{""id"":""JOIN_OPERAND@66bfd864"",""value"":""NS_IDENT@26ae880a"",""pos"":{""lineNum"":14,""columnNum"":58,""endLineNum"":14,""endColumnNum"":66,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@79ab34c1"",""value"":""NS_IDENT@26ae880a.DRINKER"",""pos"":{""lineNum"":14,""columnNum"":35,""endLineNum"":14,""endColumnNum"":51,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":14,""columnNum"":28,""endLineNum"":14,""endColumnNum"":66,""quoted"":false},""children"":{}}}}}},""BLOCK_SELECT@5d39f2d8"":{""id"":""BLOCK_SELECT@5d39f2d8"",""parentId"":""BLOCK_SETOP@3f36b447"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@14fc5d40"",""value"":""NS_IDENT@6124287a.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@47d7bfb3"",""value"":""NS_IDENT@6124287a.BAR"",""pos"":{""lineNum"":1,""columnNum"":19,""endLineNum"":1,""endColumnNum"":23,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@6124287a"",""NS_SELECT@2e380628""],""fromNode"":{""id"":""OP_JOIN@1dab9dd6"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":17,""endLineNum"":2,""endColumnNum"":17,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@2f879bab"",""value"":""NS_IDENT@6124287a"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@1d207fad"",""value"":""BLOCK_SELECT@1d207fad"",""pos"":{""lineNum"":3,""columnNum"":2,""endLineNum"":5,""endColumnNum"":18,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@476ec9d0"",""value"":""AND"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":7,""endColumnNum"":32,""quoted"":false},""children"":[{""id"":""OP_BINARY@61799544"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":39,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1603dc2f"",""value"":""NS_SELECT@2e380628.MAXIMUM"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@398474a2"",""value"":""NS_IDENT@6124287a.times_a_week"",""pos"":{""lineNum"":6,""columnNum"":26,""endLineNum"":6,""endColumnNum"":39,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@6a10b263"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":5,""endLineNum"":7,""endColumnNum"":32,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@78c1a023"",""value"":""NS_IDENT@6124287a.drinker"",""pos"":{""lineNum"":7,""columnNum"":5,""endLineNum"":7,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@70abf9b0"",""value"":""NS_SELECT@2e380628.DRINKER"",""pos"":{""lineNum"":7,""columnNum"":17,""endLineNum"":7,""endColumnNum"":32,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@78c1a023"",""value"":""NS_IDENT@6124287a.drinker"",""pos"":{""lineNum"":7,""columnNum"":5,""endLineNum"":7,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@70abf9b0"",""value"":""NS_SELECT@2e380628.DRINKER"",""pos"":{""lineNum"":7,""columnNum"":17,""endLineNum"":7,""endColumnNum"":32,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1603dc2f"",""value"":""NS_SELECT@2e380628.MAXIMUM"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@47d7bfb3"",""value"":""NS_IDENT@6124287a.BAR"",""pos"":{""lineNum"":1,""columnNum"":19,""endLineNum"":1,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@14fc5d40"",""value"":""NS_IDENT@6124287a.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@398474a2"",""value"":""NS_IDENT@6124287a.times_a_week"",""pos"":{""lineNum"":6,""columnNum"":26,""endLineNum"":6,""endColumnNum"":39,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":7,""endColumnNum"":32,""quoted"":false},""children"":{""BLOCK_SELECT@1d207fad"":{""id"":""BLOCK_SELECT@1d207fad"",""parentId"":""BLOCK_SELECT@5d39f2d8"",""alias"":""MAXFREQS"",""fields"":[""DRINKER VARCHAR(100)"",""MAXIMUM INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@c81fd12"",""value"":""NS_IDENT@3b6c624.DRINKER"",""pos"":{""lineNum"":3,""columnNum"":9,""endLineNum"":3,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@5754de72"",""value"":""MAX"",""pos"":{""lineNum"":3,""columnNum"":20,""endLineNum"":3,""endColumnNum"":38,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@31ee96f4"",""value"":""NS_IDENT@3b6c624.TIMES_A_WEEK"",""pos"":{""lineNum"":3,""columnNum"":24,""endLineNum"":3,""endColumnNum"":37,""quoted"":false},""children"":[]}],""alias"":""MAXIMUM""}],""fromItemIds"":[""NS_IDENT@3b6c624""],""fromNode"":{""id"":""JOIN_OPERAND@72ed9aad"",""value"":""NS_IDENT@3b6c624"",""pos"":{""lineNum"":4,""columnNum"":6,""endLineNum"":4,""endColumnNum"":14,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@7f02251"",""value"":""NS_IDENT@3b6c624.drinker"",""pos"":{""lineNum"":5,""columnNum"":10,""endLineNum"":5,""endColumnNum"":18,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@31ee96f4"",""value"":""NS_IDENT@3b6c624.TIMES_A_WEEK"",""pos"":{""lineNum"":3,""columnNum"":24,""endLineNum"":3,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7f02251"",""value"":""NS_IDENT@3b6c624.drinker"",""pos"":{""lineNum"":5,""columnNum"":10,""endLineNum"":5,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@c81fd12"",""value"":""NS_IDENT@3b6c624.DRINKER"",""pos"":{""lineNum"":3,""columnNum"":9,""endLineNum"":3,""endColumnNum"":17,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":2,""endLineNum"":5,""endColumnNum"":18,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@3b6c624"":{""tableId"":""NS_IDENT@3b6c624"",""identifier"":""F"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":6,""endLineNum"":4,""endColumnNum"":16,""quoted"":false}},""NS_SELECT@2e380628"":{""tableId"":""NS_SELECT@2e380628"",""identifier"":""MAXFREQS"",""blockId"":""BLOCK_SELECT@1d207fad"",""fields"":[""DRINKER VARCHAR(100)"",""MAXIMUM INTEGER""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":2,""endLineNum"":5,""endColumnNum"":28,""quoted"":false}},""NS_IDENT@25a73de1"":{""tableId"":""NS_IDENT@25a73de1"",""identifier"":""DRINKER"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":13,""columnNum"":6,""endLineNum"":13,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@6124287a"":{""tableId"":""NS_IDENT@6124287a"",""identifier"":""F"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":16,""quoted"":false}},""NS_IDENT@26ae880a"":{""tableId"":""NS_IDENT@26ae880a"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":14,""columnNum"":58,""endLineNum"":14,""endColumnNum"":66,""quoted"":false}},""NS_SELECT@50d3bf39"":{""tableId"":""NS_SELECT@50d3bf39"",""identifier"":""NODRINKERS"",""blockId"":""BLOCK_SELECT@54da32dc"",""fields"":[""NAME VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":12,""columnNum"":7,""endLineNum"":14,""endColumnNum"":79,""quoted"":false}}},""corrTables"":[]}
"
"WITH maxFrequents AS(
SELECT frequents.drinker, bar
FROM frequents, (SELECT drinker, max(times_a_week) AS freq
FROM frequents
GROUP BY frequents.drinker) AS maxTimesByDrinker
WHERE frequents.drinker=maxTimesByDrinker.drinker AND times_a_week=freq
)
SELECT drinker.name AS drinker, maxFrequents.bar
FROM drinker LEFT JOIN maxFrequents ON drinker.name=maxFrequents.drinker","{""blocks"":{""id"":""BLOCK_SELECT@1ddd3478"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@652ab8d9"",""value"":""NS_IDENT@31ee96f4.NAME"",""pos"":{""lineNum"":8,""columnNum"":8,""endLineNum"":8,""endColumnNum"":19,""quoted"":false},""children"":[],""alias"":""DRINKER""},{""id"":""COLUMN_LOCAL@250b236d"",""value"":""NS_IDENT@320494b6.BAR"",""pos"":{""lineNum"":8,""columnNum"":33,""endLineNum"":8,""endColumnNum"":48,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@31ee96f4"",""NS_IDENT@320494b6""],""fromNode"":{""id"":""OP_JOIN@f973499"",""value"":""LEFT"",""pos"":{""lineNum"":9,""columnNum"":19,""endLineNum"":9,""endColumnNum"":22,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@4d33940d"",""value"":""NS_IDENT@31ee96f4"",""pos"":{""lineNum"":9,""columnNum"":6,""endLineNum"":9,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@43cf6ea3"",""value"":""NS_IDENT@320494b6"",""pos"":{""lineNum"":9,""columnNum"":24,""endLineNum"":9,""endColumnNum"":35,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@23e44287"",""value"":""="",""pos"":{""lineNum"":9,""columnNum"":40,""endLineNum"":9,""endColumnNum"":72,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@65bb9029"",""value"":""NS_IDENT@31ee96f4.name"",""pos"":{""lineNum"":9,""columnNum"":40,""endLineNum"":9,""endColumnNum"":51,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@49601f82"",""value"":""NS_IDENT@320494b6.DRINKER"",""pos"":{""lineNum"":9,""columnNum"":53,""endLineNum"":9,""endColumnNum"":72,""quoted"":false},""children"":[]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@65bb9029"",""value"":""NS_IDENT@31ee96f4.name"",""pos"":{""lineNum"":9,""columnNum"":40,""endLineNum"":9,""endColumnNum"":51,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@652ab8d9"",""value"":""NS_IDENT@31ee96f4.NAME"",""pos"":{""lineNum"":8,""columnNum"":8,""endLineNum"":8,""endColumnNum"":19,""quoted"":false},""children"":[],""alias"":""DRINKER""},{""id"":""COLUMN_LOCAL@250b236d"",""value"":""NS_IDENT@320494b6.BAR"",""pos"":{""lineNum"":8,""columnNum"":33,""endLineNum"":8,""endColumnNum"":48,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@49601f82"",""value"":""NS_IDENT@320494b6.DRINKER"",""pos"":{""lineNum"":9,""columnNum"":53,""endLineNum"":9,""endColumnNum"":72,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":8,""columnNum"":1,""endLineNum"":9,""endColumnNum"":72,""quoted"":false},""children"":{}},""tables"":{""NS_IDENT@320494b6"":{""tableId"":""NS_IDENT@320494b6"",""identifier"":""MAXFREQUENTS"",""dbTableName"":""MAXFREQUENTS"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":9,""columnNum"":24,""endLineNum"":9,""endColumnNum"":35,""quoted"":false}},""NS_IDENT@71870da7"":{""tableId"":""NS_IDENT@71870da7"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":6,""endLineNum"":3,""endColumnNum"":14,""quoted"":false}},""NS_SELECT@4e25147a"":{""tableId"":""NS_SELECT@4e25147a"",""identifier"":""MAXTIMESBYDRINKER"",""blockId"":""BLOCK_SELECT@201aa8c1"",""fields"":[""DRINKER VARCHAR(100)"",""FREQ INTEGER""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":5,""endColumnNum"":48,""quoted"":false}},""NS_IDENT@6b68cb27"":{""tableId"":""NS_IDENT@6b68cb27"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":6,""endLineNum"":4,""endColumnNum"":14,""quoted"":false}},""NS_IDENT@31ee96f4"":{""tableId"":""NS_IDENT@31ee96f4"",""identifier"":""DRINKER"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":9,""columnNum"":6,""endLineNum"":9,""endColumnNum"":12,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@5c20ffa8"",""alias"":""MAXFREQUENTS"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@19569ebd"",""value"":""NS_IDENT@71870da7.DRINKER"",""pos"":{""lineNum"":2,""columnNum"":8,""endLineNum"":2,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6e1f8469"",""value"":""NS_IDENT@71870da7.BAR"",""pos"":{""lineNum"":2,""columnNum"":27,""endLineNum"":2,""endColumnNum"":29,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@71870da7"",""NS_SELECT@4e25147a""],""fromNode"":{""id"":""OP_JOIN@6bcbf05b"",""value"":""COMMA"",""pos"":{""lineNum"":3,""columnNum"":15,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@37a64f9d"",""value"":""NS_IDENT@71870da7"",""pos"":{""lineNum"":3,""columnNum"":6,""endLineNum"":3,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@201aa8c1"",""value"":""BLOCK_SELECT@201aa8c1"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":5,""endColumnNum"":26,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@543e593"",""value"":""AND"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":71,""quoted"":false},""children"":[{""id"":""OP_BINARY@2c16fadb"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":49,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@72fe8a4f"",""value"":""NS_IDENT@71870da7.drinker"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@43effd89"",""value"":""NS_SELECT@4e25147a.DRINKER"",""pos"":{""lineNum"":6,""columnNum"":25,""endLineNum"":6,""endColumnNum"":49,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@1e9804b9"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":55,""endLineNum"":6,""endColumnNum"":71,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@248deced"",""value"":""NS_IDENT@71870da7.times_a_week"",""pos"":{""lineNum"":6,""columnNum"":55,""endLineNum"":6,""endColumnNum"":66,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2227a6c1"",""value"":""NS_SELECT@4e25147a.FREQ"",""pos"":{""lineNum"":6,""columnNum"":68,""endLineNum"":6,""endColumnNum"":71,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@6e1f8469"",""value"":""NS_IDENT@71870da7.BAR"",""pos"":{""lineNum"":2,""columnNum"":27,""endLineNum"":2,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@72fe8a4f"",""value"":""NS_IDENT@71870da7.drinker"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@248deced"",""value"":""NS_IDENT@71870da7.times_a_week"",""pos"":{""lineNum"":6,""columnNum"":55,""endLineNum"":6,""endColumnNum"":66,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2227a6c1"",""value"":""NS_SELECT@4e25147a.FREQ"",""pos"":{""lineNum"":6,""columnNum"":68,""endLineNum"":6,""endColumnNum"":71,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@43effd89"",""value"":""NS_SELECT@4e25147a.DRINKER"",""pos"":{""lineNum"":6,""columnNum"":25,""endLineNum"":6,""endColumnNum"":49,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@19569ebd"",""value"":""NS_IDENT@71870da7.DRINKER"",""pos"":{""lineNum"":2,""columnNum"":8,""endLineNum"":2,""endColumnNum"":24,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":1,""endLineNum"":6,""endColumnNum"":71,""quoted"":false},""children"":{""BLOCK_SELECT@201aa8c1"":{""id"":""BLOCK_SELECT@201aa8c1"",""parentId"":""BLOCK_SELECT@5c20ffa8"",""alias"":""MAXTIMESBYDRINKER"",""fields"":[""DRINKER VARCHAR(100)"",""FREQ INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@56303475"",""value"":""NS_IDENT@6b68cb27.DRINKER"",""pos"":{""lineNum"":3,""columnNum"":25,""endLineNum"":3,""endColumnNum"":31,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@1dcca8d3"",""value"":""MAX"",""pos"":{""lineNum"":3,""columnNum"":34,""endLineNum"":3,""endColumnNum"":50,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5631962"",""value"":""NS_IDENT@6b68cb27.TIMES_A_WEEK"",""pos"":{""lineNum"":3,""columnNum"":38,""endLineNum"":3,""endColumnNum"":49,""quoted"":false},""children"":[]}],""alias"":""FREQ""}],""fromItemIds"":[""NS_IDENT@6b68cb27""],""fromNode"":{""id"":""JOIN_OPERAND@5d58c727"",""value"":""NS_IDENT@6b68cb27"",""pos"":{""lineNum"":4,""columnNum"":6,""endLineNum"":4,""endColumnNum"":14,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@1bbae752"",""value"":""NS_IDENT@6b68cb27.drinker"",""pos"":{""lineNum"":5,""columnNum"":10,""endLineNum"":5,""endColumnNum"":26,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@5631962"",""value"":""NS_IDENT@6b68cb27.TIMES_A_WEEK"",""pos"":{""lineNum"":3,""columnNum"":38,""endLineNum"":3,""endColumnNum"":49,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@56303475"",""value"":""NS_IDENT@6b68cb27.DRINKER"",""pos"":{""lineNum"":3,""columnNum"":25,""endLineNum"":3,""endColumnNum"":31,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1bbae752"",""value"":""NS_IDENT@6b68cb27.drinker"",""pos"":{""lineNum"":5,""columnNum"":10,""endLineNum"":5,""endColumnNum"":26,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":5,""endColumnNum"":26,""quoted"":false},""children"":{}}}}]}
"
"select fmax.name, f0.bar
from 
    (select f.drinker as name, f.bar, f.times_a_week
    from frequents as f) as f0 
right outer join 
    (select f2.name, max(f2.times_a_week)  
    from (select d.name, f.times_a_week
        from frequents f
        right outer join 
        drinker d 
        on f.drinker = d.name) as f2 
    group by f2.name
    ) as fmax 
on f0.name = fmax.name and f0.times_a_week = fmax.max;
","{""failed"":true,""errorMsg"":""Parsing error at line 14, column 50. Query syntax may be incorrect""}
"
"SELECT name, bar
FROM (SELECT name, MAX(times_a_week)
FROM drinker LEFT OUTER JOIN frequents ON drinker.name = frequents.drinker
GROUP BY name) as A LEFT JOIN
frequents ON A.name=frequents.drinker
WHERE A.max=frequents.times_a_week OR frequents.bar IS NULL;","{""failed"":true,""errorMsg"":""Parsing error at line 6, column 8. Query syntax may be incorrect""}
"
"WITH maxweek as (select drinker,MAX(times_a_week) as times_a_week
from frequents
group by drinker), drinker1 as (select name as drinker from drinker), drinkerbar as (select maxweek.drinker, frequents.bar
from maxweek join frequents ON frequents.drinker = maxweek.drinker and frequents.times_a_week = maxweek.times_a_week)
SELECT drinker1.drinker, drinkerbar.bar
FROM drinker1
LEFT JOIN drinkerbar
ON drinkerbar.drinker = drinker1.drinker

","{""blocks"":{""id"":""BLOCK_SELECT@1c025cb"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@60e5272"",""value"":""NS_IDENT@770b3be0.DRINKER"",""pos"":{""lineNum"":5,""columnNum"":8,""endLineNum"":5,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7d755813"",""value"":""NS_IDENT@1eb6e1c.BAR"",""pos"":{""lineNum"":5,""columnNum"":26,""endLineNum"":5,""endColumnNum"":39,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@770b3be0"",""NS_IDENT@1eb6e1c""],""fromNode"":{""id"":""OP_JOIN@50825a02"",""value"":""LEFT"",""pos"":{""lineNum"":7,""columnNum"":6,""endLineNum"":7,""endColumnNum"":9,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@68809cc7"",""value"":""NS_IDENT@770b3be0"",""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@703feacd"",""value"":""NS_IDENT@1eb6e1c"",""pos"":{""lineNum"":7,""columnNum"":11,""endLineNum"":7,""endColumnNum"":20,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@432034a"",""value"":""="",""pos"":{""lineNum"":8,""columnNum"":4,""endLineNum"":8,""endColumnNum"":40,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@61f3fbb8"",""value"":""NS_IDENT@1eb6e1c.DRINKER"",""pos"":{""lineNum"":8,""columnNum"":4,""endLineNum"":8,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7551da2a"",""value"":""NS_IDENT@770b3be0.DRINKER"",""pos"":{""lineNum"":8,""columnNum"":25,""endLineNum"":8,""endColumnNum"":40,""quoted"":false},""children"":[]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@7d755813"",""value"":""NS_IDENT@1eb6e1c.BAR"",""pos"":{""lineNum"":5,""columnNum"":26,""endLineNum"":5,""endColumnNum"":39,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@61f3fbb8"",""value"":""NS_IDENT@1eb6e1c.DRINKER"",""pos"":{""lineNum"":8,""columnNum"":4,""endLineNum"":8,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7551da2a"",""value"":""NS_IDENT@770b3be0.DRINKER"",""pos"":{""lineNum"":8,""columnNum"":25,""endLineNum"":8,""endColumnNum"":40,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@60e5272"",""value"":""NS_IDENT@770b3be0.DRINKER"",""pos"":{""lineNum"":5,""columnNum"":8,""endLineNum"":5,""endColumnNum"":23,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":5,""columnNum"":1,""endLineNum"":8,""endColumnNum"":40,""quoted"":false},""children"":{}},""tables"":{""NS_IDENT@770b3be0"":{""tableId"":""NS_IDENT@770b3be0"",""identifier"":""DRINKER1"",""dbTableName"":""DRINKER1"",""fields"":[""DRINKER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":13,""quoted"":false}},""NS_IDENT@1eaf1e62"":{""tableId"":""NS_IDENT@1eaf1e62"",""identifier"":""MAXWEEK"",""dbTableName"":""MAXWEEK"",""fields"":[""DRINKER VARCHAR(100)"",""TIMES_A_WEEK INTEGER""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":6,""endLineNum"":4,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@1eb6e1c"":{""tableId"":""NS_IDENT@1eb6e1c"",""identifier"":""DRINKERBAR"",""dbTableName"":""DRINKERBAR"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":11,""endLineNum"":7,""endColumnNum"":20,""quoted"":false}},""NS_IDENT@6e1f8469"":{""tableId"":""NS_IDENT@6e1f8469"",""identifier"":""DRINKER"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":61,""endLineNum"":3,""endColumnNum"":67,""quoted"":false}},""NS_IDENT@4e25147a"":{""tableId"":""NS_IDENT@4e25147a"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":14,""quoted"":false}},""NS_IDENT@c81fd12"":{""tableId"":""NS_IDENT@c81fd12"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":19,""endLineNum"":4,""endColumnNum"":27,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@7fedfe27"",""alias"":""MAXWEEK"",""fields"":[""DRINKER VARCHAR(100)"",""TIMES_A_WEEK INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@1dcca8d3"",""value"":""NS_IDENT@4e25147a.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":25,""endLineNum"":1,""endColumnNum"":31,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@52a70627"",""value"":""MAX"",""pos"":{""lineNum"":1,""columnNum"":33,""endLineNum"":1,""endColumnNum"":49,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@6124287a"",""value"":""NS_IDENT@4e25147a.TIMES_A_WEEK"",""pos"":{""lineNum"":1,""columnNum"":37,""endLineNum"":1,""endColumnNum"":48,""quoted"":false},""children"":[]}],""alias"":""TIMES_A_WEEK""}],""fromItemIds"":[""NS_IDENT@4e25147a""],""fromNode"":{""id"":""JOIN_OPERAND@488b50ec"",""value"":""NS_IDENT@4e25147a"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":14,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@383790cf"",""value"":""NS_IDENT@4e25147a.drinker"",""pos"":{""lineNum"":3,""columnNum"":10,""endLineNum"":3,""endColumnNum"":16,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@1dcca8d3"",""value"":""NS_IDENT@4e25147a.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":25,""endLineNum"":1,""endColumnNum"":31,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6124287a"",""value"":""NS_IDENT@4e25147a.TIMES_A_WEEK"",""pos"":{""lineNum"":1,""columnNum"":37,""endLineNum"":1,""endColumnNum"":48,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@383790cf"",""value"":""NS_IDENT@4e25147a.drinker"",""pos"":{""lineNum"":3,""columnNum"":10,""endLineNum"":3,""endColumnNum"":16,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":18,""endLineNum"":3,""endColumnNum"":16,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@4aac85fa"",""alias"":""DRINKER1"",""fields"":[""DRINKER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@2e380628"",""value"":""NS_IDENT@6e1f8469.NAME"",""pos"":{""lineNum"":3,""columnNum"":40,""endLineNum"":3,""endColumnNum"":43,""quoted"":false},""children"":[],""alias"":""DRINKER""}],""fromItemIds"":[""NS_IDENT@6e1f8469""],""fromNode"":{""id"":""JOIN_OPERAND@21fff664"",""value"":""NS_IDENT@6e1f8469"",""pos"":{""lineNum"":3,""columnNum"":61,""endLineNum"":3,""endColumnNum"":67,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@2e380628"",""value"":""NS_IDENT@6e1f8469.NAME"",""pos"":{""lineNum"":3,""columnNum"":40,""endLineNum"":3,""endColumnNum"":43,""quoted"":false},""children"":[],""alias"":""DRINKER""}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":33,""endLineNum"":3,""endColumnNum"":67,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@5486887b"",""alias"":""DRINKERBAR"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@1bfe3203"",""value"":""NS_IDENT@1eaf1e62.DRINKER"",""pos"":{""lineNum"":3,""columnNum"":93,""endLineNum"":3,""endColumnNum"":107,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5754de72"",""value"":""NS_IDENT@c81fd12.BAR"",""pos"":{""lineNum"":3,""columnNum"":110,""endLineNum"":3,""endColumnNum"":122,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@1eaf1e62"",""NS_IDENT@c81fd12""],""fromNode"":{""id"":""OP_JOIN@783ec989"",""value"":""INNER"",""pos"":{""lineNum"":4,""columnNum"":14,""endLineNum"":4,""endColumnNum"":17,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@1ddd3478"",""value"":""NS_IDENT@1eaf1e62"",""pos"":{""lineNum"":4,""columnNum"":6,""endLineNum"":4,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@f973499"",""value"":""NS_IDENT@c81fd12"",""pos"":{""lineNum"":4,""columnNum"":19,""endLineNum"":4,""endColumnNum"":27,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@64138b0c"",""value"":""AND"",""pos"":{""lineNum"":4,""columnNum"":32,""endLineNum"":4,""endColumnNum"":116,""quoted"":false},""children"":[{""id"":""OP_BINARY@7fab4be7"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":32,""endLineNum"":4,""endColumnNum"":66,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@15fa55a6"",""value"":""NS_IDENT@c81fd12.drinker"",""pos"":{""lineNum"":4,""columnNum"":32,""endLineNum"":4,""endColumnNum"":48,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_IDENT@1eaf1e62.DRINKER"",""pos"":{""lineNum"":4,""columnNum"":52,""endLineNum"":4,""endColumnNum"":66,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@41c204a0"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":72,""endLineNum"":4,""endColumnNum"":116,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@a64e035"",""value"":""NS_IDENT@c81fd12.times_a_week"",""pos"":{""lineNum"":4,""columnNum"":72,""endLineNum"":4,""endColumnNum"":93,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4d74c3ba"",""value"":""NS_IDENT@1eaf1e62.TIMES_A_WEEK"",""pos"":{""lineNum"":4,""columnNum"":97,""endLineNum"":4,""endColumnNum"":116,""quoted"":false},""children"":[]}]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@15fa55a6"",""value"":""NS_IDENT@c81fd12.drinker"",""pos"":{""lineNum"":4,""columnNum"":32,""endLineNum"":4,""endColumnNum"":48,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4d74c3ba"",""value"":""NS_IDENT@1eaf1e62.TIMES_A_WEEK"",""pos"":{""lineNum"":4,""columnNum"":97,""endLineNum"":4,""endColumnNum"":116,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1bfe3203"",""value"":""NS_IDENT@1eaf1e62.DRINKER"",""pos"":{""lineNum"":3,""columnNum"":93,""endLineNum"":3,""endColumnNum"":107,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5754de72"",""value"":""NS_IDENT@c81fd12.BAR"",""pos"":{""lineNum"":3,""columnNum"":110,""endLineNum"":3,""endColumnNum"":122,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_IDENT@1eaf1e62.DRINKER"",""pos"":{""lineNum"":4,""columnNum"":52,""endLineNum"":4,""endColumnNum"":66,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@a64e035"",""value"":""NS_IDENT@c81fd12.times_a_week"",""pos"":{""lineNum"":4,""columnNum"":72,""endLineNum"":4,""endColumnNum"":93,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":86,""endLineNum"":4,""endColumnNum"":116,""quoted"":false},""children"":{}}]}
"
"with drinkfreq as (select *
from frequents as f1 right join drinker as d1
on f1.drinker = d1.name),

maxfreq as(
select name, max(times_a_week) as max_times
from drinkfreq
group by name)

select maxfreq.name, f2.bar
from maxfreq left join frequents as f2
on maxfreq.max_times=f2.times_a_week and maxfreq.name=f2.drinker","{""blocks"":{""id"":""BLOCK_SELECT@43cf6ea3"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@652ab8d9"",""value"":""NS_IDENT@63ec445c.NAME"",""pos"":{""lineNum"":10,""columnNum"":8,""endLineNum"":10,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7a344b65"",""value"":""NS_IDENT@3104351d.BAR"",""pos"":{""lineNum"":10,""columnNum"":22,""endLineNum"":10,""endColumnNum"":27,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@63ec445c"",""NS_IDENT@3104351d""],""fromNode"":{""id"":""OP_JOIN@37c5fc56"",""value"":""LEFT"",""pos"":{""lineNum"":11,""columnNum"":19,""endLineNum"":11,""endColumnNum"":22,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@1c025cb"",""value"":""NS_IDENT@63ec445c"",""pos"":{""lineNum"":11,""columnNum"":6,""endLineNum"":11,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@50825a02"",""value"":""NS_IDENT@3104351d"",""pos"":{""lineNum"":11,""columnNum"":24,""endLineNum"":11,""endColumnNum"":32,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@320494b6"",""value"":""AND"",""pos"":{""lineNum"":12,""columnNum"":4,""endLineNum"":12,""endColumnNum"":64,""quoted"":false},""children"":[{""id"":""OP_BINARY@c81fd12"",""value"":""="",""pos"":{""lineNum"":12,""columnNum"":4,""endLineNum"":12,""endColumnNum"":36,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@3b6c624"",""value"":""NS_IDENT@63ec445c.MAX_TIMES"",""pos"":{""lineNum"":12,""columnNum"":4,""endLineNum"":12,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1eaf1e62"",""value"":""NS_IDENT@3104351d.times_a_week"",""pos"":{""lineNum"":12,""columnNum"":22,""endLineNum"":12,""endColumnNum"":36,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@31ee96f4"",""value"":""="",""pos"":{""lineNum"":12,""columnNum"":42,""endLineNum"":12,""endColumnNum"":64,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@62e6a3ec"",""value"":""NS_IDENT@63ec445c.NAME"",""pos"":{""lineNum"":12,""columnNum"":42,""endLineNum"":12,""endColumnNum"":53,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5754de72"",""value"":""NS_IDENT@3104351d.drinker"",""pos"":{""lineNum"":12,""columnNum"":55,""endLineNum"":12,""endColumnNum"":64,""quoted"":false},""children"":[]}]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@7a344b65"",""value"":""NS_IDENT@3104351d.BAR"",""pos"":{""lineNum"":10,""columnNum"":22,""endLineNum"":10,""endColumnNum"":27,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5754de72"",""value"":""NS_IDENT@3104351d.drinker"",""pos"":{""lineNum"":12,""columnNum"":55,""endLineNum"":12,""endColumnNum"":64,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3b6c624"",""value"":""NS_IDENT@63ec445c.MAX_TIMES"",""pos"":{""lineNum"":12,""columnNum"":4,""endLineNum"":12,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@62e6a3ec"",""value"":""NS_IDENT@63ec445c.NAME"",""pos"":{""lineNum"":12,""columnNum"":42,""endLineNum"":12,""endColumnNum"":53,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1eaf1e62"",""value"":""NS_IDENT@3104351d.times_a_week"",""pos"":{""lineNum"":12,""columnNum"":22,""endLineNum"":12,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@652ab8d9"",""value"":""NS_IDENT@63ec445c.NAME"",""pos"":{""lineNum"":10,""columnNum"":8,""endLineNum"":10,""endColumnNum"":19,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":10,""columnNum"":1,""endLineNum"":12,""endColumnNum"":64,""quoted"":false},""children"":{}},""tables"":{""NS_IDENT@17d2ed1b"":{""tableId"":""NS_IDENT@17d2ed1b"",""identifier"":""DRINKFREQ"",""dbTableName"":""DRINKFREQ"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER"",""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":6,""endLineNum"":7,""endColumnNum"":14,""quoted"":false}},""NS_IDENT@46d8f407"":{""tableId"":""NS_IDENT@46d8f407"",""identifier"":""F1"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":20,""quoted"":false}},""NS_IDENT@3104351d"":{""tableId"":""NS_IDENT@3104351d"",""identifier"":""F2"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":11,""columnNum"":24,""endLineNum"":11,""endColumnNum"":38,""quoted"":false}},""NS_IDENT@7bb004b8"":{""tableId"":""NS_IDENT@7bb004b8"",""identifier"":""D1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":33,""endLineNum"":2,""endColumnNum"":45,""quoted"":false}},""NS_IDENT@63ec445c"":{""tableId"":""NS_IDENT@63ec445c"",""identifier"":""MAXFREQ"",""dbTableName"":""MAXFREQ"",""fields"":[""NAME VARCHAR(100)"",""MAX_TIMES INTEGER""],""cursor"":[0],""pos"":{""lineNum"":11,""columnNum"":6,""endLineNum"":11,""endColumnNum"":12,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@7fedfe27"",""alias"":""DRINKFREQ"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER"",""name VARCHAR(100)"",""address VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@652ce654"",""value"":""*"",""pos"":{""lineNum"":1,""columnNum"":27,""endLineNum"":1,""endColumnNum"":27,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@46d8f407"",""NS_IDENT@7bb004b8""],""fromNode"":{""id"":""OP_JOIN@2d66530f"",""value"":""RIGHT"",""pos"":{""lineNum"":2,""columnNum"":28,""endLineNum"":2,""endColumnNum"":31,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@1869f114"",""value"":""NS_IDENT@46d8f407"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@6872f9c8"",""value"":""NS_IDENT@7bb004b8"",""pos"":{""lineNum"":2,""columnNum"":33,""endLineNum"":2,""endColumnNum"":39,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@30331109"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":4,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@ccd1bc3"",""value"":""NS_IDENT@46d8f407.drinker"",""pos"":{""lineNum"":3,""columnNum"":4,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@25d3cfc8"",""value"":""NS_IDENT@7bb004b8.name"",""pos"":{""lineNum"":3,""columnNum"":17,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@ccd1bc3"",""value"":""NS_IDENT@46d8f407.drinker"",""pos"":{""lineNum"":3,""columnNum"":4,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@25d3cfc8"",""value"":""NS_IDENT@7bb004b8.name"",""pos"":{""lineNum"":3,""columnNum"":17,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":20,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@1d782abe"",""alias"":""MAXFREQ"",""fields"":[""NAME VARCHAR(100)"",""MAX_TIMES INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@185f7840"",""value"":""NS_IDENT@17d2ed1b.NAME"",""pos"":{""lineNum"":6,""columnNum"":8,""endLineNum"":6,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@7e7f0f0a"",""value"":""MAX"",""pos"":{""lineNum"":6,""columnNum"":14,""endLineNum"":6,""endColumnNum"":30,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7ec58feb"",""value"":""NS_IDENT@17d2ed1b.TIMES_A_WEEK"",""pos"":{""lineNum"":6,""columnNum"":18,""endLineNum"":6,""endColumnNum"":29,""quoted"":false},""children"":[]}],""alias"":""MAX_TIMES""}],""fromItemIds"":[""NS_IDENT@17d2ed1b""],""fromNode"":{""id"":""JOIN_OPERAND@66bfd864"",""value"":""NS_IDENT@17d2ed1b"",""pos"":{""lineNum"":7,""columnNum"":6,""endLineNum"":7,""endColumnNum"":14,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@43effd89"",""value"":""NS_IDENT@17d2ed1b.name"",""pos"":{""lineNum"":8,""columnNum"":10,""endLineNum"":8,""endColumnNum"":13,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@7ec58feb"",""value"":""NS_IDENT@17d2ed1b.TIMES_A_WEEK"",""pos"":{""lineNum"":6,""columnNum"":18,""endLineNum"":6,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@43effd89"",""value"":""NS_IDENT@17d2ed1b.name"",""pos"":{""lineNum"":8,""columnNum"":10,""endLineNum"":8,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@185f7840"",""value"":""NS_IDENT@17d2ed1b.NAME"",""pos"":{""lineNum"":6,""columnNum"":8,""endLineNum"":6,""endColumnNum"":11,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":6,""columnNum"":1,""endLineNum"":8,""endColumnNum"":13,""quoted"":false},""children"":{}}]}
"
"WITH most AS (SELECT f1.drinker, f1.bar
			  FROM frequents f1
			  WHERE times_a_week = (SELECT MAX(times_a_week)
						  			FROM frequents f2
						  			WHERE f1.drinker = f2.drinker))
SELECT d.name, m.bar
FROM most m RIGHT OUTER JOIN drinker d ON m.drinker = d.name;","{""blocks"":{""id"":""BLOCK_SELECT@1917d90f"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@985696"",""value"":""NS_IDENT@7c455e96.NAME"",""pos"":{""lineNum"":6,""columnNum"":8,""endLineNum"":6,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1f443fae"",""value"":""NS_IDENT@1f1cae23.BAR"",""pos"":{""lineNum"":6,""columnNum"":16,""endLineNum"":6,""endColumnNum"":20,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@1f1cae23"",""NS_IDENT@7c455e96""],""fromNode"":{""id"":""OP_JOIN@6079cf5"",""value"":""RIGHT"",""pos"":{""lineNum"":7,""columnNum"":25,""endLineNum"":7,""endColumnNum"":28,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@1e6308a9"",""value"":""NS_IDENT@1f1cae23"",""pos"":{""lineNum"":7,""columnNum"":6,""endLineNum"":7,""endColumnNum"":9,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@30cecdca"",""value"":""NS_IDENT@7c455e96"",""pos"":{""lineNum"":7,""columnNum"":30,""endLineNum"":7,""endColumnNum"":36,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@4f186450"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":43,""endLineNum"":7,""endColumnNum"":60,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@f8f56b9"",""value"":""NS_IDENT@1f1cae23.DRINKER"",""pos"":{""lineNum"":7,""columnNum"":43,""endLineNum"":7,""endColumnNum"":51,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@15fa55a6"",""value"":""NS_IDENT@7c455e96.name"",""pos"":{""lineNum"":7,""columnNum"":55,""endLineNum"":7,""endColumnNum"":60,""quoted"":false},""children"":[]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@f8f56b9"",""value"":""NS_IDENT@1f1cae23.DRINKER"",""pos"":{""lineNum"":7,""columnNum"":43,""endLineNum"":7,""endColumnNum"":51,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@985696"",""value"":""NS_IDENT@7c455e96.NAME"",""pos"":{""lineNum"":6,""columnNum"":8,""endLineNum"":6,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1f443fae"",""value"":""NS_IDENT@1f1cae23.BAR"",""pos"":{""lineNum"":6,""columnNum"":16,""endLineNum"":6,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@15fa55a6"",""value"":""NS_IDENT@7c455e96.name"",""pos"":{""lineNum"":7,""columnNum"":55,""endLineNum"":7,""endColumnNum"":60,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":6,""columnNum"":1,""endLineNum"":7,""endColumnNum"":60,""quoted"":false},""children"":{}},""tables"":{""NS_IDENT@7c455e96"":{""tableId"":""NS_IDENT@7c455e96"",""identifier"":""D"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":30,""endLineNum"":7,""endColumnNum"":38,""quoted"":false}},""NS_IDENT@61f3fbb8"":{""tableId"":""NS_IDENT@61f3fbb8"",""identifier"":""F1"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":11,""endLineNum"":2,""endColumnNum"":22,""quoted"":false}},""NS_IDENT@60dd3c23"":{""tableId"":""NS_IDENT@60dd3c23"",""identifier"":""F2"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":17,""endLineNum"":4,""endColumnNum"":28,""quoted"":false}},""NS_IDENT@1f1cae23"":{""tableId"":""NS_IDENT@1f1cae23"",""identifier"":""M"",""dbTableName"":""MOST"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":6,""endLineNum"":7,""endColumnNum"":11,""quoted"":false}}},""corrTables"":[""NS_IDENT@61f3fbb8""],""withBlocks"":[{""id"":""BLOCK_SELECT@7fedfe27"",""alias"":""MOST"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@7d755813"",""value"":""NS_IDENT@61f3fbb8.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":22,""endLineNum"":1,""endColumnNum"":31,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@63da207f"",""value"":""NS_IDENT@61f3fbb8.BAR"",""pos"":{""lineNum"":1,""columnNum"":34,""endLineNum"":1,""endColumnNum"":39,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@61f3fbb8""],""fromNode"":{""id"":""JOIN_OPERAND@54da32dc"",""value"":""NS_IDENT@61f3fbb8"",""pos"":{""lineNum"":2,""columnNum"":11,""endLineNum"":2,""endColumnNum"":19,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@27b71f50"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":12,""endLineNum"":5,""endColumnNum"":40,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@53692008"",""value"":""NS_IDENT@61f3fbb8.times_a_week"",""pos"":{""lineNum"":3,""columnNum"":12,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT_SCALAR@29fc1a2b"",""value"":""BLOCK_SELECT@56ccd751"",""pos"":{""lineNum"":3,""columnNum"":28,""endLineNum"":5,""endColumnNum"":40,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@53692008"",""value"":""NS_IDENT@61f3fbb8.times_a_week"",""pos"":{""lineNum"":3,""columnNum"":12,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@63da207f"",""value"":""NS_IDENT@61f3fbb8.BAR"",""pos"":{""lineNum"":1,""columnNum"":34,""endLineNum"":1,""endColumnNum"":39,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7d755813"",""value"":""NS_IDENT@61f3fbb8.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":22,""endLineNum"":1,""endColumnNum"":31,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@61f3fbb8.drinker""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":15,""endLineNum"":5,""endColumnNum"":41,""quoted"":false},""children"":{""BLOCK_SELECT@56ccd751"":{""id"":""BLOCK_SELECT@56ccd751"",""parentId"":""BLOCK_SELECT@7fedfe27"",""fields"":[""EXPR$0 INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""OP_AGG_FUNC@6c37bd27"",""value"":""MAX"",""pos"":{""lineNum"":3,""columnNum"":35,""endLineNum"":3,""endColumnNum"":51,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@25d3cfc8"",""value"":""NS_IDENT@60dd3c23.TIMES_A_WEEK"",""pos"":{""lineNum"":3,""columnNum"":39,""endLineNum"":3,""endColumnNum"":50,""quoted"":false},""children"":[]}]}],""fromItemIds"":[""NS_IDENT@60dd3c23""],""fromNode"":{""id"":""JOIN_OPERAND@59712875"",""value"":""NS_IDENT@60dd3c23"",""pos"":{""lineNum"":4,""columnNum"":17,""endLineNum"":4,""endColumnNum"":25,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@15923407"",""value"":""="",""pos"":{""lineNum"":5,""columnNum"":18,""endLineNum"":5,""endColumnNum"":40,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@40ee0a22"",""value"":""NS_IDENT@61f3fbb8.drinker"",""pos"":{""lineNum"":5,""columnNum"":18,""endLineNum"":5,""endColumnNum"":27,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7bde1f3a"",""value"":""NS_IDENT@60dd3c23.drinker"",""pos"":{""lineNum"":5,""columnNum"":31,""endLineNum"":5,""endColumnNum"":40,""quoted"":false},""children"":[]}]},""isAggregate"":true,""identifiers"":[{""id"":""COLUMN_LOCAL@7bde1f3a"",""value"":""NS_IDENT@60dd3c23.drinker"",""pos"":{""lineNum"":5,""columnNum"":31,""endLineNum"":5,""endColumnNum"":40,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@25d3cfc8"",""value"":""NS_IDENT@60dd3c23.TIMES_A_WEEK"",""pos"":{""lineNum"":3,""columnNum"":39,""endLineNum"":3,""endColumnNum"":50,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@40ee0a22"",""value"":""NS_IDENT@61f3fbb8.drinker"",""pos"":{""lineNum"":5,""columnNum"":18,""endLineNum"":5,""endColumnNum"":27,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@61f3fbb8""],""corrCtxIds"":[""BLOCK_SELECT@7fedfe27""],""pos"":{""lineNum"":3,""columnNum"":28,""endLineNum"":5,""endColumnNum"":40,""quoted"":false},""children"":{}}}}]}
"
"select A.name, B.bar
from drinker as A left outer join frequents as B
ON A.name = B.drinker and B.times_a_week >= ALL
(select times_a_week from frequents where drinker = A.name)","{""blocks"":{""id"":""BLOCK_SELECT@40021799"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@2bfbffb2"",""value"":""NS_IDENT@6f667ad1.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@151335cb"",""value"":""NS_IDENT@77a281fc.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@6f667ad1"",""NS_IDENT@77a281fc""],""fromNode"":{""id"":""OP_JOIN@67a056f1"",""value"":""LEFT"",""pos"":{""lineNum"":2,""columnNum"":30,""endLineNum"":2,""endColumnNum"":33,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@7fedfe27"",""value"":""NS_IDENT@6f667ad1"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@2d66530f"",""value"":""NS_IDENT@77a281fc"",""pos"":{""lineNum"":2,""columnNum"":35,""endLineNum"":2,""endColumnNum"":43,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@4c98a6d5"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":4,""endLineNum"":4,""endColumnNum"":58,""quoted"":false},""children"":[{""id"":""OP_BINARY@6f952d6c"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":4,""endLineNum"":3,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5b022357"",""value"":""NS_IDENT@6f667ad1.name"",""pos"":{""lineNum"":3,""columnNum"":4,""endLineNum"":3,""endColumnNum"":9,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4784013e"",""value"":""NS_IDENT@77a281fc.drinker"",""pos"":{""lineNum"":3,""columnNum"":13,""endLineNum"":3,""endColumnNum"":21,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@aa004a0"",""value"":"">= ALL"",""pos"":{""lineNum"":3,""columnNum"":27,""endLineNum"":4,""endColumnNum"":58,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@6d4a65c6"",""value"":""NS_IDENT@77a281fc.times_a_week"",""pos"":{""lineNum"":3,""columnNum"":27,""endLineNum"":3,""endColumnNum"":40,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@1d207fad"",""value"":""BLOCK_SELECT@1d207fad"",""pos"":{""lineNum"":4,""columnNum"":2,""endLineNum"":4,""endColumnNum"":58,""quoted"":false},""children"":[]}]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@2bfbffb2"",""value"":""NS_IDENT@6f667ad1.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4784013e"",""value"":""NS_IDENT@77a281fc.drinker"",""pos"":{""lineNum"":3,""columnNum"":13,""endLineNum"":3,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@151335cb"",""value"":""NS_IDENT@77a281fc.BAR"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5b022357"",""value"":""NS_IDENT@6f667ad1.name"",""pos"":{""lineNum"":3,""columnNum"":4,""endLineNum"":3,""endColumnNum"":9,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6d4a65c6"",""value"":""NS_IDENT@77a281fc.times_a_week"",""pos"":{""lineNum"":3,""columnNum"":27,""endLineNum"":3,""endColumnNum"":40,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@6f667ad1.name""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":4,""endColumnNum"":59,""quoted"":false},""children"":{""BLOCK_SELECT@1d207fad"":{""id"":""BLOCK_SELECT@1d207fad"",""parentId"":""BLOCK_SELECT@40021799"",""fields"":[""TIMES_A_WEEK INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@53692008"",""value"":""NS_IDENT@4cdd2c73.TIMES_A_WEEK"",""pos"":{""lineNum"":4,""columnNum"":9,""endLineNum"":4,""endColumnNum"":20,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@4cdd2c73""],""fromNode"":{""id"":""JOIN_OPERAND@488b50ec"",""value"":""NS_IDENT@4cdd2c73"",""pos"":{""lineNum"":4,""columnNum"":27,""endLineNum"":4,""endColumnNum"":35,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@963176"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":43,""endLineNum"":4,""endColumnNum"":58,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@3a627c80"",""value"":""NS_IDENT@4cdd2c73.drinker"",""pos"":{""lineNum"":4,""columnNum"":43,""endLineNum"":4,""endColumnNum"":49,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@49aa766b"",""value"":""NS_IDENT@6f667ad1.name"",""pos"":{""lineNum"":4,""columnNum"":53,""endLineNum"":4,""endColumnNum"":58,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@3a627c80"",""value"":""NS_IDENT@4cdd2c73.drinker"",""pos"":{""lineNum"":4,""columnNum"":43,""endLineNum"":4,""endColumnNum"":49,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@53692008"",""value"":""NS_IDENT@4cdd2c73.TIMES_A_WEEK"",""pos"":{""lineNum"":4,""columnNum"":9,""endLineNum"":4,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@49aa766b"",""value"":""NS_IDENT@6f667ad1.name"",""pos"":{""lineNum"":4,""columnNum"":53,""endLineNum"":4,""endColumnNum"":58,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@6f667ad1""],""corrCtxIds"":[""BLOCK_SELECT@40021799""],""pos"":{""lineNum"":4,""columnNum"":2,""endLineNum"":4,""endColumnNum"":58,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@77a281fc"":{""tableId"":""NS_IDENT@77a281fc"",""identifier"":""B"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":35,""endLineNum"":2,""endColumnNum"":48,""quoted"":false}},""NS_IDENT@4cdd2c73"":{""tableId"":""NS_IDENT@4cdd2c73"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":27,""endLineNum"":4,""endColumnNum"":35,""quoted"":false}},""NS_IDENT@6f667ad1"":{""tableId"":""NS_IDENT@6f667ad1"",""identifier"":""A"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":17,""quoted"":false}}},""corrTables"":[""NS_IDENT@6f667ad1""]}
"
"with

maxFrequents as (select drinker, max(times_a_week) as times_a_week from frequents group by drinker), /*no nulls*/

drinkerBar as (select drinker, bar from maxFrequents natural join frequents), /* no nulls*/

drinkers as (select name as drinker from drinker)

select drinkers.drinker, drinkerBar.bar from drinkers left outer join drinkerBar on drinkers.drinker = drinkerBar.drinker;

","{""failed"":true,""errorMsg"":""From line 5, column 23 to line 5, column 29: Column 'DRINKER' is ambiguous""}
"
"with temp1 as (select distinct f1.drinker, f2.bar from frequents f1, frequents f2 where f1.drinker = f2.drinker and f2.times_a_week < f1.times_a_week),
     temp2 as (select drinker.name as drinker from drinker except select frequents.drinker from frequents),
     temp3 as (select temp2.drinker, null::text as bar from temp2),
     temp4 as (select frequents.drinker, frequents.bar from frequents except select * from temp1)
select * from temp4 union select * from temp3","{""failed"":true,""errorMsg"":""Parsing error at line 3, column 42. Query syntax may be incorrect""}
"
"SELECT
   drinker.name as drinker,
   maximums.bar 
FROM drinker
LEFT JOIN
(SELECT drinker, bar
FROM frequents
WHERE (drinker, times_a_week)
IN 
   (
      SELECT
         drinker, max(times_a_week) as times_a_week
      FROM
         frequents 
      GROUP BY
      drinker
   )) as maximums
ON maximums.drinker = drinker.name
","{""failed"":true}
"
"WITH MaxVisits AS (SELECT F.drinker, MAX(F.times_a_week) AS max_value
                  FROM Frequents F
                  GROUP BY F.drinker),
    DrinkerMaxBar AS (SELECT F.drinker, F.bar
                      FROM Frequents F, MaxVisits MV
                      WHERE F.drinker = MV.drinker AND F.times_a_week = MV.max_value)
SELECT D.name AS drinker, bar
FROM Drinker D FULL OUTER JOIN DrinkerMaxBar DMB
ON D.name = DMB.drinker","{""blocks"":{""id"":""BLOCK_SELECT@5226e402"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@5f13be1"",""value"":""NS_IDENT@51dbd6e4.NAME"",""pos"":{""lineNum"":7,""columnNum"":8,""endLineNum"":7,""endColumnNum"":13,""quoted"":false},""children"":[],""alias"":""DRINKER""},{""id"":""COLUMN_LOCAL@50d3bf39"",""value"":""NS_IDENT@2b8bd14b.BAR"",""pos"":{""lineNum"":7,""columnNum"":27,""endLineNum"":7,""endColumnNum"":29,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@51dbd6e4"",""NS_IDENT@2b8bd14b""],""fromNode"":{""id"":""OP_JOIN@1440c311"",""value"":""FULL"",""pos"":{""lineNum"":8,""columnNum"":27,""endLineNum"":8,""endColumnNum"":30,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@189b5fb1"",""value"":""NS_IDENT@51dbd6e4"",""pos"":{""lineNum"":8,""columnNum"":6,""endLineNum"":8,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@783ec989"",""value"":""NS_IDENT@2b8bd14b"",""pos"":{""lineNum"":8,""columnNum"":32,""endLineNum"":8,""endColumnNum"":44,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@7551da2a"",""value"":""="",""pos"":{""lineNum"":9,""columnNum"":4,""endLineNum"":9,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@250b236d"",""value"":""NS_IDENT@51dbd6e4.name"",""pos"":{""lineNum"":9,""columnNum"":4,""endLineNum"":9,""endColumnNum"":9,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@61f3fbb8"",""value"":""NS_IDENT@2b8bd14b.DRINKER"",""pos"":{""lineNum"":9,""columnNum"":13,""endLineNum"":9,""endColumnNum"":23,""quoted"":false},""children"":[]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@61f3fbb8"",""value"":""NS_IDENT@2b8bd14b.DRINKER"",""pos"":{""lineNum"":9,""columnNum"":13,""endLineNum"":9,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@250b236d"",""value"":""NS_IDENT@51dbd6e4.name"",""pos"":{""lineNum"":9,""columnNum"":4,""endLineNum"":9,""endColumnNum"":9,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@50d3bf39"",""value"":""NS_IDENT@2b8bd14b.BAR"",""pos"":{""lineNum"":7,""columnNum"":27,""endLineNum"":7,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5f13be1"",""value"":""NS_IDENT@51dbd6e4.NAME"",""pos"":{""lineNum"":7,""columnNum"":8,""endLineNum"":7,""endColumnNum"":13,""quoted"":false},""children"":[],""alias"":""DRINKER""}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":7,""columnNum"":1,""endLineNum"":9,""endColumnNum"":23,""quoted"":false},""children"":{}},""tables"":{""NS_IDENT@30506c0d"":{""tableId"":""NS_IDENT@30506c0d"",""identifier"":""F"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":24,""endLineNum"":2,""endColumnNum"":34,""quoted"":false}},""NS_IDENT@51dbd6e4"":{""tableId"":""NS_IDENT@51dbd6e4"",""identifier"":""D"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":6,""endLineNum"":8,""endColumnNum"":14,""quoted"":false}},""NS_IDENT@2b8bd14b"":{""tableId"":""NS_IDENT@2b8bd14b"",""identifier"":""DMB"",""dbTableName"":""DRINKERMAXBAR"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":32,""endLineNum"":8,""endColumnNum"":48,""quoted"":false}},""NS_IDENT@62e6a3ec"":{""tableId"":""NS_IDENT@62e6a3ec"",""identifier"":""MV"",""dbTableName"":""MAXVISITS"",""fields"":[""DRINKER VARCHAR(100)"",""MAX_VALUE INTEGER""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":41,""endLineNum"":5,""endColumnNum"":52,""quoted"":false}},""NS_IDENT@c81fd12"":{""tableId"":""NS_IDENT@c81fd12"",""identifier"":""F"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":28,""endLineNum"":5,""endColumnNum"":38,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@5c20ffa8"",""alias"":""MAXVISITS"",""fields"":[""DRINKER VARCHAR(100)"",""MAX_VALUE INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@19569ebd"",""value"":""NS_IDENT@30506c0d.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":27,""endLineNum"":1,""endColumnNum"":35,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@6e1f8469"",""value"":""MAX"",""pos"":{""lineNum"":1,""columnNum"":38,""endLineNum"":1,""endColumnNum"":56,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@2e380628"",""value"":""NS_IDENT@30506c0d.TIMES_A_WEEK"",""pos"":{""lineNum"":1,""columnNum"":42,""endLineNum"":1,""endColumnNum"":55,""quoted"":false},""children"":[]}],""alias"":""MAX_VALUE""}],""fromItemIds"":[""NS_IDENT@30506c0d""],""fromNode"":{""id"":""JOIN_OPERAND@72ed9aad"",""value"":""NS_IDENT@30506c0d"",""pos"":{""lineNum"":2,""columnNum"":24,""endLineNum"":2,""endColumnNum"":32,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@76075d65"",""value"":""NS_IDENT@30506c0d.drinker"",""pos"":{""lineNum"":3,""columnNum"":28,""endLineNum"":3,""endColumnNum"":36,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@2e380628"",""value"":""NS_IDENT@30506c0d.TIMES_A_WEEK"",""pos"":{""lineNum"":1,""columnNum"":42,""endLineNum"":1,""endColumnNum"":55,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@76075d65"",""value"":""NS_IDENT@30506c0d.drinker"",""pos"":{""lineNum"":3,""columnNum"":28,""endLineNum"":3,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@19569ebd"",""value"":""NS_IDENT@30506c0d.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":27,""endLineNum"":1,""endColumnNum"":35,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":20,""endLineNum"":3,""endColumnNum"":36,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@27b22f74"",""alias"":""DRINKERMAXBAR"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@5754de72"",""value"":""NS_IDENT@c81fd12.DRINKER"",""pos"":{""lineNum"":4,""columnNum"":30,""endLineNum"":4,""endColumnNum"":38,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@320494b6"",""value"":""NS_IDENT@c81fd12.BAR"",""pos"":{""lineNum"":4,""columnNum"":41,""endLineNum"":4,""endColumnNum"":45,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@c81fd12"",""NS_IDENT@62e6a3ec""],""fromNode"":{""id"":""OP_JOIN@1917d90f"",""value"":""COMMA"",""pos"":{""lineNum"":5,""columnNum"":39,""endLineNum"":5,""endColumnNum"":39,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@66bfd864"",""value"":""NS_IDENT@c81fd12"",""pos"":{""lineNum"":5,""columnNum"":28,""endLineNum"":5,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@4aac85fa"",""value"":""NS_IDENT@62e6a3ec"",""pos"":{""lineNum"":5,""columnNum"":41,""endLineNum"":5,""endColumnNum"":49,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@64138b0c"",""value"":""AND"",""pos"":{""lineNum"":6,""columnNum"":29,""endLineNum"":6,""endColumnNum"":84,""quoted"":false},""children"":[{""id"":""OP_BINARY@7fab4be7"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":29,""endLineNum"":6,""endColumnNum"":50,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@15fa55a6"",""value"":""NS_IDENT@c81fd12.drinker"",""pos"":{""lineNum"":6,""columnNum"":29,""endLineNum"":6,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_IDENT@62e6a3ec.DRINKER"",""pos"":{""lineNum"":6,""columnNum"":41,""endLineNum"":6,""endColumnNum"":50,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@41c204a0"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":56,""endLineNum"":6,""endColumnNum"":84,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@a64e035"",""value"":""NS_IDENT@c81fd12.times_a_week"",""pos"":{""lineNum"":6,""columnNum"":56,""endLineNum"":6,""endColumnNum"":69,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4d74c3ba"",""value"":""NS_IDENT@62e6a3ec.MAX_VALUE"",""pos"":{""lineNum"":6,""columnNum"":73,""endLineNum"":6,""endColumnNum"":84,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@320494b6"",""value"":""NS_IDENT@c81fd12.BAR"",""pos"":{""lineNum"":4,""columnNum"":41,""endLineNum"":4,""endColumnNum"":45,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@a64e035"",""value"":""NS_IDENT@c81fd12.times_a_week"",""pos"":{""lineNum"":6,""columnNum"":56,""endLineNum"":6,""endColumnNum"":69,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5754de72"",""value"":""NS_IDENT@c81fd12.DRINKER"",""pos"":{""lineNum"":4,""columnNum"":30,""endLineNum"":4,""endColumnNum"":38,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4d74c3ba"",""value"":""NS_IDENT@62e6a3ec.MAX_VALUE"",""pos"":{""lineNum"":6,""columnNum"":73,""endLineNum"":6,""endColumnNum"":84,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@15fa55a6"",""value"":""NS_IDENT@c81fd12.drinker"",""pos"":{""lineNum"":6,""columnNum"":29,""endLineNum"":6,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_IDENT@62e6a3ec.DRINKER"",""pos"":{""lineNum"":6,""columnNum"":41,""endLineNum"":6,""endColumnNum"":50,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":4,""columnNum"":23,""endLineNum"":6,""endColumnNum"":84,""quoted"":false},""children"":{}}]}
"
"WITH alldrinkernames AS (SELECT name FROM drinker),
drinkerfreqcounts AS (SELECT drinker, MAX(times_a_week) FROM frequents GROUP BY drinker),
alldrinkerfreqcounts AS (SELECT A.name, B.max FROM alldrinkernames A LEFT OUTER JOIN drinkerfreqcounts B ON A.name = B.drinker)
SELECT X.name, Y.bar FROM alldrinkerfreqcounts X LEFT OUTER JOIN frequents Y ON X.name = Y.drinker AND X.max = Y.times_a_week","{""failed"":true,""errorMsg"":""Parsing error at line 3, column 42. Query syntax may be incorrect""}
"
"with maxes as
  (select frequents.drinker, max(frequents.times_a_week)
  from frequents
  group by frequents.drinker),
  bars as
  (select frequents.drinker, frequents.bar
  from frequents, maxes
  where frequents.drinker = maxes.drinker and frequents.times_a_week = maxes.max),
  drinkers as
  (select drinker.name as drinker
  from drinker)
select drinkers.drinker, bars.bar
from drinkers left outer join bars
on drinkers.drinker = bars.drinker;","{""failed"":true,""errorMsg"":""Parsing error at line 8, column 77. Query syntax may be incorrect""}
"
"SELECT name, bar
FROM drinker d
LEFT OUTER JOIN frequents f ON d.name = f.drinker
WHERE EXISTS (SELECT name
FROM drinker
LEFT OUTER JOIN frequents ON drinker.name = frequents.drinker
WHERE d.name = drinker.name
GROUP BY name
HAVING f.times_a_week = MAX(times_a_week) OR f.times_a_week IS NULL);
","{""failed"":true,""errorMsg"":""From line 9, column 8 to line 9, column 21: Expression 'F.TIMES_A_WEEK' is not being grouped""}
"
"WITH maxNum AS (
    SELECT f.drinker, max(f.times_a_week)
    FROM frequents as f
    GROUP BY f.drinker
),

noFreq AS (
    SELECT d.name 
    FROM drinker AS d 
    WHERE d.name NOT IN (
        SELECT DISTINCT f.drinker 
        FROM frequents AS f 
    )
)


SELECT f.drinker, f.bar 
FROM frequents as f, maxNum as m 
WHERE f.drinker = m.drinker AND f.times_a_week = m.max
UNION (
    SELECT noFreq.name, NULL 
    FROM noFreq
)","{""failed"":true,""errorMsg"":""Parsing error at line 19, column 51. Query syntax may be incorrect""}
"
"WITH frequenters AS
(SELECT f.drinker as drinker, f.bar as bar
FROM (
   SELECT drinker, MAX(times_a_week) as maxtimes
   FROM frequents GROUP BY drinker
) as x inner join frequents as f on f.drinker = x.drinker and f.times_a_week = x.maxtimes)

SELECT drinker.name, frequenters.bar FROM drinker LEFT OUTER JOIN frequenters
ON drinker.name = frequenters.drinker;","{""blocks"":{""id"":""BLOCK_SELECT@1ddd3478"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@14fc5d40"",""value"":""NS_IDENT@320494b6.NAME"",""pos"":{""lineNum"":8,""columnNum"":8,""endLineNum"":8,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@61f3fbb8"",""value"":""NS_IDENT@652ab8d9.BAR"",""pos"":{""lineNum"":8,""columnNum"":22,""endLineNum"":8,""endColumnNum"":36,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@320494b6"",""NS_IDENT@652ab8d9""],""fromNode"":{""id"":""OP_JOIN@f973499"",""value"":""LEFT"",""pos"":{""lineNum"":8,""columnNum"":62,""endLineNum"":8,""endColumnNum"":65,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@4d33940d"",""value"":""NS_IDENT@320494b6"",""pos"":{""lineNum"":8,""columnNum"":43,""endLineNum"":8,""endColumnNum"":49,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@43cf6ea3"",""value"":""NS_IDENT@652ab8d9"",""pos"":{""lineNum"":8,""columnNum"":67,""endLineNum"":8,""endColumnNum"":77,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@2b8d084"",""value"":""="",""pos"":{""lineNum"":9,""columnNum"":4,""endLineNum"":9,""endColumnNum"":37,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1bfe3203"",""value"":""NS_IDENT@320494b6.name"",""pos"":{""lineNum"":9,""columnNum"":4,""endLineNum"":9,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@23e44287"",""value"":""NS_IDENT@652ab8d9.DRINKER"",""pos"":{""lineNum"":9,""columnNum"":19,""endLineNum"":9,""endColumnNum"":37,""quoted"":false},""children"":[]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@61f3fbb8"",""value"":""NS_IDENT@652ab8d9.BAR"",""pos"":{""lineNum"":8,""columnNum"":22,""endLineNum"":8,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@23e44287"",""value"":""NS_IDENT@652ab8d9.DRINKER"",""pos"":{""lineNum"":9,""columnNum"":19,""endLineNum"":9,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1bfe3203"",""value"":""NS_IDENT@320494b6.name"",""pos"":{""lineNum"":9,""columnNum"":4,""endLineNum"":9,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@14fc5d40"",""value"":""NS_IDENT@320494b6.NAME"",""pos"":{""lineNum"":8,""columnNum"":8,""endLineNum"":8,""endColumnNum"":19,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":8,""columnNum"":1,""endLineNum"":9,""endColumnNum"":37,""quoted"":false},""children"":{}},""tables"":{""NS_IDENT@45792847"":{""tableId"":""NS_IDENT@45792847"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":9,""endLineNum"":5,""endColumnNum"":17,""quoted"":false}},""NS_SELECT@6dd91637"":{""tableId"":""NS_SELECT@6dd91637"",""identifier"":""X"",""blockId"":""BLOCK_SELECT@1d207fad"",""fields"":[""DRINKER VARCHAR(100)"",""MAXTIMES INTEGER""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":4,""endLineNum"":6,""endColumnNum"":6,""quoted"":false}},""NS_IDENT@320494b6"":{""tableId"":""NS_IDENT@320494b6"",""identifier"":""DRINKER"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":43,""endLineNum"":8,""endColumnNum"":49,""quoted"":false}},""NS_IDENT@652ab8d9"":{""tableId"":""NS_IDENT@652ab8d9"",""identifier"":""FREQUENTERS"",""dbTableName"":""FREQUENTERS"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":67,""endLineNum"":8,""endColumnNum"":77,""quoted"":false}},""NS_IDENT@19569ebd"":{""tableId"":""NS_IDENT@19569ebd"",""identifier"":""F"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":19,""endLineNum"":6,""endColumnNum"":32,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@5c20ffa8"",""alias"":""FREQUENTERS"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@4632cfc"",""value"":""NS_IDENT@19569ebd.DRINKER"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":17,""quoted"":false},""children"":[],""alias"":""DRINKER""},{""id"":""COLUMN_LOCAL@2e380628"",""value"":""NS_IDENT@19569ebd.BAR"",""pos"":{""lineNum"":2,""columnNum"":31,""endLineNum"":2,""endColumnNum"":35,""quoted"":false},""children"":[],""alias"":""BAR""}],""fromItemIds"":[""NS_SELECT@6dd91637"",""NS_IDENT@19569ebd""],""fromNode"":{""id"":""OP_JOIN@6bcbf05b"",""value"":""INNER"",""pos"":{""lineNum"":6,""columnNum"":14,""endLineNum"":6,""endColumnNum"":17,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@1d207fad"",""value"":""BLOCK_SELECT@1d207fad"",""pos"":{""lineNum"":4,""columnNum"":4,""endLineNum"":5,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@21fff664"",""value"":""NS_IDENT@19569ebd"",""pos"":{""lineNum"":6,""columnNum"":19,""endLineNum"":6,""endColumnNum"":27,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@43effd89"",""value"":""AND"",""pos"":{""lineNum"":6,""columnNum"":37,""endLineNum"":6,""endColumnNum"":89,""quoted"":false},""children"":[{""id"":""OP_BINARY@476ec9d0"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":37,""endLineNum"":6,""endColumnNum"":57,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@70abf9b0"",""value"":""NS_IDENT@19569ebd.drinker"",""pos"":{""lineNum"":6,""columnNum"":37,""endLineNum"":6,""endColumnNum"":45,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6a10b263"",""value"":""NS_SELECT@6dd91637.DRINKER"",""pos"":{""lineNum"":6,""columnNum"":49,""endLineNum"":6,""endColumnNum"":57,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@72fe8a4f"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":63,""endLineNum"":6,""endColumnNum"":89,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@325bb9a6"",""value"":""NS_IDENT@19569ebd.times_a_week"",""pos"":{""lineNum"":6,""columnNum"":63,""endLineNum"":6,""endColumnNum"":76,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1d12b024"",""value"":""NS_SELECT@6dd91637.MAXTIMES"",""pos"":{""lineNum"":6,""columnNum"":80,""endLineNum"":6,""endColumnNum"":89,""quoted"":false},""children"":[]}]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@2e380628"",""value"":""NS_IDENT@19569ebd.BAR"",""pos"":{""lineNum"":2,""columnNum"":31,""endLineNum"":2,""endColumnNum"":35,""quoted"":false},""children"":[],""alias"":""BAR""},{""id"":""COLUMN_LOCAL@70abf9b0"",""value"":""NS_IDENT@19569ebd.drinker"",""pos"":{""lineNum"":6,""columnNum"":37,""endLineNum"":6,""endColumnNum"":45,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4632cfc"",""value"":""NS_IDENT@19569ebd.DRINKER"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":17,""quoted"":false},""children"":[],""alias"":""DRINKER""},{""id"":""COLUMN_LOCAL@325bb9a6"",""value"":""NS_IDENT@19569ebd.times_a_week"",""pos"":{""lineNum"":6,""columnNum"":63,""endLineNum"":6,""endColumnNum"":76,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6a10b263"",""value"":""NS_SELECT@6dd91637.DRINKER"",""pos"":{""lineNum"":6,""columnNum"":49,""endLineNum"":6,""endColumnNum"":57,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1d12b024"",""value"":""NS_SELECT@6dd91637.MAXTIMES"",""pos"":{""lineNum"":6,""columnNum"":80,""endLineNum"":6,""endColumnNum"":89,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":2,""endLineNum"":6,""endColumnNum"":89,""quoted"":false},""children"":{""BLOCK_SELECT@1d207fad"":{""id"":""BLOCK_SELECT@1d207fad"",""parentId"":""BLOCK_SELECT@5c20ffa8"",""alias"":""X"",""fields"":[""DRINKER VARCHAR(100)"",""MAXTIMES INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@56303475"",""value"":""NS_IDENT@45792847.DRINKER"",""pos"":{""lineNum"":4,""columnNum"":11,""endLineNum"":4,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""OP_AGG_FUNC@1dcca8d3"",""value"":""MAX"",""pos"":{""lineNum"":4,""columnNum"":20,""endLineNum"":4,""endColumnNum"":36,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5631962"",""value"":""NS_IDENT@45792847.TIMES_A_WEEK"",""pos"":{""lineNum"":4,""columnNum"":24,""endLineNum"":4,""endColumnNum"":35,""quoted"":false},""children"":[]}],""alias"":""MAXTIMES""}],""fromItemIds"":[""NS_IDENT@45792847""],""fromNode"":{""id"":""JOIN_OPERAND@bdecc21"",""value"":""NS_IDENT@45792847"",""pos"":{""lineNum"":5,""columnNum"":9,""endLineNum"":5,""endColumnNum"":17,""quoted"":false},""children"":[]},""isAggregate"":true,""groupByList"":[{""id"":""COLUMN_LOCAL@1bbae752"",""value"":""NS_IDENT@45792847.drinker"",""pos"":{""lineNum"":5,""columnNum"":28,""endLineNum"":5,""endColumnNum"":34,""quoted"":false},""children"":[]}],""identifiers"":[{""id"":""COLUMN_LOCAL@5631962"",""value"":""NS_IDENT@45792847.TIMES_A_WEEK"",""pos"":{""lineNum"":4,""columnNum"":24,""endLineNum"":4,""endColumnNum"":35,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@56303475"",""value"":""NS_IDENT@45792847.DRINKER"",""pos"":{""lineNum"":4,""columnNum"":11,""endLineNum"":4,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1bbae752"",""value"":""NS_IDENT@45792847.drinker"",""pos"":{""lineNum"":5,""columnNum"":28,""endLineNum"":5,""endColumnNum"":34,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":4,""columnNum"":4,""endLineNum"":5,""endColumnNum"":34,""quoted"":false},""children"":{}}}}]}
"
"SELECT name, bar
FROM frequents f RIGHT OUTER JOIN drinker d
ON f.drinker = d.name
WHERE NOT EXISTS
(SELECT *
FROM frequents RIGHT OUTER JOIN drinker d
ON f.drinker = d.name
WHERE times_a_week>f.times_a_week and drinker=f.drinker)","{""blocks"":{""id"":""BLOCK_SELECT@3f36b447"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@2b214b94"",""value"":""NS_IDENT@65bb9029.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@49601f82"",""value"":""NS_IDENT@7435a578.BAR"",""pos"":{""lineNum"":1,""columnNum"":14,""endLineNum"":1,""endColumnNum"":16,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@7435a578"",""NS_IDENT@65bb9029""],""fromNode"":{""id"":""OP_JOIN@37a64f9d"",""value"":""RIGHT"",""pos"":{""lineNum"":2,""columnNum"":30,""endLineNum"":2,""endColumnNum"":33,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@25b865b5"",""value"":""NS_IDENT@7435a578"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@f9b5552"",""value"":""NS_IDENT@65bb9029"",""pos"":{""lineNum"":2,""columnNum"":35,""endLineNum"":2,""endColumnNum"":41,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@4784013e"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":4,""endLineNum"":3,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4b2a30d"",""value"":""NS_IDENT@7435a578.drinker"",""pos"":{""lineNum"":3,""columnNum"":4,""endLineNum"":3,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3a91d146"",""value"":""NS_IDENT@65bb9029.name"",""pos"":{""lineNum"":3,""columnNum"":16,""endLineNum"":3,""endColumnNum"":21,""quoted"":false},""children"":[]}]}},""whereNode"":{""id"":""OP_PREFIX@58cec85b"",""value"":""NOT"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":8,""endColumnNum"":55,""quoted"":false},""children"":[{""id"":""OP_PREFIX@5cf8edcf"",""value"":""EXISTS"",""pos"":{""lineNum"":4,""columnNum"":11,""endLineNum"":8,""endColumnNum"":55,""quoted"":false},""children"":[{""id"":""BLOCK_SELECT@5e742e4"",""value"":""BLOCK_SELECT@5e742e4"",""pos"":{""lineNum"":5,""columnNum"":2,""endLineNum"":8,""endColumnNum"":55,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@49601f82"",""value"":""NS_IDENT@7435a578.BAR"",""pos"":{""lineNum"":1,""columnNum"":14,""endLineNum"":1,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4b2a30d"",""value"":""NS_IDENT@7435a578.drinker"",""pos"":{""lineNum"":3,""columnNum"":4,""endLineNum"":3,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2b214b94"",""value"":""NS_IDENT@65bb9029.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3a91d146"",""value"":""NS_IDENT@65bb9029.name"",""pos"":{""lineNum"":3,""columnNum"":16,""endLineNum"":3,""endColumnNum"":21,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@7435a578.times_a_week"",""NS_IDENT@7435a578.drinker""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":8,""endColumnNum"":56,""quoted"":false},""children"":{""BLOCK_SELECT@5e742e4"":{""id"":""BLOCK_SELECT@5e742e4"",""parentId"":""BLOCK_SELECT@3f36b447"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER"",""name VARCHAR(100)"",""address VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@ecfbe91"",""value"":""*"",""pos"":{""lineNum"":5,""columnNum"":9,""endLineNum"":5,""endColumnNum"":9,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@2b8d084"",""NS_IDENT@6daf2337""],""fromNode"":{""id"":""OP_JOIN@71c905a3"",""value"":""RIGHT"",""pos"":{""lineNum"":6,""columnNum"":28,""endLineNum"":6,""endColumnNum"":31,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@46c00568"",""value"":""NS_IDENT@2b8d084"",""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@59712875"",""value"":""NS_IDENT@6daf2337"",""pos"":{""lineNum"":6,""columnNum"":33,""endLineNum"":6,""endColumnNum"":39,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@3766c667"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":4,""endLineNum"":7,""endColumnNum"":21,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@66e889df"",""value"":""NS_IDENT@7435a578.drinker"",""pos"":{""lineNum"":7,""columnNum"":4,""endLineNum"":7,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@444548a0"",""value"":""NS_IDENT@6daf2337.name"",""pos"":{""lineNum"":7,""columnNum"":16,""endLineNum"":7,""endColumnNum"":21,""quoted"":false},""children"":[]}]}},""whereNode"":{""id"":""OP_BINARY@31ddd4a4"",""value"":""AND"",""pos"":{""lineNum"":8,""columnNum"":7,""endLineNum"":8,""endColumnNum"":55,""quoted"":false},""children"":[{""id"":""OP_BINARY@3b569985"",""value"":"">"",""pos"":{""lineNum"":8,""columnNum"":7,""endLineNum"":8,""endColumnNum"":33,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@773c0293"",""value"":""NS_IDENT@2b8d084.times_a_week"",""pos"":{""lineNum"":8,""columnNum"":7,""endLineNum"":8,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@55b8dbda"",""value"":""NS_IDENT@7435a578.times_a_week"",""pos"":{""lineNum"":8,""columnNum"":20,""endLineNum"":8,""endColumnNum"":33,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@3e48e859"",""value"":""="",""pos"":{""lineNum"":8,""columnNum"":39,""endLineNum"":8,""endColumnNum"":55,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@3a022576"",""value"":""NS_IDENT@2b8d084.drinker"",""pos"":{""lineNum"":8,""columnNum"":39,""endLineNum"":8,""endColumnNum"":45,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@2dbd803f"",""value"":""NS_IDENT@7435a578.drinker"",""pos"":{""lineNum"":8,""columnNum"":47,""endLineNum"":8,""endColumnNum"":55,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_CORRELATE@66e889df"",""value"":""NS_IDENT@7435a578.drinker"",""pos"":{""lineNum"":7,""columnNum"":4,""endLineNum"":7,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@773c0293"",""value"":""NS_IDENT@2b8d084.times_a_week"",""pos"":{""lineNum"":8,""columnNum"":7,""endLineNum"":8,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@55b8dbda"",""value"":""NS_IDENT@7435a578.times_a_week"",""pos"":{""lineNum"":8,""columnNum"":20,""endLineNum"":8,""endColumnNum"":33,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3a022576"",""value"":""NS_IDENT@2b8d084.drinker"",""pos"":{""lineNum"":8,""columnNum"":39,""endLineNum"":8,""endColumnNum"":45,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@2dbd803f"",""value"":""NS_IDENT@7435a578.drinker"",""pos"":{""lineNum"":8,""columnNum"":47,""endLineNum"":8,""endColumnNum"":55,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@444548a0"",""value"":""NS_IDENT@6daf2337.name"",""pos"":{""lineNum"":7,""columnNum"":16,""endLineNum"":7,""endColumnNum"":21,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@7435a578""],""corrCtxIds"":[""BLOCK_SELECT@3f36b447""],""pos"":{""lineNum"":5,""columnNum"":2,""endLineNum"":8,""endColumnNum"":55,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@6daf2337"":{""tableId"":""NS_IDENT@6daf2337"",""identifier"":""D"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":33,""endLineNum"":6,""endColumnNum"":41,""quoted"":false}},""NS_IDENT@7435a578"":{""tableId"":""NS_IDENT@7435a578"",""identifier"":""F"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":16,""quoted"":false}},""NS_IDENT@65bb9029"":{""tableId"":""NS_IDENT@65bb9029"",""identifier"":""D"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":35,""endLineNum"":2,""endColumnNum"":43,""quoted"":false}},""NS_IDENT@2b8d084"":{""tableId"":""NS_IDENT@2b8d084"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":14,""quoted"":false}}},""corrTables"":[""NS_IDENT@7435a578""]}
"
"
WITH frequency as 
(Select drinker.name as drinker, max(frequents.times_a_week)
From drinker LEFT OUTER JOIN frequents ON drinker.name = frequents.drinker
Group by drinker.name),
freqandbar as 
(select drinker, bar, max from frequents natural join frequency where max = times_a_week)

select drinker.name, freqandbar.bar
from (drinker left outer join freqandbar on drinker.name = freqandbar.drinker)","{""failed"":true,""errorMsg"":""Parsing error at line 7, column 23. Query syntax may be incorrect""}
"
"(SELECT drinker.name, frequents.bar
FROM drinker LEFT OUTER JOIN frequents
ON drinker.name=frequents.drinker)
EXCEPT
(SELECT f1.drinker, f1.bar
FROM frequents f1, frequents f2
WHERE f1.drinker=f2.drinker and f1.times_a_week<f2.times_a_week);","{""blocks"":{""id"":""BLOCK_SETOP@3f36b447"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@65004ff6"",""rightBlockId"":""BLOCK_SELECT@4158debd"",""pos"":{""lineNum"":1,""columnNum"":2,""endLineNum"":7,""endColumnNum"":63,""quoted"":false},""children"":{""BLOCK_SELECT@65004ff6"":{""id"":""BLOCK_SELECT@65004ff6"",""parentId"":""BLOCK_SETOP@3f36b447"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@676ff3b0"",""value"":""NS_IDENT@53e3a87a.NAME"",""pos"":{""lineNum"":1,""columnNum"":9,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5fb7183b"",""value"":""NS_IDENT@3d43fe.BAR"",""pos"":{""lineNum"":1,""columnNum"":23,""endLineNum"":1,""endColumnNum"":35,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@53e3a87a"",""NS_IDENT@3d43fe""],""fromNode"":{""id"":""OP_JOIN@383f1975"",""value"":""LEFT"",""pos"":{""lineNum"":2,""columnNum"":25,""endLineNum"":2,""endColumnNum"":28,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@3e48e859"",""value"":""NS_IDENT@53e3a87a"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@529cfee5"",""value"":""NS_IDENT@3d43fe"",""pos"":{""lineNum"":2,""columnNum"":30,""endLineNum"":2,""endColumnNum"":38,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@70242f38"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":4,""endLineNum"":3,""endColumnNum"":33,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@141e879d"",""value"":""NS_IDENT@53e3a87a.name"",""pos"":{""lineNum"":3,""columnNum"":4,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@61c76850"",""value"":""NS_IDENT@3d43fe.drinker"",""pos"":{""lineNum"":3,""columnNum"":17,""endLineNum"":3,""endColumnNum"":33,""quoted"":false},""children"":[]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@141e879d"",""value"":""NS_IDENT@53e3a87a.name"",""pos"":{""lineNum"":3,""columnNum"":4,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@676ff3b0"",""value"":""NS_IDENT@53e3a87a.NAME"",""pos"":{""lineNum"":1,""columnNum"":9,""endLineNum"":1,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@61c76850"",""value"":""NS_IDENT@3d43fe.drinker"",""pos"":{""lineNum"":3,""columnNum"":17,""endLineNum"":3,""endColumnNum"":33,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5fb7183b"",""value"":""NS_IDENT@3d43fe.BAR"",""pos"":{""lineNum"":1,""columnNum"":23,""endLineNum"":1,""endColumnNum"":35,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":2,""endLineNum"":3,""endColumnNum"":33,""quoted"":false},""children"":{}},""BLOCK_SELECT@4158debd"":{""id"":""BLOCK_SELECT@4158debd"",""parentId"":""BLOCK_SETOP@3f36b447"",""fields"":[""DRINKER VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@6e106680"",""value"":""NS_IDENT@65bcf7c2.DRINKER"",""pos"":{""lineNum"":5,""columnNum"":9,""endLineNum"":5,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@55ecbafe"",""value"":""NS_IDENT@65bcf7c2.BAR"",""pos"":{""lineNum"":5,""columnNum"":21,""endLineNum"":5,""endColumnNum"":26,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@65bcf7c2"",""NS_IDENT@3db64bd4""],""fromNode"":{""id"":""OP_JOIN@af78c87"",""value"":""COMMA"",""pos"":{""lineNum"":6,""columnNum"":18,""endLineNum"":6,""endColumnNum"":18,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@1ecfcbc9"",""value"":""NS_IDENT@65bcf7c2"",""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@1965539b"",""value"":""NS_IDENT@3db64bd4"",""pos"":{""lineNum"":6,""columnNum"":20,""endLineNum"":6,""endColumnNum"":28,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@7cf162bc"",""value"":""AND"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":63,""quoted"":false},""children"":[{""id"":""OP_BINARY@1a35993f"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":27,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@562457e1"",""value"":""NS_IDENT@65bcf7c2.drinker"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@54562ea6"",""value"":""NS_IDENT@3db64bd4.drinker"",""pos"":{""lineNum"":7,""columnNum"":18,""endLineNum"":7,""endColumnNum"":27,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@4a3be6a5"",""value"":""<"",""pos"":{""lineNum"":7,""columnNum"":33,""endLineNum"":7,""endColumnNum"":63,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5b12012e"",""value"":""NS_IDENT@65bcf7c2.times_a_week"",""pos"":{""lineNum"":7,""columnNum"":33,""endLineNum"":7,""endColumnNum"":47,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2f7dcef2"",""value"":""NS_IDENT@3db64bd4.times_a_week"",""pos"":{""lineNum"":7,""columnNum"":49,""endLineNum"":7,""endColumnNum"":63,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@54562ea6"",""value"":""NS_IDENT@3db64bd4.drinker"",""pos"":{""lineNum"":7,""columnNum"":18,""endLineNum"":7,""endColumnNum"":27,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2f7dcef2"",""value"":""NS_IDENT@3db64bd4.times_a_week"",""pos"":{""lineNum"":7,""columnNum"":49,""endLineNum"":7,""endColumnNum"":63,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@55ecbafe"",""value"":""NS_IDENT@65bcf7c2.BAR"",""pos"":{""lineNum"":5,""columnNum"":21,""endLineNum"":5,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@562457e1"",""value"":""NS_IDENT@65bcf7c2.drinker"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6e106680"",""value"":""NS_IDENT@65bcf7c2.DRINKER"",""pos"":{""lineNum"":5,""columnNum"":9,""endLineNum"":5,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5b12012e"",""value"":""NS_IDENT@65bcf7c2.times_a_week"",""pos"":{""lineNum"":7,""columnNum"":33,""endLineNum"":7,""endColumnNum"":47,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":5,""columnNum"":2,""endLineNum"":7,""endColumnNum"":63,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@3d43fe"":{""tableId"":""NS_IDENT@3d43fe"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":30,""endLineNum"":2,""endColumnNum"":38,""quoted"":false}},""NS_IDENT@65bcf7c2"":{""tableId"":""NS_IDENT@65bcf7c2"",""identifier"":""F1"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":17,""quoted"":false}},""NS_IDENT@53e3a87a"":{""tableId"":""NS_IDENT@53e3a87a"",""identifier"":""DRINKER"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@3db64bd4"":{""tableId"":""NS_IDENT@3db64bd4"",""identifier"":""F2"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":20,""endLineNum"":6,""endColumnNum"":31,""quoted"":false}}},""corrTables"":[]}
"
"select distinct name, bar from
((select distinct f1.drinker as name, f1.bar from frequents as f1, (select drinker,max(times_a_week) as max from frequents group by drinker) as f2  where f1.drinker=f2.drinker and f1.times_a_week=max) union
(select name,NULL from drinker where name not in (select drinker from frequents))) as ans","{""failed"":true,""errorMsg"":""Parsing error at line 2, column 105. Query syntax may be incorrect""}
"
"select x.name as drinker, x.bar 
from (drinker left join frequents on drinker.name = frequents.drinker) x
where x.times_a_week >= all(select times_a_week from frequents where frequents.drinker = x.name)","{""failed"":true,""errorMsg"":""Parsing error at line 2, column 7. Query syntax may be incorrect""}
"
"with djf as
  (select name, bar, times_a_week
    from drinker left outer join frequents
      on drinker.name = frequents.drinker)
select name, bar
  from djf djf1
    where djf1.times_a_week >= all(
      select times_a_week
        from djf djf2
          where djf2.name = djf1.name
    ) or djf1.bar is null","{""blocks"":{""id"":""BLOCK_SELECT@1917d90f"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_IDENT@15fa55a6.NAME"",""pos"":{""lineNum"":5,""columnNum"":8,""endLineNum"":5,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@a64e035"",""value"":""NS_IDENT@15fa55a6.BAR"",""pos"":{""lineNum"":5,""columnNum"":14,""endLineNum"":5,""endColumnNum"":16,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@15fa55a6""],""fromNode"":{""id"":""JOIN_OPERAND@6079cf5"",""value"":""NS_IDENT@15fa55a6"",""pos"":{""lineNum"":6,""columnNum"":8,""endLineNum"":6,""endColumnNum"":10,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@773dab28"",""value"":""OR"",""pos"":{""lineNum"":7,""columnNum"":11,""endLineNum"":11,""endColumnNum"":25,""quoted"":false},""children"":[{""id"":""OP_BINARY@4af46df3"",""value"":"">= ALL"",""pos"":{""lineNum"":7,""columnNum"":11,""endLineNum"":10,""endColumnNum"":37,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@393881f0"",""value"":""NS_IDENT@15fa55a6.TIMES_A_WEEK"",""pos"":{""lineNum"":7,""columnNum"":11,""endLineNum"":7,""endColumnNum"":27,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@66bfd864"",""value"":""BLOCK_SELECT@66bfd864"",""pos"":{""lineNum"":8,""columnNum"":7,""endLineNum"":10,""endColumnNum"":37,""quoted"":false},""children"":[]}]},{""id"":""OP_POSTFIX@af78c87"",""value"":""IS NULL"",""pos"":{""lineNum"":11,""columnNum"":10,""endLineNum"":11,""endColumnNum"":25,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4158debd"",""value"":""NS_IDENT@15fa55a6.BAR"",""pos"":{""lineNum"":11,""columnNum"":10,""endLineNum"":11,""endColumnNum"":17,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@393881f0"",""value"":""NS_IDENT@15fa55a6.TIMES_A_WEEK"",""pos"":{""lineNum"":7,""columnNum"":11,""endLineNum"":7,""endColumnNum"":27,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4158debd"",""value"":""NS_IDENT@15fa55a6.BAR"",""pos"":{""lineNum"":11,""columnNum"":10,""endLineNum"":11,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4f186450"",""value"":""NS_IDENT@15fa55a6.NAME"",""pos"":{""lineNum"":5,""columnNum"":8,""endLineNum"":5,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@a64e035"",""value"":""NS_IDENT@15fa55a6.BAR"",""pos"":{""lineNum"":5,""columnNum"":14,""endLineNum"":5,""endColumnNum"":16,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@15fa55a6.NAME""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":5,""columnNum"":1,""endLineNum"":11,""endColumnNum"":25,""quoted"":false},""children"":{""BLOCK_SELECT@66bfd864"":{""id"":""BLOCK_SELECT@66bfd864"",""parentId"":""BLOCK_SELECT@1917d90f"",""fields"":[""TIMES_A_WEEK INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@2fc07784"",""value"":""NS_IDENT@64138b0c.TIMES_A_WEEK"",""pos"":{""lineNum"":8,""columnNum"":14,""endLineNum"":8,""endColumnNum"":25,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@64138b0c""],""fromNode"":{""id"":""JOIN_OPERAND@21fff664"",""value"":""NS_IDENT@64138b0c"",""pos"":{""lineNum"":9,""columnNum"":14,""endLineNum"":9,""endColumnNum"":16,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@55cff952"",""value"":""="",""pos"":{""lineNum"":10,""columnNum"":17,""endLineNum"":10,""endColumnNum"":37,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@660591fb"",""value"":""NS_IDENT@64138b0c.NAME"",""pos"":{""lineNum"":10,""columnNum"":17,""endLineNum"":10,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@4a55a6e8"",""value"":""NS_IDENT@15fa55a6.NAME"",""pos"":{""lineNum"":10,""columnNum"":29,""endLineNum"":10,""endColumnNum"":37,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_CORRELATE@4a55a6e8"",""value"":""NS_IDENT@15fa55a6.NAME"",""pos"":{""lineNum"":10,""columnNum"":29,""endLineNum"":10,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2fc07784"",""value"":""NS_IDENT@64138b0c.TIMES_A_WEEK"",""pos"":{""lineNum"":8,""columnNum"":14,""endLineNum"":8,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@660591fb"",""value"":""NS_IDENT@64138b0c.NAME"",""pos"":{""lineNum"":10,""columnNum"":17,""endLineNum"":10,""endColumnNum"":25,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@15fa55a6""],""corrCtxIds"":[""BLOCK_SELECT@1917d90f""],""pos"":{""lineNum"":8,""columnNum"":7,""endLineNum"":10,""endColumnNum"":37,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@1d12b024"":{""tableId"":""NS_IDENT@1d12b024"",""identifier"":""FREQUENTS"",""dbTableName"":""FREQUENTS"",""fields"":[""drinker VARCHAR(100)"",""bar VARCHAR(100)"",""times_a_week INTEGER""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":34,""endLineNum"":3,""endColumnNum"":42,""quoted"":false}},""NS_IDENT@15fa55a6"":{""tableId"":""NS_IDENT@15fa55a6"",""identifier"":""DJF1"",""dbTableName"":""DJF"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)"",""TIMES_A_WEEK INTEGER""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":8,""endLineNum"":6,""endColumnNum"":15,""quoted"":false}},""NS_IDENT@64138b0c"":{""tableId"":""NS_IDENT@64138b0c"",""identifier"":""DJF2"",""dbTableName"":""DJF"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)"",""TIMES_A_WEEK INTEGER""],""cursor"":[0],""pos"":{""lineNum"":9,""columnNum"":14,""endLineNum"":9,""endColumnNum"":21,""quoted"":false}},""NS_IDENT@70abf9b0"":{""tableId"":""NS_IDENT@70abf9b0"",""identifier"":""DRINKER"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":10,""endLineNum"":3,""endColumnNum"":16,""quoted"":false}}},""corrTables"":[""NS_IDENT@15fa55a6""],""withBlocks"":[{""id"":""BLOCK_SELECT@1d4664d7"",""alias"":""DJF"",""fields"":[""NAME VARCHAR(100)"",""BAR VARCHAR(100)"",""TIMES_A_WEEK INTEGER""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@43effd89"",""value"":""NS_IDENT@70abf9b0.NAME"",""pos"":{""lineNum"":2,""columnNum"":11,""endLineNum"":2,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@248deced"",""value"":""NS_IDENT@1d12b024.BAR"",""pos"":{""lineNum"":2,""columnNum"":17,""endLineNum"":2,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1e9804b9"",""value"":""NS_IDENT@1d12b024.TIMES_A_WEEK"",""pos"":{""lineNum"":2,""columnNum"":22,""endLineNum"":2,""endColumnNum"":33,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@70abf9b0"",""NS_IDENT@1d12b024""],""fromNode"":{""id"":""OP_JOIN@72ed9aad"",""value"":""LEFT"",""pos"":{""lineNum"":3,""columnNum"":29,""endLineNum"":3,""endColumnNum"":32,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@6872f9c8"",""value"":""NS_IDENT@70abf9b0"",""pos"":{""lineNum"":3,""columnNum"":10,""endLineNum"":3,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@52a36910"",""value"":""NS_IDENT@1d12b024"",""pos"":{""lineNum"":3,""columnNum"":34,""endLineNum"":3,""endColumnNum"":42,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@3a4ba480"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":10,""endLineNum"":4,""endColumnNum"":41,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@392a04e7"",""value"":""NS_IDENT@70abf9b0.name"",""pos"":{""lineNum"":4,""columnNum"":10,""endLineNum"":4,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@76075d65"",""value"":""NS_IDENT@1d12b024.drinker"",""pos"":{""lineNum"":4,""columnNum"":25,""endLineNum"":4,""endColumnNum"":41,""quoted"":false},""children"":[]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@1e9804b9"",""value"":""NS_IDENT@1d12b024.TIMES_A_WEEK"",""pos"":{""lineNum"":2,""columnNum"":22,""endLineNum"":2,""endColumnNum"":33,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@248deced"",""value"":""NS_IDENT@1d12b024.BAR"",""pos"":{""lineNum"":2,""columnNum"":17,""endLineNum"":2,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@76075d65"",""value"":""NS_IDENT@1d12b024.drinker"",""pos"":{""lineNum"":4,""columnNum"":25,""endLineNum"":4,""endColumnNum"":41,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@43effd89"",""value"":""NS_IDENT@70abf9b0.NAME"",""pos"":{""lineNum"":2,""columnNum"":11,""endLineNum"":2,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@392a04e7"",""value"":""NS_IDENT@70abf9b0.name"",""pos"":{""lineNum"":4,""columnNum"":10,""endLineNum"":4,""endColumnNum"":21,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":4,""endLineNum"":4,""endColumnNum"":41,""quoted"":false},""children"":{}}]}
"
