"select d1.name as drinker1, d2.name as drinker2
from drinker d1, drinker d2
where d1.name <> d2.name
except
(with temp1 as (select likes.drinker as drinker1, likes.beer as beer1, drinker.name as drinker2 from likes, drinker),
     temp2 as (select drinker.name as drinker, beer.name as beer from drinker, beer except select* from likes)
select temp1.drinker1 as drinker1, temp1.drinker2 as drinkers
from temp1, temp2
where temp1.beer1 = temp2.beer
  and temp1.drinker2 = temp2.drinker)
","{""failed"":true,""errorMsg"":""class org.apache.calcite.sql.SqlNodeList cannot be cast to class org.apache.calcite.sql.SqlCall (org.apache.calcite.sql.SqlNodeList and org.apache.calcite.sql.SqlCall are in unnamed module of loader 'app')""}
"
"WITH pairs as (SELECT d1.name as drinker1, d2.name as drinker2 FROM drinker d1, drinker d2 WHERE d1.name <> d2.name),
  names as (SELECT name as drinker FROM drinker),
  dislikes as (SELECT drinker, beer.name as beer FROM names, beer EXCEPT SELECT * FROM likes)
  
SELECT *
FROM pairs

EXCEPT 

SELECT likes.drinker as drinker1, dislikes.drinker as drinker2
FROM likes, dislikes 
WHERE likes.beer = dislikes.beer;","{""blocks"":{""id"":""BLOCK_SETOP@3e850122"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@27fde870"",""rightBlockId"":""BLOCK_SELECT@5ac7aa18"",""pos"":{""lineNum"":5,""columnNum"":1,""endLineNum"":12,""endColumnNum"":32,""quoted"":false},""children"":{""BLOCK_SELECT@27fde870"":{""id"":""BLOCK_SELECT@27fde870"",""parentId"":""BLOCK_SETOP@3e850122"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@4a0df195"",""value"":""*"",""pos"":{""lineNum"":5,""columnNum"":8,""endLineNum"":5,""endColumnNum"":8,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@3fae596""],""fromNode"":{""id"":""JOIN_OPERAND@2b4c3c29"",""value"":""NS_IDENT@3fae596"",""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":10,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":5,""columnNum"":1,""endLineNum"":6,""endColumnNum"":10,""quoted"":false},""children"":{}},""BLOCK_SELECT@5ac7aa18"":{""id"":""BLOCK_SELECT@5ac7aa18"",""parentId"":""BLOCK_SETOP@3e850122"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@5da7cee2"",""value"":""NS_IDENT@42fcc7e6.DRINKER"",""pos"":{""lineNum"":10,""columnNum"":8,""endLineNum"":10,""endColumnNum"":20,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@2e3cdec2"",""value"":""NS_IDENT@9255c05.DRINKER"",""pos"":{""lineNum"":10,""columnNum"":35,""endLineNum"":10,""endColumnNum"":50,""quoted"":false},""children"":[],""alias"":""DRINKER2""}],""fromItemIds"":[""NS_IDENT@42fcc7e6"",""NS_IDENT@9255c05""],""fromNode"":{""id"":""OP_JOIN@4cdd2c73"",""value"":""COMMA"",""pos"":{""lineNum"":11,""columnNum"":11,""endLineNum"":11,""endColumnNum"":11,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@4abf3f0"",""value"":""NS_IDENT@42fcc7e6"",""pos"":{""lineNum"":11,""columnNum"":6,""endLineNum"":11,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@4e4c3a38"",""value"":""NS_IDENT@9255c05"",""pos"":{""lineNum"":11,""columnNum"":13,""endLineNum"":11,""endColumnNum"":20,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@2b556bb2"",""value"":""="",""pos"":{""lineNum"":12,""columnNum"":7,""endLineNum"":12,""endColumnNum"":32,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@287f7811"",""value"":""NS_IDENT@42fcc7e6.beer"",""pos"":{""lineNum"":12,""columnNum"":7,""endLineNum"":12,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@451f87af"",""value"":""NS_IDENT@9255c05.BEER"",""pos"":{""lineNum"":12,""columnNum"":20,""endLineNum"":12,""endColumnNum"":32,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@287f7811"",""value"":""NS_IDENT@42fcc7e6.beer"",""pos"":{""lineNum"":12,""columnNum"":7,""endLineNum"":12,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5da7cee2"",""value"":""NS_IDENT@42fcc7e6.DRINKER"",""pos"":{""lineNum"":10,""columnNum"":8,""endLineNum"":10,""endColumnNum"":20,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@451f87af"",""value"":""NS_IDENT@9255c05.BEER"",""pos"":{""lineNum"":12,""columnNum"":20,""endLineNum"":12,""endColumnNum"":32,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2e3cdec2"",""value"":""NS_IDENT@9255c05.DRINKER"",""pos"":{""lineNum"":10,""columnNum"":35,""endLineNum"":10,""endColumnNum"":50,""quoted"":false},""children"":[],""alias"":""DRINKER2""}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":10,""columnNum"":1,""endLineNum"":12,""endColumnNum"":32,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@3b36e000"":{""tableId"":""NS_IDENT@3b36e000"",""identifier"":""BEER"",""dbTableName"":""BEER"",""fields"":[""name VARCHAR(100)"",""brewer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":62,""endLineNum"":3,""endColumnNum"":65,""quoted"":false}},""NS_IDENT@6dcd5639"":{""tableId"":""NS_IDENT@6dcd5639"",""identifier"":""NAMES"",""dbTableName"":""NAMES"",""fields"":[""DRINKER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":55,""endLineNum"":3,""endColumnNum"":59,""quoted"":false}},""NS_IDENT@6d4c273c"":{""tableId"":""NS_IDENT@6d4c273c"",""identifier"":""D1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":69,""endLineNum"":1,""endColumnNum"":78,""quoted"":false}},""NS_IDENT@3fae596"":{""tableId"":""NS_IDENT@3fae596"",""identifier"":""PAIRS"",""dbTableName"":""PAIRS"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":10,""quoted"":false}},""NS_IDENT@42fcc7e6"":{""tableId"":""NS_IDENT@42fcc7e6"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":11,""columnNum"":6,""endLineNum"":11,""endColumnNum"":10,""quoted"":false}},""NS_IDENT@9255c05"":{""tableId"":""NS_IDENT@9255c05"",""identifier"":""DISLIKES"",""dbTableName"":""DISLIKES"",""fields"":[""DRINKER VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":11,""columnNum"":13,""endLineNum"":11,""endColumnNum"":20,""quoted"":false}},""NS_IDENT@5bca7664"":{""tableId"":""NS_IDENT@5bca7664"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":88,""endLineNum"":3,""endColumnNum"":92,""quoted"":false}},""NS_IDENT@2ba33e2c"":{""tableId"":""NS_IDENT@2ba33e2c"",""identifier"":""DRINKER"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":41,""endLineNum"":2,""endColumnNum"":47,""quoted"":false}},""NS_IDENT@27b000f7"":{""tableId"":""NS_IDENT@27b000f7"",""identifier"":""D2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":81,""endLineNum"":1,""endColumnNum"":90,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@4bff2185"",""alias"":""PAIRS"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@64bfd6fd"",""value"":""NS_IDENT@6d4c273c.NAME"",""pos"":{""lineNum"":1,""columnNum"":23,""endLineNum"":1,""endColumnNum"":29,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@253b380a"",""value"":""NS_IDENT@27b000f7.NAME"",""pos"":{""lineNum"":1,""columnNum"":44,""endLineNum"":1,""endColumnNum"":50,""quoted"":false},""children"":[],""alias"":""DRINKER2""}],""fromItemIds"":[""NS_IDENT@6d4c273c"",""NS_IDENT@27b000f7""],""fromNode"":{""id"":""OP_JOIN@458544e0"",""value"":""COMMA"",""pos"":{""lineNum"":1,""columnNum"":79,""endLineNum"":1,""endColumnNum"":79,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@47b2e9e1"",""value"":""NS_IDENT@6d4c273c"",""pos"":{""lineNum"":1,""columnNum"":69,""endLineNum"":1,""endColumnNum"":75,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@25b865b5"",""value"":""NS_IDENT@27b000f7"",""pos"":{""lineNum"":1,""columnNum"":81,""endLineNum"":1,""endColumnNum"":87,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@2532b351"",""value"":""<>"",""pos"":{""lineNum"":1,""columnNum"":98,""endLineNum"":1,""endColumnNum"":115,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@746cd757"",""value"":""NS_IDENT@6d4c273c.name"",""pos"":{""lineNum"":1,""columnNum"":98,""endLineNum"":1,""endColumnNum"":104,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2bf94401"",""value"":""NS_IDENT@27b000f7.name"",""pos"":{""lineNum"":1,""columnNum"":109,""endLineNum"":1,""endColumnNum"":115,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@253b380a"",""value"":""NS_IDENT@27b000f7.NAME"",""pos"":{""lineNum"":1,""columnNum"":44,""endLineNum"":1,""endColumnNum"":50,""quoted"":false},""children"":[],""alias"":""DRINKER2""},{""id"":""COLUMN_LOCAL@2bf94401"",""value"":""NS_IDENT@27b000f7.name"",""pos"":{""lineNum"":1,""columnNum"":109,""endLineNum"":1,""endColumnNum"":115,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@64bfd6fd"",""value"":""NS_IDENT@6d4c273c.NAME"",""pos"":{""lineNum"":1,""columnNum"":23,""endLineNum"":1,""endColumnNum"":29,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@746cd757"",""value"":""NS_IDENT@6d4c273c.name"",""pos"":{""lineNum"":1,""columnNum"":98,""endLineNum"":1,""endColumnNum"":104,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":115,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@4f20a5e0"",""alias"":""NAMES"",""fields"":[""DRINKER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@1f193686"",""value"":""NS_IDENT@2ba33e2c.NAME"",""pos"":{""lineNum"":2,""columnNum"":20,""endLineNum"":2,""endColumnNum"":23,""quoted"":false},""children"":[],""alias"":""DRINKER""}],""fromItemIds"":[""NS_IDENT@2ba33e2c""],""fromNode"":{""id"":""JOIN_OPERAND@2fe88a09"",""value"":""NS_IDENT@2ba33e2c"",""pos"":{""lineNum"":2,""columnNum"":41,""endLineNum"":2,""endColumnNum"":47,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@1f193686"",""value"":""NS_IDENT@2ba33e2c.NAME"",""pos"":{""lineNum"":2,""columnNum"":20,""endLineNum"":2,""endColumnNum"":23,""quoted"":false},""children"":[],""alias"":""DRINKER""}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":13,""endLineNum"":2,""endColumnNum"":47,""quoted"":false},""children"":{}},{""id"":""BLOCK_SETOP@2bcec6a6"",""alias"":""DISLIKES"",""fields"":[""DRINKER VARCHAR(100)"",""BEER VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@77a281fc"",""rightBlockId"":""BLOCK_SELECT@151335cb"",""pos"":{""lineNum"":3,""columnNum"":16,""endLineNum"":3,""endColumnNum"":92,""quoted"":false},""children"":{""BLOCK_SELECT@77a281fc"":{""id"":""BLOCK_SELECT@77a281fc"",""parentId"":""BLOCK_SETOP@2bcec6a6"",""fields"":[""DRINKER VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@333cb916"",""value"":""NS_IDENT@6dcd5639.DRINKER"",""pos"":{""lineNum"":3,""columnNum"":23,""endLineNum"":3,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1d25c1c"",""value"":""NS_IDENT@3b36e000.NAME"",""pos"":{""lineNum"":3,""columnNum"":32,""endLineNum"":3,""endColumnNum"":40,""quoted"":false},""children"":[],""alias"":""BEER""}],""fromItemIds"":[""NS_IDENT@6dcd5639"",""NS_IDENT@3b36e000""],""fromNode"":{""id"":""OP_JOIN@4912d525"",""value"":""COMMA"",""pos"":{""lineNum"":3,""columnNum"":60,""endLineNum"":3,""endColumnNum"":60,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@2bfbffb2"",""value"":""NS_IDENT@6dcd5639"",""pos"":{""lineNum"":3,""columnNum"":55,""endLineNum"":3,""endColumnNum"":59,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@765df79d"",""value"":""NS_IDENT@3b36e000"",""pos"":{""lineNum"":3,""columnNum"":62,""endLineNum"":3,""endColumnNum"":65,""quoted"":false},""children"":[]}],""natural"":false},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@333cb916"",""value"":""NS_IDENT@6dcd5639.DRINKER"",""pos"":{""lineNum"":3,""columnNum"":23,""endLineNum"":3,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1d25c1c"",""value"":""NS_IDENT@3b36e000.NAME"",""pos"":{""lineNum"":3,""columnNum"":32,""endLineNum"":3,""endColumnNum"":40,""quoted"":false},""children"":[],""alias"":""BEER""}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":16,""endLineNum"":3,""endColumnNum"":65,""quoted"":false},""children"":{}},""BLOCK_SELECT@151335cb"":{""id"":""BLOCK_SELECT@151335cb"",""parentId"":""BLOCK_SETOP@2bcec6a6"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@105b693d"",""value"":""*"",""pos"":{""lineNum"":3,""columnNum"":81,""endLineNum"":3,""endColumnNum"":81,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@5bca7664""],""fromNode"":{""id"":""JOIN_OPERAND@4a7761b1"",""value"":""NS_IDENT@5bca7664"",""pos"":{""lineNum"":3,""columnNum"":88,""endLineNum"":3,""endColumnNum"":92,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":74,""endLineNum"":3,""endColumnNum"":92,""quoted"":false},""children"":{}}}}]}
"
"WITH 
drinkerPairs AS 
(SELECT d1.name drinker1, d2.name drinker2
FROM drinker d1, drinker d2
WHERE d1.name <> d2.name),

oneReal AS
(SELECT drinker1, drinker2, beer
FROM drinkerPairs, likes
WHERE drinker1 = drinker),

twoReal AS
(SELECT drinker1, drinker2, beer
FROM drinkerPairs, likes
WHERE drinker2 = drinker), 

diff AS
(SELECT DISTINCT drinker1, drinker2
FROM
((SELECT * FROM oneReal)
EXCEPT
(SELECT * FROM twoReal)) AS temp
)

((SELECT * FROM drinkerPairs)
EXCEPT
(SELECT * FROM diff));","{""blocks"":{""id"":""BLOCK_SETOP@57c88764"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@78faea5f"",""rightBlockId"":""BLOCK_SELECT@5e39850"",""pos"":{""lineNum"":25,""columnNum"":3,""endLineNum"":27,""endColumnNum"":19,""quoted"":false},""children"":{""BLOCK_SELECT@5e39850"":{""id"":""BLOCK_SELECT@5e39850"",""parentId"":""BLOCK_SETOP@57c88764"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@35088e87"",""value"":""*"",""pos"":{""lineNum"":27,""columnNum"":9,""endLineNum"":27,""endColumnNum"":9,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@314ed053""],""fromNode"":{""id"":""JOIN_OPERAND@1603dc2f"",""value"":""NS_IDENT@314ed053"",""pos"":{""lineNum"":27,""columnNum"":16,""endLineNum"":27,""endColumnNum"":19,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":27,""columnNum"":2,""endLineNum"":27,""endColumnNum"":19,""quoted"":false},""children"":{}},""BLOCK_SELECT@78faea5f"":{""id"":""BLOCK_SELECT@78faea5f"",""parentId"":""BLOCK_SETOP@57c88764"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@54aca26f"",""value"":""*"",""pos"":{""lineNum"":25,""columnNum"":10,""endLineNum"":25,""endColumnNum"":10,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@58a4a74d""],""fromNode"":{""id"":""JOIN_OPERAND@37fdfb05"",""value"":""NS_IDENT@58a4a74d"",""pos"":{""lineNum"":25,""columnNum"":17,""endLineNum"":25,""endColumnNum"":28,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":25,""columnNum"":3,""endLineNum"":25,""endColumnNum"":28,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@ec1b2e4"":{""tableId"":""NS_IDENT@ec1b2e4"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":14,""columnNum"":20,""endLineNum"":14,""endColumnNum"":24,""quoted"":false}},""NS_SETOP@b18c4"":{""tableId"":""NS_SETOP@b18c4"",""identifier"":""TEMP"",""blockId"":""BLOCK_SETOP@4cdd2c73"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":20,""columnNum"":3,""endLineNum"":22,""endColumnNum"":22,""quoted"":false}},""NS_IDENT@58a4a74d"":{""tableId"":""NS_IDENT@58a4a74d"",""identifier"":""DRINKERPAIRS"",""dbTableName"":""DRINKERPAIRS"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":25,""columnNum"":17,""endLineNum"":25,""endColumnNum"":28,""quoted"":false}},""NS_IDENT@314ed053"":{""tableId"":""NS_IDENT@314ed053"",""identifier"":""DIFF"",""dbTableName"":""DIFF"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":27,""columnNum"":16,""endLineNum"":27,""endColumnNum"":19,""quoted"":false}},""NS_IDENT@105b693d"":{""tableId"":""NS_IDENT@105b693d"",""identifier"":""D1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":6,""endLineNum"":4,""endColumnNum"":15,""quoted"":false}},""NS_IDENT@3daa82be"":{""tableId"":""NS_IDENT@3daa82be"",""identifier"":""DRINKERPAIRS"",""dbTableName"":""DRINKERPAIRS"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":14,""columnNum"":6,""endLineNum"":14,""endColumnNum"":17,""quoted"":false}},""NS_IDENT@73017a80"":{""tableId"":""NS_IDENT@73017a80"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":9,""columnNum"":20,""endLineNum"":9,""endColumnNum"":24,""quoted"":false}},""NS_IDENT@9255c05"":{""tableId"":""NS_IDENT@9255c05"",""identifier"":""D2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":18,""endLineNum"":4,""endColumnNum"":27,""quoted"":false}},""NS_IDENT@4d48bd85"":{""tableId"":""NS_IDENT@4d48bd85"",""identifier"":""TWOREAL"",""dbTableName"":""TWOREAL"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":22,""columnNum"":16,""endLineNum"":22,""endColumnNum"":22,""quoted"":false}},""NS_IDENT@7ad54c55"":{""tableId"":""NS_IDENT@7ad54c55"",""identifier"":""DRINKERPAIRS"",""dbTableName"":""DRINKERPAIRS"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":9,""columnNum"":6,""endLineNum"":9,""endColumnNum"":17,""quoted"":false}},""NS_IDENT@597f48df"":{""tableId"":""NS_IDENT@597f48df"",""identifier"":""ONEREAL"",""dbTableName"":""ONEREAL"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":20,""columnNum"":17,""endLineNum"":20,""endColumnNum"":23,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@2f879bab"",""alias"":""DRINKERPAIRS"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@78830d9a"",""value"":""NS_IDENT@105b693d.NAME"",""pos"":{""lineNum"":3,""columnNum"":9,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@7f829c76"",""value"":""NS_IDENT@9255c05.NAME"",""pos"":{""lineNum"":3,""columnNum"":27,""endLineNum"":3,""endColumnNum"":33,""quoted"":false},""children"":[],""alias"":""DRINKER2""}],""fromItemIds"":[""NS_IDENT@105b693d"",""NS_IDENT@9255c05""],""fromNode"":{""id"":""OP_JOIN@1d207fad"",""value"":""COMMA"",""pos"":{""lineNum"":4,""columnNum"":16,""endLineNum"":4,""endColumnNum"":16,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@488b50ec"",""value"":""NS_IDENT@105b693d"",""pos"":{""lineNum"":4,""columnNum"":6,""endLineNum"":4,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@6d2d99fc"",""value"":""NS_IDENT@9255c05"",""pos"":{""lineNum"":4,""columnNum"":18,""endLineNum"":4,""endColumnNum"":24,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@3b0ee03a"",""value"":""<>"",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":5,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@65fd6708"",""value"":""NS_IDENT@105b693d.name"",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":5,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@b967222"",""value"":""NS_IDENT@9255c05.name"",""pos"":{""lineNum"":5,""columnNum"":18,""endLineNum"":5,""endColumnNum"":24,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@65fd6708"",""value"":""NS_IDENT@105b693d.name"",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":5,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@b967222"",""value"":""NS_IDENT@9255c05.name"",""pos"":{""lineNum"":5,""columnNum"":18,""endLineNum"":5,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7f829c76"",""value"":""NS_IDENT@9255c05.NAME"",""pos"":{""lineNum"":3,""columnNum"":27,""endLineNum"":3,""endColumnNum"":33,""quoted"":false},""children"":[],""alias"":""DRINKER2""},{""id"":""COLUMN_LOCAL@78830d9a"",""value"":""NS_IDENT@105b693d.NAME"",""pos"":{""lineNum"":3,""columnNum"":9,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[],""alias"":""DRINKER1""}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":2,""endLineNum"":5,""endColumnNum"":24,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@6df7988f"",""alias"":""ONEREAL"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@6ae7deac"",""value"":""NS_IDENT@7ad54c55.DRINKER1"",""pos"":{""lineNum"":8,""columnNum"":9,""endLineNum"":8,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1a3e5f23"",""value"":""NS_IDENT@7ad54c55.DRINKER2"",""pos"":{""lineNum"":8,""columnNum"":19,""endLineNum"":8,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@365553de"",""value"":""NS_IDENT@73017a80.BEER"",""pos"":{""lineNum"":8,""columnNum"":29,""endLineNum"":8,""endColumnNum"":32,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@7ad54c55"",""NS_IDENT@73017a80""],""fromNode"":{""id"":""OP_JOIN@27b22f74"",""value"":""COMMA"",""pos"":{""lineNum"":9,""columnNum"":18,""endLineNum"":9,""endColumnNum"":18,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@21fff664"",""value"":""NS_IDENT@7ad54c55"",""pos"":{""lineNum"":9,""columnNum"":6,""endLineNum"":9,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@6079cf5"",""value"":""NS_IDENT@73017a80"",""pos"":{""lineNum"":9,""columnNum"":20,""endLineNum"":9,""endColumnNum"":24,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@6fd1660"",""value"":""="",""pos"":{""lineNum"":10,""columnNum"":7,""endLineNum"":10,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@2a27cb34"",""value"":""NS_IDENT@7ad54c55.DRINKER1"",""pos"":{""lineNum"":10,""columnNum"":7,""endLineNum"":10,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6892cc6f"",""value"":""NS_IDENT@73017a80.drinker"",""pos"":{""lineNum"":10,""columnNum"":18,""endLineNum"":10,""endColumnNum"":24,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@6ae7deac"",""value"":""NS_IDENT@7ad54c55.DRINKER1"",""pos"":{""lineNum"":8,""columnNum"":9,""endLineNum"":8,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@365553de"",""value"":""NS_IDENT@73017a80.BEER"",""pos"":{""lineNum"":8,""columnNum"":29,""endLineNum"":8,""endColumnNum"":32,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6892cc6f"",""value"":""NS_IDENT@73017a80.drinker"",""pos"":{""lineNum"":10,""columnNum"":18,""endLineNum"":10,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1a3e5f23"",""value"":""NS_IDENT@7ad54c55.DRINKER2"",""pos"":{""lineNum"":8,""columnNum"":19,""endLineNum"":8,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2a27cb34"",""value"":""NS_IDENT@7ad54c55.DRINKER1"",""pos"":{""lineNum"":10,""columnNum"":7,""endLineNum"":10,""endColumnNum"":14,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":8,""columnNum"":2,""endLineNum"":10,""endColumnNum"":24,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@30cecdca"",""alias"":""TWOREAL"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@29a69a35"",""value"":""NS_IDENT@3daa82be.DRINKER1"",""pos"":{""lineNum"":13,""columnNum"":9,""endLineNum"":13,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@e344ad3"",""value"":""NS_IDENT@3daa82be.DRINKER2"",""pos"":{""lineNum"":13,""columnNum"":19,""endLineNum"":13,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@108bdbd8"",""value"":""NS_IDENT@ec1b2e4.BEER"",""pos"":{""lineNum"":13,""columnNum"":29,""endLineNum"":13,""endColumnNum"":32,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@3daa82be"",""NS_IDENT@ec1b2e4""],""fromNode"":{""id"":""OP_JOIN@6edc4161"",""value"":""COMMA"",""pos"":{""lineNum"":14,""columnNum"":18,""endLineNum"":14,""endColumnNum"":18,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@5486887b"",""value"":""NS_IDENT@3daa82be"",""pos"":{""lineNum"":14,""columnNum"":6,""endLineNum"":14,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@5226e402"",""value"":""NS_IDENT@ec1b2e4"",""pos"":{""lineNum"":14,""columnNum"":20,""endLineNum"":14,""endColumnNum"":24,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@53e3a87a"",""value"":""="",""pos"":{""lineNum"":15,""columnNum"":7,""endLineNum"":15,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@2822c6ff"",""value"":""NS_IDENT@3daa82be.DRINKER2"",""pos"":{""lineNum"":15,""columnNum"":7,""endLineNum"":15,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4dafba3e"",""value"":""NS_IDENT@ec1b2e4.drinker"",""pos"":{""lineNum"":15,""columnNum"":18,""endLineNum"":15,""endColumnNum"":24,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@29a69a35"",""value"":""NS_IDENT@3daa82be.DRINKER1"",""pos"":{""lineNum"":13,""columnNum"":9,""endLineNum"":13,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@e344ad3"",""value"":""NS_IDENT@3daa82be.DRINKER2"",""pos"":{""lineNum"":13,""columnNum"":19,""endLineNum"":13,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4dafba3e"",""value"":""NS_IDENT@ec1b2e4.drinker"",""pos"":{""lineNum"":15,""columnNum"":18,""endLineNum"":15,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2822c6ff"",""value"":""NS_IDENT@3daa82be.DRINKER2"",""pos"":{""lineNum"":15,""columnNum"":7,""endLineNum"":15,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@108bdbd8"",""value"":""NS_IDENT@ec1b2e4.BEER"",""pos"":{""lineNum"":13,""columnNum"":29,""endLineNum"":13,""endColumnNum"":32,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":13,""columnNum"":2,""endLineNum"":15,""endColumnNum"":24,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@189b5fb1"",""alias"":""DIFF"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":true,""selectList"":[{""id"":""COLUMN_LOCAL@58a120b0"",""value"":""NS_SETOP@b18c4.DRINKER1"",""pos"":{""lineNum"":18,""columnNum"":18,""endLineNum"":18,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2ff95fc6"",""value"":""NS_SETOP@b18c4.DRINKER2"",""pos"":{""lineNum"":18,""columnNum"":28,""endLineNum"":18,""endColumnNum"":35,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_SETOP@b18c4""],""fromNode"":{""id"":""JOIN_OPERAND@4cdd2c73"",""value"":""BLOCK_SETOP@4cdd2c73"",""pos"":{""lineNum"":20,""columnNum"":3,""endLineNum"":22,""endColumnNum"":22,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@2ff95fc6"",""value"":""NS_SETOP@b18c4.DRINKER2"",""pos"":{""lineNum"":18,""columnNum"":28,""endLineNum"":18,""endColumnNum"":35,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@58a120b0"",""value"":""NS_SETOP@b18c4.DRINKER1"",""pos"":{""lineNum"":18,""columnNum"":18,""endLineNum"":18,""endColumnNum"":25,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":18,""columnNum"":2,""endLineNum"":22,""endColumnNum"":32,""quoted"":false},""children"":{""BLOCK_SETOP@4cdd2c73"":{""id"":""BLOCK_SETOP@4cdd2c73"",""parentId"":""BLOCK_SELECT@189b5fb1"",""alias"":""TEMP"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@4abf3f0"",""rightBlockId"":""BLOCK_SELECT@293cde83"",""pos"":{""lineNum"":20,""columnNum"":3,""endLineNum"":22,""endColumnNum"":22,""quoted"":false},""children"":{""BLOCK_SELECT@4abf3f0"":{""id"":""BLOCK_SELECT@4abf3f0"",""parentId"":""BLOCK_SETOP@4cdd2c73"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@15dd5ac2"",""value"":""*"",""pos"":{""lineNum"":20,""columnNum"":10,""endLineNum"":20,""endColumnNum"":10,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@597f48df""],""fromNode"":{""id"":""JOIN_OPERAND@4e4c3a38"",""value"":""NS_IDENT@597f48df"",""pos"":{""lineNum"":20,""columnNum"":17,""endLineNum"":20,""endColumnNum"":23,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":20,""columnNum"":3,""endLineNum"":20,""endColumnNum"":23,""quoted"":false},""children"":{}},""BLOCK_SELECT@293cde83"":{""id"":""BLOCK_SELECT@293cde83"",""parentId"":""BLOCK_SETOP@4cdd2c73"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@7bbbb6a8"",""value"":""*"",""pos"":{""lineNum"":22,""columnNum"":9,""endLineNum"":22,""endColumnNum"":9,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@4d48bd85""],""fromNode"":{""id"":""JOIN_OPERAND@c27d163"",""value"":""NS_IDENT@4d48bd85"",""pos"":{""lineNum"":22,""columnNum"":16,""endLineNum"":22,""endColumnNum"":22,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":22,""columnNum"":2,""endLineNum"":22,""endColumnNum"":22,""quoted"":false},""children"":{}}}}}}]}
"
"select d1.name as drinker1, d2.name as drinker2
  from drinker d1, drinker d2
  where d1.name <> d2.name
  
except

select l1.drinker as drinker1, l2.name as drinker2
  from likes l1, drinker l2
  where not exists (
    select likes.beer, likes.drinker
      from likes
      where likes.beer = l1.beer and likes.drinker = l2.name
  )
 
  
","{""blocks"":{""id"":""BLOCK_SETOP@3f36b447"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@65004ff6"",""rightBlockId"":""BLOCK_SELECT@319854f0"",""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":13,""endColumnNum"":3,""quoted"":false},""children"":{""BLOCK_SELECT@65004ff6"":{""id"":""BLOCK_SELECT@65004ff6"",""parentId"":""BLOCK_SETOP@3f36b447"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@3cbcd8f3"",""value"":""NS_IDENT@15bc339.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":14,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@9a2ec9b"",""value"":""NS_IDENT@205b132e.NAME"",""pos"":{""lineNum"":1,""columnNum"":29,""endLineNum"":1,""endColumnNum"":35,""quoted"":false},""children"":[],""alias"":""DRINKER2""}],""fromItemIds"":[""NS_IDENT@15bc339"",""NS_IDENT@205b132e""],""fromNode"":{""id"":""OP_JOIN@383f1975"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":18,""endLineNum"":2,""endColumnNum"":18,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@773c0293"",""value"":""NS_IDENT@15bc339"",""pos"":{""lineNum"":2,""columnNum"":8,""endLineNum"":2,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@1a5f7e7c"",""value"":""NS_IDENT@205b132e"",""pos"":{""lineNum"":2,""columnNum"":20,""endLineNum"":2,""endColumnNum"":26,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@4390f46e"",""value"":""<>"",""pos"":{""lineNum"":3,""columnNum"":9,""endLineNum"":3,""endColumnNum"":26,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5af97169"",""value"":""NS_IDENT@15bc339.name"",""pos"":{""lineNum"":3,""columnNum"":9,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@121c54fa"",""value"":""NS_IDENT@205b132e.name"",""pos"":{""lineNum"":3,""columnNum"":20,""endLineNum"":3,""endColumnNum"":26,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@9a2ec9b"",""value"":""NS_IDENT@205b132e.NAME"",""pos"":{""lineNum"":1,""columnNum"":29,""endLineNum"":1,""endColumnNum"":35,""quoted"":false},""children"":[],""alias"":""DRINKER2""},{""id"":""COLUMN_LOCAL@5af97169"",""value"":""NS_IDENT@15bc339.name"",""pos"":{""lineNum"":3,""columnNum"":9,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@121c54fa"",""value"":""NS_IDENT@205b132e.name"",""pos"":{""lineNum"":3,""columnNum"":20,""endLineNum"":3,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3cbcd8f3"",""value"":""NS_IDENT@15bc339.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":14,""quoted"":false},""children"":[],""alias"":""DRINKER1""}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":3,""endColumnNum"":26,""quoted"":false},""children"":{}},""BLOCK_SELECT@319854f0"":{""id"":""BLOCK_SELECT@319854f0"",""parentId"":""BLOCK_SETOP@3f36b447"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@6a84bc3f"",""value"":""NS_IDENT@7ec25216.DRINKER"",""pos"":{""lineNum"":7,""columnNum"":8,""endLineNum"":7,""endColumnNum"":17,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@4930539b"",""value"":""NS_IDENT@7cab1508.NAME"",""pos"":{""lineNum"":7,""columnNum"":32,""endLineNum"":7,""endColumnNum"":38,""quoted"":false},""children"":[],""alias"":""DRINKER2""}],""fromItemIds"":[""NS_IDENT@7ec25216"",""NS_IDENT@7cab1508""],""fromNode"":{""id"":""OP_JOIN@1965539b"",""value"":""COMMA"",""pos"":{""lineNum"":8,""columnNum"":16,""endLineNum"":8,""endColumnNum"":16,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@2fc07784"",""value"":""NS_IDENT@7ec25216"",""pos"":{""lineNum"":8,""columnNum"":8,""endLineNum"":8,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@353efdbf"",""value"":""NS_IDENT@7cab1508"",""pos"":{""lineNum"":8,""columnNum"":18,""endLineNum"":8,""endColumnNum"":24,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_PREFIX@6e91893"",""value"":""NOT"",""pos"":{""lineNum"":9,""columnNum"":9,""endLineNum"":12,""endColumnNum"":60,""quoted"":false},""children"":[{""id"":""OP_PREFIX@66ec9390"",""value"":""EXISTS"",""pos"":{""lineNum"":9,""columnNum"":13,""endLineNum"":12,""endColumnNum"":60,""quoted"":false},""children"":[{""id"":""BLOCK_SELECT@748fe51d"",""value"":""BLOCK_SELECT@748fe51d"",""pos"":{""lineNum"":10,""columnNum"":5,""endLineNum"":12,""endColumnNum"":60,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@6a84bc3f"",""value"":""NS_IDENT@7ec25216.DRINKER"",""pos"":{""lineNum"":7,""columnNum"":8,""endLineNum"":7,""endColumnNum"":17,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@4930539b"",""value"":""NS_IDENT@7cab1508.NAME"",""pos"":{""lineNum"":7,""columnNum"":32,""endLineNum"":7,""endColumnNum"":38,""quoted"":false},""children"":[],""alias"":""DRINKER2""}],""incomingIdentifiers"":[""NS_IDENT@7cab1508.name"",""NS_IDENT@7ec25216.beer""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":7,""columnNum"":1,""endLineNum"":13,""endColumnNum"":3,""quoted"":false},""children"":{""BLOCK_SELECT@748fe51d"":{""id"":""BLOCK_SELECT@748fe51d"",""parentId"":""BLOCK_SELECT@319854f0"",""fields"":[""BEER VARCHAR(100)"",""DRINKER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@54562ea6"",""value"":""NS_IDENT@22bd2039.BEER"",""pos"":{""lineNum"":10,""columnNum"":12,""endLineNum"":10,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1a35993f"",""value"":""NS_IDENT@22bd2039.DRINKER"",""pos"":{""lineNum"":10,""columnNum"":24,""endLineNum"":10,""endColumnNum"":36,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@22bd2039""],""fromNode"":{""id"":""JOIN_OPERAND@1ecfcbc9"",""value"":""NS_IDENT@22bd2039"",""pos"":{""lineNum"":11,""columnNum"":12,""endLineNum"":11,""endColumnNum"":16,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@2715644a"",""value"":""AND"",""pos"":{""lineNum"":12,""columnNum"":13,""endLineNum"":12,""endColumnNum"":60,""quoted"":false},""children"":[{""id"":""OP_BINARY@7a2e0858"",""value"":""="",""pos"":{""lineNum"":12,""columnNum"":13,""endLineNum"":12,""endColumnNum"":32,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@630d1b2f"",""value"":""NS_IDENT@22bd2039.beer"",""pos"":{""lineNum"":12,""columnNum"":13,""endLineNum"":12,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@746b18fd"",""value"":""NS_IDENT@7ec25216.beer"",""pos"":{""lineNum"":12,""columnNum"":26,""endLineNum"":12,""endColumnNum"":32,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@2df3c564"",""value"":""="",""pos"":{""lineNum"":12,""columnNum"":38,""endLineNum"":12,""endColumnNum"":60,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@aac3f4e"",""value"":""NS_IDENT@22bd2039.drinker"",""pos"":{""lineNum"":12,""columnNum"":38,""endLineNum"":12,""endColumnNum"":50,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@1f38957"",""value"":""NS_IDENT@7cab1508.name"",""pos"":{""lineNum"":12,""columnNum"":54,""endLineNum"":12,""endColumnNum"":60,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@aac3f4e"",""value"":""NS_IDENT@22bd2039.drinker"",""pos"":{""lineNum"":12,""columnNum"":38,""endLineNum"":12,""endColumnNum"":50,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@1f38957"",""value"":""NS_IDENT@7cab1508.name"",""pos"":{""lineNum"":12,""columnNum"":54,""endLineNum"":12,""endColumnNum"":60,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1a35993f"",""value"":""NS_IDENT@22bd2039.DRINKER"",""pos"":{""lineNum"":10,""columnNum"":24,""endLineNum"":10,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@54562ea6"",""value"":""NS_IDENT@22bd2039.BEER"",""pos"":{""lineNum"":10,""columnNum"":12,""endLineNum"":10,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@630d1b2f"",""value"":""NS_IDENT@22bd2039.beer"",""pos"":{""lineNum"":12,""columnNum"":13,""endLineNum"":12,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@746b18fd"",""value"":""NS_IDENT@7ec25216.beer"",""pos"":{""lineNum"":12,""columnNum"":26,""endLineNum"":12,""endColumnNum"":32,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@7cab1508"",""NS_IDENT@7ec25216""],""corrCtxIds"":[""BLOCK_SELECT@319854f0""],""pos"":{""lineNum"":10,""columnNum"":5,""endLineNum"":12,""endColumnNum"":60,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@7ec25216"":{""tableId"":""NS_IDENT@7ec25216"",""identifier"":""L1"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":8,""endLineNum"":8,""endColumnNum"":15,""quoted"":false}},""NS_IDENT@22bd2039"":{""tableId"":""NS_IDENT@22bd2039"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":11,""columnNum"":12,""endLineNum"":11,""endColumnNum"":16,""quoted"":false}},""NS_IDENT@15bc339"":{""tableId"":""NS_IDENT@15bc339"",""identifier"":""D1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":8,""endLineNum"":2,""endColumnNum"":17,""quoted"":false}},""NS_IDENT@205b132e"":{""tableId"":""NS_IDENT@205b132e"",""identifier"":""D2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":20,""endLineNum"":2,""endColumnNum"":29,""quoted"":false}},""NS_IDENT@7cab1508"":{""tableId"":""NS_IDENT@7cab1508"",""identifier"":""L2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":18,""endLineNum"":8,""endColumnNum"":27,""quoted"":false}}},""corrTables"":[""NS_IDENT@7ec25216"",""NS_IDENT@7cab1508""]}
"
"select a.name, b.name from drinker a, drinker b where NOT EXISTS ((select c.beer from likes c where a.name = c.drinker) EXCEPT (select l.beer from likes l where l.drinker = b.name)) and a.name <> b.name;","{""blocks"":{""id"":""BLOCK_SELECT@3f36b447"",""fields"":[""NAME VARCHAR(100)"",""NAME VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@352e787a"",""value"":""NS_IDENT@576c5536.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@15bc339"",""value"":""NS_IDENT@232cce0.NAME"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":21,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@576c5536"",""NS_IDENT@232cce0""],""fromNode"":{""id"":""OP_JOIN@529cfee5"",""value"":""COMMA"",""pos"":{""lineNum"":1,""columnNum"":37,""endLineNum"":1,""endColumnNum"":37,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@7ca0863b"",""value"":""NS_IDENT@576c5536"",""pos"":{""lineNum"":1,""columnNum"":28,""endLineNum"":1,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@319854f0"",""value"":""NS_IDENT@232cce0"",""pos"":{""lineNum"":1,""columnNum"":39,""endLineNum"":1,""endColumnNum"":45,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@48c3205a"",""value"":""AND"",""pos"":{""lineNum"":1,""columnNum"":55,""endLineNum"":1,""endColumnNum"":202,""quoted"":false},""children"":[{""id"":""OP_PREFIX@42435b98"",""value"":""NOT"",""pos"":{""lineNum"":1,""columnNum"":55,""endLineNum"":1,""endColumnNum"":179,""quoted"":false},""children"":[{""id"":""OP_PREFIX@6be25526"",""value"":""EXISTS"",""pos"":{""lineNum"":1,""columnNum"":59,""endLineNum"":1,""endColumnNum"":179,""quoted"":false},""children"":[{""id"":""BLOCK_SETOP@3eed0f5"",""value"":""BLOCK_SETOP@3eed0f5"",""pos"":{""lineNum"":1,""columnNum"":68,""endLineNum"":1,""endColumnNum"":179,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@2a22ad2b"",""value"":""<>"",""pos"":{""lineNum"":1,""columnNum"":187,""endLineNum"":1,""endColumnNum"":202,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@42e22a53"",""value"":""NS_IDENT@576c5536.name"",""pos"":{""lineNum"":1,""columnNum"":187,""endLineNum"":1,""endColumnNum"":192,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@70242f38"",""value"":""NS_IDENT@232cce0.name"",""pos"":{""lineNum"":1,""columnNum"":197,""endLineNum"":1,""endColumnNum"":202,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@15bc339"",""value"":""NS_IDENT@232cce0.NAME"",""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@42e22a53"",""value"":""NS_IDENT@576c5536.name"",""pos"":{""lineNum"":1,""columnNum"":187,""endLineNum"":1,""endColumnNum"":192,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@352e787a"",""value"":""NS_IDENT@576c5536.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@70242f38"",""value"":""NS_IDENT@232cce0.name"",""pos"":{""lineNum"":1,""columnNum"":197,""endLineNum"":1,""endColumnNum"":202,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@232cce0.name"",""NS_IDENT@576c5536.name""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":1,""endColumnNum"":202,""quoted"":false},""children"":{""BLOCK_SETOP@3eed0f5"":{""id"":""BLOCK_SETOP@3eed0f5"",""parentId"":""BLOCK_SELECT@3f36b447"",""fields"":[""BEER VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@64030b91"",""rightBlockId"":""BLOCK_SELECT@1a5f7e7c"",""pos"":{""lineNum"":1,""columnNum"":68,""endLineNum"":1,""endColumnNum"":179,""quoted"":false},""children"":{""BLOCK_SELECT@64030b91"":{""id"":""BLOCK_SELECT@64030b91"",""parentId"":""BLOCK_SETOP@3eed0f5"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@1948ea69"",""value"":""NS_IDENT@7fc645e4.BEER"",""pos"":{""lineNum"":1,""columnNum"":75,""endLineNum"":1,""endColumnNum"":80,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@7fc645e4""],""fromNode"":{""id"":""JOIN_OPERAND@66e889df"",""value"":""NS_IDENT@7fc645e4"",""pos"":{""lineNum"":1,""columnNum"":87,""endLineNum"":1,""endColumnNum"":91,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@3b0ee03a"",""value"":""="",""pos"":{""lineNum"":1,""columnNum"":101,""endLineNum"":1,""endColumnNum"":118,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@6a2eea2a"",""value"":""NS_IDENT@576c5536.name"",""pos"":{""lineNum"":1,""columnNum"":101,""endLineNum"":1,""endColumnNum"":106,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@b967222"",""value"":""NS_IDENT@7fc645e4.drinker"",""pos"":{""lineNum"":1,""columnNum"":110,""endLineNum"":1,""endColumnNum"":118,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@1948ea69"",""value"":""NS_IDENT@7fc645e4.BEER"",""pos"":{""lineNum"":1,""columnNum"":75,""endLineNum"":1,""endColumnNum"":80,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@6a2eea2a"",""value"":""NS_IDENT@576c5536.name"",""pos"":{""lineNum"":1,""columnNum"":101,""endLineNum"":1,""endColumnNum"":106,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@b967222"",""value"":""NS_IDENT@7fc645e4.drinker"",""pos"":{""lineNum"":1,""columnNum"":110,""endLineNum"":1,""endColumnNum"":118,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@576c5536""],""corrCtxIds"":[""BLOCK_SELECT@3f36b447""],""pos"":{""lineNum"":1,""columnNum"":68,""endLineNum"":1,""endColumnNum"":118,""quoted"":false},""children"":{}},""BLOCK_SELECT@1a5f7e7c"":{""id"":""BLOCK_SELECT@1a5f7e7c"",""parentId"":""BLOCK_SETOP@3eed0f5"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@12f8b1d8"",""value"":""NS_IDENT@719843e5.BEER"",""pos"":{""lineNum"":1,""columnNum"":136,""endLineNum"":1,""endColumnNum"":141,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@719843e5""],""fromNode"":{""id"":""JOIN_OPERAND@5b22b970"",""value"":""NS_IDENT@719843e5"",""pos"":{""lineNum"":1,""columnNum"":148,""endLineNum"":1,""endColumnNum"":152,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@aac3f4e"",""value"":""="",""pos"":{""lineNum"":1,""columnNum"":162,""endLineNum"":1,""endColumnNum"":179,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@746b18fd"",""value"":""NS_IDENT@719843e5.drinker"",""pos"":{""lineNum"":1,""columnNum"":162,""endLineNum"":1,""endColumnNum"":170,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@7a2e0858"",""value"":""NS_IDENT@232cce0.name"",""pos"":{""lineNum"":1,""columnNum"":174,""endLineNum"":1,""endColumnNum"":179,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@746b18fd"",""value"":""NS_IDENT@719843e5.drinker"",""pos"":{""lineNum"":1,""columnNum"":162,""endLineNum"":1,""endColumnNum"":170,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@7a2e0858"",""value"":""NS_IDENT@232cce0.name"",""pos"":{""lineNum"":1,""columnNum"":174,""endLineNum"":1,""endColumnNum"":179,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@12f8b1d8"",""value"":""NS_IDENT@719843e5.BEER"",""pos"":{""lineNum"":1,""columnNum"":136,""endLineNum"":1,""endColumnNum"":141,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@232cce0""],""corrCtxIds"":[""BLOCK_SELECT@3f36b447""],""pos"":{""lineNum"":1,""columnNum"":129,""endLineNum"":1,""endColumnNum"":179,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@232cce0"":{""tableId"":""NS_IDENT@232cce0"",""identifier"":""B"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":39,""endLineNum"":1,""endColumnNum"":47,""quoted"":false}},""NS_IDENT@7fc645e4"":{""tableId"":""NS_IDENT@7fc645e4"",""identifier"":""C"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":87,""endLineNum"":1,""endColumnNum"":93,""quoted"":false}},""NS_IDENT@576c5536"":{""tableId"":""NS_IDENT@576c5536"",""identifier"":""A"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":28,""endLineNum"":1,""endColumnNum"":36,""quoted"":false}},""NS_IDENT@719843e5"":{""tableId"":""NS_IDENT@719843e5"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":148,""endLineNum"":1,""endColumnNum"":154,""quoted"":false}}},""corrTables"":[""NS_IDENT@232cce0"",""NS_IDENT@576c5536""]}
"
"
WITH pairs AS
	(SELECT d1.name AS drinker1, d2.name AS drinker2
	FROM drinker d1, drinker d2
	WHERE d1.name <> d2.name)

SELECT p.drinker1, p.drinker2
FROM (
	(SELECT * from pairs)
	
	EXCEPT ALL
	
(
	SELECT first.drinker1, first.drinker2 
	FROM
	(

		(SELECT pairs.drinker1, pairs.drinker2, beer
		FROM pairs, likes
		WHERE pairs.drinker1 = likes.drinker)

		EXCEPT ALL

		(SELECT pairs.drinker1, pairs.drinker2, beer
		FROM pairs, likes
		WHERE pairs.drinker2 = likes.drinker)

	) as first
)

) as p;


","{""failed"":true}
"
"WITH persPair AS
(SELECT d1.name as drinker1, d2.name as drinker2
FROM drinker d1, drinker d2
WHERE d1.name <> d2.name), 
notLikes AS
(SELECT drinker1, drinker2, beer
FROM persPair
JOIN likes ON drinker1 = drinker 
EXCEPT
(SELECT drinker1, drinker2, beer
FROM persPair JOIN likes ON drinker2 = drinker 
))

SELECT drinker2, drinker1
FROM persPair
EXCEPT 
(SELECT drinker1, drinker2 FROM notLikes);","{""blocks"":{""id"":""BLOCK_SETOP@3e850122"",""fields"":[""DRINKER2 VARCHAR(100)"",""DRINKER1 VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@27fde870"",""rightBlockId"":""BLOCK_SELECT@5ac7aa18"",""pos"":{""lineNum"":14,""columnNum"":1,""endLineNum"":17,""endColumnNum"":40,""quoted"":false},""children"":{""BLOCK_SELECT@27fde870"":{""id"":""BLOCK_SELECT@27fde870"",""parentId"":""BLOCK_SETOP@3e850122"",""fields"":[""DRINKER2 VARCHAR(100)"",""DRINKER1 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@2bc9a775"",""value"":""NS_IDENT@545e57d7.DRINKER2"",""pos"":{""lineNum"":14,""columnNum"":8,""endLineNum"":14,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@42f9c19a"",""value"":""NS_IDENT@545e57d7.DRINKER1"",""pos"":{""lineNum"":14,""columnNum"":18,""endLineNum"":14,""endColumnNum"":25,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@545e57d7""],""fromNode"":{""id"":""JOIN_OPERAND@2b4c3c29"",""value"":""NS_IDENT@545e57d7"",""pos"":{""lineNum"":15,""columnNum"":6,""endLineNum"":15,""endColumnNum"":13,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@42f9c19a"",""value"":""NS_IDENT@545e57d7.DRINKER1"",""pos"":{""lineNum"":14,""columnNum"":18,""endLineNum"":14,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2bc9a775"",""value"":""NS_IDENT@545e57d7.DRINKER2"",""pos"":{""lineNum"":14,""columnNum"":8,""endLineNum"":14,""endColumnNum"":15,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":14,""columnNum"":1,""endLineNum"":15,""endColumnNum"":13,""quoted"":false},""children"":{}},""BLOCK_SELECT@5ac7aa18"":{""id"":""BLOCK_SELECT@5ac7aa18"",""parentId"":""BLOCK_SETOP@3e850122"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@253b380a"",""value"":""NS_IDENT@2ab2710.DRINKER1"",""pos"":{""lineNum"":17,""columnNum"":9,""endLineNum"":17,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3350ebdd"",""value"":""NS_IDENT@2ab2710.DRINKER2"",""pos"":{""lineNum"":17,""columnNum"":19,""endLineNum"":17,""endColumnNum"":26,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@2ab2710""],""fromNode"":{""id"":""JOIN_OPERAND@4cdd2c73"",""value"":""NS_IDENT@2ab2710"",""pos"":{""lineNum"":17,""columnNum"":33,""endLineNum"":17,""endColumnNum"":40,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@253b380a"",""value"":""NS_IDENT@2ab2710.DRINKER1"",""pos"":{""lineNum"":17,""columnNum"":9,""endLineNum"":17,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3350ebdd"",""value"":""NS_IDENT@2ab2710.DRINKER2"",""pos"":{""lineNum"":17,""columnNum"":19,""endLineNum"":17,""endColumnNum"":26,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":17,""columnNum"":2,""endLineNum"":17,""endColumnNum"":40,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@451f87af"":{""tableId"":""NS_IDENT@451f87af"",""identifier"":""D2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":27,""quoted"":false}},""NS_IDENT@8ed9cf"":{""tableId"":""NS_IDENT@8ed9cf"",""identifier"":""PERSPAIR"",""dbTableName"":""PERSPAIR"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":11,""columnNum"":6,""endLineNum"":11,""endColumnNum"":13,""quoted"":false}},""NS_IDENT@67c277a0"":{""tableId"":""NS_IDENT@67c277a0"",""identifier"":""PERSPAIR"",""dbTableName"":""PERSPAIR"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":6,""endLineNum"":7,""endColumnNum"":13,""quoted"":false}},""NS_IDENT@f72203"":{""tableId"":""NS_IDENT@f72203"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":11,""columnNum"":20,""endLineNum"":11,""endColumnNum"":24,""quoted"":false}},""NS_IDENT@2ab2710"":{""tableId"":""NS_IDENT@2ab2710"",""identifier"":""NOTLIKES"",""dbTableName"":""NOTLIKES"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":17,""columnNum"":33,""endLineNum"":17,""endColumnNum"":40,""quoted"":false}},""NS_IDENT@6fc3e1a4"":{""tableId"":""NS_IDENT@6fc3e1a4"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":6,""endLineNum"":8,""endColumnNum"":10,""quoted"":false}},""NS_IDENT@545e57d7"":{""tableId"":""NS_IDENT@545e57d7"",""identifier"":""PERSPAIR"",""dbTableName"":""PERSPAIR"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":15,""columnNum"":6,""endLineNum"":15,""endColumnNum"":13,""quoted"":false}},""NS_IDENT@57b75756"":{""tableId"":""NS_IDENT@57b75756"",""identifier"":""D1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":6,""endLineNum"":3,""endColumnNum"":15,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@5c20ffa8"",""alias"":""PERSPAIR"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@44cb460e"",""value"":""NS_IDENT@57b75756.NAME"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":15,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@2e3cdec2"",""value"":""NS_IDENT@451f87af.NAME"",""pos"":{""lineNum"":2,""columnNum"":30,""endLineNum"":2,""endColumnNum"":36,""quoted"":false},""children"":[],""alias"":""DRINKER2""}],""fromItemIds"":[""NS_IDENT@57b75756"",""NS_IDENT@451f87af""],""fromNode"":{""id"":""OP_JOIN@6bcbf05b"",""value"":""COMMA"",""pos"":{""lineNum"":3,""columnNum"":16,""endLineNum"":3,""endColumnNum"":16,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@59942b48"",""value"":""NS_IDENT@57b75756"",""pos"":{""lineNum"":3,""columnNum"":6,""endLineNum"":3,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@f9b5552"",""value"":""NS_IDENT@451f87af"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@127f9161"",""value"":""<>"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7f9ab969"",""value"":""NS_IDENT@57b75756.name"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@749ab7b4"",""value"":""NS_IDENT@451f87af.name"",""pos"":{""lineNum"":4,""columnNum"":18,""endLineNum"":4,""endColumnNum"":24,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@44cb460e"",""value"":""NS_IDENT@57b75756.NAME"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":15,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@7f9ab969"",""value"":""NS_IDENT@57b75756.name"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2e3cdec2"",""value"":""NS_IDENT@451f87af.NAME"",""pos"":{""lineNum"":2,""columnNum"":30,""endLineNum"":2,""endColumnNum"":36,""quoted"":false},""children"":[],""alias"":""DRINKER2""},{""id"":""COLUMN_LOCAL@749ab7b4"",""value"":""NS_IDENT@451f87af.name"",""pos"":{""lineNum"":4,""columnNum"":18,""endLineNum"":4,""endColumnNum"":24,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":2,""endLineNum"":4,""endColumnNum"":24,""quoted"":false},""children"":{}},{""id"":""BLOCK_SETOP@24097e9b"",""alias"":""NOTLIKES"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@5eb97ced"",""rightBlockId"":""BLOCK_SELECT@2bfbffb2"",""pos"":{""lineNum"":6,""columnNum"":2,""endLineNum"":11,""endColumnNum"":46,""quoted"":false},""children"":{""BLOCK_SELECT@5eb97ced"":{""id"":""BLOCK_SELECT@5eb97ced"",""parentId"":""BLOCK_SETOP@24097e9b"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@3fa76c61"",""value"":""NS_IDENT@67c277a0.DRINKER1"",""pos"":{""lineNum"":6,""columnNum"":9,""endLineNum"":6,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@59546cfe"",""value"":""NS_IDENT@67c277a0.DRINKER2"",""pos"":{""lineNum"":6,""columnNum"":19,""endLineNum"":6,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2d2acd89"",""value"":""NS_IDENT@6fc3e1a4.BEER"",""pos"":{""lineNum"":6,""columnNum"":29,""endLineNum"":6,""endColumnNum"":32,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@67c277a0"",""NS_IDENT@6fc3e1a4""],""fromNode"":{""id"":""OP_JOIN@68ba310d"",""value"":""INNER"",""pos"":{""lineNum"":8,""columnNum"":1,""endLineNum"":8,""endColumnNum"":4,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@77a281fc"",""value"":""NS_IDENT@67c277a0"",""pos"":{""lineNum"":7,""columnNum"":6,""endLineNum"":7,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@4912d525"",""value"":""NS_IDENT@6fc3e1a4"",""pos"":{""lineNum"":8,""columnNum"":6,""endLineNum"":8,""endColumnNum"":10,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@7207cb51"",""value"":""="",""pos"":{""lineNum"":8,""columnNum"":15,""endLineNum"":8,""endColumnNum"":32,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@35835fa"",""value"":""NS_IDENT@67c277a0.DRINKER1"",""pos"":{""lineNum"":8,""columnNum"":15,""endLineNum"":8,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@56f71edb"",""value"":""NS_IDENT@6fc3e1a4.drinker"",""pos"":{""lineNum"":8,""columnNum"":26,""endLineNum"":8,""endColumnNum"":32,""quoted"":false},""children"":[]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@2d2acd89"",""value"":""NS_IDENT@6fc3e1a4.BEER"",""pos"":{""lineNum"":6,""columnNum"":29,""endLineNum"":6,""endColumnNum"":32,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@56f71edb"",""value"":""NS_IDENT@6fc3e1a4.drinker"",""pos"":{""lineNum"":8,""columnNum"":26,""endLineNum"":8,""endColumnNum"":32,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@59546cfe"",""value"":""NS_IDENT@67c277a0.DRINKER2"",""pos"":{""lineNum"":6,""columnNum"":19,""endLineNum"":6,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3fa76c61"",""value"":""NS_IDENT@67c277a0.DRINKER1"",""pos"":{""lineNum"":6,""columnNum"":9,""endLineNum"":6,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@35835fa"",""value"":""NS_IDENT@67c277a0.DRINKER1"",""pos"":{""lineNum"":8,""columnNum"":15,""endLineNum"":8,""endColumnNum"":22,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":6,""columnNum"":2,""endLineNum"":8,""endColumnNum"":32,""quoted"":false},""children"":{}},""BLOCK_SELECT@2bfbffb2"":{""id"":""BLOCK_SELECT@2bfbffb2"",""parentId"":""BLOCK_SETOP@24097e9b"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@377008df"",""value"":""NS_IDENT@8ed9cf.DRINKER1"",""pos"":{""lineNum"":10,""columnNum"":9,""endLineNum"":10,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@22bb5646"",""value"":""NS_IDENT@8ed9cf.DRINKER2"",""pos"":{""lineNum"":10,""columnNum"":19,""endLineNum"":10,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2ce45a7b"",""value"":""NS_IDENT@f72203.BEER"",""pos"":{""lineNum"":10,""columnNum"":29,""endLineNum"":10,""endColumnNum"":32,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@8ed9cf"",""NS_IDENT@f72203""],""fromNode"":{""id"":""OP_JOIN@765df79d"",""value"":""INNER"",""pos"":{""lineNum"":11,""columnNum"":15,""endLineNum"":11,""endColumnNum"":18,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@151335cb"",""value"":""NS_IDENT@8ed9cf"",""pos"":{""lineNum"":11,""columnNum"":6,""endLineNum"":11,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@4a7761b1"",""value"":""NS_IDENT@f72203"",""pos"":{""lineNum"":11,""columnNum"":20,""endLineNum"":11,""endColumnNum"":24,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@f339eae"",""value"":""="",""pos"":{""lineNum"":11,""columnNum"":29,""endLineNum"":11,""endColumnNum"":46,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@546621c4"",""value"":""NS_IDENT@8ed9cf.DRINKER2"",""pos"":{""lineNum"":11,""columnNum"":29,""endLineNum"":11,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@621f89b8"",""value"":""NS_IDENT@f72203.drinker"",""pos"":{""lineNum"":11,""columnNum"":40,""endLineNum"":11,""endColumnNum"":46,""quoted"":false},""children"":[]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@546621c4"",""value"":""NS_IDENT@8ed9cf.DRINKER2"",""pos"":{""lineNum"":11,""columnNum"":29,""endLineNum"":11,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@377008df"",""value"":""NS_IDENT@8ed9cf.DRINKER1"",""pos"":{""lineNum"":10,""columnNum"":9,""endLineNum"":10,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@621f89b8"",""value"":""NS_IDENT@f72203.drinker"",""pos"":{""lineNum"":11,""columnNum"":40,""endLineNum"":11,""endColumnNum"":46,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2ce45a7b"",""value"":""NS_IDENT@f72203.BEER"",""pos"":{""lineNum"":10,""columnNum"":29,""endLineNum"":10,""endColumnNum"":32,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@22bb5646"",""value"":""NS_IDENT@8ed9cf.DRINKER2"",""pos"":{""lineNum"":10,""columnNum"":19,""endLineNum"":10,""endColumnNum"":26,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":10,""columnNum"":2,""endLineNum"":11,""endColumnNum"":46,""quoted"":false},""children"":{}}}}]}
"
"(select D3.name as drinker1, D4.name as drinker2
from drinker D3, drinker D4
where D3.name <> D4.name)

except

(select subquery.drinker2 as drinker1, subquery.drinker1 as drinker2

from (
select D2.name as drinker1, L2.beer as beer, L2.drinker as drinker2
from likes L2, drinker D2

except

select L1.drinker as drinker1, L1.beer as beer, D1.name as drinker2
from likes L1, drinker D1) subquery
)","{""failed"":true}
"
"WITH pairsOfDrinkers (drinker1, drinker2) AS (SELECT drinker1.name as drinker1, drinker2.name as drinker2 FROM drinker as drinker1, drinker as drinker2 
WHERE drinker1.name <> drinker2.name),

unnacceptablePairs (drinker1, drinker2) AS (SELECT t1.drinkerA, t1.drinkerB 
FROM ((SELECT likes.drinker as drinkerA, pairsOfDrinkers.drinker2 as drinkerB, likes.beer as beer1 
FROM pairsOfDrinkers, likes  
WHERE pairsOfDrinkers.drinker1 = likes.drinker) 
EXCEPT
(SELECT pairsOfDrinkers.drinker1 as drinkerA, likes.drinker as drinkerB, likes.beer as beer2 
FROM pairsOfDrinkers, likes  
WHERE pairsOfDrinkers.drinker2 = likes.drinker)
) as t1
)

(SELECT drinker1, drinker2 FROM pairsOfDrinkers)
EXCEPT
(SELECT drinker1, drinker2 FROM unnacceptablePairs)","{""failed"":true}
"
"SELECT DISTINCT D1.name as drinker1, D2.name as drinker2
FROM drinker AS D1, drinker AS D2
WHERE NOT EXISTS 
  ((SELECT beer FROM likes WHERE drinker = D1.name)
  EXCEPT
  (SELECT beer FROM likes WHERE drinker = D2.name))
  AND D1.name <> D2.name","{""blocks"":{""id"":""BLOCK_SELECT@5eeedb60"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":true,""selectList"":[{""id"":""COLUMN_LOCAL@37c2eacb"",""value"":""NS_IDENT@65bcf7c2.NAME"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":23,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@32b9bd12"",""value"":""NS_IDENT@55ecbafe.NAME"",""pos"":{""lineNum"":1,""columnNum"":38,""endLineNum"":1,""endColumnNum"":44,""quoted"":false},""children"":[],""alias"":""DRINKER2""}],""fromItemIds"":[""NS_IDENT@65bcf7c2"",""NS_IDENT@55ecbafe""],""fromNode"":{""id"":""OP_JOIN@4158debd"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":19,""endLineNum"":2,""endColumnNum"":19,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@773dab28"",""value"":""NS_IDENT@65bcf7c2"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@1ecfcbc9"",""value"":""NS_IDENT@55ecbafe"",""pos"":{""lineNum"":2,""columnNum"":21,""endLineNum"":2,""endColumnNum"":27,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@2a22ad2b"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":7,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""OP_PREFIX@646811d6"",""value"":""NOT"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":6,""endColumnNum"":49,""quoted"":false},""children"":[{""id"":""OP_PREFIX@511505e7"",""value"":""EXISTS"",""pos"":{""lineNum"":3,""columnNum"":11,""endLineNum"":6,""endColumnNum"":49,""quoted"":false},""children"":[{""id"":""BLOCK_SETOP@2032e725"",""value"":""BLOCK_SETOP@2032e725"",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":6,""endColumnNum"":49,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@70242f38"",""value"":""<>"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@257cc1fc"",""value"":""NS_IDENT@65bcf7c2.name"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@61c76850"",""value"":""NS_IDENT@55ecbafe.name"",""pos"":{""lineNum"":7,""columnNum"":18,""endLineNum"":7,""endColumnNum"":24,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@37c2eacb"",""value"":""NS_IDENT@65bcf7c2.NAME"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":23,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@32b9bd12"",""value"":""NS_IDENT@55ecbafe.NAME"",""pos"":{""lineNum"":1,""columnNum"":38,""endLineNum"":1,""endColumnNum"":44,""quoted"":false},""children"":[],""alias"":""DRINKER2""},{""id"":""COLUMN_LOCAL@61c76850"",""value"":""NS_IDENT@55ecbafe.name"",""pos"":{""lineNum"":7,""columnNum"":18,""endLineNum"":7,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@257cc1fc"",""value"":""NS_IDENT@65bcf7c2.name"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":13,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@55ecbafe.name"",""NS_IDENT@65bcf7c2.name""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":7,""endColumnNum"":24,""quoted"":false},""children"":{""BLOCK_SETOP@2032e725"":{""id"":""BLOCK_SETOP@2032e725"",""parentId"":""BLOCK_SELECT@5eeedb60"",""fields"":[""BEER VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@4d23015c"",""rightBlockId"":""BLOCK_SELECT@319854f0"",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":6,""endColumnNum"":49,""quoted"":false},""children"":{""BLOCK_SELECT@4d23015c"":{""id"":""BLOCK_SELECT@4d23015c"",""parentId"":""BLOCK_SETOP@2032e725"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@5dbf5634"",""value"":""NS_IDENT@15bc339.BEER"",""pos"":{""lineNum"":4,""columnNum"":12,""endLineNum"":4,""endColumnNum"":15,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@15bc339""],""fromNode"":{""id"":""JOIN_OPERAND@2dbd803f"",""value"":""NS_IDENT@15bc339"",""pos"":{""lineNum"":4,""columnNum"":22,""endLineNum"":4,""endColumnNum"":26,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@4349754"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":34,""endLineNum"":4,""endColumnNum"":50,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@2bf94401"",""value"":""NS_IDENT@15bc339.drinker"",""pos"":{""lineNum"":4,""columnNum"":34,""endLineNum"":4,""endColumnNum"":40,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@2532b351"",""value"":""NS_IDENT@65bcf7c2.name"",""pos"":{""lineNum"":4,""columnNum"":44,""endLineNum"":4,""endColumnNum"":50,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_CORRELATE@2532b351"",""value"":""NS_IDENT@65bcf7c2.name"",""pos"":{""lineNum"":4,""columnNum"":44,""endLineNum"":4,""endColumnNum"":50,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5dbf5634"",""value"":""NS_IDENT@15bc339.BEER"",""pos"":{""lineNum"":4,""columnNum"":12,""endLineNum"":4,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2bf94401"",""value"":""NS_IDENT@15bc339.drinker"",""pos"":{""lineNum"":4,""columnNum"":34,""endLineNum"":4,""endColumnNum"":40,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@65bcf7c2""],""corrCtxIds"":[""BLOCK_SELECT@5eeedb60""],""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":4,""endColumnNum"":50,""quoted"":false},""children"":{}},""BLOCK_SELECT@319854f0"":{""id"":""BLOCK_SELECT@319854f0"",""parentId"":""BLOCK_SETOP@2032e725"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@5a6482a9"",""value"":""NS_IDENT@205b132e.BEER"",""pos"":{""lineNum"":6,""columnNum"":11,""endLineNum"":6,""endColumnNum"":14,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@205b132e""],""fromNode"":{""id"":""JOIN_OPERAND@748fe51d"",""value"":""NS_IDENT@205b132e"",""pos"":{""lineNum"":6,""columnNum"":21,""endLineNum"":6,""endColumnNum"":25,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@630d1b2f"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":33,""endLineNum"":6,""endColumnNum"":49,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@f202d6d"",""value"":""NS_IDENT@205b132e.drinker"",""pos"":{""lineNum"":6,""columnNum"":33,""endLineNum"":6,""endColumnNum"":39,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@60e21209"",""value"":""NS_IDENT@55ecbafe.name"",""pos"":{""lineNum"":6,""columnNum"":43,""endLineNum"":6,""endColumnNum"":49,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@5a6482a9"",""value"":""NS_IDENT@205b132e.BEER"",""pos"":{""lineNum"":6,""columnNum"":11,""endLineNum"":6,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@60e21209"",""value"":""NS_IDENT@55ecbafe.name"",""pos"":{""lineNum"":6,""columnNum"":43,""endLineNum"":6,""endColumnNum"":49,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@f202d6d"",""value"":""NS_IDENT@205b132e.drinker"",""pos"":{""lineNum"":6,""columnNum"":33,""endLineNum"":6,""endColumnNum"":39,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@55ecbafe""],""corrCtxIds"":[""BLOCK_SELECT@5eeedb60""],""pos"":{""lineNum"":6,""columnNum"":4,""endLineNum"":6,""endColumnNum"":49,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@15bc339"":{""tableId"":""NS_IDENT@15bc339"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":22,""endLineNum"":4,""endColumnNum"":26,""quoted"":false}},""NS_IDENT@205b132e"":{""tableId"":""NS_IDENT@205b132e"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":21,""endLineNum"":6,""endColumnNum"":25,""quoted"":false}},""NS_IDENT@65bcf7c2"":{""tableId"":""NS_IDENT@65bcf7c2"",""identifier"":""D1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":18,""quoted"":false}},""NS_IDENT@55ecbafe"":{""tableId"":""NS_IDENT@55ecbafe"",""identifier"":""D2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":21,""endLineNum"":2,""endColumnNum"":33,""quoted"":false}}},""corrTables"":[""NS_IDENT@65bcf7c2"",""NS_IDENT@55ecbafe""]}
"
"SELECT D1.name as drinker1, D2.name as drinker2
FROM drinker D1, drinker D2
WHERE D1.name <> D2.name AND NOT EXISTS
	((SELECT beer
	FROM likes
	WHERE drinker = D1.name)
	EXCEPT
	(SELECT  beer
	FROM likes
	WHERE drinker = D2.name))","{""blocks"":{""id"":""BLOCK_SELECT@4b1abd11"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@37c2eacb"",""value"":""NS_IDENT@65bcf7c2.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":14,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@32b9bd12"",""value"":""NS_IDENT@55ecbafe.NAME"",""pos"":{""lineNum"":1,""columnNum"":29,""endLineNum"":1,""endColumnNum"":35,""quoted"":false},""children"":[],""alias"":""DRINKER2""}],""fromItemIds"":[""NS_IDENT@65bcf7c2"",""NS_IDENT@55ecbafe""],""fromNode"":{""id"":""OP_JOIN@415156bf"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":16,""endLineNum"":2,""endColumnNum"":16,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@4af46df3"",""value"":""NS_IDENT@65bcf7c2"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@4158debd"",""value"":""NS_IDENT@55ecbafe"",""pos"":{""lineNum"":2,""columnNum"":18,""endLineNum"":2,""endColumnNum"":24,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@2a22ad2b"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":10,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""OP_BINARY@31da6b2e"",""value"":""<>"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@6e0f7aad"",""value"":""NS_IDENT@65bcf7c2.name"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@99a78d7"",""value"":""NS_IDENT@55ecbafe.name"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[]}]},{""id"":""OP_PREFIX@70242f38"",""value"":""NOT"",""pos"":{""lineNum"":3,""columnNum"":30,""endLineNum"":10,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""OP_PREFIX@61c76850"",""value"":""EXISTS"",""pos"":{""lineNum"":3,""columnNum"":34,""endLineNum"":10,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""BLOCK_SETOP@31cb96e1"",""value"":""BLOCK_SETOP@31cb96e1"",""pos"":{""lineNum"":4,""columnNum"":4,""endLineNum"":10,""endColumnNum"":24,""quoted"":false},""children"":[]}]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@37c2eacb"",""value"":""NS_IDENT@65bcf7c2.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":14,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@99a78d7"",""value"":""NS_IDENT@55ecbafe.name"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@32b9bd12"",""value"":""NS_IDENT@55ecbafe.NAME"",""pos"":{""lineNum"":1,""columnNum"":29,""endLineNum"":1,""endColumnNum"":35,""quoted"":false},""children"":[],""alias"":""DRINKER2""},{""id"":""COLUMN_LOCAL@6e0f7aad"",""value"":""NS_IDENT@65bcf7c2.name"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@55ecbafe.name"",""NS_IDENT@65bcf7c2.name""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":10,""endColumnNum"":26,""quoted"":false},""children"":{""BLOCK_SETOP@31cb96e1"":{""id"":""BLOCK_SETOP@31cb96e1"",""parentId"":""BLOCK_SELECT@4b1abd11"",""fields"":[""BEER VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@3eed0f5"",""rightBlockId"":""BLOCK_SELECT@1cbb3d3b"",""pos"":{""lineNum"":4,""columnNum"":4,""endLineNum"":10,""endColumnNum"":24,""quoted"":false},""children"":{""BLOCK_SELECT@3eed0f5"":{""id"":""BLOCK_SELECT@3eed0f5"",""parentId"":""BLOCK_SETOP@31cb96e1"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@49798e84"",""value"":""NS_IDENT@385ef531.BEER"",""pos"":{""lineNum"":4,""columnNum"":11,""endLineNum"":4,""endColumnNum"":14,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@385ef531""],""fromNode"":{""id"":""JOIN_OPERAND@55b8dbda"",""value"":""NS_IDENT@385ef531"",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":5,""endColumnNum"":11,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@3c0fbd3a"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":8,""endLineNum"":6,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@66ec9390"",""value"":""NS_IDENT@385ef531.drinker"",""pos"":{""lineNum"":6,""columnNum"":8,""endLineNum"":6,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@6e91893"",""value"":""NS_IDENT@65bcf7c2.name"",""pos"":{""lineNum"":6,""columnNum"":18,""endLineNum"":6,""endColumnNum"":24,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@49798e84"",""value"":""NS_IDENT@385ef531.BEER"",""pos"":{""lineNum"":4,""columnNum"":11,""endLineNum"":4,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@66ec9390"",""value"":""NS_IDENT@385ef531.drinker"",""pos"":{""lineNum"":6,""columnNum"":8,""endLineNum"":6,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@6e91893"",""value"":""NS_IDENT@65bcf7c2.name"",""pos"":{""lineNum"":6,""columnNum"":18,""endLineNum"":6,""endColumnNum"":24,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@65bcf7c2""],""corrCtxIds"":[""BLOCK_SELECT@4b1abd11""],""pos"":{""lineNum"":4,""columnNum"":4,""endLineNum"":6,""endColumnNum"":24,""quoted"":false},""children"":{}},""BLOCK_SELECT@1cbb3d3b"":{""id"":""BLOCK_SELECT@1cbb3d3b"",""parentId"":""BLOCK_SETOP@31cb96e1"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@5a6482a9"",""value"":""NS_IDENT@3cbcd8f3.BEER"",""pos"":{""lineNum"":8,""columnNum"":11,""endLineNum"":8,""endColumnNum"":14,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@3cbcd8f3""],""fromNode"":{""id"":""JOIN_OPERAND@529cfee5"",""value"":""NS_IDENT@3cbcd8f3"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":11,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@630d1b2f"",""value"":""="",""pos"":{""lineNum"":10,""columnNum"":8,""endLineNum"":10,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@f202d6d"",""value"":""NS_IDENT@3cbcd8f3.drinker"",""pos"":{""lineNum"":10,""columnNum"":8,""endLineNum"":10,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@60e21209"",""value"":""NS_IDENT@55ecbafe.name"",""pos"":{""lineNum"":10,""columnNum"":18,""endLineNum"":10,""endColumnNum"":24,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_CORRELATE@60e21209"",""value"":""NS_IDENT@55ecbafe.name"",""pos"":{""lineNum"":10,""columnNum"":18,""endLineNum"":10,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@f202d6d"",""value"":""NS_IDENT@3cbcd8f3.drinker"",""pos"":{""lineNum"":10,""columnNum"":8,""endLineNum"":10,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5a6482a9"",""value"":""NS_IDENT@3cbcd8f3.BEER"",""pos"":{""lineNum"":8,""columnNum"":11,""endLineNum"":8,""endColumnNum"":14,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@55ecbafe""],""corrCtxIds"":[""BLOCK_SELECT@4b1abd11""],""pos"":{""lineNum"":8,""columnNum"":3,""endLineNum"":10,""endColumnNum"":24,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@3cbcd8f3"":{""tableId"":""NS_IDENT@3cbcd8f3"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":11,""quoted"":false}},""NS_IDENT@65bcf7c2"":{""tableId"":""NS_IDENT@65bcf7c2"",""identifier"":""D1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":15,""quoted"":false}},""NS_IDENT@55ecbafe"":{""tableId"":""NS_IDENT@55ecbafe"",""identifier"":""D2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":18,""endLineNum"":2,""endColumnNum"":27,""quoted"":false}},""NS_IDENT@385ef531"":{""tableId"":""NS_IDENT@385ef531"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":5,""endColumnNum"":11,""quoted"":false}}},""corrTables"":[""NS_IDENT@65bcf7c2"",""NS_IDENT@55ecbafe""]}
"
"WITH drinkerpairs AS
(SELECT l1.name AS ""d1"", l2.name AS ""d2""
FROM drinker as l1, drinker as l2
WHERE l1.name != l2.name),
d1likes AS
(SELECT d1, d2, beer
FROM likes, drinkerpairs
WHERE drinker = d1),
difference AS
(SELECT *
FROM d1likes
EXCEPT (SELECT d1, d2, beer
FROM likes, drinkerpairs
WHERE drinker = d2))

SELECT d1 AS ""drinker1"", d2 AS ""drinker2""
FROM drinkerpairs
EXCEPT(SELECT d1, d2
FROM difference);
","{""failed"":true,""errorMsg"":""Parsing error at line 4, column 15. Query syntax may be incorrect""}
"
"With initial as (
Select name 
From drinker
),

i as (
Select name as drinker1
From initial
),

j as (
Select name as drinker2 
From initial
),

alldrinkers as (
Select *
From i, j
Where drinker1 <> drinker2
),

temp1 as (
select *
From alldrinkers, likes
where alldrinkers.drinker1 = likes.drinker
),

temp2 as (
Select drinker1, drinker2, beer
From temp1
),


t1 as (
Select *
From alldrinkers, likes
Where drinker2 = drinker
),

t2 as (
Select drinker1, drinker2, beer
From t1
),

difference1 as (
Select * from temp2
Except 
Select * from t2
),

differencecool as (
select drinker1, drinker2
from difference1
),

final as (
select * from alldrinkers
Except
select * from differencecool
)

select *
from final



","{""failed"":true,""errorMsg"":""Parsing error at line 1, column 6. Query syntax may be incorrect""}
"
"WITH pairs AS 
(SELECT d1.name drinker1, d2.name drinker2 FROM drinker d1, drinker d2 WHERE d1.name <> d2.name)
SELECT DISTINCT drinker1, drinker2 FROM pairs
WHERE NOT EXISTS
(SELECT * FROM likes loop2 WHERE drinker = pairs.drinker1
AND NOT EXISTS 
(SELECT * FROM likes loop3 WHERE drinker = pairs.drinker2 AND beer = loop2.beer))","{""blocks"":{""id"":""BLOCK_SELECT@21fff664"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":true,""selectList"":[{""id"":""COLUMN_LOCAL@1d25c1c"",""value"":""NS_IDENT@629ae7e.DRINKER1"",""pos"":{""lineNum"":3,""columnNum"":17,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5bca7664"",""value"":""NS_IDENT@629ae7e.DRINKER2"",""pos"":{""lineNum"":3,""columnNum"":27,""endLineNum"":3,""endColumnNum"":34,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@629ae7e""],""fromNode"":{""id"":""JOIN_OPERAND@f973499"",""value"":""NS_IDENT@629ae7e"",""pos"":{""lineNum"":3,""columnNum"":41,""endLineNum"":3,""endColumnNum"":45,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_PREFIX@518cf84a"",""value"":""NOT"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":7,""endColumnNum"":80,""quoted"":false},""children"":[{""id"":""OP_PREFIX@4c2869a9"",""value"":""EXISTS"",""pos"":{""lineNum"":4,""columnNum"":11,""endLineNum"":7,""endColumnNum"":80,""quoted"":false},""children"":[{""id"":""BLOCK_SELECT@6079cf5"",""value"":""BLOCK_SELECT@6079cf5"",""pos"":{""lineNum"":5,""columnNum"":2,""endLineNum"":7,""endColumnNum"":80,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@5bca7664"",""value"":""NS_IDENT@629ae7e.DRINKER2"",""pos"":{""lineNum"":3,""columnNum"":27,""endLineNum"":3,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1d25c1c"",""value"":""NS_IDENT@629ae7e.DRINKER1"",""pos"":{""lineNum"":3,""columnNum"":17,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@629ae7e.DRINKER2"",""NS_IDENT@629ae7e.DRINKER1""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":1,""endLineNum"":7,""endColumnNum"":81,""quoted"":false},""children"":{""BLOCK_SELECT@6079cf5"":{""id"":""BLOCK_SELECT@6079cf5"",""parentId"":""BLOCK_SELECT@21fff664"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@6136998b"",""value"":""*"",""pos"":{""lineNum"":5,""columnNum"":9,""endLineNum"":5,""endColumnNum"":9,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@3fae596""],""fromNode"":{""id"":""JOIN_OPERAND@6edc4161"",""value"":""NS_IDENT@3fae596"",""pos"":{""lineNum"":5,""columnNum"":16,""endLineNum"":5,""endColumnNum"":20,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@676ff3b0"",""value"":""AND"",""pos"":{""lineNum"":5,""columnNum"":34,""endLineNum"":7,""endColumnNum"":79,""quoted"":false},""children"":[{""id"":""OP_BINARY@74ad8d05"",""value"":""="",""pos"":{""lineNum"":5,""columnNum"":34,""endLineNum"":5,""endColumnNum"":57,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@3d43fe"",""value"":""NS_IDENT@3fae596.drinker"",""pos"":{""lineNum"":5,""columnNum"":34,""endLineNum"":5,""endColumnNum"":40,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@2a27cb34"",""value"":""NS_IDENT@629ae7e.DRINKER1"",""pos"":{""lineNum"":5,""columnNum"":44,""endLineNum"":5,""endColumnNum"":57,""quoted"":false},""children"":[]}]},{""id"":""OP_PREFIX@6892cc6f"",""value"":""NOT"",""pos"":{""lineNum"":6,""columnNum"":5,""endLineNum"":7,""endColumnNum"":79,""quoted"":false},""children"":[{""id"":""OP_PREFIX@6fd1660"",""value"":""EXISTS"",""pos"":{""lineNum"":6,""columnNum"":9,""endLineNum"":7,""endColumnNum"":79,""quoted"":false},""children"":[{""id"":""BLOCK_SELECT@1e6308a9"",""value"":""BLOCK_SELECT@1e6308a9"",""pos"":{""lineNum"":7,""columnNum"":2,""endLineNum"":7,""endColumnNum"":79,""quoted"":false},""children"":[]}]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@3d43fe"",""value"":""NS_IDENT@3fae596.drinker"",""pos"":{""lineNum"":5,""columnNum"":34,""endLineNum"":5,""endColumnNum"":40,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@2a27cb34"",""value"":""NS_IDENT@629ae7e.DRINKER1"",""pos"":{""lineNum"":5,""columnNum"":44,""endLineNum"":5,""endColumnNum"":57,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@3fae596.beer""],""corrTableIds"":[""NS_IDENT@629ae7e""],""corrCtxIds"":[""BLOCK_SELECT@21fff664""],""pos"":{""lineNum"":5,""columnNum"":2,""endLineNum"":7,""endColumnNum"":80,""quoted"":false},""children"":{""BLOCK_SELECT@1e6308a9"":{""id"":""BLOCK_SELECT@1e6308a9"",""parentId"":""BLOCK_SELECT@6079cf5"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@20095ab4"",""value"":""*"",""pos"":{""lineNum"":7,""columnNum"":9,""endLineNum"":7,""endColumnNum"":9,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@9255c05""],""fromNode"":{""id"":""JOIN_OPERAND@30cecdca"",""value"":""NS_IDENT@9255c05"",""pos"":{""lineNum"":7,""columnNum"":16,""endLineNum"":7,""endColumnNum"":20,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@7159139f"",""value"":""AND"",""pos"":{""lineNum"":7,""columnNum"":34,""endLineNum"":7,""endColumnNum"":79,""quoted"":false},""children"":[{""id"":""OP_BINARY@5fb7183b"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":34,""endLineNum"":7,""endColumnNum"":57,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@35ff8fc9"",""value"":""NS_IDENT@9255c05.drinker"",""pos"":{""lineNum"":7,""columnNum"":34,""endLineNum"":7,""endColumnNum"":40,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@546621c4"",""value"":""NS_IDENT@629ae7e.DRINKER2"",""pos"":{""lineNum"":7,""columnNum"":44,""endLineNum"":7,""endColumnNum"":57,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@16c8b7bd"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":63,""endLineNum"":7,""endColumnNum"":79,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@476a736d"",""value"":""NS_IDENT@9255c05.beer"",""pos"":{""lineNum"":7,""columnNum"":63,""endLineNum"":7,""endColumnNum"":66,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@5f80fa43"",""value"":""NS_IDENT@3fae596.beer"",""pos"":{""lineNum"":7,""columnNum"":70,""endLineNum"":7,""endColumnNum"":79,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_CORRELATE@5f80fa43"",""value"":""NS_IDENT@3fae596.beer"",""pos"":{""lineNum"":7,""columnNum"":70,""endLineNum"":7,""endColumnNum"":79,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@35ff8fc9"",""value"":""NS_IDENT@9255c05.drinker"",""pos"":{""lineNum"":7,""columnNum"":34,""endLineNum"":7,""endColumnNum"":40,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@546621c4"",""value"":""NS_IDENT@629ae7e.DRINKER2"",""pos"":{""lineNum"":7,""columnNum"":44,""endLineNum"":7,""endColumnNum"":57,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@476a736d"",""value"":""NS_IDENT@9255c05.beer"",""pos"":{""lineNum"":7,""columnNum"":63,""endLineNum"":7,""endColumnNum"":66,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@3fae596"",""NS_IDENT@629ae7e""],""corrCtxIds"":[""BLOCK_SELECT@21fff664"",""BLOCK_SELECT@6079cf5""],""pos"":{""lineNum"":7,""columnNum"":2,""endLineNum"":7,""endColumnNum"":79,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@629ae7e"":{""tableId"":""NS_IDENT@629ae7e"",""identifier"":""PAIRS"",""dbTableName"":""PAIRS"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":41,""endLineNum"":3,""endColumnNum"":45,""quoted"":false}},""NS_IDENT@2ab2710"":{""tableId"":""NS_IDENT@2ab2710"",""identifier"":""D1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":49,""endLineNum"":2,""endColumnNum"":58,""quoted"":false}},""NS_IDENT@3fae596"":{""tableId"":""NS_IDENT@3fae596"",""identifier"":""LOOP2"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":16,""endLineNum"":5,""endColumnNum"":26,""quoted"":false}},""NS_IDENT@9255c05"":{""tableId"":""NS_IDENT@9255c05"",""identifier"":""LOOP3"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":16,""endLineNum"":7,""endColumnNum"":26,""quoted"":false}},""NS_IDENT@6818d900"":{""tableId"":""NS_IDENT@6818d900"",""identifier"":""D2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":61,""endLineNum"":2,""endColumnNum"":70,""quoted"":false}}},""corrTables"":[""NS_IDENT@629ae7e"",""NS_IDENT@3fae596""],""withBlocks"":[{""id"":""BLOCK_SELECT@4690f583"",""alias"":""PAIRS"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@2ba33e2c"",""value"":""NS_IDENT@2ab2710.NAME"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":15,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@31e72cbc"",""value"":""NS_IDENT@6818d900.NAME"",""pos"":{""lineNum"":2,""columnNum"":27,""endLineNum"":2,""endColumnNum"":33,""quoted"":false},""children"":[],""alias"":""DRINKER2""}],""fromItemIds"":[""NS_IDENT@2ab2710"",""NS_IDENT@6818d900""],""fromNode"":{""id"":""OP_JOIN@6090f3ca"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":59,""endLineNum"":2,""endColumnNum"":59,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@5e3a39cd"",""value"":""NS_IDENT@2ab2710"",""pos"":{""lineNum"":2,""columnNum"":49,""endLineNum"":2,""endColumnNum"":55,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@54da32dc"",""value"":""NS_IDENT@6818d900"",""pos"":{""lineNum"":2,""columnNum"":61,""endLineNum"":2,""endColumnNum"":67,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@4d0b0fd4"",""value"":""<>"",""pos"":{""lineNum"":2,""columnNum"":78,""endLineNum"":2,""endColumnNum"":95,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@27b71f50"",""value"":""NS_IDENT@2ab2710.name"",""pos"":{""lineNum"":2,""columnNum"":78,""endLineNum"":2,""endColumnNum"":84,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@29fc1a2b"",""value"":""NS_IDENT@6818d900.name"",""pos"":{""lineNum"":2,""columnNum"":89,""endLineNum"":2,""endColumnNum"":95,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@31e72cbc"",""value"":""NS_IDENT@6818d900.NAME"",""pos"":{""lineNum"":2,""columnNum"":27,""endLineNum"":2,""endColumnNum"":33,""quoted"":false},""children"":[],""alias"":""DRINKER2""},{""id"":""COLUMN_LOCAL@27b71f50"",""value"":""NS_IDENT@2ab2710.name"",""pos"":{""lineNum"":2,""columnNum"":78,""endLineNum"":2,""endColumnNum"":84,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@29fc1a2b"",""value"":""NS_IDENT@6818d900.name"",""pos"":{""lineNum"":2,""columnNum"":89,""endLineNum"":2,""endColumnNum"":95,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2ba33e2c"",""value"":""NS_IDENT@2ab2710.NAME"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":15,""quoted"":false},""children"":[],""alias"":""DRINKER1""}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":2,""endLineNum"":2,""endColumnNum"":95,""quoted"":false},""children"":{}}]}
"
"WITH allPairs AS (
SELECT d1.name one, d2.name two FROM drinker d1, drinker d2
WHERE d1.name <> d2.name
),
drinkerOne AS (
SELECT allPairs.one, allPairs.two, likes.beer FROM likes, allPairs
WHERE allPairs.one = likes.drinker
),
drinkerTwo AS (
SELECT allPairs.one, allPairs.two, likes.beer FROM likes, allPairs
WHERE allPairs.two = likes.drinker
),
oneTwoDiff AS (
SELECT * FROM drinkerOne EXCEPT (SELECT * FROM drinkerTwo)
)

SELECT * FROM allPairs EXCEPT (SELECT oneTwoDiff.one, oneTwoDiff.two FROM oneTwoDiff)","{""failed"":true,""errorMsg"":""Parsing error at line 2, column 16. Query syntax may be incorrect""}
"
"Select distinct d1.name, d2.name
From drinker d1, drinker d2
Where d1.name<>d2.name except
Select distinct l1.drinker, d2.name
From likes l1, drinker d2
Where l1.beer not in (select distinct beer from likes where drinker = d2.name);
","{""blocks"":{""id"":""BLOCK_SETOP@5eeedb60"",""fields"":[""NAME VARCHAR(100)"",""NAME VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@562c877a"",""rightBlockId"":""BLOCK_SELECT@415156bf"",""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":6,""endColumnNum"":78,""quoted"":false},""children"":{""BLOCK_SELECT@562c877a"":{""id"":""BLOCK_SELECT@562c877a"",""parentId"":""BLOCK_SETOP@5eeedb60"",""fields"":[""NAME VARCHAR(100)"",""NAME VARCHAR(100)""],""isDistinct"":true,""selectList"":[{""id"":""COLUMN_LOCAL@37c2eacb"",""value"":""NS_IDENT@65bcf7c2.NAME"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@32b9bd12"",""value"":""NS_IDENT@55ecbafe.NAME"",""pos"":{""lineNum"":1,""columnNum"":26,""endLineNum"":1,""endColumnNum"":32,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@65bcf7c2"",""NS_IDENT@55ecbafe""],""fromNode"":{""id"":""OP_JOIN@73a00e09"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":16,""endLineNum"":2,""endColumnNum"":16,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@3b569985"",""value"":""NS_IDENT@65bcf7c2"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@22d1886d"",""value"":""NS_IDENT@55ecbafe"",""pos"":{""lineNum"":2,""columnNum"":18,""endLineNum"":2,""endColumnNum"":24,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@121c54fa"",""value"":""<>"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":22,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1949309d"",""value"":""NS_IDENT@65bcf7c2.name"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@48c3205a"",""value"":""NS_IDENT@55ecbafe.name"",""pos"":{""lineNum"":3,""columnNum"":16,""endLineNum"":3,""endColumnNum"":22,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@37c2eacb"",""value"":""NS_IDENT@65bcf7c2.NAME"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@48c3205a"",""value"":""NS_IDENT@55ecbafe.name"",""pos"":{""lineNum"":3,""columnNum"":16,""endLineNum"":3,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@32b9bd12"",""value"":""NS_IDENT@55ecbafe.NAME"",""pos"":{""lineNum"":1,""columnNum"":26,""endLineNum"":1,""endColumnNum"":32,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1949309d"",""value"":""NS_IDENT@65bcf7c2.name"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":3,""endColumnNum"":22,""quoted"":false},""children"":{}},""BLOCK_SELECT@415156bf"":{""id"":""BLOCK_SELECT@415156bf"",""parentId"":""BLOCK_SETOP@5eeedb60"",""fields"":[""DRINKER VARCHAR(100)"",""NAME VARCHAR(100)""],""isDistinct"":true,""selectList"":[{""id"":""COLUMN_LOCAL@205b132e"",""value"":""NS_IDENT@385ef531.DRINKER"",""pos"":{""lineNum"":4,""columnNum"":17,""endLineNum"":4,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3cbcd8f3"",""value"":""NS_IDENT@7fc645e4.NAME"",""pos"":{""lineNum"":4,""columnNum"":29,""endLineNum"":4,""endColumnNum"":35,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@385ef531"",""NS_IDENT@7fc645e4""],""fromNode"":{""id"":""OP_JOIN@353efdbf"",""value"":""COMMA"",""pos"":{""lineNum"":5,""columnNum"":14,""endLineNum"":5,""endColumnNum"":14,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@55cff952"",""value"":""NS_IDENT@385ef531"",""pos"":{""lineNum"":5,""columnNum"":6,""endLineNum"":5,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@660591fb"",""value"":""NS_IDENT@7fc645e4"",""pos"":{""lineNum"":5,""columnNum"":16,""endLineNum"":5,""endColumnNum"":22,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@66ec9390"",""value"":""NOT IN"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":77,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5e268ce6"",""value"":""NS_IDENT@385ef531.beer"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@393881f0"",""value"":""BLOCK_SELECT@393881f0"",""pos"":{""lineNum"":6,""columnNum"":23,""endLineNum"":6,""endColumnNum"":77,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@5e268ce6"",""value"":""NS_IDENT@385ef531.beer"",""pos"":{""lineNum"":6,""columnNum"":7,""endLineNum"":6,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@205b132e"",""value"":""NS_IDENT@385ef531.DRINKER"",""pos"":{""lineNum"":4,""columnNum"":17,""endLineNum"":4,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3cbcd8f3"",""value"":""NS_IDENT@7fc645e4.NAME"",""pos"":{""lineNum"":4,""columnNum"":29,""endLineNum"":4,""endColumnNum"":35,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@7fc645e4.name""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":4,""columnNum"":1,""endLineNum"":6,""endColumnNum"":78,""quoted"":false},""children"":{""BLOCK_SELECT@393881f0"":{""id"":""BLOCK_SELECT@393881f0"",""parentId"":""BLOCK_SELECT@415156bf"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":true,""selectList"":[{""id"":""COLUMN_LOCAL@54562ea6"",""value"":""NS_IDENT@58112bc4.BEER"",""pos"":{""lineNum"":6,""columnNum"":39,""endLineNum"":6,""endColumnNum"":42,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@58112bc4""],""fromNode"":{""id"":""JOIN_OPERAND@2fc07784"",""value"":""NS_IDENT@58112bc4"",""pos"":{""lineNum"":6,""columnNum"":49,""endLineNum"":6,""endColumnNum"":53,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@14e2e1c3"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":61,""endLineNum"":6,""endColumnNum"":77,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@766a4535"",""value"":""NS_IDENT@58112bc4.drinker"",""pos"":{""lineNum"":6,""columnNum"":61,""endLineNum"":6,""endColumnNum"":67,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@63718b93"",""value"":""NS_IDENT@7fc645e4.name"",""pos"":{""lineNum"":6,""columnNum"":71,""endLineNum"":6,""endColumnNum"":77,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@54562ea6"",""value"":""NS_IDENT@58112bc4.BEER"",""pos"":{""lineNum"":6,""columnNum"":39,""endLineNum"":6,""endColumnNum"":42,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@766a4535"",""value"":""NS_IDENT@58112bc4.drinker"",""pos"":{""lineNum"":6,""columnNum"":61,""endLineNum"":6,""endColumnNum"":67,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@63718b93"",""value"":""NS_IDENT@7fc645e4.name"",""pos"":{""lineNum"":6,""columnNum"":71,""endLineNum"":6,""endColumnNum"":77,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@7fc645e4""],""corrCtxIds"":[""BLOCK_SELECT@415156bf""],""pos"":{""lineNum"":6,""columnNum"":23,""endLineNum"":6,""endColumnNum"":77,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@58112bc4"":{""tableId"":""NS_IDENT@58112bc4"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":49,""endLineNum"":6,""endColumnNum"":53,""quoted"":false}},""NS_IDENT@65bcf7c2"":{""tableId"":""NS_IDENT@65bcf7c2"",""identifier"":""D1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":15,""quoted"":false}},""NS_IDENT@55ecbafe"":{""tableId"":""NS_IDENT@55ecbafe"",""identifier"":""D2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":18,""endLineNum"":2,""endColumnNum"":27,""quoted"":false}},""NS_IDENT@7fc645e4"":{""tableId"":""NS_IDENT@7fc645e4"",""identifier"":""D2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":16,""endLineNum"":5,""endColumnNum"":25,""quoted"":false}},""NS_IDENT@385ef531"":{""tableId"":""NS_IDENT@385ef531"",""identifier"":""L1"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":6,""endLineNum"":5,""endColumnNum"":13,""quoted"":false}}},""corrTables"":[""NS_IDENT@7fc645e4""]}
"
"with crossdrinker(drinker1, drinker2) as (
  select
    d1.name,
    d2.name
  from
    drinker d1
    cross join drinker d2
  where
    d1.name <> d2.name
),
crossdrinkernoelim(drinker1, drinker2) as (
  select
    d1.name,
    d2.name
  from
    drinker d1
    cross join drinker d2
),
drinkerslikes(drinker1, drinker2, beer) as (
  select
    crossdrinkernoelim.drinker1,
    crossdrinkernoelim.drinker2,
    likes.beer
  from
    likes
    join crossdrinkernoelim on crossdrinkernoelim.drinker1 = likes.drinker
),
doublelikes(drinker1, drinker2, beer) as (
  select
    l1.drinker,
    l2.drinker,
    l1.beer
  from
    likes l1,
    likes l2
  where
    l1.beer = l2.beer
    and l1.drinker <> l2.drinker
),

rightside(drinker1, drinker2) as
(select drinker1, drinker2, beer
from drinkerslikes

except
select drinker1, drinker2, beer
from doublelikes
)


select drinker1, drinker2
from 
(select drinker1, drinker2
from crossdrinker 

except 

select drinker1, drinker2
from rightside
) as final
","{""failed"":true,""errorMsg"":""From line 41, column 10 to line 41, column 29: Number of columns must match number of query columns""}
"
"with pairs as
(select d1.name as drinker1, d2.name as drinker2
from drinker d1, drinker d2
where d1.name <> d2.name),

drink1 as
(select p.drinker1, p.drinker2, l.beer as beer1 
from pairs p, likes l 
where p.drinker1 = l.drinker),

drink2 as
(select p.drinker1, p.drinker2, l.beer as beer2 
from pairs p, likes l 
where p.drinker2 = l.drinker),

nolikes as
(select distinct d.name as drinker1, l.drinker as drinker2
from drinker d, likes l
where d.name not in (select l2.drinker from likes l2)),

difference1 as
((select * 
from drink1)
except 
(select *
from drink2))

((select p.drinker1, p.drinker2
from pairs p)
except
(select d.drinker1, d.drinker2
from difference1 d))
union
(select * from nolikes)
","{""blocks"":{""id"":""BLOCK_SETOP@2c16fadb"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""opName"":""UNION"",""all"":false,""leftBlockId"":""BLOCK_SETOP@248deced"",""rightBlockId"":""BLOCK_SELECT@51ec2df1"",""pos"":{""lineNum"":28,""columnNum"":3,""endLineNum"":34,""endColumnNum"":22,""quoted"":false},""children"":{""BLOCK_SELECT@51ec2df1"":{""id"":""BLOCK_SELECT@51ec2df1"",""parentId"":""BLOCK_SETOP@2c16fadb"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@4e92466a"",""value"":""*"",""pos"":{""lineNum"":34,""columnNum"":9,""endLineNum"":34,""endColumnNum"":9,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@6cf31447""],""fromNode"":{""id"":""JOIN_OPERAND@f8f56b9"",""value"":""NS_IDENT@6cf31447"",""pos"":{""lineNum"":34,""columnNum"":16,""endLineNum"":34,""endColumnNum"":22,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":34,""columnNum"":2,""endLineNum"":34,""endColumnNum"":22,""quoted"":false},""children"":{}},""BLOCK_SETOP@248deced"":{""id"":""BLOCK_SETOP@248deced"",""parentId"":""BLOCK_SETOP@2c16fadb"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@2227a6c1"",""rightBlockId"":""BLOCK_SELECT@543e593"",""pos"":{""lineNum"":28,""columnNum"":3,""endLineNum"":32,""endColumnNum"":18,""quoted"":false},""children"":{""BLOCK_SELECT@2227a6c1"":{""id"":""BLOCK_SELECT@2227a6c1"",""parentId"":""BLOCK_SETOP@248deced"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@7c3ebc6b"",""value"":""NS_IDENT@cc239ba.DRINKER1"",""pos"":{""lineNum"":28,""columnNum"":10,""endLineNum"":28,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1931d99"",""value"":""NS_IDENT@cc239ba.DRINKER2"",""pos"":{""lineNum"":28,""columnNum"":22,""endLineNum"":28,""endColumnNum"":31,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@cc239ba""],""fromNode"":{""id"":""JOIN_OPERAND@1e9804b9"",""value"":""NS_IDENT@cc239ba"",""pos"":{""lineNum"":29,""columnNum"":6,""endLineNum"":29,""endColumnNum"":10,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@1931d99"",""value"":""NS_IDENT@cc239ba.DRINKER2"",""pos"":{""lineNum"":28,""columnNum"":22,""endLineNum"":28,""endColumnNum"":31,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7c3ebc6b"",""value"":""NS_IDENT@cc239ba.DRINKER1"",""pos"":{""lineNum"":28,""columnNum"":10,""endLineNum"":28,""endColumnNum"":19,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":28,""columnNum"":3,""endLineNum"":29,""endColumnNum"":12,""quoted"":false},""children"":{}},""BLOCK_SELECT@543e593"":{""id"":""BLOCK_SELECT@543e593"",""parentId"":""BLOCK_SETOP@248deced"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@73017a80"",""value"":""NS_IDENT@3162743f.DRINKER1"",""pos"":{""lineNum"":31,""columnNum"":9,""endLineNum"":31,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6ae7deac"",""value"":""NS_IDENT@3162743f.DRINKER2"",""pos"":{""lineNum"":31,""columnNum"":21,""endLineNum"":31,""endColumnNum"":30,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@3162743f""],""fromNode"":{""id"":""JOIN_OPERAND@4e628b52"",""value"":""NS_IDENT@3162743f"",""pos"":{""lineNum"":32,""columnNum"":6,""endLineNum"":32,""endColumnNum"":16,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@73017a80"",""value"":""NS_IDENT@3162743f.DRINKER1"",""pos"":{""lineNum"":31,""columnNum"":9,""endLineNum"":31,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6ae7deac"",""value"":""NS_IDENT@3162743f.DRINKER2"",""pos"":{""lineNum"":31,""columnNum"":21,""endLineNum"":31,""endColumnNum"":30,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":31,""columnNum"":2,""endLineNum"":32,""endColumnNum"":18,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@dca2615"":{""tableId"":""NS_IDENT@dca2615"",""identifier"":""P"",""dbTableName"":""PAIRS"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":6,""endLineNum"":8,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@7c4fc2bf"":{""tableId"":""NS_IDENT@7c4fc2bf"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":18,""columnNum"":17,""endLineNum"":18,""endColumnNum"":23,""quoted"":false}},""NS_IDENT@3162743f"":{""tableId"":""NS_IDENT@3162743f"",""identifier"":""D"",""dbTableName"":""DIFFERENCE1"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER1 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":32,""columnNum"":6,""endLineNum"":32,""endColumnNum"":18,""quoted"":false}},""NS_IDENT@58d63b16"":{""tableId"":""NS_IDENT@58d63b16"",""identifier"":""D"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":18,""columnNum"":6,""endLineNum"":18,""endColumnNum"":14,""quoted"":false}},""NS_IDENT@68dcfd52"":{""tableId"":""NS_IDENT@68dcfd52"",""identifier"":""DRINK1"",""dbTableName"":""DRINK1"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER1 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":23,""columnNum"":6,""endLineNum"":23,""endColumnNum"":11,""quoted"":false}},""NS_IDENT@cc239ba"":{""tableId"":""NS_IDENT@cc239ba"",""identifier"":""P"",""dbTableName"":""PAIRS"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":29,""columnNum"":6,""endLineNum"":29,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@369c9bb"":{""tableId"":""NS_IDENT@369c9bb"",""identifier"":""L2"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":19,""columnNum"":45,""endLineNum"":19,""endColumnNum"":52,""quoted"":false}},""NS_IDENT@6cf31447"":{""tableId"":""NS_IDENT@6cf31447"",""identifier"":""NOLIKES"",""dbTableName"":""NOLIKES"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":34,""columnNum"":16,""endLineNum"":34,""endColumnNum"":22,""quoted"":false}},""NS_IDENT@5c748168"":{""tableId"":""NS_IDENT@5c748168"",""identifier"":""P"",""dbTableName"":""PAIRS"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":13,""columnNum"":6,""endLineNum"":13,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@58a4a74d"":{""tableId"":""NS_IDENT@58a4a74d"",""identifier"":""D2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":27,""quoted"":false}},""NS_IDENT@421a4ee1"":{""tableId"":""NS_IDENT@421a4ee1"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":15,""endLineNum"":8,""endColumnNum"":21,""quoted"":false}},""NS_IDENT@58a120b0"":{""tableId"":""NS_IDENT@58a120b0"",""identifier"":""D1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":6,""endLineNum"":3,""endColumnNum"":15,""quoted"":false}},""NS_IDENT@6441c486"":{""tableId"":""NS_IDENT@6441c486"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":13,""columnNum"":15,""endLineNum"":13,""endColumnNum"":21,""quoted"":false}},""NS_IDENT@5177e388"":{""tableId"":""NS_IDENT@5177e388"",""identifier"":""DRINK2"",""dbTableName"":""DRINK2"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":26,""columnNum"":6,""endLineNum"":26,""endColumnNum"":11,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@4690f583"",""alias"":""PAIRS"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@314ed053"",""value"":""NS_IDENT@58a120b0.NAME"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":15,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@486bc9a4"",""value"":""NS_IDENT@58a4a74d.NAME"",""pos"":{""lineNum"":2,""columnNum"":30,""endLineNum"":2,""endColumnNum"":36,""quoted"":false},""children"":[],""alias"":""DRINKER2""}],""fromItemIds"":[""NS_IDENT@58a120b0"",""NS_IDENT@58a4a74d""],""fromNode"":{""id"":""OP_JOIN@6090f3ca"",""value"":""COMMA"",""pos"":{""lineNum"":3,""columnNum"":16,""endLineNum"":3,""endColumnNum"":16,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@5e3a39cd"",""value"":""NS_IDENT@58a120b0"",""pos"":{""lineNum"":3,""columnNum"":6,""endLineNum"":3,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@54da32dc"",""value"":""NS_IDENT@58a4a74d"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@38eb2fb0"",""value"":""<>"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@d8948cd"",""value"":""NS_IDENT@58a120b0.name"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@336365bc"",""value"":""NS_IDENT@58a4a74d.name"",""pos"":{""lineNum"":4,""columnNum"":18,""endLineNum"":4,""endColumnNum"":24,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@336365bc"",""value"":""NS_IDENT@58a4a74d.name"",""pos"":{""lineNum"":4,""columnNum"":18,""endLineNum"":4,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@d8948cd"",""value"":""NS_IDENT@58a120b0.name"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@486bc9a4"",""value"":""NS_IDENT@58a4a74d.NAME"",""pos"":{""lineNum"":2,""columnNum"":30,""endLineNum"":2,""endColumnNum"":36,""quoted"":false},""children"":[],""alias"":""DRINKER2""},{""id"":""COLUMN_LOCAL@314ed053"",""value"":""NS_IDENT@58a120b0.NAME"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":15,""quoted"":false},""children"":[],""alias"":""DRINKER1""}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":2,""endLineNum"":4,""endColumnNum"":24,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@6079cf5"",""alias"":""DRINK1"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER1 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@35ff8fc9"",""value"":""NS_IDENT@dca2615.DRINKER1"",""pos"":{""lineNum"":7,""columnNum"":9,""endLineNum"":7,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5fb7183b"",""value"":""NS_IDENT@dca2615.DRINKER2"",""pos"":{""lineNum"":7,""columnNum"":21,""endLineNum"":7,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@ea9e141"",""value"":""NS_IDENT@421a4ee1.BEER"",""pos"":{""lineNum"":7,""columnNum"":33,""endLineNum"":7,""endColumnNum"":38,""quoted"":false},""children"":[],""alias"":""BEER1""}],""fromItemIds"":[""NS_IDENT@dca2615"",""NS_IDENT@421a4ee1""],""fromNode"":{""id"":""OP_JOIN@1e6308a9"",""value"":""COMMA"",""pos"":{""lineNum"":8,""columnNum"":13,""endLineNum"":8,""endColumnNum"":13,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@30cecdca"",""value"":""NS_IDENT@dca2615"",""pos"":{""lineNum"":8,""columnNum"":6,""endLineNum"":8,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@6edc4161"",""value"":""NS_IDENT@421a4ee1"",""pos"":{""lineNum"":8,""columnNum"":15,""endLineNum"":8,""endColumnNum"":19,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@676ff3b0"",""value"":""="",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":28,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@3d43fe"",""value"":""NS_IDENT@dca2615.DRINKER1"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@74ad8d05"",""value"":""NS_IDENT@421a4ee1.drinker"",""pos"":{""lineNum"":9,""columnNum"":20,""endLineNum"":9,""endColumnNum"":28,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@5fb7183b"",""value"":""NS_IDENT@dca2615.DRINKER2"",""pos"":{""lineNum"":7,""columnNum"":21,""endLineNum"":7,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@74ad8d05"",""value"":""NS_IDENT@421a4ee1.drinker"",""pos"":{""lineNum"":9,""columnNum"":20,""endLineNum"":9,""endColumnNum"":28,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@ea9e141"",""value"":""NS_IDENT@421a4ee1.BEER"",""pos"":{""lineNum"":7,""columnNum"":33,""endLineNum"":7,""endColumnNum"":38,""quoted"":false},""children"":[],""alias"":""BEER1""},{""id"":""COLUMN_LOCAL@35ff8fc9"",""value"":""NS_IDENT@dca2615.DRINKER1"",""pos"":{""lineNum"":7,""columnNum"":9,""endLineNum"":7,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3d43fe"",""value"":""NS_IDENT@dca2615.DRINKER1"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":16,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":7,""columnNum"":2,""endLineNum"":9,""endColumnNum"":28,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@5226e402"",""alias"":""DRINK2"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@37c2eacb"",""value"":""NS_IDENT@5c748168.DRINKER1"",""pos"":{""lineNum"":12,""columnNum"":9,""endLineNum"":12,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@232cce0"",""value"":""NS_IDENT@5c748168.DRINKER2"",""pos"":{""lineNum"":12,""columnNum"":21,""endLineNum"":12,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5b4d25e7"",""value"":""NS_IDENT@6441c486.BEER"",""pos"":{""lineNum"":12,""columnNum"":33,""endLineNum"":12,""endColumnNum"":38,""quoted"":false},""children"":[],""alias"":""BEER2""}],""fromItemIds"":[""NS_IDENT@5c748168"",""NS_IDENT@6441c486""],""fromNode"":{""id"":""OP_JOIN@1440c311"",""value"":""COMMA"",""pos"":{""lineNum"":13,""columnNum"":13,""endLineNum"":13,""endColumnNum"":13,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@189b5fb1"",""value"":""NS_IDENT@5c748168"",""pos"":{""lineNum"":13,""columnNum"":6,""endLineNum"":13,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@783ec989"",""value"":""NS_IDENT@6441c486"",""pos"":{""lineNum"":13,""columnNum"":15,""endLineNum"":13,""endColumnNum"":19,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@5a8ba37c"",""value"":""="",""pos"":{""lineNum"":14,""columnNum"":7,""endLineNum"":14,""endColumnNum"":28,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@576c5536"",""value"":""NS_IDENT@5c748168.DRINKER2"",""pos"":{""lineNum"":14,""columnNum"":7,""endLineNum"":14,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@55ecbafe"",""value"":""NS_IDENT@6441c486.drinker"",""pos"":{""lineNum"":14,""columnNum"":20,""endLineNum"":14,""endColumnNum"":28,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@576c5536"",""value"":""NS_IDENT@5c748168.DRINKER2"",""pos"":{""lineNum"":14,""columnNum"":7,""endLineNum"":14,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@55ecbafe"",""value"":""NS_IDENT@6441c486.drinker"",""pos"":{""lineNum"":14,""columnNum"":20,""endLineNum"":14,""endColumnNum"":28,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@232cce0"",""value"":""NS_IDENT@5c748168.DRINKER2"",""pos"":{""lineNum"":12,""columnNum"":21,""endLineNum"":12,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5b4d25e7"",""value"":""NS_IDENT@6441c486.BEER"",""pos"":{""lineNum"":12,""columnNum"":33,""endLineNum"":12,""endColumnNum"":38,""quoted"":false},""children"":[],""alias"":""BEER2""},{""id"":""COLUMN_LOCAL@37c2eacb"",""value"":""NS_IDENT@5c748168.DRINKER1"",""pos"":{""lineNum"":12,""columnNum"":9,""endLineNum"":12,""endColumnNum"":18,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":12,""columnNum"":2,""endLineNum"":14,""endColumnNum"":28,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@f973499"",""alias"":""NOLIKES"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":true,""selectList"":[{""id"":""COLUMN_LOCAL@7772054c"",""value"":""NS_IDENT@58d63b16.NAME"",""pos"":{""lineNum"":17,""columnNum"":18,""endLineNum"":17,""endColumnNum"":23,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@46866946"",""value"":""NS_IDENT@7c4fc2bf.DRINKER"",""pos"":{""lineNum"":17,""columnNum"":38,""endLineNum"":17,""endColumnNum"":46,""quoted"":false},""children"":[],""alias"":""DRINKER2""}],""fromItemIds"":[""NS_IDENT@58d63b16"",""NS_IDENT@7c4fc2bf""],""fromNode"":{""id"":""OP_JOIN@37c5fc56"",""value"":""COMMA"",""pos"":{""lineNum"":18,""columnNum"":15,""endLineNum"":18,""endColumnNum"":15,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@1c025cb"",""value"":""NS_IDENT@58d63b16"",""pos"":{""lineNum"":18,""columnNum"":6,""endLineNum"":18,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@50825a02"",""value"":""NS_IDENT@7c4fc2bf"",""pos"":{""lineNum"":18,""columnNum"":17,""endLineNum"":18,""endColumnNum"":21,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@73044cdf"",""value"":""NOT IN"",""pos"":{""lineNum"":19,""columnNum"":7,""endLineNum"":19,""endColumnNum"":52,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@205b132e"",""value"":""NS_IDENT@58d63b16.name"",""pos"":{""lineNum"":19,""columnNum"":7,""endLineNum"":19,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@4d33940d"",""value"":""BLOCK_SELECT@4d33940d"",""pos"":{""lineNum"":19,""columnNum"":22,""endLineNum"":19,""endColumnNum"":52,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@205b132e"",""value"":""NS_IDENT@58d63b16.name"",""pos"":{""lineNum"":19,""columnNum"":7,""endLineNum"":19,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7772054c"",""value"":""NS_IDENT@58d63b16.NAME"",""pos"":{""lineNum"":17,""columnNum"":18,""endLineNum"":17,""endColumnNum"":23,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@46866946"",""value"":""NS_IDENT@7c4fc2bf.DRINKER"",""pos"":{""lineNum"":17,""columnNum"":38,""endLineNum"":17,""endColumnNum"":46,""quoted"":false},""children"":[],""alias"":""DRINKER2""}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":17,""columnNum"":2,""endLineNum"":19,""endColumnNum"":53,""quoted"":false},""children"":{""BLOCK_SELECT@4d33940d"":{""id"":""BLOCK_SELECT@4d33940d"",""parentId"":""BLOCK_SELECT@f973499"",""fields"":[""DRINKER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@9a2ec9b"",""value"":""NS_IDENT@369c9bb.DRINKER"",""pos"":{""lineNum"":19,""columnNum"":29,""endLineNum"":19,""endColumnNum"":38,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@369c9bb""],""fromNode"":{""id"":""JOIN_OPERAND@43cf6ea3"",""value"":""NS_IDENT@369c9bb"",""pos"":{""lineNum"":19,""columnNum"":45,""endLineNum"":19,""endColumnNum"":49,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@9a2ec9b"",""value"":""NS_IDENT@369c9bb.DRINKER"",""pos"":{""lineNum"":19,""columnNum"":29,""endLineNum"":19,""endColumnNum"":38,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":19,""columnNum"":22,""endLineNum"":19,""endColumnNum"":52,""quoted"":false},""children"":{}}}},{""id"":""BLOCK_SETOP@1603dc2f"",""alias"":""DIFFERENCE1"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER1 VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@398474a2"",""rightBlockId"":""BLOCK_SELECT@72fe8a4f"",""pos"":{""lineNum"":22,""columnNum"":3,""endLineNum"":26,""endColumnNum"":11,""quoted"":false},""children"":{""BLOCK_SELECT@72fe8a4f"":{""id"":""BLOCK_SELECT@72fe8a4f"",""parentId"":""BLOCK_SETOP@1603dc2f"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@37b72ea"",""value"":""*"",""pos"":{""lineNum"":25,""columnNum"":9,""endLineNum"":25,""endColumnNum"":9,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@5177e388""],""fromNode"":{""id"":""JOIN_OPERAND@43effd89"",""value"":""NS_IDENT@5177e388"",""pos"":{""lineNum"":26,""columnNum"":6,""endLineNum"":26,""endColumnNum"":11,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":25,""columnNum"":2,""endLineNum"":26,""endColumnNum"":11,""quoted"":false},""children"":{}},""BLOCK_SELECT@398474a2"":{""id"":""BLOCK_SELECT@398474a2"",""parentId"":""BLOCK_SETOP@1603dc2f"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER1 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@25b5c5e3"",""value"":""*"",""pos"":{""lineNum"":22,""columnNum"":10,""endLineNum"":22,""endColumnNum"":10,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@68dcfd52""],""fromNode"":{""id"":""JOIN_OPERAND@1d12b024"",""value"":""NS_IDENT@68dcfd52"",""pos"":{""lineNum"":23,""columnNum"":6,""endLineNum"":23,""endColumnNum"":11,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":22,""columnNum"":3,""endLineNum"":23,""endColumnNum"":11,""quoted"":false},""children"":{}}}}]}
"
"
WITH 
	drinkerpairs(drinker1, drinker2) AS
	(SELECT d1.name, d2.name
	FROM drinker d1, drinker d2
	WHERE d1.name <> d2.name),

	drinker1(drinker1, drinker2, beer) AS
	(SELECT dp.drinker1, dp.drinker2, l.beer
	FROM drinkerpairs dp, likes l
	WHERE dp.drinker1 = l.drinker),

	drinker2(drinker1, drinker2, beer) AS
	(SELECT dp.drinker1, dp.drinker2, l.beer
	FROM drinkerpairs dp, likes l
	WHERE dp.drinker2 = l.drinker),

	diff(drinker1, drinker2, beer) AS 
	((SELECT drinker1, drinker2, beer FROM drinker1) 
	EXCEPT
	(SELECT drinker1, drinker2, beer FROM drinker2))

(SELECT * FROM drinkerpairs)
EXCEPT
(SELECT drinker1, drinker2 FROM diff);","{""blocks"":{""id"":""BLOCK_SETOP@4e4c3a38"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@293cde83"",""rightBlockId"":""BLOCK_SELECT@57c88764"",""pos"":{""lineNum"":23,""columnNum"":2,""endLineNum"":25,""endColumnNum"":36,""quoted"":false},""children"":{""BLOCK_SELECT@293cde83"":{""id"":""BLOCK_SELECT@293cde83"",""parentId"":""BLOCK_SETOP@4e4c3a38"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@59532566"",""value"":""*"",""pos"":{""lineNum"":23,""columnNum"":9,""endLineNum"":23,""endColumnNum"":9,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@4f63e3c7""],""fromNode"":{""id"":""JOIN_OPERAND@c27d163"",""value"":""NS_IDENT@4f63e3c7"",""pos"":{""lineNum"":23,""columnNum"":16,""endLineNum"":23,""endColumnNum"":27,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":23,""columnNum"":2,""endLineNum"":23,""endColumnNum"":27,""quoted"":false},""children"":{}},""BLOCK_SELECT@57c88764"":{""id"":""BLOCK_SELECT@57c88764"",""parentId"":""BLOCK_SETOP@4e4c3a38"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@421a4ee1"",""value"":""NS_IDENT@dca2615.DRINKER1"",""pos"":{""lineNum"":25,""columnNum"":9,""endLineNum"":25,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@528f8f8b"",""value"":""NS_IDENT@dca2615.DRINKER2"",""pos"":{""lineNum"":25,""columnNum"":19,""endLineNum"":25,""endColumnNum"":26,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@dca2615""],""fromNode"":{""id"":""JOIN_OPERAND@78faea5f"",""value"":""NS_IDENT@dca2615"",""pos"":{""lineNum"":25,""columnNum"":33,""endLineNum"":25,""endColumnNum"":36,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@528f8f8b"",""value"":""NS_IDENT@dca2615.DRINKER2"",""pos"":{""lineNum"":25,""columnNum"":19,""endLineNum"":25,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@421a4ee1"",""value"":""NS_IDENT@dca2615.DRINKER1"",""pos"":{""lineNum"":25,""columnNum"":9,""endLineNum"":25,""endColumnNum"":16,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":25,""columnNum"":2,""endLineNum"":25,""endColumnNum"":36,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@dca2615"":{""tableId"":""NS_IDENT@dca2615"",""identifier"":""DIFF"",""dbTableName"":""DIFF"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":25,""columnNum"":33,""endLineNum"":25,""endColumnNum"":36,""quoted"":false}},""NS_IDENT@58a4a74d"":{""tableId"":""NS_IDENT@58a4a74d"",""identifier"":""DRINKER2"",""dbTableName"":""DRINKER2"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":21,""columnNum"":40,""endLineNum"":21,""endColumnNum"":47,""quoted"":false}},""NS_IDENT@15dd5ac2"":{""tableId"":""NS_IDENT@15dd5ac2"",""identifier"":""DRINKER1"",""dbTableName"":""DRINKER1"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":19,""columnNum"":41,""endLineNum"":19,""endColumnNum"":48,""quoted"":false}},""NS_IDENT@365553de"":{""tableId"":""NS_IDENT@365553de"",""identifier"":""DP"",""dbTableName"":""DRINKERPAIRS"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":10,""columnNum"":7,""endLineNum"":10,""endColumnNum"":21,""quoted"":false}},""NS_IDENT@de18f63"":{""tableId"":""NS_IDENT@de18f63"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":15,""columnNum"":24,""endLineNum"":15,""endColumnNum"":30,""quoted"":false}},""NS_IDENT@7c3ebc6b"":{""tableId"":""NS_IDENT@7c3ebc6b"",""identifier"":""D2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":19,""endLineNum"":5,""endColumnNum"":28,""quoted"":false}},""NS_IDENT@e344ad3"":{""tableId"":""NS_IDENT@e344ad3"",""identifier"":""DP"",""dbTableName"":""DRINKERPAIRS"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":15,""columnNum"":7,""endLineNum"":15,""endColumnNum"":21,""quoted"":false}},""NS_IDENT@4f63e3c7"":{""tableId"":""NS_IDENT@4f63e3c7"",""identifier"":""DRINKERPAIRS"",""dbTableName"":""DRINKERPAIRS"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":23,""columnNum"":16,""endLineNum"":23,""endColumnNum"":27,""quoted"":false}},""NS_IDENT@78830d9a"":{""tableId"":""NS_IDENT@78830d9a"",""identifier"":""D1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":5,""endColumnNum"":16,""quoted"":false}},""NS_IDENT@34a0ef00"":{""tableId"":""NS_IDENT@34a0ef00"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":10,""columnNum"":24,""endLineNum"":10,""endColumnNum"":30,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@5c20ffa8"",""alias"":""DRINKERPAIRS"",""fields"":[""NAME VARCHAR(100)"",""NAME VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@6a9950f1"",""value"":""NS_IDENT@78830d9a.NAME"",""pos"":{""lineNum"":4,""columnNum"":10,""endLineNum"":4,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@73017a80"",""value"":""NS_IDENT@7c3ebc6b.NAME"",""pos"":{""lineNum"":4,""columnNum"":19,""endLineNum"":4,""endColumnNum"":25,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@78830d9a"",""NS_IDENT@7c3ebc6b""],""fromNode"":{""id"":""OP_JOIN@6bcbf05b"",""value"":""COMMA"",""pos"":{""lineNum"":5,""columnNum"":17,""endLineNum"":5,""endColumnNum"":17,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@59942b48"",""value"":""NS_IDENT@78830d9a"",""pos"":{""lineNum"":5,""columnNum"":7,""endLineNum"":5,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@f9b5552"",""value"":""NS_IDENT@7c3ebc6b"",""pos"":{""lineNum"":5,""columnNum"":19,""endLineNum"":5,""endColumnNum"":25,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@3b0ee03a"",""value"":""<>"",""pos"":{""lineNum"":6,""columnNum"":8,""endLineNum"":6,""endColumnNum"":25,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@65fd6708"",""value"":""NS_IDENT@78830d9a.name"",""pos"":{""lineNum"":6,""columnNum"":8,""endLineNum"":6,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@b967222"",""value"":""NS_IDENT@7c3ebc6b.name"",""pos"":{""lineNum"":6,""columnNum"":19,""endLineNum"":6,""endColumnNum"":25,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@6a9950f1"",""value"":""NS_IDENT@78830d9a.NAME"",""pos"":{""lineNum"":4,""columnNum"":10,""endLineNum"":4,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@65fd6708"",""value"":""NS_IDENT@78830d9a.name"",""pos"":{""lineNum"":6,""columnNum"":8,""endLineNum"":6,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@73017a80"",""value"":""NS_IDENT@7c3ebc6b.NAME"",""pos"":{""lineNum"":4,""columnNum"":19,""endLineNum"":4,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@b967222"",""value"":""NS_IDENT@7c3ebc6b.name"",""pos"":{""lineNum"":6,""columnNum"":19,""endLineNum"":6,""endColumnNum"":25,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":4,""columnNum"":3,""endLineNum"":6,""endColumnNum"":25,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@54da32dc"",""alias"":""DRINKER1"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@64aad6db"",""value"":""NS_IDENT@365553de.DRINKER1"",""pos"":{""lineNum"":9,""columnNum"":10,""endLineNum"":9,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@ae7950d"",""value"":""NS_IDENT@365553de.DRINKER2"",""pos"":{""lineNum"":9,""columnNum"":23,""endLineNum"":9,""endColumnNum"":33,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3daa82be"",""value"":""NS_IDENT@34a0ef00.BEER"",""pos"":{""lineNum"":9,""columnNum"":36,""endLineNum"":9,""endColumnNum"":41,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@365553de"",""NS_IDENT@34a0ef00""],""fromNode"":{""id"":""OP_JOIN@1d782abe"",""value"":""COMMA"",""pos"":{""lineNum"":10,""columnNum"":22,""endLineNum"":10,""endColumnNum"":22,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@6df7988f"",""value"":""NS_IDENT@365553de"",""pos"":{""lineNum"":10,""columnNum"":7,""endLineNum"":10,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@27b22f74"",""value"":""NS_IDENT@34a0ef00"",""pos"":{""lineNum"":10,""columnNum"":24,""endLineNum"":10,""endColumnNum"":28,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@4e2916c3"",""value"":""="",""pos"":{""lineNum"":11,""columnNum"":8,""endLineNum"":11,""endColumnNum"":30,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5e8604bf"",""value"":""NS_IDENT@365553de.DRINKER1"",""pos"":{""lineNum"":11,""columnNum"":8,""endLineNum"":11,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@20095ab4"",""value"":""NS_IDENT@34a0ef00.drinker"",""pos"":{""lineNum"":11,""columnNum"":22,""endLineNum"":11,""endColumnNum"":30,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@ae7950d"",""value"":""NS_IDENT@365553de.DRINKER2"",""pos"":{""lineNum"":9,""columnNum"":23,""endLineNum"":9,""endColumnNum"":33,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@20095ab4"",""value"":""NS_IDENT@34a0ef00.drinker"",""pos"":{""lineNum"":11,""columnNum"":22,""endLineNum"":11,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5e8604bf"",""value"":""NS_IDENT@365553de.DRINKER1"",""pos"":{""lineNum"":11,""columnNum"":8,""endLineNum"":11,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3daa82be"",""value"":""NS_IDENT@34a0ef00.BEER"",""pos"":{""lineNum"":9,""columnNum"":36,""endLineNum"":9,""endColumnNum"":41,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@64aad6db"",""value"":""NS_IDENT@365553de.DRINKER1"",""pos"":{""lineNum"":9,""columnNum"":10,""endLineNum"":9,""endColumnNum"":20,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":9,""columnNum"":3,""endLineNum"":11,""endColumnNum"":30,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@7e8a46b7"",""alias"":""DRINKER2"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@4ed38226"",""value"":""NS_IDENT@e344ad3.DRINKER1"",""pos"":{""lineNum"":14,""columnNum"":10,""endLineNum"":14,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3d43fe"",""value"":""NS_IDENT@e344ad3.DRINKER2"",""pos"":{""lineNum"":14,""columnNum"":23,""endLineNum"":14,""endColumnNum"":33,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4f8b4bd0"",""value"":""NS_IDENT@de18f63.BEER"",""pos"":{""lineNum"":14,""columnNum"":36,""endLineNum"":14,""endColumnNum"":41,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@e344ad3"",""NS_IDENT@de18f63""],""fromNode"":{""id"":""OP_JOIN@2fe88a09"",""value"":""COMMA"",""pos"":{""lineNum"":15,""columnNum"":22,""endLineNum"":15,""endColumnNum"":22,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@1917d90f"",""value"":""NS_IDENT@e344ad3"",""pos"":{""lineNum"":15,""columnNum"":7,""endLineNum"":15,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@66bfd864"",""value"":""NS_IDENT@de18f63"",""pos"":{""lineNum"":15,""columnNum"":24,""endLineNum"":15,""endColumnNum"":28,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@7e9da981"",""value"":""="",""pos"":{""lineNum"":16,""columnNum"":8,""endLineNum"":16,""endColumnNum"":30,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@53e3a87a"",""value"":""NS_IDENT@e344ad3.DRINKER2"",""pos"":{""lineNum"":16,""columnNum"":8,""endLineNum"":16,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@40368a46"",""value"":""NS_IDENT@de18f63.drinker"",""pos"":{""lineNum"":16,""columnNum"":22,""endLineNum"":16,""endColumnNum"":30,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@4ed38226"",""value"":""NS_IDENT@e344ad3.DRINKER1"",""pos"":{""lineNum"":14,""columnNum"":10,""endLineNum"":14,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4f8b4bd0"",""value"":""NS_IDENT@de18f63.BEER"",""pos"":{""lineNum"":14,""columnNum"":36,""endLineNum"":14,""endColumnNum"":41,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3d43fe"",""value"":""NS_IDENT@e344ad3.DRINKER2"",""pos"":{""lineNum"":14,""columnNum"":23,""endLineNum"":14,""endColumnNum"":33,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@40368a46"",""value"":""NS_IDENT@de18f63.drinker"",""pos"":{""lineNum"":16,""columnNum"":22,""endLineNum"":16,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@53e3a87a"",""value"":""NS_IDENT@e344ad3.DRINKER2"",""pos"":{""lineNum"":16,""columnNum"":8,""endLineNum"":16,""endColumnNum"":18,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":14,""columnNum"":3,""endLineNum"":16,""endColumnNum"":30,""quoted"":false},""children"":{}},{""id"":""BLOCK_SETOP@4912d525"",""alias"":""DIFF"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@2bfbffb2"",""rightBlockId"":""BLOCK_SELECT@4cdd2c73"",""pos"":{""lineNum"":19,""columnNum"":4,""endLineNum"":21,""endColumnNum"":47,""quoted"":false},""children"":{""BLOCK_SELECT@4cdd2c73"":{""id"":""BLOCK_SELECT@4cdd2c73"",""parentId"":""BLOCK_SETOP@4912d525"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@54aca26f"",""value"":""NS_IDENT@58a4a74d.DRINKER1"",""pos"":{""lineNum"":21,""columnNum"":10,""endLineNum"":21,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@35088e87"",""value"":""NS_IDENT@58a4a74d.DRINKER2"",""pos"":{""lineNum"":21,""columnNum"":20,""endLineNum"":21,""endColumnNum"":27,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7965a51c"",""value"":""NS_IDENT@58a4a74d.BEER"",""pos"":{""lineNum"":21,""columnNum"":30,""endLineNum"":21,""endColumnNum"":33,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@58a4a74d""],""fromNode"":{""id"":""JOIN_OPERAND@4abf3f0"",""value"":""NS_IDENT@58a4a74d"",""pos"":{""lineNum"":21,""columnNum"":40,""endLineNum"":21,""endColumnNum"":47,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@7965a51c"",""value"":""NS_IDENT@58a4a74d.BEER"",""pos"":{""lineNum"":21,""columnNum"":30,""endLineNum"":21,""endColumnNum"":33,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@54aca26f"",""value"":""NS_IDENT@58a4a74d.DRINKER1"",""pos"":{""lineNum"":21,""columnNum"":10,""endLineNum"":21,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@35088e87"",""value"":""NS_IDENT@58a4a74d.DRINKER2"",""pos"":{""lineNum"":21,""columnNum"":20,""endLineNum"":21,""endColumnNum"":27,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":21,""columnNum"":3,""endLineNum"":21,""endColumnNum"":47,""quoted"":false},""children"":{}},""BLOCK_SELECT@2bfbffb2"":{""id"":""BLOCK_SELECT@2bfbffb2"",""parentId"":""BLOCK_SETOP@4912d525"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@4d48bd85"",""value"":""NS_IDENT@15dd5ac2.DRINKER1"",""pos"":{""lineNum"":19,""columnNum"":11,""endLineNum"":19,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@58a120b0"",""value"":""NS_IDENT@15dd5ac2.DRINKER2"",""pos"":{""lineNum"":19,""columnNum"":21,""endLineNum"":19,""endColumnNum"":28,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2ff95fc6"",""value"":""NS_IDENT@15dd5ac2.BEER"",""pos"":{""lineNum"":19,""columnNum"":31,""endLineNum"":19,""endColumnNum"":34,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@15dd5ac2""],""fromNode"":{""id"":""JOIN_OPERAND@5ac7aa18"",""value"":""NS_IDENT@15dd5ac2"",""pos"":{""lineNum"":19,""columnNum"":41,""endLineNum"":19,""endColumnNum"":48,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@4d48bd85"",""value"":""NS_IDENT@15dd5ac2.DRINKER1"",""pos"":{""lineNum"":19,""columnNum"":11,""endLineNum"":19,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2ff95fc6"",""value"":""NS_IDENT@15dd5ac2.BEER"",""pos"":{""lineNum"":19,""columnNum"":31,""endLineNum"":19,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@58a120b0"",""value"":""NS_IDENT@15dd5ac2.DRINKER2"",""pos"":{""lineNum"":19,""columnNum"":21,""endLineNum"":19,""endColumnNum"":28,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":19,""columnNum"":4,""endLineNum"":19,""endColumnNum"":48,""quoted"":false},""children"":{}}}}]}
"
"WITH Temp1 AS
  (SELECT DISTINCT A.name as drinker1, B.name as drinker2
  FROM drinker as A, drinker as B
  WHERE A.name != B.name),
  Temp2 AS
  (
    (SELECT DISTINCT  D.name, C.beer, C.drinker
    FROM likes C, drinker D
    WHERE C.drinker != D.name)
  EXCEPT ALL
    (SELECT DISTINCT E.drinker, E.beer, F.drinker
    FROM likes E, likes F
    WHERE E.drinker != F.drinker and E.beer = F.beer)
  )
SELECT DISTINCT drinker1, drinker2
FROM Temp1
EXCEPT ALL
(SELECT drinker, name
FROM Temp2)","{""failed"":true,""errorMsg"":""Parsing error at line 4, column 16. Query syntax may be incorrect""}
"
"/*
can't use views in online SQL tester

CREATE VIEW PairCountNoNull AS
SELECT L1.drinker AS drinker1, L2.drinker AS drinker2, count(*) AS counter
FROM likes L1, likes L2
WHERE L1.beer = L2.beer and L1.drinker <> L2.drinker
GROUP BY drinker1, drinker2;

CREATE VIEW NoLikesPairs AS
SELECT Numliked.name AS drinker1, Drinker.name AS drinker2, Numliked.counter AS counter
FROM 
  (SELECT name, count(drinker) AS counter
  FROM likes FULL OUTER JOIN drinker
    ON likes.drinker = drinker.name
  GROUP BY name) NumLiked JOIN Drinker
    ON Numliked.counter = 0;

CREATE VIEW PairCount AS
(NoLikesPairs
UNION ALL
PairCountNoNull)

SELECT drinker1, drinker2
FROM PairCount P
WHERE EXISTS
  (SELECT *
  FROM NumLiked N
  WHERE (P.drinker1 = N.drinker and P.counter = N.counter)
    OR P.counter = 0);
*/


WITH PairCount AS
  ((SELECT Numliked.name AS drinker1, Drinker.name AS drinker2, Numliked.counter AS counter
    FROM 
      (SELECT name, count(drinker) AS counter
      FROM likes FULL OUTER JOIN drinker
        ON likes.drinker = drinker.name
      GROUP BY name) NumLiked JOIN Drinker
        ON Numliked.counter = 0)
  UNION ALL
  (SELECT L1.drinker AS drinker1, L2.drinker AS drinker2, count(*) AS counter
  FROM likes L1, likes L2
  WHERE L1.beer = L2.beer and L1.drinker <> L2.drinker
  GROUP BY drinker1, drinker2))

SELECT drinker1, drinker2
FROM PairCount P
WHERE EXISTS
  (SELECT *
  FROM (SELECT name, count(drinker) AS counter
       FROM likes FULL OUTER JOIN drinker
         ON likes.drinker = drinker.name
       GROUP BY name) N
  WHERE ((P.drinker1 = N.name and P.counter = N.counter)
    OR P.counter = 0))
    AND P.drinker1 <> P.drinker2;","{""failed"":true,""errorMsg"":""From line 46, column 12 to line 46, column 19: Column 'DRINKER1' not found in any table""}
"
"select first.drinker1, first.drinker2 
from 
(select d.name as drinker1, d2.name as drinker2 
from drinker d, drinker d2
where d.name != d2.name) as first

except 

select second.drinker2, second.drinker1
from 
(select d.name as drinker1, d2.name as drinker2, beer 
from drinker d, drinker d2, likes l 
where d.name !=d2.name and l.drinker = d2.name

except

select d.name as drinker1, d2.name as drinker2, beer 
from drinker d, drinker d2, likes l 
where d.name !=d2.name and l.drinker = d.name) as second ; 
","{""failed"":true,""errorMsg"":""Parsing error at line 5, column 14. Query syntax may be incorrect""}
"
"with allPairs as (select one.name drinker1, two.name drinker2 from drinker one, drinker two where one.name <> two.name), 
firstD as (select allPairs.drinker1, allPairs.drinker2, l.beer from allPairs, likes l where allPairs.drinker1 = l.drinker),
secondD as (select allPairs.drinker1, allPairs.drinker2, l.beer from likes l, allPairs where allPairs.drinker2 = l.drinker),
exceptions as (select * from firstD except (select * from secondD))
select * from allPairs except (select exceptions.drinker1, exceptions.drinker2 from exceptions)","{""failed"":true,""errorMsg"":""Parsing error at line 1, column 26. Query syntax may be incorrect""}
"
"WITH Temp1 AS (
(SELECT DISTINCT d1.name as drinker1, d2.name as drinker2, likes.beer
FROM drinker d1, drinker d2, likes
WHERE d1.name != d2.name and d1.name = drinker)
EXCEPT
(SELECT DISTINCT d1.name as drinker1, d2.name as drinker2, likes.beer
FROM drinker d1, drinker d2, likes
WHERE d1.name != d2.name and d2.name = drinker))
(SELECT DISTINCT d1.name AS drinker1, d2.name AS drinker2
FROM drinker d1, drinker d2
WHERE d1.name != d2.name)
EXCEPT
(
SELECT drinker1, drinker2 FROM Temp1
);","{""failed"":true,""errorMsg"":""Parsing error at line 4, column 15. Query syntax may be incorrect""}
"
"SELECT distinct D1.name, D2.name
FROM drinker D1, drinker D2
WHERE D1.name <> D2.name AND (
NOT EXISTS 
((SELECT likes.beer
FROM drinker LEFT OUTER JOIN likes ON D1.name = likes.drinker) 
except 
(SELECT likes.beer
FROM drinker LEFT OUTER JOIN likes ON D2.name = likes.drinker))
OR EXISTS(
SELECT likes.drinker
FROM drinker LEFT OUTER JOIN likes ON drinker.name = likes.drinker
WHERE likes.drinker IS NULL
))

","{""blocks"":{""id"":""BLOCK_SELECT@5eeedb60"",""fields"":[""NAME VARCHAR(100)"",""NAME VARCHAR(100)""],""isDistinct"":true,""selectList"":[{""id"":""COLUMN_LOCAL@3fa76c61"",""value"":""NS_IDENT@3051e0b2.NAME"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@59546cfe"",""value"":""NS_IDENT@67c277a0.NAME"",""pos"":{""lineNum"":1,""columnNum"":26,""endLineNum"":1,""endColumnNum"":32,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@3051e0b2"",""NS_IDENT@67c277a0""],""fromNode"":{""id"":""OP_JOIN@226b143b"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":16,""endLineNum"":2,""endColumnNum"":16,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@f2e4acf"",""value"":""NS_IDENT@3051e0b2"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@24097e9b"",""value"":""NS_IDENT@67c277a0"",""pos"":{""lineNum"":2,""columnNum"":18,""endLineNum"":2,""endColumnNum"":24,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@6ed06f69"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":13,""endColumnNum"":27,""quoted"":false},""children"":[{""id"":""OP_BINARY@2d746ce4"",""value"":""<>"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@31da6b2e"",""value"":""NS_IDENT@3051e0b2.name"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7c6442c2"",""value"":""NS_IDENT@67c277a0.name"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@49798e84"",""value"":""OR"",""pos"":{""lineNum"":4,""columnNum"":1,""endLineNum"":13,""endColumnNum"":27,""quoted"":false},""children"":[{""id"":""OP_PREFIX@1948ea69"",""value"":""NOT"",""pos"":{""lineNum"":4,""columnNum"":1,""endLineNum"":9,""endColumnNum"":61,""quoted"":false},""children"":[{""id"":""OP_PREFIX@5dbf5634"",""value"":""EXISTS"",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":9,""endColumnNum"":61,""quoted"":false},""children"":[{""id"":""BLOCK_SETOP@2032e725"",""value"":""BLOCK_SETOP@2032e725"",""pos"":{""lineNum"":5,""columnNum"":3,""endLineNum"":9,""endColumnNum"":61,""quoted"":false},""children"":[]}]}]},{""id"":""OP_PREFIX@47e4d9d0"",""value"":""EXISTS"",""pos"":{""lineNum"":10,""columnNum"":4,""endLineNum"":13,""endColumnNum"":27,""quoted"":false},""children"":[{""id"":""BLOCK_SELECT@55cff952"",""value"":""BLOCK_SELECT@55cff952"",""pos"":{""lineNum"":11,""columnNum"":1,""endLineNum"":13,""endColumnNum"":27,""quoted"":false},""children"":[]}]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@7c6442c2"",""value"":""NS_IDENT@67c277a0.name"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@31da6b2e"",""value"":""NS_IDENT@3051e0b2.name"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@59546cfe"",""value"":""NS_IDENT@67c277a0.NAME"",""pos"":{""lineNum"":1,""columnNum"":26,""endLineNum"":1,""endColumnNum"":32,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3fa76c61"",""value"":""NS_IDENT@3051e0b2.NAME"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":23,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@67c277a0.name"",""NS_IDENT@3051e0b2.name""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":14,""endColumnNum"":2,""quoted"":false},""children"":{""BLOCK_SETOP@2032e725"":{""id"":""BLOCK_SETOP@2032e725"",""parentId"":""BLOCK_SELECT@5eeedb60"",""fields"":[""BEER VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@4d23015c"",""rightBlockId"":""BLOCK_SELECT@1ecfcbc9"",""pos"":{""lineNum"":5,""columnNum"":3,""endLineNum"":9,""endColumnNum"":61,""quoted"":false},""children"":{""BLOCK_SELECT@1ecfcbc9"":{""id"":""BLOCK_SELECT@1ecfcbc9"",""parentId"":""BLOCK_SETOP@2032e725"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@6a2eea2a"",""value"":""NS_IDENT@2ce45a7b.BEER"",""pos"":{""lineNum"":8,""columnNum"":9,""endLineNum"":8,""endColumnNum"":18,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@1be59f28"",""NS_IDENT@2ce45a7b""],""fromNode"":{""id"":""OP_JOIN@1965539b"",""value"":""LEFT"",""pos"":{""lineNum"":9,""columnNum"":25,""endLineNum"":9,""endColumnNum"":28,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@2fc07784"",""value"":""NS_IDENT@1be59f28"",""pos"":{""lineNum"":9,""columnNum"":6,""endLineNum"":9,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@353efdbf"",""value"":""NS_IDENT@2ce45a7b"",""pos"":{""lineNum"":9,""columnNum"":30,""endLineNum"":9,""endColumnNum"":34,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@3d43fe"",""value"":""="",""pos"":{""lineNum"":9,""columnNum"":39,""endLineNum"":9,""endColumnNum"":61,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@7e9da981"",""value"":""NS_IDENT@67c277a0.name"",""pos"":{""lineNum"":9,""columnNum"":39,""endLineNum"":9,""endColumnNum"":45,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4ed38226"",""value"":""NS_IDENT@2ce45a7b.drinker"",""pos"":{""lineNum"":9,""columnNum"":49,""endLineNum"":9,""endColumnNum"":61,""quoted"":false},""children"":[]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_CORRELATE@7e9da981"",""value"":""NS_IDENT@67c277a0.name"",""pos"":{""lineNum"":9,""columnNum"":39,""endLineNum"":9,""endColumnNum"":45,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4ed38226"",""value"":""NS_IDENT@2ce45a7b.drinker"",""pos"":{""lineNum"":9,""columnNum"":49,""endLineNum"":9,""endColumnNum"":61,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6a2eea2a"",""value"":""NS_IDENT@2ce45a7b.BEER"",""pos"":{""lineNum"":8,""columnNum"":9,""endLineNum"":8,""endColumnNum"":18,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@67c277a0""],""corrCtxIds"":[""BLOCK_SELECT@5eeedb60""],""pos"":{""lineNum"":8,""columnNum"":2,""endLineNum"":9,""endColumnNum"":61,""quoted"":false},""children"":{}},""BLOCK_SELECT@4d23015c"":{""id"":""BLOCK_SELECT@4d23015c"",""parentId"":""BLOCK_SETOP@2032e725"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@7f9ab969"",""value"":""NS_IDENT@8ed9cf.BEER"",""pos"":{""lineNum"":5,""columnNum"":10,""endLineNum"":5,""endColumnNum"":19,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@7b3315a5"",""NS_IDENT@8ed9cf""],""fromNode"":{""id"":""OP_JOIN@26dcd8c0"",""value"":""LEFT"",""pos"":{""lineNum"":6,""columnNum"":25,""endLineNum"":6,""endColumnNum"":28,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@5b22b970"",""value"":""NS_IDENT@7b3315a5"",""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@748fe51d"",""value"":""NS_IDENT@8ed9cf"",""pos"":{""lineNum"":6,""columnNum"":30,""endLineNum"":6,""endColumnNum"":34,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@5e8604bf"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":39,""endLineNum"":6,""endColumnNum"":61,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@b8a7e43"",""value"":""NS_IDENT@3051e0b2.name"",""pos"":{""lineNum"":6,""columnNum"":39,""endLineNum"":6,""endColumnNum"":45,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4a6c18ad"",""value"":""NS_IDENT@8ed9cf.drinker"",""pos"":{""lineNum"":6,""columnNum"":49,""endLineNum"":6,""endColumnNum"":61,""quoted"":false},""children"":[]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@7f9ab969"",""value"":""NS_IDENT@8ed9cf.BEER"",""pos"":{""lineNum"":5,""columnNum"":10,""endLineNum"":5,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@b8a7e43"",""value"":""NS_IDENT@3051e0b2.name"",""pos"":{""lineNum"":6,""columnNum"":39,""endLineNum"":6,""endColumnNum"":45,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4a6c18ad"",""value"":""NS_IDENT@8ed9cf.drinker"",""pos"":{""lineNum"":6,""columnNum"":49,""endLineNum"":6,""endColumnNum"":61,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@3051e0b2""],""corrCtxIds"":[""BLOCK_SELECT@5eeedb60""],""pos"":{""lineNum"":5,""columnNum"":3,""endLineNum"":6,""endColumnNum"":61,""quoted"":false},""children"":{}}}},""BLOCK_SELECT@55cff952"":{""id"":""BLOCK_SELECT@55cff952"",""parentId"":""BLOCK_SELECT@5eeedb60"",""fields"":[""DRINKER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@d8948cd"",""value"":""NS_IDENT@2bc9a775.DRINKER"",""pos"":{""lineNum"":11,""columnNum"":8,""endLineNum"":11,""endColumnNum"":20,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@545e57d7"",""NS_IDENT@2bc9a775""],""fromNode"":{""id"":""OP_JOIN@660591fb"",""value"":""LEFT"",""pos"":{""lineNum"":12,""columnNum"":25,""endLineNum"":12,""endColumnNum"":28,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@4a55a6e8"",""value"":""NS_IDENT@545e57d7"",""pos"":{""lineNum"":12,""columnNum"":6,""endLineNum"":12,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@8c46918"",""value"":""NS_IDENT@2bc9a775"",""pos"":{""lineNum"":12,""columnNum"":30,""endLineNum"":12,""endColumnNum"":34,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@5a8ba37c"",""value"":""="",""pos"":{""lineNum"":12,""columnNum"":39,""endLineNum"":12,""endColumnNum"":66,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@576c5536"",""value"":""NS_IDENT@545e57d7.name"",""pos"":{""lineNum"":12,""columnNum"":39,""endLineNum"":12,""endColumnNum"":50,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@55ecbafe"",""value"":""NS_IDENT@2bc9a775.drinker"",""pos"":{""lineNum"":12,""columnNum"":54,""endLineNum"":12,""endColumnNum"":66,""quoted"":false},""children"":[]}]}},""whereNode"":{""id"":""OP_POSTFIX@232cce0"",""value"":""IS NULL"",""pos"":{""lineNum"":13,""columnNum"":7,""endLineNum"":13,""endColumnNum"":27,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@37c2eacb"",""value"":""NS_IDENT@2bc9a775.drinker"",""pos"":{""lineNum"":13,""columnNum"":7,""endLineNum"":13,""endColumnNum"":19,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@576c5536"",""value"":""NS_IDENT@545e57d7.name"",""pos"":{""lineNum"":12,""columnNum"":39,""endLineNum"":12,""endColumnNum"":50,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@37c2eacb"",""value"":""NS_IDENT@2bc9a775.drinker"",""pos"":{""lineNum"":13,""columnNum"":7,""endLineNum"":13,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@d8948cd"",""value"":""NS_IDENT@2bc9a775.DRINKER"",""pos"":{""lineNum"":11,""columnNum"":8,""endLineNum"":11,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@55ecbafe"",""value"":""NS_IDENT@2bc9a775.drinker"",""pos"":{""lineNum"":12,""columnNum"":54,""endLineNum"":12,""endColumnNum"":66,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":11,""columnNum"":1,""endLineNum"":13,""endColumnNum"":27,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@8ed9cf"":{""tableId"":""NS_IDENT@8ed9cf"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":30,""endLineNum"":6,""endColumnNum"":34,""quoted"":false}},""NS_IDENT@67c277a0"":{""tableId"":""NS_IDENT@67c277a0"",""identifier"":""D2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":18,""endLineNum"":2,""endColumnNum"":27,""quoted"":false}},""NS_IDENT@2bc9a775"":{""tableId"":""NS_IDENT@2bc9a775"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":12,""columnNum"":30,""endLineNum"":12,""endColumnNum"":34,""quoted"":false}},""NS_IDENT@7b3315a5"":{""tableId"":""NS_IDENT@7b3315a5"",""identifier"":""DRINKER"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@1be59f28"":{""tableId"":""NS_IDENT@1be59f28"",""identifier"":""DRINKER"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":9,""columnNum"":6,""endLineNum"":9,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@545e57d7"":{""tableId"":""NS_IDENT@545e57d7"",""identifier"":""DRINKER"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":12,""columnNum"":6,""endLineNum"":12,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@2ce45a7b"":{""tableId"":""NS_IDENT@2ce45a7b"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":9,""columnNum"":30,""endLineNum"":9,""endColumnNum"":34,""quoted"":false}},""NS_IDENT@3051e0b2"":{""tableId"":""NS_IDENT@3051e0b2"",""identifier"":""D1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":15,""quoted"":false}}},""corrTables"":[""NS_IDENT@67c277a0"",""NS_IDENT@3051e0b2""]}
"
"WITH subsubq AS (
                SELECT l1.drinker, l2.drinker, l1.beer
		FROM likes l1, likes l2
		WHERE l1.drinker <> l2.drinker
		AND l1.beer = l2.beer
),

subq AS (
	SELECT l1.drinker, l2.drinker
	FROM likes l1, likes l2
	WHERE l1.drinker <> l2.drinker
	AND l1.beer <> l2.beer
	AND (l1.drinker, l2.drinker,l1.beer) NOT IN
	(SELECT * FROM subsubq)
),

nolikes AS (
        SELECT name
        FROM drinker
        WHERE name NOT IN (SELECT drinker FROM likes)
),

leftlikerightnolike AS (
        SELECT d1.name, d2.name
        FROM drinker d1, drinker d2
        WHERE d1.name IN (SELECT drinker FROM likes)
        AND d2.name IN (SELECT * FROM nolikes)
)

SELECT DISTINCT d1.name, d2.name
FROM drinker d1, drinker d2
WHERE d1.name <> d2.name
EXCEPT 
(
        (SELECT * FROM subq)
        UNION (SELECT * FROM leftlikerightnolike)
)
","{""failed"":true,""errorMsg"":""From line 2, column 17 to line 5, column 23: Column has duplicate column name 'DRINKER' and no column list specified""}
"
"((SELECT d1.name AS drinker1, d2.name AS drinker2
FROM drinker d1, drinker d2
WHERE d1 != d2)

EXCEPT

(SELECT d1, d2
FROM (

(SELECT d1, d2, l.beer AS b1
FROM likes l JOIN (SELECT d1.name AS d1, d2.name AS d2
FROM drinker d1, drinker d2) AS a ON l.drinker = d1)

EXCEPT

(SELECT l1.drinker AS d1, l2.drinker AS d2, l2.beer AS b1
FROM likes l1, likes l2
WHERE l1.beer = l2.beer AND l1.drinker != l2.drinker)) AS b))","{""failed"":true,""errorMsg"":""Parsing error at line 3, column 10. Query syntax may be incorrect""}
"
"/*WITH a AS (
    SELECT a1.drinker AS drinker1, a1.beer AS beer1, b.drinker AS drinker2, b.beer as beer2
    FROM likes a1, likes b
    WHERE a1.drinker <> b.drinker AND a1.beer = b.beer
  ),
  b AS (
    SELECT a.drinker AS drinker1, a.beer AS beer1, b.drinker AS drinker2, b.beer as beer2
    FROM likes a, likes b
    WHERE a.drinker <> b.drinker
  ),
  c AS (
    (SELECT * FROM b)
    EXCEPT ALL
    (SELECT * FROM a)
  ),
  d AS (
    SELECT * 
    FROM c c1, c c2
    WHERE c1.drinker1 = c2.drinker1 AND c1.drinker2 = c2.drinker2 AND c1.beer1 = c2.beer2 AND c1.beer2 = c2.beer1
  )
  SELECT *
  FROM d*/
WITH a AS (
  SELECT name as drinker1, drinker as drinker2, beer
  FROM likes l, drinker d 
  WHERE l.drinker <> d.name
),
b AS (
  SELECT DISTINCT drinker1, drinker2, a.beer
  FROM a, likes l
  WHERE a.drinker1 = l.drinker AND a.beer = l.beer
),
c AS (
  SELECT drinker1, drinker2, count(beer)
  FROM b
  GROUP BY drinker1, drinker2
),
d AS (
  SELECT name as drinker, count(beer)
  FROM likes FULL OUTER JOIN drinker on likes.drinker = drinker.name
  GROUP BY name
)
SELECT c.drinker1, c.drinker2
FROM c, d
WHERE (c.count >= d.count OR (c.count IS NULL AND d.count IS NULL)) AND c.drinker1 = d.drinker
","{""failed"":true,""errorMsg"":""Parsing error at line 45, column 9. Query syntax may be incorrect""}
"
"select a.name as drinker1, b.name as drinker2 from drinker a, drinker b where a.name <> b.name and not exists(select * from likes c where c.drinker = a.name and c.beer not in(select beer from likes d where d.drinker = b.name))","{""blocks"":{""id"":""BLOCK_SELECT@3f36b447"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@3c7cfcbb"",""value"":""NS_IDENT@28d79cba.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@1bfe3203"",""value"":""NS_IDENT@6093d508.NAME"",""pos"":{""lineNum"":1,""columnNum"":28,""endLineNum"":1,""endColumnNum"":33,""quoted"":false},""children"":[],""alias"":""DRINKER2""}],""fromItemIds"":[""NS_IDENT@28d79cba"",""NS_IDENT@6093d508""],""fromNode"":{""id"":""OP_JOIN@72ed9aad"",""value"":""COMMA"",""pos"":{""lineNum"":1,""columnNum"":61,""endLineNum"":1,""endColumnNum"":61,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@4690f583"",""value"":""NS_IDENT@28d79cba"",""pos"":{""lineNum"":1,""columnNum"":52,""endLineNum"":1,""endColumnNum"":58,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@59712875"",""value"":""NS_IDENT@6093d508"",""pos"":{""lineNum"":1,""columnNum"":63,""endLineNum"":1,""endColumnNum"":69,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@6d4a65c6"",""value"":""AND"",""pos"":{""lineNum"":1,""columnNum"":79,""endLineNum"":1,""endColumnNum"":225,""quoted"":false},""children"":[{""id"":""OP_BINARY@4784013e"",""value"":""<>"",""pos"":{""lineNum"":1,""columnNum"":79,""endLineNum"":1,""endColumnNum"":94,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4b2a30d"",""value"":""NS_IDENT@28d79cba.name"",""pos"":{""lineNum"":1,""columnNum"":79,""endLineNum"":1,""endColumnNum"":84,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3a91d146"",""value"":""NS_IDENT@6093d508.name"",""pos"":{""lineNum"":1,""columnNum"":89,""endLineNum"":1,""endColumnNum"":94,""quoted"":false},""children"":[]}]},{""id"":""OP_PREFIX@5965844d"",""value"":""NOT"",""pos"":{""lineNum"":1,""columnNum"":100,""endLineNum"":1,""endColumnNum"":225,""quoted"":false},""children"":[{""id"":""OP_PREFIX@6f952d6c"",""value"":""EXISTS"",""pos"":{""lineNum"":1,""columnNum"":104,""endLineNum"":1,""endColumnNum"":225,""quoted"":false},""children"":[{""id"":""BLOCK_SELECT@5e742e4"",""value"":""BLOCK_SELECT@5e742e4"",""pos"":{""lineNum"":1,""columnNum"":111,""endLineNum"":1,""endColumnNum"":225,""quoted"":false},""children"":[]}]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@3c7cfcbb"",""value"":""NS_IDENT@28d79cba.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":13,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@3a91d146"",""value"":""NS_IDENT@6093d508.name"",""pos"":{""lineNum"":1,""columnNum"":89,""endLineNum"":1,""endColumnNum"":94,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1bfe3203"",""value"":""NS_IDENT@6093d508.NAME"",""pos"":{""lineNum"":1,""columnNum"":28,""endLineNum"":1,""endColumnNum"":33,""quoted"":false},""children"":[],""alias"":""DRINKER2""},{""id"":""COLUMN_LOCAL@4b2a30d"",""value"":""NS_IDENT@28d79cba.name"",""pos"":{""lineNum"":1,""columnNum"":79,""endLineNum"":1,""endColumnNum"":84,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@28d79cba.name"",""NS_IDENT@6093d508.name""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":1,""endColumnNum"":226,""quoted"":false},""children"":{""BLOCK_SELECT@5e742e4"":{""id"":""BLOCK_SELECT@5e742e4"",""parentId"":""BLOCK_SELECT@3f36b447"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@1bcf67e8"",""value"":""*"",""pos"":{""lineNum"":1,""columnNum"":118,""endLineNum"":1,""endColumnNum"":118,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@23e44287""],""fromNode"":{""id"":""JOIN_OPERAND@458544e0"",""value"":""NS_IDENT@23e44287"",""pos"":{""lineNum"":1,""columnNum"":125,""endLineNum"":1,""endColumnNum"":129,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@444548a0"",""value"":""AND"",""pos"":{""lineNum"":1,""columnNum"":139,""endLineNum"":1,""endColumnNum"":224,""quoted"":false},""children"":[{""id"":""OP_BINARY@73a00e09"",""value"":""="",""pos"":{""lineNum"":1,""columnNum"":139,""endLineNum"":1,""endColumnNum"":156,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@383f1975"",""value"":""NS_IDENT@23e44287.drinker"",""pos"":{""lineNum"":1,""columnNum"":139,""endLineNum"":1,""endColumnNum"":147,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@441cc260"",""value"":""NS_IDENT@28d79cba.name"",""pos"":{""lineNum"":1,""columnNum"":151,""endLineNum"":1,""endColumnNum"":156,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@66e889df"",""value"":""NOT IN"",""pos"":{""lineNum"":1,""columnNum"":162,""endLineNum"":1,""endColumnNum"":224,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@26dcd8c0"",""value"":""NS_IDENT@23e44287.beer"",""pos"":{""lineNum"":1,""columnNum"":162,""endLineNum"":1,""endColumnNum"":167,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@175acfb2"",""value"":""BLOCK_SELECT@175acfb2"",""pos"":{""lineNum"":1,""columnNum"":176,""endLineNum"":1,""endColumnNum"":224,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@26dcd8c0"",""value"":""NS_IDENT@23e44287.beer"",""pos"":{""lineNum"":1,""columnNum"":162,""endLineNum"":1,""endColumnNum"":167,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@441cc260"",""value"":""NS_IDENT@28d79cba.name"",""pos"":{""lineNum"":1,""columnNum"":151,""endLineNum"":1,""endColumnNum"":156,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@383f1975"",""value"":""NS_IDENT@23e44287.drinker"",""pos"":{""lineNum"":1,""columnNum"":139,""endLineNum"":1,""endColumnNum"":147,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@28d79cba"",""NS_IDENT@6093d508""],""corrCtxIds"":[""BLOCK_SELECT@3f36b447""],""pos"":{""lineNum"":1,""columnNum"":111,""endLineNum"":1,""endColumnNum"":225,""quoted"":false},""children"":{""BLOCK_SELECT@175acfb2"":{""id"":""BLOCK_SELECT@175acfb2"",""parentId"":""BLOCK_SELECT@5e742e4"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@131fcb6f"",""value"":""NS_IDENT@250b236d.BEER"",""pos"":{""lineNum"":1,""columnNum"":183,""endLineNum"":1,""endColumnNum"":186,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@250b236d""],""fromNode"":{""id"":""JOIN_OPERAND@247667dd"",""value"":""NS_IDENT@250b236d"",""pos"":{""lineNum"":1,""columnNum"":193,""endLineNum"":1,""endColumnNum"":197,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@55b8dbda"",""value"":""="",""pos"":{""lineNum"":1,""columnNum"":207,""endLineNum"":1,""endColumnNum"":224,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@3766c667"",""value"":""NS_IDENT@250b236d.drinker"",""pos"":{""lineNum"":1,""columnNum"":207,""endLineNum"":1,""endColumnNum"":215,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@773c0293"",""value"":""NS_IDENT@6093d508.name"",""pos"":{""lineNum"":1,""columnNum"":219,""endLineNum"":1,""endColumnNum"":224,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_CORRELATE@773c0293"",""value"":""NS_IDENT@6093d508.name"",""pos"":{""lineNum"":1,""columnNum"":219,""endLineNum"":1,""endColumnNum"":224,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@131fcb6f"",""value"":""NS_IDENT@250b236d.BEER"",""pos"":{""lineNum"":1,""columnNum"":183,""endLineNum"":1,""endColumnNum"":186,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3766c667"",""value"":""NS_IDENT@250b236d.drinker"",""pos"":{""lineNum"":1,""columnNum"":207,""endLineNum"":1,""endColumnNum"":215,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@6093d508""],""corrCtxIds"":[""BLOCK_SELECT@3f36b447""],""pos"":{""lineNum"":1,""columnNum"":176,""endLineNum"":1,""endColumnNum"":224,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@6093d508"":{""tableId"":""NS_IDENT@6093d508"",""identifier"":""B"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":63,""endLineNum"":1,""endColumnNum"":71,""quoted"":false}},""NS_IDENT@28d79cba"":{""tableId"":""NS_IDENT@28d79cba"",""identifier"":""A"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":52,""endLineNum"":1,""endColumnNum"":60,""quoted"":false}},""NS_IDENT@23e44287"":{""tableId"":""NS_IDENT@23e44287"",""identifier"":""C"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":125,""endLineNum"":1,""endColumnNum"":131,""quoted"":false}},""NS_IDENT@250b236d"":{""tableId"":""NS_IDENT@250b236d"",""identifier"":""D"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":193,""endLineNum"":1,""endColumnNum"":199,""quoted"":false}}},""corrTables"":[""NS_IDENT@6093d508"",""NS_IDENT@28d79cba""]}
"
"WITH pairs AS
(SELECT drinker1.name d1, drinker2.name d2
 FROM drinker drinker1, drinker drinker2
 WHERE drinker1.name <> drinker2.name), 

one AS
(SELECT pairs.d1, pairs.d2, L.beer
 FROM likes L, pairs
 WHERE pairs.d1 = L.drinker),

two AS
(SELECT pairs.d1, pairs.d2, L.beer
 FROM likes L, pairs
 WHERE pairs.d2 = L.drinker),

difference AS
(SELECT *
 FROM one
 EXCEPT (SELECT * FROM two))

SELECT *
FROM pairs
EXCEPT (SELECT difference.d1, difference.d2 FROM difference)","{""failed"":true,""errorMsg"":""Parsing error at line 6, column 1. Query syntax may be incorrect""}
"
"SELECT DISTINCT l1.drinker, l2.drinker 
from likes l1, likes l2
where (l1.drinker <> l2.drinker and l1.beer = l2.beer and (SELECT COUNT(beer) from likes where drinker = l1.drinker) < (SELECT COUNT(beer) from likes where drinker=l2.drinker))","{""blocks"":{""id"":""BLOCK_SELECT@40021799"",""fields"":[""DRINKER VARCHAR(100)"",""DRINKER VARCHAR(100)""],""isDistinct"":true,""selectList"":[{""id"":""COLUMN_LOCAL@6fc3e1a4"",""value"":""NS_IDENT@2e34384c.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2d5f7182"",""value"":""NS_IDENT@58294867.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":29,""endLineNum"":1,""endColumnNum"":38,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@2e34384c"",""NS_IDENT@58294867""],""fromNode"":{""id"":""OP_JOIN@5d58c727"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":14,""endLineNum"":2,""endColumnNum"":14,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@3a095ec0"",""value"":""NS_IDENT@2e34384c"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@4f20a5e0"",""value"":""NS_IDENT@58294867"",""pos"":{""lineNum"":2,""columnNum"":16,""endLineNum"":2,""endColumnNum"":20,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@49798e84"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":8,""endLineNum"":3,""endColumnNum"":174,""quoted"":false},""children"":[{""id"":""OP_BINARY@1948ea69"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":8,""endLineNum"":3,""endColumnNum"":53,""quoted"":false},""children"":[{""id"":""OP_BINARY@4390f46e"",""value"":""<>"",""pos"":{""lineNum"":3,""columnNum"":8,""endLineNum"":3,""endColumnNum"":31,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5af97169"",""value"":""NS_IDENT@2e34384c.drinker"",""pos"":{""lineNum"":3,""columnNum"":8,""endLineNum"":3,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@121c54fa"",""value"":""NS_IDENT@58294867.drinker"",""pos"":{""lineNum"":3,""columnNum"":22,""endLineNum"":3,""endColumnNum"":31,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@5dbf5634"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":37,""endLineNum"":3,""endColumnNum"":53,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7c6442c2"",""value"":""NS_IDENT@2e34384c.beer"",""pos"":{""lineNum"":3,""columnNum"":37,""endLineNum"":3,""endColumnNum"":43,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2d746ce4"",""value"":""NS_IDENT@58294867.beer"",""pos"":{""lineNum"":3,""columnNum"":47,""endLineNum"":3,""endColumnNum"":53,""quoted"":false},""children"":[]}]}]},{""id"":""OP_BINARY@47e4d9d0"",""value"":""<"",""pos"":{""lineNum"":3,""columnNum"":60,""endLineNum"":3,""endColumnNum"":174,""quoted"":false},""children"":[{""id"":""BLOCK_SELECT_SCALAR@34dc85a"",""value"":""BLOCK_SELECT@4e868ef5"",""pos"":{""lineNum"":3,""columnNum"":60,""endLineNum"":3,""endColumnNum"":115,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT_SCALAR@74ad8d05"",""value"":""BLOCK_SELECT@6d2d99fc"",""pos"":{""lineNum"":3,""columnNum"":121,""endLineNum"":3,""endColumnNum"":174,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@7c6442c2"",""value"":""NS_IDENT@2e34384c.beer"",""pos"":{""lineNum"":3,""columnNum"":37,""endLineNum"":3,""endColumnNum"":43,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@121c54fa"",""value"":""NS_IDENT@58294867.drinker"",""pos"":{""lineNum"":3,""columnNum"":22,""endLineNum"":3,""endColumnNum"":31,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6fc3e1a4"",""value"":""NS_IDENT@2e34384c.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2d5f7182"",""value"":""NS_IDENT@58294867.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":29,""endLineNum"":1,""endColumnNum"":38,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5af97169"",""value"":""NS_IDENT@2e34384c.drinker"",""pos"":{""lineNum"":3,""columnNum"":8,""endLineNum"":3,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2d746ce4"",""value"":""NS_IDENT@58294867.beer"",""pos"":{""lineNum"":3,""columnNum"":47,""endLineNum"":3,""endColumnNum"":53,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@58294867.drinker"",""NS_IDENT@2e34384c.drinker""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":3,""endColumnNum"":176,""quoted"":false},""children"":{""BLOCK_SELECT@4e868ef5"":{""id"":""BLOCK_SELECT@4e868ef5"",""parentId"":""BLOCK_SELECT@40021799"",""fields"":[""EXPR$0 BIGINT""],""isDistinct"":false,""selectList"":[{""id"":""OP_AGG_FUNC@40368a46"",""value"":""COUNT"",""pos"":{""lineNum"":3,""columnNum"":67,""endLineNum"":3,""endColumnNum"":77,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7e9da981"",""value"":""NS_IDENT@7b3315a5.BEER"",""pos"":{""lineNum"":3,""columnNum"":73,""endLineNum"":3,""endColumnNum"":76,""quoted"":false},""children"":[]}]}],""fromItemIds"":[""NS_IDENT@7b3315a5""],""fromNode"":{""id"":""JOIN_OPERAND@1d4664d7"",""value"":""NS_IDENT@7b3315a5"",""pos"":{""lineNum"":3,""columnNum"":84,""endLineNum"":3,""endColumnNum"":88,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@7f9ab969"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":96,""endLineNum"":3,""endColumnNum"":115,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@67403656"",""value"":""NS_IDENT@7b3315a5.drinker"",""pos"":{""lineNum"":3,""columnNum"":96,""endLineNum"":3,""endColumnNum"":102,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@5a6482a9"",""value"":""NS_IDENT@2e34384c.drinker"",""pos"":{""lineNum"":3,""columnNum"":106,""endLineNum"":3,""endColumnNum"":115,""quoted"":false},""children"":[]}]},""isAggregate"":true,""identifiers"":[{""id"":""COLUMN_LOCAL@7e9da981"",""value"":""NS_IDENT@7b3315a5.BEER"",""pos"":{""lineNum"":3,""columnNum"":73,""endLineNum"":3,""endColumnNum"":76,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@67403656"",""value"":""NS_IDENT@7b3315a5.drinker"",""pos"":{""lineNum"":3,""columnNum"":96,""endLineNum"":3,""endColumnNum"":102,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@5a6482a9"",""value"":""NS_IDENT@2e34384c.drinker"",""pos"":{""lineNum"":3,""columnNum"":106,""endLineNum"":3,""endColumnNum"":115,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@2e34384c""],""corrCtxIds"":[""BLOCK_SELECT@40021799""],""pos"":{""lineNum"":3,""columnNum"":60,""endLineNum"":3,""endColumnNum"":115,""quoted"":false},""children"":{}},""BLOCK_SELECT@6d2d99fc"":{""id"":""BLOCK_SELECT@6d2d99fc"",""parentId"":""BLOCK_SELECT@40021799"",""fields"":[""EXPR$0 BIGINT""],""isDistinct"":false,""selectList"":[{""id"":""OP_AGG_FUNC@5fb7183b"",""value"":""COUNT"",""pos"":{""lineNum"":3,""columnNum"":128,""endLineNum"":3,""endColumnNum"":138,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@476a736d"",""value"":""NS_IDENT@540dbda9.BEER"",""pos"":{""lineNum"":3,""columnNum"":134,""endLineNum"":3,""endColumnNum"":137,""quoted"":false},""children"":[]}]}],""fromItemIds"":[""NS_IDENT@540dbda9""],""fromNode"":{""id"":""JOIN_OPERAND@bdecc21"",""value"":""NS_IDENT@540dbda9"",""pos"":{""lineNum"":3,""columnNum"":145,""endLineNum"":3,""endColumnNum"":149,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@5a8ba37c"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":157,""endLineNum"":3,""endColumnNum"":174,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@576c5536"",""value"":""NS_IDENT@540dbda9.drinker"",""pos"":{""lineNum"":3,""columnNum"":157,""endLineNum"":3,""endColumnNum"":163,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@55ecbafe"",""value"":""NS_IDENT@58294867.drinker"",""pos"":{""lineNum"":3,""columnNum"":165,""endLineNum"":3,""endColumnNum"":174,""quoted"":false},""children"":[]}]},""isAggregate"":true,""identifiers"":[{""id"":""COLUMN_LOCAL@476a736d"",""value"":""NS_IDENT@540dbda9.BEER"",""pos"":{""lineNum"":3,""columnNum"":134,""endLineNum"":3,""endColumnNum"":137,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@576c5536"",""value"":""NS_IDENT@540dbda9.drinker"",""pos"":{""lineNum"":3,""columnNum"":157,""endLineNum"":3,""endColumnNum"":163,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@55ecbafe"",""value"":""NS_IDENT@58294867.drinker"",""pos"":{""lineNum"":3,""columnNum"":165,""endLineNum"":3,""endColumnNum"":174,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@58294867""],""corrCtxIds"":[""BLOCK_SELECT@40021799""],""pos"":{""lineNum"":3,""columnNum"":121,""endLineNum"":3,""endColumnNum"":174,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@540dbda9"":{""tableId"":""NS_IDENT@540dbda9"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":145,""endLineNum"":3,""endColumnNum"":149,""quoted"":false}},""NS_IDENT@2e34384c"":{""tableId"":""NS_IDENT@2e34384c"",""identifier"":""L1"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":13,""quoted"":false}},""NS_IDENT@7b3315a5"":{""tableId"":""NS_IDENT@7b3315a5"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":84,""endLineNum"":3,""endColumnNum"":88,""quoted"":false}},""NS_IDENT@58294867"":{""tableId"":""NS_IDENT@58294867"",""identifier"":""L2"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":16,""endLineNum"":2,""endColumnNum"":23,""quoted"":false}}},""corrTables"":[""NS_IDENT@2e34384c"",""NS_IDENT@58294867""]}
"
"with dislikes as ((select distinct likes.drinker, beer.name as beer
from likes, beer
where likes.beer != beer.name) except (select * from likes)),
Temp2 as (
  select likes.drinker, dislikes.drinker
  from dislikes, likes
  where dislikes.beer = likes.beer
)
(select drinker.name, likes.drinker from (drinker left join likes on drinker.name != likes.drinker)) except (select * from Temp2);","{""failed"":true,""errorMsg"":""Parsing error at line 3, column 18. Query syntax may be incorrect""}
"
"WITH pairs AS (SELECT d1.name AS n1, d2.name AS n2 FROM drinker d1, drinker d2 WHERE d1.name != d2.name),
p1like AS (SELECT pairs.n1, pairs.n2, beer FROM pairs, likes WHERE pairs.n1 = likes.drinker),
p2like AS (SELECT pairs.n1, pairs.n2, beer FROM pairs, likes WHERE pairs.n2 = likes.drinker),
likeDIFF AS ((Select * FROM p1like) EXCEPT (Select * FROM p2like))
(SELECT * FROM pairs) EXCEPT (SELECT n1, n2 FROM likediff);","{""failed"":true,""errorMsg"":""Parsing error at line 1, column 94. Query syntax may be incorrect""}
"
"SELECT DISTINCT drinker1.name, drinker2.name
FROM drinker AS drinker1, drinker AS drinker2
WHERE drinker1.name <> drinker2.name AND 
NOT EXISTS
((SELECT beer FROM likes WHERE drinker = drinker1.name)
EXCEPT
(SELECT beer FROM likes WHERE drinker = drinker2.name))
","{""blocks"":{""id"":""BLOCK_SELECT@847f3e7"",""fields"":[""NAME VARCHAR(100)"",""NAME VARCHAR(100)""],""isDistinct"":true,""selectList"":[{""id"":""COLUMN_LOCAL@205b132e"",""value"":""NS_IDENT@352e787a.NAME"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3cbcd8f3"",""value"":""NS_IDENT@385ef531.NAME"",""pos"":{""lineNum"":1,""columnNum"":32,""endLineNum"":1,""endColumnNum"":44,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@352e787a"",""NS_IDENT@385ef531""],""fromNode"":{""id"":""OP_JOIN@4a55a6e8"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":25,""endLineNum"":2,""endColumnNum"":25,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@226b143b"",""value"":""NS_IDENT@352e787a"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@682bd3c4"",""value"":""NS_IDENT@385ef531"",""pos"":{""lineNum"":2,""columnNum"":27,""endLineNum"":2,""endColumnNum"":33,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@49798e84"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":7,""endColumnNum"":53,""quoted"":false},""children"":[{""id"":""OP_BINARY@5dbf5634"",""value"":""<>"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":36,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@61c76850"",""value"":""NS_IDENT@352e787a.name"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2d746ce4"",""value"":""NS_IDENT@385ef531.name"",""pos"":{""lineNum"":3,""columnNum"":24,""endLineNum"":3,""endColumnNum"":36,""quoted"":false},""children"":[]}]},{""id"":""OP_PREFIX@47e4d9d0"",""value"":""NOT"",""pos"":{""lineNum"":4,""columnNum"":1,""endLineNum"":7,""endColumnNum"":53,""quoted"":false},""children"":[{""id"":""OP_PREFIX@1948ea69"",""value"":""EXISTS"",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":7,""endColumnNum"":53,""quoted"":false},""children"":[{""id"":""BLOCK_SETOP@773c0293"",""value"":""BLOCK_SETOP@773c0293"",""pos"":{""lineNum"":5,""columnNum"":3,""endLineNum"":7,""endColumnNum"":53,""quoted"":false},""children"":[]}]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@2d746ce4"",""value"":""NS_IDENT@385ef531.name"",""pos"":{""lineNum"":3,""columnNum"":24,""endLineNum"":3,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@61c76850"",""value"":""NS_IDENT@352e787a.name"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@205b132e"",""value"":""NS_IDENT@352e787a.NAME"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3cbcd8f3"",""value"":""NS_IDENT@385ef531.NAME"",""pos"":{""lineNum"":1,""columnNum"":32,""endLineNum"":1,""endColumnNum"":44,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@385ef531.name"",""NS_IDENT@352e787a.name""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":7,""endColumnNum"":55,""quoted"":false},""children"":{""BLOCK_SETOP@773c0293"":{""id"":""BLOCK_SETOP@773c0293"",""parentId"":""BLOCK_SELECT@847f3e7"",""fields"":[""BEER VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@55b8dbda"",""rightBlockId"":""BLOCK_SELECT@1965539b"",""pos"":{""lineNum"":5,""columnNum"":3,""endLineNum"":7,""endColumnNum"":53,""quoted"":false},""children"":{""BLOCK_SELECT@1965539b"":{""id"":""BLOCK_SELECT@1965539b"",""parentId"":""BLOCK_SETOP@773c0293"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@127f9161"",""value"":""NS_IDENT@6a84bc3f.BEER"",""pos"":{""lineNum"":7,""columnNum"":9,""endLineNum"":7,""endColumnNum"":12,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@6a84bc3f""],""fromNode"":{""id"":""JOIN_OPERAND@2fc07784"",""value"":""NS_IDENT@6a84bc3f"",""pos"":{""lineNum"":7,""columnNum"":19,""endLineNum"":7,""endColumnNum"":23,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@62e7dffa"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":31,""endLineNum"":7,""endColumnNum"":53,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4c2869a9"",""value"":""NS_IDENT@6a84bc3f.drinker"",""pos"":{""lineNum"":7,""columnNum"":31,""endLineNum"":7,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@518cf84a"",""value"":""NS_IDENT@385ef531.name"",""pos"":{""lineNum"":7,""columnNum"":41,""endLineNum"":7,""endColumnNum"":53,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@127f9161"",""value"":""NS_IDENT@6a84bc3f.BEER"",""pos"":{""lineNum"":7,""columnNum"":9,""endLineNum"":7,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@518cf84a"",""value"":""NS_IDENT@385ef531.name"",""pos"":{""lineNum"":7,""columnNum"":41,""endLineNum"":7,""endColumnNum"":53,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4c2869a9"",""value"":""NS_IDENT@6a84bc3f.drinker"",""pos"":{""lineNum"":7,""columnNum"":31,""endLineNum"":7,""endColumnNum"":37,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@385ef531""],""corrCtxIds"":[""BLOCK_SELECT@847f3e7""],""pos"":{""lineNum"":7,""columnNum"":2,""endLineNum"":7,""endColumnNum"":53,""quoted"":false},""children"":{}},""BLOCK_SELECT@55b8dbda"":{""id"":""BLOCK_SELECT@55b8dbda"",""parentId"":""BLOCK_SETOP@773c0293"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@5a6482a9"",""value"":""NS_IDENT@3104f7bd.BEER"",""pos"":{""lineNum"":5,""columnNum"":10,""endLineNum"":5,""endColumnNum"":13,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@3104f7bd""],""fromNode"":{""id"":""JOIN_OPERAND@7ca0863b"",""value"":""NS_IDENT@3104f7bd"",""pos"":{""lineNum"":5,""columnNum"":20,""endLineNum"":5,""endColumnNum"":24,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@766a4535"",""value"":""="",""pos"":{""lineNum"":5,""columnNum"":32,""endLineNum"":5,""endColumnNum"":54,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7cf162bc"",""value"":""NS_IDENT@3104f7bd.drinker"",""pos"":{""lineNum"":5,""columnNum"":32,""endLineNum"":5,""endColumnNum"":38,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@3721177d"",""value"":""NS_IDENT@352e787a.name"",""pos"":{""lineNum"":5,""columnNum"":42,""endLineNum"":5,""endColumnNum"":54,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_CORRELATE@3721177d"",""value"":""NS_IDENT@352e787a.name"",""pos"":{""lineNum"":5,""columnNum"":42,""endLineNum"":5,""endColumnNum"":54,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7cf162bc"",""value"":""NS_IDENT@3104f7bd.drinker"",""pos"":{""lineNum"":5,""columnNum"":32,""endLineNum"":5,""endColumnNum"":38,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5a6482a9"",""value"":""NS_IDENT@3104f7bd.BEER"",""pos"":{""lineNum"":5,""columnNum"":10,""endLineNum"":5,""endColumnNum"":13,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@352e787a""],""corrCtxIds"":[""BLOCK_SELECT@847f3e7""],""pos"":{""lineNum"":5,""columnNum"":3,""endLineNum"":5,""endColumnNum"":54,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@352e787a"":{""tableId"":""NS_IDENT@352e787a"",""identifier"":""DRINKER1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":24,""quoted"":false}},""NS_IDENT@3104f7bd"":{""tableId"":""NS_IDENT@3104f7bd"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":20,""endLineNum"":5,""endColumnNum"":24,""quoted"":false}},""NS_IDENT@6a84bc3f"":{""tableId"":""NS_IDENT@6a84bc3f"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":19,""endLineNum"":7,""endColumnNum"":23,""quoted"":false}},""NS_IDENT@385ef531"":{""tableId"":""NS_IDENT@385ef531"",""identifier"":""DRINKER2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":27,""endLineNum"":2,""endColumnNum"":45,""quoted"":false}}},""corrTables"":[""NS_IDENT@352e787a"",""NS_IDENT@385ef531""]}
"
"SELECT DISTINCT d1.name, d2.name
FROM drinker AS d1, drinker AS d2
WHERE d1.name <> d2.name AND NOT EXISTS
((SELECT beer FROM likes WHERE drinker = d1.name)
EXCEPT
(SELECT beer FROM likes WHERE drinker = d2.name))","{""blocks"":{""id"":""BLOCK_SELECT@5eeedb60"",""fields"":[""NAME VARCHAR(100)"",""NAME VARCHAR(100)""],""isDistinct"":true,""selectList"":[{""id"":""COLUMN_LOCAL@37c2eacb"",""value"":""NS_IDENT@65bcf7c2.NAME"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@32b9bd12"",""value"":""NS_IDENT@55ecbafe.NAME"",""pos"":{""lineNum"":1,""columnNum"":26,""endLineNum"":1,""endColumnNum"":32,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@65bcf7c2"",""NS_IDENT@55ecbafe""],""fromNode"":{""id"":""OP_JOIN@4158debd"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":19,""endLineNum"":2,""endColumnNum"":19,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@773dab28"",""value"":""NS_IDENT@65bcf7c2"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@1ecfcbc9"",""value"":""NS_IDENT@55ecbafe"",""pos"":{""lineNum"":2,""columnNum"":21,""endLineNum"":2,""endColumnNum"":27,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@2a22ad2b"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":6,""endColumnNum"":47,""quoted"":false},""children"":[{""id"":""OP_BINARY@31da6b2e"",""value"":""<>"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@6e0f7aad"",""value"":""NS_IDENT@65bcf7c2.name"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@99a78d7"",""value"":""NS_IDENT@55ecbafe.name"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[]}]},{""id"":""OP_PREFIX@70242f38"",""value"":""NOT"",""pos"":{""lineNum"":3,""columnNum"":30,""endLineNum"":6,""endColumnNum"":47,""quoted"":false},""children"":[{""id"":""OP_PREFIX@61c76850"",""value"":""EXISTS"",""pos"":{""lineNum"":3,""columnNum"":34,""endLineNum"":6,""endColumnNum"":47,""quoted"":false},""children"":[{""id"":""BLOCK_SETOP@2032e725"",""value"":""BLOCK_SETOP@2032e725"",""pos"":{""lineNum"":4,""columnNum"":3,""endLineNum"":6,""endColumnNum"":47,""quoted"":false},""children"":[]}]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@37c2eacb"",""value"":""NS_IDENT@65bcf7c2.NAME"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@99a78d7"",""value"":""NS_IDENT@55ecbafe.name"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@32b9bd12"",""value"":""NS_IDENT@55ecbafe.NAME"",""pos"":{""lineNum"":1,""columnNum"":26,""endLineNum"":1,""endColumnNum"":32,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6e0f7aad"",""value"":""NS_IDENT@65bcf7c2.name"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@55ecbafe.name"",""NS_IDENT@65bcf7c2.name""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":6,""endColumnNum"":49,""quoted"":false},""children"":{""BLOCK_SETOP@2032e725"":{""id"":""BLOCK_SETOP@2032e725"",""parentId"":""BLOCK_SELECT@5eeedb60"",""fields"":[""BEER VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@4d23015c"",""rightBlockId"":""BLOCK_SELECT@319854f0"",""pos"":{""lineNum"":4,""columnNum"":3,""endLineNum"":6,""endColumnNum"":47,""quoted"":false},""children"":{""BLOCK_SELECT@4d23015c"":{""id"":""BLOCK_SELECT@4d23015c"",""parentId"":""BLOCK_SETOP@2032e725"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@49798e84"",""value"":""NS_IDENT@385ef531.BEER"",""pos"":{""lineNum"":4,""columnNum"":10,""endLineNum"":4,""endColumnNum"":13,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@385ef531""],""fromNode"":{""id"":""JOIN_OPERAND@2dbd803f"",""value"":""NS_IDENT@385ef531"",""pos"":{""lineNum"":4,""columnNum"":20,""endLineNum"":4,""endColumnNum"":24,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@3c0fbd3a"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":32,""endLineNum"":4,""endColumnNum"":48,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@66ec9390"",""value"":""NS_IDENT@385ef531.drinker"",""pos"":{""lineNum"":4,""columnNum"":32,""endLineNum"":4,""endColumnNum"":38,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@6e91893"",""value"":""NS_IDENT@65bcf7c2.name"",""pos"":{""lineNum"":4,""columnNum"":42,""endLineNum"":4,""endColumnNum"":48,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@49798e84"",""value"":""NS_IDENT@385ef531.BEER"",""pos"":{""lineNum"":4,""columnNum"":10,""endLineNum"":4,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@66ec9390"",""value"":""NS_IDENT@385ef531.drinker"",""pos"":{""lineNum"":4,""columnNum"":32,""endLineNum"":4,""endColumnNum"":38,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@6e91893"",""value"":""NS_IDENT@65bcf7c2.name"",""pos"":{""lineNum"":4,""columnNum"":42,""endLineNum"":4,""endColumnNum"":48,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@65bcf7c2""],""corrCtxIds"":[""BLOCK_SELECT@5eeedb60""],""pos"":{""lineNum"":4,""columnNum"":3,""endLineNum"":4,""endColumnNum"":48,""quoted"":false},""children"":{}},""BLOCK_SELECT@319854f0"":{""id"":""BLOCK_SELECT@319854f0"",""parentId"":""BLOCK_SETOP@2032e725"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@5a6482a9"",""value"":""NS_IDENT@3cbcd8f3.BEER"",""pos"":{""lineNum"":6,""columnNum"":9,""endLineNum"":6,""endColumnNum"":12,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@3cbcd8f3""],""fromNode"":{""id"":""JOIN_OPERAND@748fe51d"",""value"":""NS_IDENT@3cbcd8f3"",""pos"":{""lineNum"":6,""columnNum"":19,""endLineNum"":6,""endColumnNum"":23,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@630d1b2f"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":31,""endLineNum"":6,""endColumnNum"":47,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@f202d6d"",""value"":""NS_IDENT@3cbcd8f3.drinker"",""pos"":{""lineNum"":6,""columnNum"":31,""endLineNum"":6,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@60e21209"",""value"":""NS_IDENT@55ecbafe.name"",""pos"":{""lineNum"":6,""columnNum"":41,""endLineNum"":6,""endColumnNum"":47,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_CORRELATE@60e21209"",""value"":""NS_IDENT@55ecbafe.name"",""pos"":{""lineNum"":6,""columnNum"":41,""endLineNum"":6,""endColumnNum"":47,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@f202d6d"",""value"":""NS_IDENT@3cbcd8f3.drinker"",""pos"":{""lineNum"":6,""columnNum"":31,""endLineNum"":6,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5a6482a9"",""value"":""NS_IDENT@3cbcd8f3.BEER"",""pos"":{""lineNum"":6,""columnNum"":9,""endLineNum"":6,""endColumnNum"":12,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@55ecbafe""],""corrCtxIds"":[""BLOCK_SELECT@5eeedb60""],""pos"":{""lineNum"":6,""columnNum"":2,""endLineNum"":6,""endColumnNum"":47,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@3cbcd8f3"":{""tableId"":""NS_IDENT@3cbcd8f3"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":19,""endLineNum"":6,""endColumnNum"":23,""quoted"":false}},""NS_IDENT@65bcf7c2"":{""tableId"":""NS_IDENT@65bcf7c2"",""identifier"":""D1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":18,""quoted"":false}},""NS_IDENT@55ecbafe"":{""tableId"":""NS_IDENT@55ecbafe"",""identifier"":""D2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":21,""endLineNum"":2,""endColumnNum"":33,""quoted"":false}},""NS_IDENT@385ef531"":{""tableId"":""NS_IDENT@385ef531"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":20,""endLineNum"":4,""endColumnNum"":24,""quoted"":false}}},""corrTables"":[""NS_IDENT@65bcf7c2"",""NS_IDENT@55ecbafe""]}
"
"SELECT d1.name AS drinker1, d2.name AS drinker2
FROM drinker AS d1, drinker AS d2
WHERE d1.name <> d2.name
AND NOT EXISTS
((SELECT beer
FROM likes
WHERE drinker = d1.name)
EXCEPT
(SELECT beer
FROM likes
WHERE drinker = d2.name));
","{""blocks"":{""id"":""BLOCK_SELECT@3f36b447"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@232cce0"",""value"":""NS_IDENT@3db64bd4.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":14,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@352e787a"",""value"":""NS_IDENT@5a8ba37c.NAME"",""pos"":{""lineNum"":1,""columnNum"":29,""endLineNum"":1,""endColumnNum"":35,""quoted"":false},""children"":[],""alias"":""DRINKER2""}],""fromItemIds"":[""NS_IDENT@3db64bd4"",""NS_IDENT@5a8ba37c""],""fromNode"":{""id"":""OP_JOIN@393881f0"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":19,""endLineNum"":2,""endColumnNum"":19,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@4158debd"",""value"":""NS_IDENT@3db64bd4"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@af78c87"",""value"":""NS_IDENT@5a8ba37c"",""pos"":{""lineNum"":2,""columnNum"":21,""endLineNum"":2,""endColumnNum"":27,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@48c3205a"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":11,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""OP_BINARY@61c76850"",""value"":""<>"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@15fb7a32"",""value"":""NS_IDENT@3db64bd4.name"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@31da6b2e"",""value"":""NS_IDENT@5a8ba37c.name"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[]}]},{""id"":""OP_PREFIX@2a22ad2b"",""value"":""NOT"",""pos"":{""lineNum"":4,""columnNum"":5,""endLineNum"":11,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""OP_PREFIX@70242f38"",""value"":""EXISTS"",""pos"":{""lineNum"":4,""columnNum"":9,""endLineNum"":11,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""BLOCK_SETOP@3eed0f5"",""value"":""BLOCK_SETOP@3eed0f5"",""pos"":{""lineNum"":5,""columnNum"":3,""endLineNum"":11,""endColumnNum"":23,""quoted"":false},""children"":[]}]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@15fb7a32"",""value"":""NS_IDENT@3db64bd4.name"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@31da6b2e"",""value"":""NS_IDENT@5a8ba37c.name"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@232cce0"",""value"":""NS_IDENT@3db64bd4.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":14,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@352e787a"",""value"":""NS_IDENT@5a8ba37c.NAME"",""pos"":{""lineNum"":1,""columnNum"":29,""endLineNum"":1,""endColumnNum"":35,""quoted"":false},""children"":[],""alias"":""DRINKER2""}],""incomingIdentifiers"":[""NS_IDENT@3db64bd4.name"",""NS_IDENT@5a8ba37c.name""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":11,""endColumnNum"":25,""quoted"":false},""children"":{""BLOCK_SETOP@3eed0f5"":{""id"":""BLOCK_SETOP@3eed0f5"",""parentId"":""BLOCK_SELECT@3f36b447"",""fields"":[""BEER VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@64030b91"",""rightBlockId"":""BLOCK_SELECT@529cfee5"",""pos"":{""lineNum"":5,""columnNum"":3,""endLineNum"":11,""endColumnNum"":23,""quoted"":false},""children"":{""BLOCK_SELECT@529cfee5"":{""id"":""BLOCK_SELECT@529cfee5"",""parentId"":""BLOCK_SETOP@3eed0f5"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@7f9ab969"",""value"":""NS_IDENT@719843e5.BEER"",""pos"":{""lineNum"":9,""columnNum"":9,""endLineNum"":9,""endColumnNum"":12,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@719843e5""],""fromNode"":{""id"":""JOIN_OPERAND@7ca0863b"",""value"":""NS_IDENT@719843e5"",""pos"":{""lineNum"":10,""columnNum"":6,""endLineNum"":10,""endColumnNum"":10,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@746b18fd"",""value"":""="",""pos"":{""lineNum"":11,""columnNum"":7,""endLineNum"":11,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@60e21209"",""value"":""NS_IDENT@719843e5.drinker"",""pos"":{""lineNum"":11,""columnNum"":7,""endLineNum"":11,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@630d1b2f"",""value"":""NS_IDENT@5a8ba37c.name"",""pos"":{""lineNum"":11,""columnNum"":17,""endLineNum"":11,""endColumnNum"":23,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@60e21209"",""value"":""NS_IDENT@719843e5.drinker"",""pos"":{""lineNum"":11,""columnNum"":7,""endLineNum"":11,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@630d1b2f"",""value"":""NS_IDENT@5a8ba37c.name"",""pos"":{""lineNum"":11,""columnNum"":17,""endLineNum"":11,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7f9ab969"",""value"":""NS_IDENT@719843e5.BEER"",""pos"":{""lineNum"":9,""columnNum"":9,""endLineNum"":9,""endColumnNum"":12,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@5a8ba37c""],""corrCtxIds"":[""BLOCK_SELECT@3f36b447""],""pos"":{""lineNum"":9,""columnNum"":2,""endLineNum"":11,""endColumnNum"":23,""quoted"":false},""children"":{}},""BLOCK_SELECT@64030b91"":{""id"":""BLOCK_SELECT@64030b91"",""parentId"":""BLOCK_SETOP@3eed0f5"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@6ed06f69"",""value"":""NS_IDENT@7fc645e4.BEER"",""pos"":{""lineNum"":5,""columnNum"":10,""endLineNum"":5,""endColumnNum"":13,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@7fc645e4""],""fromNode"":{""id"":""JOIN_OPERAND@3b569985"",""value"":""NS_IDENT@7fc645e4"",""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":10,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@562457e1"",""value"":""="",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@6e91893"",""value"":""NS_IDENT@7fc645e4.drinker"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@3c0fbd3a"",""value"":""NS_IDENT@3db64bd4.name"",""pos"":{""lineNum"":7,""columnNum"":17,""endLineNum"":7,""endColumnNum"":23,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@6ed06f69"",""value"":""NS_IDENT@7fc645e4.BEER"",""pos"":{""lineNum"":5,""columnNum"":10,""endLineNum"":5,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6e91893"",""value"":""NS_IDENT@7fc645e4.drinker"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@3c0fbd3a"",""value"":""NS_IDENT@3db64bd4.name"",""pos"":{""lineNum"":7,""columnNum"":17,""endLineNum"":7,""endColumnNum"":23,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@3db64bd4""],""corrCtxIds"":[""BLOCK_SELECT@3f36b447""],""pos"":{""lineNum"":5,""columnNum"":3,""endLineNum"":7,""endColumnNum"":23,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@5a8ba37c"":{""tableId"":""NS_IDENT@5a8ba37c"",""identifier"":""D2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":21,""endLineNum"":2,""endColumnNum"":33,""quoted"":false}},""NS_IDENT@7fc645e4"":{""tableId"":""NS_IDENT@7fc645e4"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":10,""quoted"":false}},""NS_IDENT@3db64bd4"":{""tableId"":""NS_IDENT@3db64bd4"",""identifier"":""D1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":18,""quoted"":false}},""NS_IDENT@719843e5"":{""tableId"":""NS_IDENT@719843e5"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":10,""columnNum"":6,""endLineNum"":10,""endColumnNum"":10,""quoted"":false}}},""corrTables"":[""NS_IDENT@5a8ba37c"",""NS_IDENT@3db64bd4""]}
"
"select * from ((select d.name drinker1, d2.name drinker2 from drinker d, drinker d2) except (with notlikes as ((select drinker.name drinker,beer.name beer from drinker, beer) except (select * from likes)) select distinct l.drinker drinker1, nl.drinker drinker2 from likes l, notlikes nl where l.beer=nl.beer and l.drinker<>nl.drinker)) as subsets where drinker1<>drinker2;
","{""failed"":true}
"
"WITH pairs AS
(SELECT drinker1.name d1, drinker2.name d2
 FROM drinker drinker1, drinker drinker2
 WHERE drinker1.name <> drinker2.name), 
drink_one AS
(SELECT pairs.d1, pairs.d2, L.beer
 FROM likes L, pairs
 WHERE pairs.d1 = L.drinker),
drink_two AS
(SELECT pairs.d1, pairs.d2, L.beer
 FROM likes L, pairs
 WHERE pairs.d2 = L.drinker),

diff AS
(SELECT *
 FROM drink_one
 EXCEPT (SELECT * FROM drink_two))

SELECT *
FROM pairs
EXCEPT (SELECT diff.d1, diff.d2 FROM diff)","{""blocks"":{""id"":""BLOCK_SETOP@4e4c3a38"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@293cde83"",""rightBlockId"":""BLOCK_SELECT@57c88764"",""pos"":{""lineNum"":19,""columnNum"":1,""endLineNum"":21,""endColumnNum"":41,""quoted"":false},""children"":{""BLOCK_SELECT@293cde83"":{""id"":""BLOCK_SELECT@293cde83"",""parentId"":""BLOCK_SETOP@4e4c3a38"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@5c0f79f0"",""value"":""*"",""pos"":{""lineNum"":19,""columnNum"":8,""endLineNum"":19,""endColumnNum"":8,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@34a0ef00""],""fromNode"":{""id"":""JOIN_OPERAND@c27d163"",""value"":""NS_IDENT@34a0ef00"",""pos"":{""lineNum"":20,""columnNum"":6,""endLineNum"":20,""endColumnNum"":10,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":19,""columnNum"":1,""endLineNum"":20,""endColumnNum"":10,""quoted"":false},""children"":{}},""BLOCK_SELECT@57c88764"":{""id"":""BLOCK_SELECT@57c88764"",""parentId"":""BLOCK_SETOP@4e4c3a38"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@2d2acd89"",""value"":""NS_IDENT@21fdfefc.D1"",""pos"":{""lineNum"":21,""columnNum"":16,""endLineNum"":21,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7baf6acf"",""value"":""NS_IDENT@21fdfefc.D2"",""pos"":{""lineNum"":21,""columnNum"":25,""endLineNum"":21,""endColumnNum"":31,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@21fdfefc""],""fromNode"":{""id"":""JOIN_OPERAND@78faea5f"",""value"":""NS_IDENT@21fdfefc"",""pos"":{""lineNum"":21,""columnNum"":38,""endLineNum"":21,""endColumnNum"":41,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@2d2acd89"",""value"":""NS_IDENT@21fdfefc.D1"",""pos"":{""lineNum"":21,""columnNum"":16,""endLineNum"":21,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7baf6acf"",""value"":""NS_IDENT@21fdfefc.D2"",""pos"":{""lineNum"":21,""columnNum"":25,""endLineNum"":21,""endColumnNum"":31,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":21,""columnNum"":9,""endLineNum"":21,""endColumnNum"":41,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@1f193686"":{""tableId"":""NS_IDENT@1f193686"",""identifier"":""DRINKER2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":25,""endLineNum"":3,""endColumnNum"":40,""quoted"":false}},""NS_IDENT@105b693d"":{""tableId"":""NS_IDENT@105b693d"",""identifier"":""PAIRS"",""dbTableName"":""PAIRS"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":16,""endLineNum"":7,""endColumnNum"":20,""quoted"":false}},""NS_IDENT@21fdfefc"":{""tableId"":""NS_IDENT@21fdfefc"",""identifier"":""DIFF"",""dbTableName"":""DIFF"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":21,""columnNum"":38,""endLineNum"":21,""endColumnNum"":41,""quoted"":false}},""NS_IDENT@6293e39e"":{""tableId"":""NS_IDENT@6293e39e"",""identifier"":""DRINK_TWO"",""dbTableName"":""DRINK_TWO"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":17,""columnNum"":24,""endLineNum"":17,""endColumnNum"":32,""quoted"":false}},""NS_IDENT@5bca7664"":{""tableId"":""NS_IDENT@5bca7664"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":13,""quoted"":false}},""NS_IDENT@3350ebdd"":{""tableId"":""NS_IDENT@3350ebdd"",""identifier"":""DRINKER1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":22,""quoted"":false}},""NS_IDENT@4a5905d9"":{""tableId"":""NS_IDENT@4a5905d9"",""identifier"":""DRINK_ONE"",""dbTableName"":""DRINK_ONE"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":16,""columnNum"":7,""endLineNum"":16,""endColumnNum"":15,""quoted"":false}},""NS_IDENT@5ce4369b"":{""tableId"":""NS_IDENT@5ce4369b"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":11,""columnNum"":7,""endLineNum"":11,""endColumnNum"":13,""quoted"":false}},""NS_IDENT@7f829c76"":{""tableId"":""NS_IDENT@7f829c76"",""identifier"":""PAIRS"",""dbTableName"":""PAIRS"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":11,""columnNum"":16,""endLineNum"":11,""endColumnNum"":20,""quoted"":false}},""NS_IDENT@34a0ef00"":{""tableId"":""NS_IDENT@34a0ef00"",""identifier"":""PAIRS"",""dbTableName"":""PAIRS"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":20,""columnNum"":6,""endLineNum"":20,""endColumnNum"":10,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@5c20ffa8"",""alias"":""PAIRS"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@5fad41be"",""value"":""NS_IDENT@3350ebdd.NAME"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":21,""quoted"":false},""children"":[],""alias"":""D1""},{""id"":""COLUMN_LOCAL@3b36e000"",""value"":""NS_IDENT@1f193686.NAME"",""pos"":{""lineNum"":2,""columnNum"":27,""endLineNum"":2,""endColumnNum"":39,""quoted"":false},""children"":[],""alias"":""D2""}],""fromItemIds"":[""NS_IDENT@3350ebdd"",""NS_IDENT@1f193686""],""fromNode"":{""id"":""OP_JOIN@6bcbf05b"",""value"":""COMMA"",""pos"":{""lineNum"":3,""columnNum"":23,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@59942b48"",""value"":""NS_IDENT@3350ebdd"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@f9b5552"",""value"":""NS_IDENT@1f193686"",""pos"":{""lineNum"":3,""columnNum"":25,""endLineNum"":3,""endColumnNum"":31,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@3b0ee03a"",""value"":""<>"",""pos"":{""lineNum"":4,""columnNum"":8,""endLineNum"":4,""endColumnNum"":37,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@65fd6708"",""value"":""NS_IDENT@3350ebdd.name"",""pos"":{""lineNum"":4,""columnNum"":8,""endLineNum"":4,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@b967222"",""value"":""NS_IDENT@1f193686.name"",""pos"":{""lineNum"":4,""columnNum"":25,""endLineNum"":4,""endColumnNum"":37,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@5fad41be"",""value"":""NS_IDENT@3350ebdd.NAME"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":21,""quoted"":false},""children"":[],""alias"":""D1""},{""id"":""COLUMN_LOCAL@65fd6708"",""value"":""NS_IDENT@3350ebdd.name"",""pos"":{""lineNum"":4,""columnNum"":8,""endLineNum"":4,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3b36e000"",""value"":""NS_IDENT@1f193686.NAME"",""pos"":{""lineNum"":2,""columnNum"":27,""endLineNum"":2,""endColumnNum"":39,""quoted"":false},""children"":[],""alias"":""D2""},{""id"":""COLUMN_LOCAL@b967222"",""value"":""NS_IDENT@1f193686.name"",""pos"":{""lineNum"":4,""columnNum"":25,""endLineNum"":4,""endColumnNum"":37,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":2,""endLineNum"":4,""endColumnNum"":37,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@54da32dc"",""alias"":""DRINK_ONE"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@5e8604bf"",""value"":""NS_IDENT@105b693d.D1"",""pos"":{""lineNum"":6,""columnNum"":9,""endLineNum"":6,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@20095ab4"",""value"":""NS_IDENT@105b693d.D2"",""pos"":{""lineNum"":6,""columnNum"":19,""endLineNum"":6,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@42fcc7e6"",""value"":""NS_IDENT@5bca7664.BEER"",""pos"":{""lineNum"":6,""columnNum"":29,""endLineNum"":6,""endColumnNum"":34,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@5bca7664"",""NS_IDENT@105b693d""],""fromNode"":{""id"":""OP_JOIN@1d782abe"",""value"":""COMMA"",""pos"":{""lineNum"":7,""columnNum"":14,""endLineNum"":7,""endColumnNum"":14,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@6df7988f"",""value"":""NS_IDENT@5bca7664"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@4aac85fa"",""value"":""NS_IDENT@105b693d"",""pos"":{""lineNum"":7,""columnNum"":16,""endLineNum"":7,""endColumnNum"":20,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@4a6c18ad"",""value"":""="",""pos"":{""lineNum"":8,""columnNum"":8,""endLineNum"":8,""endColumnNum"":27,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@6892cc6f"",""value"":""NS_IDENT@105b693d.D1"",""pos"":{""lineNum"":8,""columnNum"":8,""endLineNum"":8,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6fd1660"",""value"":""NS_IDENT@5bca7664.drinker"",""pos"":{""lineNum"":8,""columnNum"":19,""endLineNum"":8,""endColumnNum"":27,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@42fcc7e6"",""value"":""NS_IDENT@5bca7664.BEER"",""pos"":{""lineNum"":6,""columnNum"":29,""endLineNum"":6,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6892cc6f"",""value"":""NS_IDENT@105b693d.D1"",""pos"":{""lineNum"":8,""columnNum"":8,""endLineNum"":8,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@20095ab4"",""value"":""NS_IDENT@105b693d.D2"",""pos"":{""lineNum"":6,""columnNum"":19,""endLineNum"":6,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6fd1660"",""value"":""NS_IDENT@5bca7664.drinker"",""pos"":{""lineNum"":8,""columnNum"":19,""endLineNum"":8,""endColumnNum"":27,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5e8604bf"",""value"":""NS_IDENT@105b693d.D1"",""pos"":{""lineNum"":6,""columnNum"":9,""endLineNum"":6,""endColumnNum"":16,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":6,""columnNum"":2,""endLineNum"":8,""endColumnNum"":27,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@6079cf5"",""alias"":""DRINK_TWO"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@4dafba3e"",""value"":""NS_IDENT@7f829c76.D1"",""pos"":{""lineNum"":10,""columnNum"":9,""endLineNum"":10,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@53e3a87a"",""value"":""NS_IDENT@7f829c76.D2"",""pos"":{""lineNum"":10,""columnNum"":19,""endLineNum"":10,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1931d99"",""value"":""NS_IDENT@5ce4369b.BEER"",""pos"":{""lineNum"":10,""columnNum"":29,""endLineNum"":10,""endColumnNum"":34,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@5ce4369b"",""NS_IDENT@7f829c76""],""fromNode"":{""id"":""OP_JOIN@1e6308a9"",""value"":""COMMA"",""pos"":{""lineNum"":11,""columnNum"":14,""endLineNum"":11,""endColumnNum"":14,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@30cecdca"",""value"":""NS_IDENT@5ce4369b"",""pos"":{""lineNum"":11,""columnNum"":7,""endLineNum"":11,""endColumnNum"":11,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@6edc4161"",""value"":""NS_IDENT@7f829c76"",""pos"":{""lineNum"":11,""columnNum"":16,""endLineNum"":11,""endColumnNum"":20,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@2822c6ff"",""value"":""="",""pos"":{""lineNum"":12,""columnNum"":8,""endLineNum"":12,""endColumnNum"":27,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@621f89b8"",""value"":""NS_IDENT@7f829c76.D2"",""pos"":{""lineNum"":12,""columnNum"":8,""endLineNum"":12,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@f339eae"",""value"":""NS_IDENT@5ce4369b.drinker"",""pos"":{""lineNum"":12,""columnNum"":19,""endLineNum"":12,""endColumnNum"":27,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@621f89b8"",""value"":""NS_IDENT@7f829c76.D2"",""pos"":{""lineNum"":12,""columnNum"":8,""endLineNum"":12,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@f339eae"",""value"":""NS_IDENT@5ce4369b.drinker"",""pos"":{""lineNum"":12,""columnNum"":19,""endLineNum"":12,""endColumnNum"":27,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@53e3a87a"",""value"":""NS_IDENT@7f829c76.D2"",""pos"":{""lineNum"":10,""columnNum"":19,""endLineNum"":10,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1931d99"",""value"":""NS_IDENT@5ce4369b.BEER"",""pos"":{""lineNum"":10,""columnNum"":29,""endLineNum"":10,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4dafba3e"",""value"":""NS_IDENT@7f829c76.D1"",""pos"":{""lineNum"":10,""columnNum"":9,""endLineNum"":10,""endColumnNum"":16,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":10,""columnNum"":2,""endLineNum"":12,""endColumnNum"":27,""quoted"":false},""children"":{}},{""id"":""BLOCK_SETOP@27fde870"",""alias"":""DIFF"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)"",""BEER VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@2b4c3c29"",""rightBlockId"":""BLOCK_SELECT@4cdd2c73"",""pos"":{""lineNum"":15,""columnNum"":2,""endLineNum"":17,""endColumnNum"":32,""quoted"":false},""children"":{""BLOCK_SELECT@2b4c3c29"":{""id"":""BLOCK_SELECT@2b4c3c29"",""parentId"":""BLOCK_SETOP@27fde870"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@1a3e5f23"",""value"":""*"",""pos"":{""lineNum"":15,""columnNum"":9,""endLineNum"":15,""endColumnNum"":9,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@4a5905d9""],""fromNode"":{""id"":""JOIN_OPERAND@5ac7aa18"",""value"":""NS_IDENT@4a5905d9"",""pos"":{""lineNum"":16,""columnNum"":7,""endLineNum"":16,""endColumnNum"":15,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":15,""columnNum"":2,""endLineNum"":16,""endColumnNum"":15,""quoted"":false},""children"":{}},""BLOCK_SELECT@4cdd2c73"":{""id"":""BLOCK_SELECT@4cdd2c73"",""parentId"":""BLOCK_SETOP@27fde870"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@365553de"",""value"":""*"",""pos"":{""lineNum"":17,""columnNum"":17,""endLineNum"":17,""endColumnNum"":17,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@6293e39e""],""fromNode"":{""id"":""JOIN_OPERAND@4abf3f0"",""value"":""NS_IDENT@6293e39e"",""pos"":{""lineNum"":17,""columnNum"":24,""endLineNum"":17,""endColumnNum"":32,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":17,""columnNum"":10,""endLineNum"":17,""endColumnNum"":32,""quoted"":false},""children"":{}}}}]}
"
"WITH pairs AS
(SELECT d1.name D1, d2.name D2
FROM drinker d1, drinker d2
WHERE d1.name <> d2.name), 
Q1 AS
(SELECT P.d1, P.d2, L.beer
FROM likes L, pairs P
WHERE P.d1 = L.drinker),
Q2 AS
(SELECT P.d1, P.d2, L.beer
FROM likes L, pairs P
WHERE P.d2 = L.drinker),
diff AS
(SELECT *
FROM Q1
EXCEPT (SELECT * FROM Q2))
SELECT *
FROM pairs P
EXCEPT (SELECT diff.d1, diff.d2 FROM diff)","{""blocks"":{""id"":""BLOCK_SETOP@4abf3f0"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@4e4c3a38"",""rightBlockId"":""BLOCK_SELECT@c27d163"",""pos"":{""lineNum"":17,""columnNum"":1,""endLineNum"":19,""endColumnNum"":41,""quoted"":false},""children"":{""BLOCK_SELECT@c27d163"":{""id"":""BLOCK_SELECT@c27d163"",""parentId"":""BLOCK_SETOP@4abf3f0"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@1e6dad8"",""value"":""NS_IDENT@ec1b2e4.D1"",""pos"":{""lineNum"":19,""columnNum"":16,""endLineNum"":19,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7b3315a5"",""value"":""NS_IDENT@ec1b2e4.D2"",""pos"":{""lineNum"":19,""columnNum"":25,""endLineNum"":19,""endColumnNum"":31,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@ec1b2e4""],""fromNode"":{""id"":""JOIN_OPERAND@57c88764"",""value"":""NS_IDENT@ec1b2e4"",""pos"":{""lineNum"":19,""columnNum"":38,""endLineNum"":19,""endColumnNum"":41,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@7b3315a5"",""value"":""NS_IDENT@ec1b2e4.D2"",""pos"":{""lineNum"":19,""columnNum"":25,""endLineNum"":19,""endColumnNum"":31,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1e6dad8"",""value"":""NS_IDENT@ec1b2e4.D1"",""pos"":{""lineNum"":19,""columnNum"":16,""endLineNum"":19,""endColumnNum"":22,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":19,""columnNum"":9,""endLineNum"":19,""endColumnNum"":41,""quoted"":false},""children"":{}},""BLOCK_SELECT@4e4c3a38"":{""id"":""BLOCK_SELECT@4e4c3a38"",""parentId"":""BLOCK_SETOP@4abf3f0"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@3daa82be"",""value"":""*"",""pos"":{""lineNum"":17,""columnNum"":8,""endLineNum"":17,""endColumnNum"":8,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@21fdfefc""],""fromNode"":{""id"":""JOIN_OPERAND@293cde83"",""value"":""NS_IDENT@21fdfefc"",""pos"":{""lineNum"":18,""columnNum"":6,""endLineNum"":18,""endColumnNum"":10,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":17,""columnNum"":1,""endLineNum"":18,""endColumnNum"":12,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@1cb19dba"":{""tableId"":""NS_IDENT@1cb19dba"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":11,""columnNum"":6,""endLineNum"":11,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@ec1b2e4"":{""tableId"":""NS_IDENT@ec1b2e4"",""identifier"":""DIFF"",""dbTableName"":""DIFF"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":19,""columnNum"":38,""endLineNum"":19,""endColumnNum"":41,""quoted"":false}},""NS_IDENT@3fae596"":{""tableId"":""NS_IDENT@3fae596"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":6,""endLineNum"":7,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@149f5761"":{""tableId"":""NS_IDENT@149f5761"",""identifier"":""D1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":6,""endLineNum"":3,""endColumnNum"":15,""quoted"":false}},""NS_IDENT@21fdfefc"":{""tableId"":""NS_IDENT@21fdfefc"",""identifier"":""P"",""dbTableName"":""PAIRS"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":18,""columnNum"":6,""endLineNum"":18,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@6293e39e"":{""tableId"":""NS_IDENT@6293e39e"",""identifier"":""Q1"",""dbTableName"":""Q1"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":15,""columnNum"":6,""endLineNum"":15,""endColumnNum"":7,""quoted"":false}},""NS_IDENT@5fad41be"":{""tableId"":""NS_IDENT@5fad41be"",""identifier"":""D2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":27,""quoted"":false}},""NS_IDENT@7c3ebc6b"":{""tableId"":""NS_IDENT@7c3ebc6b"",""identifier"":""P"",""dbTableName"":""PAIRS"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":11,""columnNum"":15,""endLineNum"":11,""endColumnNum"":21,""quoted"":false}},""NS_IDENT@4a0df195"":{""tableId"":""NS_IDENT@4a0df195"",""identifier"":""P"",""dbTableName"":""PAIRS"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":15,""endLineNum"":7,""endColumnNum"":21,""quoted"":false}},""NS_IDENT@34a0ef00"":{""tableId"":""NS_IDENT@34a0ef00"",""identifier"":""Q2"",""dbTableName"":""Q2"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":16,""columnNum"":23,""endLineNum"":16,""endColumnNum"":24,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@4bff2185"",""alias"":""PAIRS"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@3b36e000"",""value"":""NS_IDENT@149f5761.NAME"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":15,""quoted"":false},""children"":[],""alias"":""D1""},{""id"":""COLUMN_LOCAL@629ae7e"",""value"":""NS_IDENT@5fad41be.NAME"",""pos"":{""lineNum"":2,""columnNum"":21,""endLineNum"":2,""endColumnNum"":27,""quoted"":false},""children"":[],""alias"":""D2""}],""fromItemIds"":[""NS_IDENT@149f5761"",""NS_IDENT@5fad41be""],""fromNode"":{""id"":""OP_JOIN@458544e0"",""value"":""COMMA"",""pos"":{""lineNum"":3,""columnNum"":16,""endLineNum"":3,""endColumnNum"":16,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@47b2e9e1"",""value"":""NS_IDENT@149f5761"",""pos"":{""lineNum"":3,""columnNum"":6,""endLineNum"":3,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@25b865b5"",""value"":""NS_IDENT@5fad41be"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@b967222"",""value"":""<>"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@77b9d0c7"",""value"":""NS_IDENT@149f5761.name"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6a2eea2a"",""value"":""NS_IDENT@5fad41be.name"",""pos"":{""lineNum"":4,""columnNum"":18,""endLineNum"":4,""endColumnNum"":24,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@3b36e000"",""value"":""NS_IDENT@149f5761.NAME"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":15,""quoted"":false},""children"":[],""alias"":""D1""},{""id"":""COLUMN_LOCAL@629ae7e"",""value"":""NS_IDENT@5fad41be.NAME"",""pos"":{""lineNum"":2,""columnNum"":21,""endLineNum"":2,""endColumnNum"":27,""quoted"":false},""children"":[],""alias"":""D2""},{""id"":""COLUMN_LOCAL@77b9d0c7"",""value"":""NS_IDENT@149f5761.name"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6a2eea2a"",""value"":""NS_IDENT@5fad41be.name"",""pos"":{""lineNum"":4,""columnNum"":18,""endLineNum"":4,""endColumnNum"":24,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":2,""endLineNum"":4,""endColumnNum"":24,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@4f20a5e0"",""alias"":""Q1"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@5e8604bf"",""value"":""NS_IDENT@4a0df195.D1"",""pos"":{""lineNum"":6,""columnNum"":9,""endLineNum"":6,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@20095ab4"",""value"":""NS_IDENT@4a0df195.D2"",""pos"":{""lineNum"":6,""columnNum"":15,""endLineNum"":6,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5da7cee2"",""value"":""NS_IDENT@3fae596.BEER"",""pos"":{""lineNum"":6,""columnNum"":21,""endLineNum"":6,""endColumnNum"":26,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@3fae596"",""NS_IDENT@4a0df195""],""fromNode"":{""id"":""OP_JOIN@54da32dc"",""value"":""COMMA"",""pos"":{""lineNum"":7,""columnNum"":13,""endLineNum"":7,""endColumnNum"":13,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@1d782abe"",""value"":""NS_IDENT@3fae596"",""pos"":{""lineNum"":7,""columnNum"":6,""endLineNum"":7,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@6df7988f"",""value"":""NS_IDENT@4a0df195"",""pos"":{""lineNum"":7,""columnNum"":15,""endLineNum"":7,""endColumnNum"":19,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@4a6c18ad"",""value"":""="",""pos"":{""lineNum"":8,""columnNum"":7,""endLineNum"":8,""endColumnNum"":22,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@6892cc6f"",""value"":""NS_IDENT@4a0df195.D1"",""pos"":{""lineNum"":8,""columnNum"":7,""endLineNum"":8,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6fd1660"",""value"":""NS_IDENT@3fae596.drinker"",""pos"":{""lineNum"":8,""columnNum"":14,""endLineNum"":8,""endColumnNum"":22,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@20095ab4"",""value"":""NS_IDENT@4a0df195.D2"",""pos"":{""lineNum"":6,""columnNum"":15,""endLineNum"":6,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6fd1660"",""value"":""NS_IDENT@3fae596.drinker"",""pos"":{""lineNum"":8,""columnNum"":14,""endLineNum"":8,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5da7cee2"",""value"":""NS_IDENT@3fae596.BEER"",""pos"":{""lineNum"":6,""columnNum"":21,""endLineNum"":6,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5e8604bf"",""value"":""NS_IDENT@4a0df195.D1"",""pos"":{""lineNum"":6,""columnNum"":9,""endLineNum"":6,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6892cc6f"",""value"":""NS_IDENT@4a0df195.D1"",""pos"":{""lineNum"":8,""columnNum"":7,""endLineNum"":8,""endColumnNum"":10,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":6,""columnNum"":2,""endLineNum"":8,""endColumnNum"":22,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@22fba58c"",""alias"":""Q2"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@53e3a87a"",""value"":""NS_IDENT@7c3ebc6b.D1"",""pos"":{""lineNum"":10,""columnNum"":9,""endLineNum"":10,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@40368a46"",""value"":""NS_IDENT@7c3ebc6b.D2"",""pos"":{""lineNum"":10,""columnNum"":15,""endLineNum"":10,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7ad54c55"",""value"":""NS_IDENT@1cb19dba.BEER"",""pos"":{""lineNum"":10,""columnNum"":21,""endLineNum"":10,""endColumnNum"":26,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@1cb19dba"",""NS_IDENT@7c3ebc6b""],""fromNode"":{""id"":""OP_JOIN@7e8a46b7"",""value"":""COMMA"",""pos"":{""lineNum"":11,""columnNum"":13,""endLineNum"":11,""endColumnNum"":13,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@2fe88a09"",""value"":""NS_IDENT@1cb19dba"",""pos"":{""lineNum"":11,""columnNum"":6,""endLineNum"":11,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@1917d90f"",""value"":""NS_IDENT@7c3ebc6b"",""pos"":{""lineNum"":11,""columnNum"":15,""endLineNum"":11,""endColumnNum"":19,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@4dafba3e"",""value"":""="",""pos"":{""lineNum"":12,""columnNum"":7,""endLineNum"":12,""endColumnNum"":22,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@f339eae"",""value"":""NS_IDENT@7c3ebc6b.D2"",""pos"":{""lineNum"":12,""columnNum"":7,""endLineNum"":12,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2822c6ff"",""value"":""NS_IDENT@1cb19dba.drinker"",""pos"":{""lineNum"":12,""columnNum"":14,""endLineNum"":12,""endColumnNum"":22,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@2822c6ff"",""value"":""NS_IDENT@1cb19dba.drinker"",""pos"":{""lineNum"":12,""columnNum"":14,""endLineNum"":12,""endColumnNum"":22,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7ad54c55"",""value"":""NS_IDENT@1cb19dba.BEER"",""pos"":{""lineNum"":10,""columnNum"":21,""endLineNum"":10,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@40368a46"",""value"":""NS_IDENT@7c3ebc6b.D2"",""pos"":{""lineNum"":10,""columnNum"":15,""endLineNum"":10,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@53e3a87a"",""value"":""NS_IDENT@7c3ebc6b.D1"",""pos"":{""lineNum"":10,""columnNum"":9,""endLineNum"":10,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@f339eae"",""value"":""NS_IDENT@7c3ebc6b.D2"",""pos"":{""lineNum"":12,""columnNum"":7,""endLineNum"":12,""endColumnNum"":10,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":10,""columnNum"":2,""endLineNum"":12,""endColumnNum"":22,""quoted"":false},""children"":{}},{""id"":""BLOCK_SETOP@77a281fc"",""alias"":""DIFF"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)"",""BEER VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@4912d525"",""rightBlockId"":""BLOCK_SELECT@5ac7aa18"",""pos"":{""lineNum"":14,""columnNum"":2,""endLineNum"":16,""endColumnNum"":24,""quoted"":false},""children"":{""BLOCK_SELECT@5ac7aa18"":{""id"":""BLOCK_SELECT@5ac7aa18"",""parentId"":""BLOCK_SETOP@77a281fc"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@5c0f79f0"",""value"":""*"",""pos"":{""lineNum"":16,""columnNum"":16,""endLineNum"":16,""endColumnNum"":16,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@34a0ef00""],""fromNode"":{""id"":""JOIN_OPERAND@4cdd2c73"",""value"":""NS_IDENT@34a0ef00"",""pos"":{""lineNum"":16,""columnNum"":23,""endLineNum"":16,""endColumnNum"":24,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":16,""columnNum"":9,""endLineNum"":16,""endColumnNum"":24,""quoted"":false},""children"":{}},""BLOCK_SELECT@4912d525"":{""id"":""BLOCK_SELECT@4912d525"",""parentId"":""BLOCK_SETOP@77a281fc"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@365553de"",""value"":""*"",""pos"":{""lineNum"":14,""columnNum"":9,""endLineNum"":14,""endColumnNum"":9,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@6293e39e""],""fromNode"":{""id"":""JOIN_OPERAND@2b4c3c29"",""value"":""NS_IDENT@6293e39e"",""pos"":{""lineNum"":15,""columnNum"":6,""endLineNum"":15,""endColumnNum"":7,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":14,""columnNum"":2,""endLineNum"":15,""endColumnNum"":7,""quoted"":false},""children"":{}}}}]}
"
"with allPairs as 
(select d1.name d, d2.name dd
from drinker d1, drinker d2
where d1.name != d2.name),

d1Likes as
(select allPairs.d, allPairs.dd, likes.beer
from allPairs, likes
where allPairs.d = likes.drinker),

d2likes as 
(select allpairs.d, allpairs.dd, likes.beer
from allpairs, likes
where allpairs.dd = likes.drinker)

select allpairs.d, allpairs.dd
from allpairs except 
select unwanted.d, unwanted.dd 
from (select * from d1likes except select * from d2likes) unwanted;
","{""failed"":true,""errorMsg"":""Parsing error at line 4, column 15. Query syntax may be incorrect""}
"
"select D1.name as drinker1, D2.name as drinker2
from drinker D1, drinker D2
where D1.name != D2.name and not exists
((select beer from likes where drinker=D1.name) 
except
(select beer from likes where drinker=D2.name))
","{""failed"":true,""errorMsg"":""Parsing error at line 3, column 15. Query syntax may be incorrect""}
"
"select d.drinker
from likes as d
where d.drinker not in

(select c.drinker
from likes as c
where c.beer not in

(select a.beer
from likes as a, likes as b
where a.drinker = 'Amy'
and a.beer = b.beer))","{""blocks"":{""id"":""BLOCK_SELECT@4bdcaf36"",""fields"":[""DRINKER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@6a10b263"",""value"":""NS_IDENT@1603dc2f.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":16,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@1603dc2f""],""fromNode"":{""id"":""JOIN_OPERAND@6872f9c8"",""value"":""NS_IDENT@1603dc2f"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":10,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@3a91d146"",""value"":""NOT IN"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":12,""endColumnNum"":20,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4b2a30d"",""value"":""NS_IDENT@1603dc2f.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@1dab9dd6"",""value"":""BLOCK_SELECT@1dab9dd6"",""pos"":{""lineNum"":5,""columnNum"":2,""endLineNum"":12,""endColumnNum"":20,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@4b2a30d"",""value"":""NS_IDENT@1603dc2f.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6a10b263"",""value"":""NS_IDENT@1603dc2f.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":16,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":12,""endColumnNum"":21,""quoted"":false},""children"":{""BLOCK_SELECT@1dab9dd6"":{""id"":""BLOCK_SELECT@1dab9dd6"",""parentId"":""BLOCK_SELECT@4bdcaf36"",""fields"":[""DRINKER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@dffa30b"",""value"":""NS_IDENT@1d12b024.DRINKER"",""pos"":{""lineNum"":5,""columnNum"":9,""endLineNum"":5,""endColumnNum"":17,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@1d12b024""],""fromNode"":{""id"":""JOIN_OPERAND@f9b5552"",""value"":""NS_IDENT@1d12b024"",""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":10,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@74fe5966"",""value"":""NOT IN"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":12,""endColumnNum"":19,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@2571066a"",""value"":""NS_IDENT@1d12b024.beer"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@247667dd"",""value"":""BLOCK_SELECT@247667dd"",""pos"":{""lineNum"":9,""columnNum"":2,""endLineNum"":12,""endColumnNum"":19,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@dffa30b"",""value"":""NS_IDENT@1d12b024.DRINKER"",""pos"":{""lineNum"":5,""columnNum"":9,""endLineNum"":5,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2571066a"",""value"":""NS_IDENT@1d12b024.beer"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":12,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":5,""columnNum"":2,""endLineNum"":12,""endColumnNum"":20,""quoted"":false},""children"":{""BLOCK_SELECT@247667dd"":{""id"":""BLOCK_SELECT@247667dd"",""parentId"":""BLOCK_SELECT@1dab9dd6"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@7b2a3ff8"",""value"":""NS_IDENT@2c16fadb.BEER"",""pos"":{""lineNum"":9,""columnNum"":9,""endLineNum"":9,""endColumnNum"":14,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@2c16fadb"",""NS_IDENT@248deced""],""fromNode"":{""id"":""OP_JOIN@5c20ffa8"",""value"":""COMMA"",""pos"":{""lineNum"":10,""columnNum"":16,""endLineNum"":10,""endColumnNum"":16,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@6bcbf05b"",""value"":""NS_IDENT@2c16fadb"",""pos"":{""lineNum"":10,""columnNum"":6,""endLineNum"":10,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@59942b48"",""value"":""NS_IDENT@248deced"",""pos"":{""lineNum"":10,""columnNum"":18,""endLineNum"":10,""endColumnNum"":22,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@629f066f"",""value"":""AND"",""pos"":{""lineNum"":11,""columnNum"":7,""endLineNum"":12,""endColumnNum"":19,""quoted"":false},""children"":[{""id"":""OP_BINARY@67dba613"",""value"":""="",""pos"":{""lineNum"":11,""columnNum"":7,""endLineNum"":11,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@15923407"",""value"":""NS_IDENT@2c16fadb.drinker"",""pos"":{""lineNum"":11,""columnNum"":7,""endLineNum"":11,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""LITERAL_STRING@ccd1bc3"",""value"":""'Amy'"",""pos"":{""lineNum"":11,""columnNum"":19,""endLineNum"":11,""endColumnNum"":23,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@58cec85b"",""value"":""="",""pos"":{""lineNum"":12,""columnNum"":5,""endLineNum"":12,""endColumnNum"":19,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@57540fd0"",""value"":""NS_IDENT@2c16fadb.beer"",""pos"":{""lineNum"":12,""columnNum"":5,""endLineNum"":12,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5cf8edcf"",""value"":""NS_IDENT@248deced.beer"",""pos"":{""lineNum"":12,""columnNum"":14,""endLineNum"":12,""endColumnNum"":19,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@57540fd0"",""value"":""NS_IDENT@2c16fadb.beer"",""pos"":{""lineNum"":12,""columnNum"":5,""endLineNum"":12,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5cf8edcf"",""value"":""NS_IDENT@248deced.beer"",""pos"":{""lineNum"":12,""columnNum"":14,""endLineNum"":12,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@15923407"",""value"":""NS_IDENT@2c16fadb.drinker"",""pos"":{""lineNum"":11,""columnNum"":7,""endLineNum"":11,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7b2a3ff8"",""value"":""NS_IDENT@2c16fadb.BEER"",""pos"":{""lineNum"":9,""columnNum"":9,""endLineNum"":9,""endColumnNum"":14,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":9,""columnNum"":2,""endLineNum"":12,""endColumnNum"":19,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@1d12b024"":{""tableId"":""NS_IDENT@1d12b024"",""identifier"":""C"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":15,""quoted"":false}},""NS_IDENT@2c16fadb"":{""tableId"":""NS_IDENT@2c16fadb"",""identifier"":""A"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":10,""columnNum"":6,""endLineNum"":10,""endColumnNum"":15,""quoted"":false}},""NS_IDENT@248deced"":{""tableId"":""NS_IDENT@248deced"",""identifier"":""B"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":10,""columnNum"":18,""endLineNum"":10,""endColumnNum"":27,""quoted"":false}},""NS_IDENT@1603dc2f"":{""tableId"":""NS_IDENT@1603dc2f"",""identifier"":""D"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":15,""quoted"":false}}},""corrTables"":[]}
"
"With newLikes as (select drinker.name as drinker, likes.beer as beer 
from drinker left join likes on drinker.name = likes.drinker)
(select l1.drinker as drinker1, l2.drinker as drinker2
from newLikes l1, newLikes l2 where l1.drinker != l2.drinker)
except
(select joined.drinker1, joined.drinker2
from ((select l3.drinker as drinker1, l4.drinker as drinker2, l3.beer
from newLikes l3, newLikes l4 where l3.drinker != l4.drinker)
except 
(select l5.drinker as drinker1, l6.drinker as drinker2, l6.beer
from newLikes l5, newLikes l6 where l5.drinker != l6.drinker)) as joined)","{""failed"":true,""errorMsg"":""Parsing error at line 4, column 48. Query syntax may be incorrect""}
"
"WITH allPossiblePairs (drinker1, drinker2) AS (SELECT drinker1.name as drinker1, drinker2.name as drinker2 FROM drinker as drinker1, drinker as drinker2 
WHERE drinker1.name != drinker2.name),

allWrongPairs (drinker1, drinker2) AS (SELECT X.drinkerA, X.drinkerB 
FROM ((SELECT L1.drinker as drinkerA, allPossiblePairs.drinker2 as drinkerB, L1.beer as beer1 
      FROM allPossiblePairs, likes L1 
      WHERE allPossiblePairs.drinker1 = L1.drinker) 
EXCEPT
(SELECT allPossiblePairs.drinker1 as drinkerA, L2.drinker as drinkerB, L2.beer as beer2 
      FROM allPossiblePairs, likes L2 
      WHERE allPossiblePairs.drinker2 = L2.drinker)
) as X
)

(SELECT drinker1, drinker2 FROM allPossiblePairs)
EXCEPT
(SELECT drinker1, drinker2 FROM allWrongPairs)

","{""failed"":true,""errorMsg"":""Parsing error at line 2, column 21. Query syntax may be incorrect""}
"
"with pairs as (SELECT d1.name drinker1, d2.name drinker2 FROM drinker d1 CROSS JOIN drinker d2 WHERE d1.name <> d2.name),
d_one as (SELECT drinker1, drinker2, l.beer FROM pairs, likes l WHERE l.drinker = drinker1),
d_two as (SELECT drinker1, drinker2, l.beer FROM pairs, likes l WHERE l.drinker = drinker2) 
SELECT * FROM pairs EXCEPT SELECT drinker1, drinker2 FROM (SELECT * FROM d_one EXCEPT SELECT * FROM d_two) a","{""blocks"":{""id"":""BLOCK_SETOP@3e850122"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@27fde870"",""rightBlockId"":""BLOCK_SELECT@5ac7aa18"",""pos"":{""lineNum"":4,""columnNum"":1,""endLineNum"":4,""endColumnNum"":108,""quoted"":false},""children"":{""BLOCK_SELECT@27fde870"":{""id"":""BLOCK_SELECT@27fde870"",""parentId"":""BLOCK_SETOP@3e850122"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@4e904fd5"",""value"":""*"",""pos"":{""lineNum"":4,""columnNum"":8,""endLineNum"":4,""endColumnNum"":8,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@4f8b4bd0""],""fromNode"":{""id"":""JOIN_OPERAND@2b4c3c29"",""value"":""NS_IDENT@4f8b4bd0"",""pos"":{""lineNum"":4,""columnNum"":15,""endLineNum"":4,""endColumnNum"":19,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":4,""columnNum"":1,""endLineNum"":4,""endColumnNum"":19,""quoted"":false},""children"":{}},""BLOCK_SELECT@5ac7aa18"":{""id"":""BLOCK_SELECT@5ac7aa18"",""parentId"":""BLOCK_SETOP@3e850122"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@7bbbb6a8"",""value"":""NS_SETOP@b18c4.DRINKER1"",""pos"":{""lineNum"":4,""columnNum"":35,""endLineNum"":4,""endColumnNum"":42,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@27d57a2c"",""value"":""NS_SETOP@b18c4.DRINKER2"",""pos"":{""lineNum"":4,""columnNum"":45,""endLineNum"":4,""endColumnNum"":52,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_SETOP@b18c4""],""fromNode"":{""id"":""JOIN_OPERAND@4cdd2c73"",""value"":""BLOCK_SETOP@4cdd2c73"",""pos"":{""lineNum"":4,""columnNum"":60,""endLineNum"":4,""endColumnNum"":105,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@7bbbb6a8"",""value"":""NS_SETOP@b18c4.DRINKER1"",""pos"":{""lineNum"":4,""columnNum"":35,""endLineNum"":4,""endColumnNum"":42,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@27d57a2c"",""value"":""NS_SETOP@b18c4.DRINKER2"",""pos"":{""lineNum"":4,""columnNum"":45,""endLineNum"":4,""endColumnNum"":52,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":4,""columnNum"":28,""endLineNum"":4,""endColumnNum"":108,""quoted"":false},""children"":{""BLOCK_SETOP@4cdd2c73"":{""id"":""BLOCK_SETOP@4cdd2c73"",""parentId"":""BLOCK_SELECT@5ac7aa18"",""alias"":""A"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@4abf3f0"",""rightBlockId"":""BLOCK_SELECT@293cde83"",""pos"":{""lineNum"":4,""columnNum"":60,""endLineNum"":4,""endColumnNum"":105,""quoted"":false},""children"":{""BLOCK_SELECT@4abf3f0"":{""id"":""BLOCK_SELECT@4abf3f0"",""parentId"":""BLOCK_SETOP@4cdd2c73"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@597f48df"",""value"":""*"",""pos"":{""lineNum"":4,""columnNum"":67,""endLineNum"":4,""endColumnNum"":67,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@4cbf4f53""],""fromNode"":{""id"":""JOIN_OPERAND@4e4c3a38"",""value"":""NS_IDENT@4cbf4f53"",""pos"":{""lineNum"":4,""columnNum"":74,""endLineNum"":4,""endColumnNum"":78,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":4,""columnNum"":60,""endLineNum"":4,""endColumnNum"":78,""quoted"":false},""children"":{}},""BLOCK_SELECT@293cde83"":{""id"":""BLOCK_SELECT@293cde83"",""parentId"":""BLOCK_SETOP@4cdd2c73"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@4d48bd85"",""value"":""*"",""pos"":{""lineNum"":4,""columnNum"":94,""endLineNum"":4,""endColumnNum"":94,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@15dd5ac2""],""fromNode"":{""id"":""JOIN_OPERAND@c27d163"",""value"":""NS_IDENT@15dd5ac2"",""pos"":{""lineNum"":4,""columnNum"":101,""endLineNum"":4,""endColumnNum"":105,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":4,""columnNum"":87,""endLineNum"":4,""endColumnNum"":105,""quoted"":false},""children"":{}}}}}}}},""tables"":{""NS_IDENT@4f8b4bd0"":{""tableId"":""NS_IDENT@4f8b4bd0"",""identifier"":""PAIRS"",""dbTableName"":""PAIRS"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":15,""endLineNum"":4,""endColumnNum"":19,""quoted"":false}},""NS_IDENT@1d25c1c"":{""tableId"":""NS_IDENT@1d25c1c"",""identifier"":""D1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":63,""endLineNum"":1,""endColumnNum"":72,""quoted"":false}},""NS_SETOP@b18c4"":{""tableId"":""NS_SETOP@b18c4"",""identifier"":""A"",""blockId"":""BLOCK_SETOP@4cdd2c73"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":60,""endLineNum"":4,""endColumnNum"":105,""quoted"":false}},""NS_IDENT@3fae596"":{""tableId"":""NS_IDENT@3fae596"",""identifier"":""D2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":1,""columnNum"":85,""endLineNum"":1,""endColumnNum"":94,""quoted"":false}},""NS_IDENT@15dd5ac2"":{""tableId"":""NS_IDENT@15dd5ac2"",""identifier"":""D_TWO"",""dbTableName"":""D_TWO"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":101,""endLineNum"":4,""endColumnNum"":105,""quoted"":false}},""NS_IDENT@1931d99"":{""tableId"":""NS_IDENT@1931d99"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":57,""endLineNum"":2,""endColumnNum"":63,""quoted"":false}},""NS_IDENT@5c0f79f0"":{""tableId"":""NS_IDENT@5c0f79f0"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":57,""endLineNum"":3,""endColumnNum"":63,""quoted"":false}},""NS_IDENT@4cbf4f53"":{""tableId"":""NS_IDENT@4cbf4f53"",""identifier"":""D_ONE"",""dbTableName"":""D_ONE"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":74,""endLineNum"":4,""endColumnNum"":78,""quoted"":false}},""NS_IDENT@7c3ebc6b"":{""tableId"":""NS_IDENT@7c3ebc6b"",""identifier"":""PAIRS"",""dbTableName"":""PAIRS"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":50,""endLineNum"":2,""endColumnNum"":54,""quoted"":false}},""NS_IDENT@34a0ef00"":{""tableId"":""NS_IDENT@34a0ef00"",""identifier"":""PAIRS"",""dbTableName"":""PAIRS"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":50,""endLineNum"":3,""endColumnNum"":54,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@5c20ffa8"",""alias"":""PAIRS"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@42fcc7e6"",""value"":""NS_IDENT@1d25c1c.NAME"",""pos"":{""lineNum"":1,""columnNum"":23,""endLineNum"":1,""endColumnNum"":29,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@5da7cee2"",""value"":""NS_IDENT@3fae596.NAME"",""pos"":{""lineNum"":1,""columnNum"":41,""endLineNum"":1,""endColumnNum"":47,""quoted"":false},""children"":[],""alias"":""DRINKER2""}],""fromItemIds"":[""NS_IDENT@1d25c1c"",""NS_IDENT@3fae596""],""fromNode"":{""id"":""OP_JOIN@6bcbf05b"",""value"":""CROSS"",""pos"":{""lineNum"":1,""columnNum"":80,""endLineNum"":1,""endColumnNum"":83,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@59942b48"",""value"":""NS_IDENT@1d25c1c"",""pos"":{""lineNum"":1,""columnNum"":63,""endLineNum"":1,""endColumnNum"":69,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@f9b5552"",""value"":""NS_IDENT@3fae596"",""pos"":{""lineNum"":1,""columnNum"":85,""endLineNum"":1,""endColumnNum"":91,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@6a2eea2a"",""value"":""<>"",""pos"":{""lineNum"":1,""columnNum"":102,""endLineNum"":1,""endColumnNum"":119,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@2098d37d"",""value"":""NS_IDENT@1d25c1c.name"",""pos"":{""lineNum"":1,""columnNum"":102,""endLineNum"":1,""endColumnNum"":108,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4349754"",""value"":""NS_IDENT@3fae596.name"",""pos"":{""lineNum"":1,""columnNum"":113,""endLineNum"":1,""endColumnNum"":119,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@42fcc7e6"",""value"":""NS_IDENT@1d25c1c.NAME"",""pos"":{""lineNum"":1,""columnNum"":23,""endLineNum"":1,""endColumnNum"":29,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@4349754"",""value"":""NS_IDENT@3fae596.name"",""pos"":{""lineNum"":1,""columnNum"":113,""endLineNum"":1,""endColumnNum"":119,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5da7cee2"",""value"":""NS_IDENT@3fae596.NAME"",""pos"":{""lineNum"":1,""columnNum"":41,""endLineNum"":1,""endColumnNum"":47,""quoted"":false},""children"":[],""alias"":""DRINKER2""},{""id"":""COLUMN_LOCAL@2098d37d"",""value"":""NS_IDENT@1d25c1c.name"",""pos"":{""lineNum"":1,""columnNum"":102,""endLineNum"":1,""endColumnNum"":108,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":16,""endLineNum"":1,""endColumnNum"":119,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@54da32dc"",""alias"":""D_ONE"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@6a9950f1"",""value"":""NS_IDENT@7c3ebc6b.DRINKER1"",""pos"":{""lineNum"":2,""columnNum"":18,""endLineNum"":2,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@73017a80"",""value"":""NS_IDENT@7c3ebc6b.DRINKER2"",""pos"":{""lineNum"":2,""columnNum"":28,""endLineNum"":2,""endColumnNum"":35,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4a5905d9"",""value"":""NS_IDENT@1931d99.BEER"",""pos"":{""lineNum"":2,""columnNum"":38,""endLineNum"":2,""endColumnNum"":43,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@7c3ebc6b"",""NS_IDENT@1931d99""],""fromNode"":{""id"":""OP_JOIN@1d782abe"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":55,""endLineNum"":2,""endColumnNum"":55,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@66bfd864"",""value"":""NS_IDENT@7c3ebc6b"",""pos"":{""lineNum"":2,""columnNum"":50,""endLineNum"":2,""endColumnNum"":54,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@4aac85fa"",""value"":""NS_IDENT@1931d99"",""pos"":{""lineNum"":2,""columnNum"":57,""endLineNum"":2,""endColumnNum"":61,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@6892cc6f"",""value"":""="",""pos"":{""lineNum"":2,""columnNum"":71,""endLineNum"":2,""endColumnNum"":90,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7207cb51"",""value"":""NS_IDENT@1931d99.drinker"",""pos"":{""lineNum"":2,""columnNum"":71,""endLineNum"":2,""endColumnNum"":79,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2a27cb34"",""value"":""NS_IDENT@7c3ebc6b.DRINKER1"",""pos"":{""lineNum"":2,""columnNum"":83,""endLineNum"":2,""endColumnNum"":90,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@6a9950f1"",""value"":""NS_IDENT@7c3ebc6b.DRINKER1"",""pos"":{""lineNum"":2,""columnNum"":18,""endLineNum"":2,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@73017a80"",""value"":""NS_IDENT@7c3ebc6b.DRINKER2"",""pos"":{""lineNum"":2,""columnNum"":28,""endLineNum"":2,""endColumnNum"":35,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2a27cb34"",""value"":""NS_IDENT@7c3ebc6b.DRINKER1"",""pos"":{""lineNum"":2,""columnNum"":83,""endLineNum"":2,""endColumnNum"":90,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4a5905d9"",""value"":""NS_IDENT@1931d99.BEER"",""pos"":{""lineNum"":2,""columnNum"":38,""endLineNum"":2,""endColumnNum"":43,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7207cb51"",""value"":""NS_IDENT@1931d99.drinker"",""pos"":{""lineNum"":2,""columnNum"":71,""endLineNum"":2,""endColumnNum"":79,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":11,""endLineNum"":2,""endColumnNum"":90,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@6079cf5"",""alias"":""D_TWO"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@21fdfefc"",""value"":""NS_IDENT@34a0ef00.DRINKER1"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@ec1b2e4"",""value"":""NS_IDENT@34a0ef00.DRINKER2"",""pos"":{""lineNum"":3,""columnNum"":28,""endLineNum"":3,""endColumnNum"":35,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@67e28be3"",""value"":""NS_IDENT@5c0f79f0.BEER"",""pos"":{""lineNum"":3,""columnNum"":38,""endLineNum"":3,""endColumnNum"":43,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@34a0ef00"",""NS_IDENT@5c0f79f0""],""fromNode"":{""id"":""OP_JOIN@1e6308a9"",""value"":""COMMA"",""pos"":{""lineNum"":3,""columnNum"":55,""endLineNum"":3,""endColumnNum"":55,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@30cecdca"",""value"":""NS_IDENT@34a0ef00"",""pos"":{""lineNum"":3,""columnNum"":50,""endLineNum"":3,""endColumnNum"":54,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@6edc4161"",""value"":""NS_IDENT@5c0f79f0"",""pos"":{""lineNum"":3,""columnNum"":57,""endLineNum"":3,""endColumnNum"":61,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@53e3a87a"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":71,""endLineNum"":3,""endColumnNum"":90,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@2822c6ff"",""value"":""NS_IDENT@5c0f79f0.drinker"",""pos"":{""lineNum"":3,""columnNum"":71,""endLineNum"":3,""endColumnNum"":79,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4dafba3e"",""value"":""NS_IDENT@34a0ef00.DRINKER2"",""pos"":{""lineNum"":3,""columnNum"":83,""endLineNum"":3,""endColumnNum"":90,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@2822c6ff"",""value"":""NS_IDENT@5c0f79f0.drinker"",""pos"":{""lineNum"":3,""columnNum"":71,""endLineNum"":3,""endColumnNum"":79,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@ec1b2e4"",""value"":""NS_IDENT@34a0ef00.DRINKER2"",""pos"":{""lineNum"":3,""columnNum"":28,""endLineNum"":3,""endColumnNum"":35,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4dafba3e"",""value"":""NS_IDENT@34a0ef00.DRINKER2"",""pos"":{""lineNum"":3,""columnNum"":83,""endLineNum"":3,""endColumnNum"":90,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@21fdfefc"",""value"":""NS_IDENT@34a0ef00.DRINKER1"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@67e28be3"",""value"":""NS_IDENT@5c0f79f0.BEER"",""pos"":{""lineNum"":3,""columnNum"":38,""endLineNum"":3,""endColumnNum"":43,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":3,""columnNum"":11,""endLineNum"":3,""endColumnNum"":90,""quoted"":false},""children"":{}}]}
"
"(select d1.name drinker1, d2.name drinker2 
from drinker d1, drinker d2
where d1.name <>d2.name)
except
(select l.drinker drinker1, d.name drinker2
from likes as l, drinker as d 
where l.beer not in (
  select likes.beer 
  from likes
  where likes.drinker = d.name
  )); 

","{""blocks"":{""id"":""BLOCK_SETOP@4b1abd11"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@963176"",""rightBlockId"":""BLOCK_SELECT@7ca0863b"",""pos"":{""lineNum"":1,""columnNum"":2,""endLineNum"":11,""endColumnNum"":3,""quoted"":false},""children"":{""BLOCK_SELECT@7ca0863b"":{""id"":""BLOCK_SELECT@7ca0863b"",""parentId"":""BLOCK_SETOP@4b1abd11"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@205b132e"",""value"":""NS_IDENT@385ef531.DRINKER"",""pos"":{""lineNum"":5,""columnNum"":9,""endLineNum"":5,""endColumnNum"":17,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@3cbcd8f3"",""value"":""NS_IDENT@7fc645e4.NAME"",""pos"":{""lineNum"":5,""columnNum"":29,""endLineNum"":5,""endColumnNum"":34,""quoted"":false},""children"":[],""alias"":""DRINKER2""}],""fromItemIds"":[""NS_IDENT@385ef531"",""NS_IDENT@7fc645e4""],""fromNode"":{""id"":""OP_JOIN@1ecfcbc9"",""value"":""COMMA"",""pos"":{""lineNum"":6,""columnNum"":16,""endLineNum"":6,""endColumnNum"":16,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@1965539b"",""value"":""NS_IDENT@385ef531"",""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@2fc07784"",""value"":""NS_IDENT@7fc645e4"",""pos"":{""lineNum"":6,""columnNum"":18,""endLineNum"":6,""endColumnNum"":24,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@66ec9390"",""value"":""NOT IN"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":10,""endColumnNum"":30,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5e268ce6"",""value"":""NS_IDENT@385ef531.beer"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@319854f0"",""value"":""BLOCK_SELECT@319854f0"",""pos"":{""lineNum"":8,""columnNum"":3,""endLineNum"":10,""endColumnNum"":30,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@5e268ce6"",""value"":""NS_IDENT@385ef531.beer"",""pos"":{""lineNum"":7,""columnNum"":7,""endLineNum"":7,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@205b132e"",""value"":""NS_IDENT@385ef531.DRINKER"",""pos"":{""lineNum"":5,""columnNum"":9,""endLineNum"":5,""endColumnNum"":17,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@3cbcd8f3"",""value"":""NS_IDENT@7fc645e4.NAME"",""pos"":{""lineNum"":5,""columnNum"":29,""endLineNum"":5,""endColumnNum"":34,""quoted"":false},""children"":[],""alias"":""DRINKER2""}],""incomingIdentifiers"":[""NS_IDENT@7fc645e4.name""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":5,""columnNum"":2,""endLineNum"":11,""endColumnNum"":3,""quoted"":false},""children"":{""BLOCK_SELECT@319854f0"":{""id"":""BLOCK_SELECT@319854f0"",""parentId"":""BLOCK_SELECT@7ca0863b"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@562457e1"",""value"":""NS_IDENT@58112bc4.BEER"",""pos"":{""lineNum"":8,""columnNum"":10,""endLineNum"":8,""endColumnNum"":19,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@58112bc4""],""fromNode"":{""id"":""JOIN_OPERAND@773dab28"",""value"":""NS_IDENT@58112bc4"",""pos"":{""lineNum"":9,""columnNum"":8,""endLineNum"":9,""endColumnNum"":12,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@63718b93"",""value"":""="",""pos"":{""lineNum"":10,""columnNum"":9,""endLineNum"":10,""endColumnNum"":30,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@3721177d"",""value"":""NS_IDENT@58112bc4.drinker"",""pos"":{""lineNum"":10,""columnNum"":9,""endLineNum"":10,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@766a4535"",""value"":""NS_IDENT@7fc645e4.name"",""pos"":{""lineNum"":10,""columnNum"":25,""endLineNum"":10,""endColumnNum"":30,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@562457e1"",""value"":""NS_IDENT@58112bc4.BEER"",""pos"":{""lineNum"":8,""columnNum"":10,""endLineNum"":8,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3721177d"",""value"":""NS_IDENT@58112bc4.drinker"",""pos"":{""lineNum"":10,""columnNum"":9,""endLineNum"":10,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@766a4535"",""value"":""NS_IDENT@7fc645e4.name"",""pos"":{""lineNum"":10,""columnNum"":25,""endLineNum"":10,""endColumnNum"":30,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@7fc645e4""],""corrCtxIds"":[""BLOCK_SELECT@7ca0863b""],""pos"":{""lineNum"":8,""columnNum"":3,""endLineNum"":10,""endColumnNum"":30,""quoted"":false},""children"":{}}}},""BLOCK_SELECT@963176"":{""id"":""BLOCK_SELECT@963176"",""parentId"":""BLOCK_SETOP@4b1abd11"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@37c2eacb"",""value"":""NS_IDENT@65bcf7c2.NAME"",""pos"":{""lineNum"":1,""columnNum"":9,""endLineNum"":1,""endColumnNum"":15,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@32b9bd12"",""value"":""NS_IDENT@55ecbafe.NAME"",""pos"":{""lineNum"":1,""columnNum"":27,""endLineNum"":1,""endColumnNum"":33,""quoted"":false},""children"":[],""alias"":""DRINKER2""}],""fromItemIds"":[""NS_IDENT@65bcf7c2"",""NS_IDENT@55ecbafe""],""fromNode"":{""id"":""OP_JOIN@4d23015c"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":16,""endLineNum"":2,""endColumnNum"":16,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@3766c667"",""value"":""NS_IDENT@65bcf7c2"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@31ddd4a4"",""value"":""NS_IDENT@55ecbafe"",""pos"":{""lineNum"":2,""columnNum"":18,""endLineNum"":2,""endColumnNum"":24,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@121c54fa"",""value"":""<>"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1949309d"",""value"":""NS_IDENT@65bcf7c2.name"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@48c3205a"",""value"":""NS_IDENT@55ecbafe.name"",""pos"":{""lineNum"":3,""columnNum"":17,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@37c2eacb"",""value"":""NS_IDENT@65bcf7c2.NAME"",""pos"":{""lineNum"":1,""columnNum"":9,""endLineNum"":1,""endColumnNum"":15,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@48c3205a"",""value"":""NS_IDENT@55ecbafe.name"",""pos"":{""lineNum"":3,""columnNum"":17,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@32b9bd12"",""value"":""NS_IDENT@55ecbafe.NAME"",""pos"":{""lineNum"":1,""columnNum"":27,""endLineNum"":1,""endColumnNum"":33,""quoted"":false},""children"":[],""alias"":""DRINKER2""},{""id"":""COLUMN_LOCAL@1949309d"",""value"":""NS_IDENT@65bcf7c2.name"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":2,""endLineNum"":3,""endColumnNum"":23,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@58112bc4"":{""tableId"":""NS_IDENT@58112bc4"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":9,""columnNum"":8,""endLineNum"":9,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@65bcf7c2"":{""tableId"":""NS_IDENT@65bcf7c2"",""identifier"":""D1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":15,""quoted"":false}},""NS_IDENT@55ecbafe"":{""tableId"":""NS_IDENT@55ecbafe"",""identifier"":""D2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":18,""endLineNum"":2,""endColumnNum"":27,""quoted"":false}},""NS_IDENT@7fc645e4"":{""tableId"":""NS_IDENT@7fc645e4"",""identifier"":""D"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":18,""endLineNum"":6,""endColumnNum"":29,""quoted"":false}},""NS_IDENT@385ef531"":{""tableId"":""NS_IDENT@385ef531"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":6,""endColumnNum"":15,""quoted"":false}}},""corrTables"":[""NS_IDENT@7fc645e4""]}
"
"WITH all_combos AS (
        SELECT drinker_1.name name_1, drinker_2.name name_2
        FROM drinker AS drinker_1
        CROSS JOIN drinker drinker_2
        WHERE drinker_1.name <> drinker_2.name
), drinker_one_likes AS (
        SELECT name_1, name_2, likes.beer beer
        FROM all_combos, likes
        WHERE all_combos.name_1 = likes.drinker 
        -- AND combo_cross_beer.beer = likes.beer
        
-- ), and_drinker_two_likes AS (
--         SELECT name_1, name_2, drinker_one_likes.beer 
--         FROM drinker_one_likes, likes
--         WHERE drinker_one_likes.name_2 = likes.drinker
--         AND drinker_one_likes.beer = likes.beer
), just_drinker_two_likes AS (
        SELECT name_1, name_2, likes.beer beer
        FROM all_combos, likes
        WHERE all_combos.name_2 = likes.drinker 
        -- AND combo_cross_beer.beer = likes.beer
        
-- ), drinker_two_also_likes AS (
--         SELECT name_1,name_2, beer
--         FROM just_drinker_two_likes
--         EXCEPT (
--                 SELECT * 
--                 FROM and_drinker_two_likes
--         )
)
        
SELECT * 
FROM all_combos
EXCEPT (
        SELECT name_1, name_2
        FROM (
                SELECT * 
                FROM drinker_one_likes 
                EXCEPT (
                SELECT * 
                FROM just_drinker_two_likes
        ) 
        ) as temp
);
","{""blocks"":{""id"":""BLOCK_SETOP@3e850122"",""fields"":[""NAME_1 VARCHAR(100)"",""NAME_2 VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@27fde870"",""rightBlockId"":""BLOCK_SELECT@5ac7aa18"",""pos"":{""lineNum"":32,""columnNum"":1,""endLineNum"":43,""endColumnNum"":17,""quoted"":false},""children"":{""BLOCK_SELECT@27fde870"":{""id"":""BLOCK_SELECT@27fde870"",""parentId"":""BLOCK_SETOP@3e850122"",""fields"":[""NAME_1 VARCHAR(100)"",""NAME_2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@6345e7b9"",""value"":""*"",""pos"":{""lineNum"":32,""columnNum"":8,""endLineNum"":32,""endColumnNum"":8,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@108bdbd8""],""fromNode"":{""id"":""JOIN_OPERAND@2b4c3c29"",""value"":""NS_IDENT@108bdbd8"",""pos"":{""lineNum"":33,""columnNum"":6,""endLineNum"":33,""endColumnNum"":15,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":32,""columnNum"":1,""endLineNum"":33,""endColumnNum"":15,""quoted"":false},""children"":{}},""BLOCK_SELECT@5ac7aa18"":{""id"":""BLOCK_SELECT@5ac7aa18"",""parentId"":""BLOCK_SETOP@3e850122"",""fields"":[""NAME_1 VARCHAR(100)"",""NAME_2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@15dd5ac2"",""value"":""NS_SETOP@4f8b4bd0.NAME_1"",""pos"":{""lineNum"":35,""columnNum"":16,""endLineNum"":35,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7bbbb6a8"",""value"":""NS_SETOP@4f8b4bd0.NAME_2"",""pos"":{""lineNum"":35,""columnNum"":24,""endLineNum"":35,""endColumnNum"":29,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_SETOP@4f8b4bd0""],""fromNode"":{""id"":""JOIN_OPERAND@4cdd2c73"",""value"":""BLOCK_SETOP@4cdd2c73"",""pos"":{""lineNum"":37,""columnNum"":17,""endLineNum"":41,""endColumnNum"":43,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@7bbbb6a8"",""value"":""NS_SETOP@4f8b4bd0.NAME_2"",""pos"":{""lineNum"":35,""columnNum"":24,""endLineNum"":35,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@15dd5ac2"",""value"":""NS_SETOP@4f8b4bd0.NAME_1"",""pos"":{""lineNum"":35,""columnNum"":16,""endLineNum"":35,""endColumnNum"":21,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":35,""columnNum"":9,""endLineNum"":43,""endColumnNum"":17,""quoted"":false},""children"":{""BLOCK_SETOP@4cdd2c73"":{""id"":""BLOCK_SETOP@4cdd2c73"",""parentId"":""BLOCK_SELECT@5ac7aa18"",""alias"":""TEMP"",""fields"":[""NAME_1 VARCHAR(100)"",""NAME_2 VARCHAR(100)"",""BEER VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@4abf3f0"",""rightBlockId"":""BLOCK_SELECT@293cde83"",""pos"":{""lineNum"":37,""columnNum"":17,""endLineNum"":41,""endColumnNum"":43,""quoted"":false},""children"":{""BLOCK_SELECT@4abf3f0"":{""id"":""BLOCK_SELECT@4abf3f0"",""parentId"":""BLOCK_SETOP@4cdd2c73"",""fields"":[""NAME_1 VARCHAR(100)"",""NAME_2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@b18c4"",""value"":""*"",""pos"":{""lineNum"":37,""columnNum"":24,""endLineNum"":37,""endColumnNum"":24,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@4e904fd5""],""fromNode"":{""id"":""JOIN_OPERAND@4e4c3a38"",""value"":""NS_IDENT@4e904fd5"",""pos"":{""lineNum"":38,""columnNum"":22,""endLineNum"":38,""endColumnNum"":38,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":37,""columnNum"":17,""endLineNum"":38,""endColumnNum"":38,""quoted"":false},""children"":{}},""BLOCK_SELECT@293cde83"":{""id"":""BLOCK_SELECT@293cde83"",""parentId"":""BLOCK_SETOP@4cdd2c73"",""fields"":[""NAME_1 VARCHAR(100)"",""NAME_2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@597f48df"",""value"":""*"",""pos"":{""lineNum"":40,""columnNum"":24,""endLineNum"":40,""endColumnNum"":24,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@4cbf4f53""],""fromNode"":{""id"":""JOIN_OPERAND@c27d163"",""value"":""NS_IDENT@4cbf4f53"",""pos"":{""lineNum"":41,""columnNum"":22,""endLineNum"":41,""endColumnNum"":43,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":40,""columnNum"":17,""endLineNum"":41,""endColumnNum"":43,""quoted"":false},""children"":{}}}}}}}},""tables"":{""NS_IDENT@1cb19dba"":{""tableId"":""NS_IDENT@1cb19dba"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":26,""endLineNum"":8,""endColumnNum"":30,""quoted"":false}},""NS_IDENT@365553de"":{""tableId"":""NS_IDENT@365553de"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":19,""columnNum"":26,""endLineNum"":19,""endColumnNum"":30,""quoted"":false}},""NS_IDENT@108bdbd8"":{""tableId"":""NS_IDENT@108bdbd8"",""identifier"":""ALL_COMBOS"",""dbTableName"":""ALL_COMBOS"",""fields"":[""NAME_1 VARCHAR(100)"",""NAME_2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":33,""columnNum"":6,""endLineNum"":33,""endColumnNum"":15,""quoted"":false}},""NS_IDENT@6293e39e"":{""tableId"":""NS_IDENT@6293e39e"",""identifier"":""ALL_COMBOS"",""dbTableName"":""ALL_COMBOS"",""fields"":[""NAME_1 VARCHAR(100)"",""NAME_2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":19,""columnNum"":14,""endLineNum"":19,""endColumnNum"":23,""quoted"":false}},""NS_IDENT@5bca7664"":{""tableId"":""NS_IDENT@5bca7664"",""identifier"":""DRINKER_2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":20,""endLineNum"":4,""endColumnNum"":36,""quoted"":false}},""NS_SETOP@4f8b4bd0"":{""tableId"":""NS_SETOP@4f8b4bd0"",""identifier"":""TEMP"",""blockId"":""BLOCK_SETOP@4cdd2c73"",""fields"":[""NAME_1 VARCHAR(100)"",""NAME_2 VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":37,""columnNum"":17,""endLineNum"":41,""endColumnNum"":43,""quoted"":false}},""NS_IDENT@4e904fd5"":{""tableId"":""NS_IDENT@4e904fd5"",""identifier"":""DRINKER_ONE_LIKES"",""dbTableName"":""DRINKER_ONE_LIKES"",""fields"":[""NAME_1 VARCHAR(100)"",""NAME_2 VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":38,""columnNum"":22,""endLineNum"":38,""endColumnNum"":38,""quoted"":false}},""NS_IDENT@4cbf4f53"":{""tableId"":""NS_IDENT@4cbf4f53"",""identifier"":""JUST_DRINKER_TWO_LIKES"",""dbTableName"":""JUST_DRINKER_TWO_LIKES"",""fields"":[""NAME_1 VARCHAR(100)"",""NAME_2 VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":41,""columnNum"":22,""endLineNum"":41,""endColumnNum"":43,""quoted"":false}},""NS_IDENT@333cb916"":{""tableId"":""NS_IDENT@333cb916"",""identifier"":""DRINKER_1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":14,""endLineNum"":3,""endColumnNum"":33,""quoted"":false}},""NS_IDENT@7f829c76"":{""tableId"":""NS_IDENT@7f829c76"",""identifier"":""ALL_COMBOS"",""dbTableName"":""ALL_COMBOS"",""fields"":[""NAME_1 VARCHAR(100)"",""NAME_2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":14,""endLineNum"":8,""endColumnNum"":23,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@5c20ffa8"",""alias"":""ALL_COMBOS"",""fields"":[""NAME_1 VARCHAR(100)"",""NAME_2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@3fae596"",""value"":""NS_IDENT@333cb916.NAME"",""pos"":{""lineNum"":2,""columnNum"":16,""endLineNum"":2,""endColumnNum"":29,""quoted"":false},""children"":[],""alias"":""NAME_1""},{""id"":""COLUMN_LOCAL@42fcc7e6"",""value"":""NS_IDENT@5bca7664.NAME"",""pos"":{""lineNum"":2,""columnNum"":39,""endLineNum"":2,""endColumnNum"":52,""quoted"":false},""children"":[],""alias"":""NAME_2""}],""fromItemIds"":[""NS_IDENT@333cb916"",""NS_IDENT@5bca7664""],""fromNode"":{""id"":""OP_JOIN@6bcbf05b"",""value"":""CROSS"",""pos"":{""lineNum"":4,""columnNum"":15,""endLineNum"":4,""endColumnNum"":18,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@59942b48"",""value"":""NS_IDENT@333cb916"",""pos"":{""lineNum"":3,""columnNum"":14,""endLineNum"":3,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@f9b5552"",""value"":""NS_IDENT@5bca7664"",""pos"":{""lineNum"":4,""columnNum"":20,""endLineNum"":4,""endColumnNum"":26,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@6a2eea2a"",""value"":""<>"",""pos"":{""lineNum"":5,""columnNum"":15,""endLineNum"":5,""endColumnNum"":46,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@2098d37d"",""value"":""NS_IDENT@333cb916.name"",""pos"":{""lineNum"":5,""columnNum"":15,""endLineNum"":5,""endColumnNum"":28,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4349754"",""value"":""NS_IDENT@5bca7664.name"",""pos"":{""lineNum"":5,""columnNum"":33,""endLineNum"":5,""endColumnNum"":46,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@42fcc7e6"",""value"":""NS_IDENT@5bca7664.NAME"",""pos"":{""lineNum"":2,""columnNum"":39,""endLineNum"":2,""endColumnNum"":52,""quoted"":false},""children"":[],""alias"":""NAME_2""},{""id"":""COLUMN_LOCAL@2098d37d"",""value"":""NS_IDENT@333cb916.name"",""pos"":{""lineNum"":5,""columnNum"":15,""endLineNum"":5,""endColumnNum"":28,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3fae596"",""value"":""NS_IDENT@333cb916.NAME"",""pos"":{""lineNum"":2,""columnNum"":16,""endLineNum"":2,""endColumnNum"":29,""quoted"":false},""children"":[],""alias"":""NAME_1""},{""id"":""COLUMN_LOCAL@4349754"",""value"":""NS_IDENT@5bca7664.name"",""pos"":{""lineNum"":5,""columnNum"":33,""endLineNum"":5,""endColumnNum"":46,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":5,""endColumnNum"":46,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@54da32dc"",""alias"":""DRINKER_ONE_LIKES"",""fields"":[""NAME_1 VARCHAR(100)"",""NAME_2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@7c3ebc6b"",""value"":""NS_IDENT@7f829c76.NAME_1"",""pos"":{""lineNum"":7,""columnNum"":16,""endLineNum"":7,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6a9950f1"",""value"":""NS_IDENT@7f829c76.NAME_2"",""pos"":{""lineNum"":7,""columnNum"":24,""endLineNum"":7,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@73017a80"",""value"":""NS_IDENT@1cb19dba.BEER"",""pos"":{""lineNum"":7,""columnNum"":32,""endLineNum"":7,""endColumnNum"":41,""quoted"":false},""children"":[],""alias"":""BEER""}],""fromItemIds"":[""NS_IDENT@7f829c76"",""NS_IDENT@1cb19dba""],""fromNode"":{""id"":""OP_JOIN@1d782abe"",""value"":""COMMA"",""pos"":{""lineNum"":8,""columnNum"":24,""endLineNum"":8,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@66bfd864"",""value"":""NS_IDENT@7f829c76"",""pos"":{""lineNum"":8,""columnNum"":14,""endLineNum"":8,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@4aac85fa"",""value"":""NS_IDENT@1cb19dba"",""pos"":{""lineNum"":8,""columnNum"":26,""endLineNum"":8,""endColumnNum"":30,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@2a27cb34"",""value"":""="",""pos"":{""lineNum"":9,""columnNum"":15,""endLineNum"":9,""endColumnNum"":47,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@56f71edb"",""value"":""NS_IDENT@7f829c76.NAME_1"",""pos"":{""lineNum"":9,""columnNum"":15,""endLineNum"":9,""endColumnNum"":31,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7207cb51"",""value"":""NS_IDENT@1cb19dba.drinker"",""pos"":{""lineNum"":9,""columnNum"":35,""endLineNum"":9,""endColumnNum"":47,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@6a9950f1"",""value"":""NS_IDENT@7f829c76.NAME_2"",""pos"":{""lineNum"":7,""columnNum"":24,""endLineNum"":7,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@56f71edb"",""value"":""NS_IDENT@7f829c76.NAME_1"",""pos"":{""lineNum"":9,""columnNum"":15,""endLineNum"":9,""endColumnNum"":31,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7c3ebc6b"",""value"":""NS_IDENT@7f829c76.NAME_1"",""pos"":{""lineNum"":7,""columnNum"":16,""endLineNum"":7,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@73017a80"",""value"":""NS_IDENT@1cb19dba.BEER"",""pos"":{""lineNum"":7,""columnNum"":32,""endLineNum"":7,""endColumnNum"":41,""quoted"":false},""children"":[],""alias"":""BEER""},{""id"":""COLUMN_LOCAL@7207cb51"",""value"":""NS_IDENT@1cb19dba.drinker"",""pos"":{""lineNum"":9,""columnNum"":35,""endLineNum"":9,""endColumnNum"":47,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":7,""columnNum"":9,""endLineNum"":9,""endColumnNum"":47,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@6079cf5"",""alias"":""JUST_DRINKER_TWO_LIKES"",""fields"":[""NAME_1 VARCHAR(100)"",""NAME_2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@34a0ef00"",""value"":""NS_IDENT@6293e39e.NAME_1"",""pos"":{""lineNum"":18,""columnNum"":16,""endLineNum"":18,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@21fdfefc"",""value"":""NS_IDENT@6293e39e.NAME_2"",""pos"":{""lineNum"":18,""columnNum"":24,""endLineNum"":18,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@ec1b2e4"",""value"":""NS_IDENT@365553de.BEER"",""pos"":{""lineNum"":18,""columnNum"":32,""endLineNum"":18,""endColumnNum"":41,""quoted"":false},""children"":[],""alias"":""BEER""}],""fromItemIds"":[""NS_IDENT@6293e39e"",""NS_IDENT@365553de""],""fromNode"":{""id"":""OP_JOIN@1e6308a9"",""value"":""COMMA"",""pos"":{""lineNum"":19,""columnNum"":24,""endLineNum"":19,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@30cecdca"",""value"":""NS_IDENT@6293e39e"",""pos"":{""lineNum"":19,""columnNum"":14,""endLineNum"":19,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@6edc4161"",""value"":""NS_IDENT@365553de"",""pos"":{""lineNum"":19,""columnNum"":26,""endLineNum"":19,""endColumnNum"":30,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@2822c6ff"",""value"":""="",""pos"":{""lineNum"":20,""columnNum"":15,""endLineNum"":20,""endColumnNum"":47,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@621f89b8"",""value"":""NS_IDENT@6293e39e.NAME_2"",""pos"":{""lineNum"":20,""columnNum"":15,""endLineNum"":20,""endColumnNum"":31,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@f339eae"",""value"":""NS_IDENT@365553de.drinker"",""pos"":{""lineNum"":20,""columnNum"":35,""endLineNum"":20,""endColumnNum"":47,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@621f89b8"",""value"":""NS_IDENT@6293e39e.NAME_2"",""pos"":{""lineNum"":20,""columnNum"":15,""endLineNum"":20,""endColumnNum"":31,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@ec1b2e4"",""value"":""NS_IDENT@365553de.BEER"",""pos"":{""lineNum"":18,""columnNum"":32,""endLineNum"":18,""endColumnNum"":41,""quoted"":false},""children"":[],""alias"":""BEER""},{""id"":""COLUMN_LOCAL@21fdfefc"",""value"":""NS_IDENT@6293e39e.NAME_2"",""pos"":{""lineNum"":18,""columnNum"":24,""endLineNum"":18,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@f339eae"",""value"":""NS_IDENT@365553de.drinker"",""pos"":{""lineNum"":20,""columnNum"":35,""endLineNum"":20,""endColumnNum"":47,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@34a0ef00"",""value"":""NS_IDENT@6293e39e.NAME_1"",""pos"":{""lineNum"":18,""columnNum"":16,""endLineNum"":18,""endColumnNum"":21,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":18,""columnNum"":9,""endLineNum"":20,""endColumnNum"":47,""quoted"":false},""children"":{}}]}
"
"WITH pairs AS
(SELECT drinker1.name d1, drinker2.name d2
FROM drinker drinker1, drinker drinker2
WHERE drinker1.name <> drinker2.name),

p1 AS
(SELECT pairs.d1, pairs.d2, L.beer
FROM Likes L, pairs
WHERE pairs.d1 = L.drinker),

p2 AS
(SELECT pairs.d1, pairs.d2, L.beer
FROM likes L, pairs
WHERE pairs.d2 = L.drinker),

difference AS
(SELECT *
FROM p1
EXCEPT (SELECT * FROM p2))

SELECT *
FROM pairs
EXCEPT (SELECT difference.d1, difference.d2 FROM difference)","{""blocks"":{""id"":""BLOCK_SETOP@4e4c3a38"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@293cde83"",""rightBlockId"":""BLOCK_SELECT@57c88764"",""pos"":{""lineNum"":21,""columnNum"":1,""endLineNum"":23,""endColumnNum"":59,""quoted"":false},""children"":{""BLOCK_SELECT@293cde83"":{""id"":""BLOCK_SELECT@293cde83"",""parentId"":""BLOCK_SETOP@4e4c3a38"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@5c0f79f0"",""value"":""*"",""pos"":{""lineNum"":21,""columnNum"":8,""endLineNum"":21,""endColumnNum"":8,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@34a0ef00""],""fromNode"":{""id"":""JOIN_OPERAND@c27d163"",""value"":""NS_IDENT@34a0ef00"",""pos"":{""lineNum"":22,""columnNum"":6,""endLineNum"":22,""endColumnNum"":10,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":21,""columnNum"":1,""endLineNum"":22,""endColumnNum"":10,""quoted"":false},""children"":{}},""BLOCK_SELECT@57c88764"":{""id"":""BLOCK_SELECT@57c88764"",""parentId"":""BLOCK_SETOP@4e4c3a38"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@2d2acd89"",""value"":""NS_IDENT@21fdfefc.D1"",""pos"":{""lineNum"":23,""columnNum"":16,""endLineNum"":23,""endColumnNum"":28,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7baf6acf"",""value"":""NS_IDENT@21fdfefc.D2"",""pos"":{""lineNum"":23,""columnNum"":31,""endLineNum"":23,""endColumnNum"":43,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@21fdfefc""],""fromNode"":{""id"":""JOIN_OPERAND@78faea5f"",""value"":""NS_IDENT@21fdfefc"",""pos"":{""lineNum"":23,""columnNum"":50,""endLineNum"":23,""endColumnNum"":59,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@2d2acd89"",""value"":""NS_IDENT@21fdfefc.D1"",""pos"":{""lineNum"":23,""columnNum"":16,""endLineNum"":23,""endColumnNum"":28,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7baf6acf"",""value"":""NS_IDENT@21fdfefc.D2"",""pos"":{""lineNum"":23,""columnNum"":31,""endLineNum"":23,""endColumnNum"":43,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":23,""columnNum"":9,""endLineNum"":23,""endColumnNum"":59,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@1f193686"":{""tableId"":""NS_IDENT@1f193686"",""identifier"":""DRINKER2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":24,""endLineNum"":3,""endColumnNum"":39,""quoted"":false}},""NS_IDENT@105b693d"":{""tableId"":""NS_IDENT@105b693d"",""identifier"":""PAIRS"",""dbTableName"":""PAIRS"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":15,""endLineNum"":8,""endColumnNum"":19,""quoted"":false}},""NS_IDENT@21fdfefc"":{""tableId"":""NS_IDENT@21fdfefc"",""identifier"":""DIFFERENCE"",""dbTableName"":""DIFFERENCE"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":23,""columnNum"":50,""endLineNum"":23,""endColumnNum"":59,""quoted"":false}},""NS_IDENT@6293e39e"":{""tableId"":""NS_IDENT@6293e39e"",""identifier"":""P2"",""dbTableName"":""P2"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":19,""columnNum"":23,""endLineNum"":19,""endColumnNum"":24,""quoted"":false}},""NS_IDENT@5bca7664"":{""tableId"":""NS_IDENT@5bca7664"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":6,""endLineNum"":8,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@3350ebdd"":{""tableId"":""NS_IDENT@3350ebdd"",""identifier"":""DRINKER1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":6,""endLineNum"":3,""endColumnNum"":21,""quoted"":false}},""NS_IDENT@4a5905d9"":{""tableId"":""NS_IDENT@4a5905d9"",""identifier"":""P1"",""dbTableName"":""P1"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":18,""columnNum"":6,""endLineNum"":18,""endColumnNum"":7,""quoted"":false}},""NS_IDENT@5ce4369b"":{""tableId"":""NS_IDENT@5ce4369b"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":13,""columnNum"":6,""endLineNum"":13,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@7f829c76"":{""tableId"":""NS_IDENT@7f829c76"",""identifier"":""PAIRS"",""dbTableName"":""PAIRS"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":13,""columnNum"":15,""endLineNum"":13,""endColumnNum"":19,""quoted"":false}},""NS_IDENT@34a0ef00"":{""tableId"":""NS_IDENT@34a0ef00"",""identifier"":""PAIRS"",""dbTableName"":""PAIRS"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":22,""columnNum"":6,""endLineNum"":22,""endColumnNum"":10,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@5c20ffa8"",""alias"":""PAIRS"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@5fad41be"",""value"":""NS_IDENT@3350ebdd.NAME"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":21,""quoted"":false},""children"":[],""alias"":""D1""},{""id"":""COLUMN_LOCAL@3b36e000"",""value"":""NS_IDENT@1f193686.NAME"",""pos"":{""lineNum"":2,""columnNum"":27,""endLineNum"":2,""endColumnNum"":39,""quoted"":false},""children"":[],""alias"":""D2""}],""fromItemIds"":[""NS_IDENT@3350ebdd"",""NS_IDENT@1f193686""],""fromNode"":{""id"":""OP_JOIN@6bcbf05b"",""value"":""COMMA"",""pos"":{""lineNum"":3,""columnNum"":22,""endLineNum"":3,""endColumnNum"":22,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@59942b48"",""value"":""NS_IDENT@3350ebdd"",""pos"":{""lineNum"":3,""columnNum"":6,""endLineNum"":3,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@f9b5552"",""value"":""NS_IDENT@1f193686"",""pos"":{""lineNum"":3,""columnNum"":24,""endLineNum"":3,""endColumnNum"":30,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@3b0ee03a"",""value"":""<>"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":36,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@65fd6708"",""value"":""NS_IDENT@3350ebdd.name"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@b967222"",""value"":""NS_IDENT@1f193686.name"",""pos"":{""lineNum"":4,""columnNum"":24,""endLineNum"":4,""endColumnNum"":36,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@5fad41be"",""value"":""NS_IDENT@3350ebdd.NAME"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":21,""quoted"":false},""children"":[],""alias"":""D1""},{""id"":""COLUMN_LOCAL@65fd6708"",""value"":""NS_IDENT@3350ebdd.name"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3b36e000"",""value"":""NS_IDENT@1f193686.NAME"",""pos"":{""lineNum"":2,""columnNum"":27,""endLineNum"":2,""endColumnNum"":39,""quoted"":false},""children"":[],""alias"":""D2""},{""id"":""COLUMN_LOCAL@b967222"",""value"":""NS_IDENT@1f193686.name"",""pos"":{""lineNum"":4,""columnNum"":24,""endLineNum"":4,""endColumnNum"":36,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":2,""endLineNum"":4,""endColumnNum"":36,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@54da32dc"",""alias"":""P1"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@5e8604bf"",""value"":""NS_IDENT@105b693d.D1"",""pos"":{""lineNum"":7,""columnNum"":9,""endLineNum"":7,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@20095ab4"",""value"":""NS_IDENT@105b693d.D2"",""pos"":{""lineNum"":7,""columnNum"":19,""endLineNum"":7,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@42fcc7e6"",""value"":""NS_IDENT@5bca7664.BEER"",""pos"":{""lineNum"":7,""columnNum"":29,""endLineNum"":7,""endColumnNum"":34,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@5bca7664"",""NS_IDENT@105b693d""],""fromNode"":{""id"":""OP_JOIN@1d782abe"",""value"":""COMMA"",""pos"":{""lineNum"":8,""columnNum"":13,""endLineNum"":8,""endColumnNum"":13,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@6df7988f"",""value"":""NS_IDENT@5bca7664"",""pos"":{""lineNum"":8,""columnNum"":6,""endLineNum"":8,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@4aac85fa"",""value"":""NS_IDENT@105b693d"",""pos"":{""lineNum"":8,""columnNum"":15,""endLineNum"":8,""endColumnNum"":19,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@4a6c18ad"",""value"":""="",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":26,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@6892cc6f"",""value"":""NS_IDENT@105b693d.D1"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6fd1660"",""value"":""NS_IDENT@5bca7664.drinker"",""pos"":{""lineNum"":9,""columnNum"":18,""endLineNum"":9,""endColumnNum"":26,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@42fcc7e6"",""value"":""NS_IDENT@5bca7664.BEER"",""pos"":{""lineNum"":7,""columnNum"":29,""endLineNum"":7,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6892cc6f"",""value"":""NS_IDENT@105b693d.D1"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@20095ab4"",""value"":""NS_IDENT@105b693d.D2"",""pos"":{""lineNum"":7,""columnNum"":19,""endLineNum"":7,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6fd1660"",""value"":""NS_IDENT@5bca7664.drinker"",""pos"":{""lineNum"":9,""columnNum"":18,""endLineNum"":9,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5e8604bf"",""value"":""NS_IDENT@105b693d.D1"",""pos"":{""lineNum"":7,""columnNum"":9,""endLineNum"":7,""endColumnNum"":16,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":7,""columnNum"":2,""endLineNum"":9,""endColumnNum"":26,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@6079cf5"",""alias"":""P2"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@4dafba3e"",""value"":""NS_IDENT@7f829c76.D1"",""pos"":{""lineNum"":12,""columnNum"":9,""endLineNum"":12,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@53e3a87a"",""value"":""NS_IDENT@7f829c76.D2"",""pos"":{""lineNum"":12,""columnNum"":19,""endLineNum"":12,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1931d99"",""value"":""NS_IDENT@5ce4369b.BEER"",""pos"":{""lineNum"":12,""columnNum"":29,""endLineNum"":12,""endColumnNum"":34,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@5ce4369b"",""NS_IDENT@7f829c76""],""fromNode"":{""id"":""OP_JOIN@1e6308a9"",""value"":""COMMA"",""pos"":{""lineNum"":13,""columnNum"":13,""endLineNum"":13,""endColumnNum"":13,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@30cecdca"",""value"":""NS_IDENT@5ce4369b"",""pos"":{""lineNum"":13,""columnNum"":6,""endLineNum"":13,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@6edc4161"",""value"":""NS_IDENT@7f829c76"",""pos"":{""lineNum"":13,""columnNum"":15,""endLineNum"":13,""endColumnNum"":19,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@2822c6ff"",""value"":""="",""pos"":{""lineNum"":14,""columnNum"":7,""endLineNum"":14,""endColumnNum"":26,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@621f89b8"",""value"":""NS_IDENT@7f829c76.D2"",""pos"":{""lineNum"":14,""columnNum"":7,""endLineNum"":14,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@f339eae"",""value"":""NS_IDENT@5ce4369b.drinker"",""pos"":{""lineNum"":14,""columnNum"":18,""endLineNum"":14,""endColumnNum"":26,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@621f89b8"",""value"":""NS_IDENT@7f829c76.D2"",""pos"":{""lineNum"":14,""columnNum"":7,""endLineNum"":14,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@f339eae"",""value"":""NS_IDENT@5ce4369b.drinker"",""pos"":{""lineNum"":14,""columnNum"":18,""endLineNum"":14,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@53e3a87a"",""value"":""NS_IDENT@7f829c76.D2"",""pos"":{""lineNum"":12,""columnNum"":19,""endLineNum"":12,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1931d99"",""value"":""NS_IDENT@5ce4369b.BEER"",""pos"":{""lineNum"":12,""columnNum"":29,""endLineNum"":12,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4dafba3e"",""value"":""NS_IDENT@7f829c76.D1"",""pos"":{""lineNum"":12,""columnNum"":9,""endLineNum"":12,""endColumnNum"":16,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":12,""columnNum"":2,""endLineNum"":14,""endColumnNum"":26,""quoted"":false},""children"":{}},{""id"":""BLOCK_SETOP@27fde870"",""alias"":""DIFFERENCE"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)"",""BEER VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@2b4c3c29"",""rightBlockId"":""BLOCK_SELECT@4cdd2c73"",""pos"":{""lineNum"":17,""columnNum"":2,""endLineNum"":19,""endColumnNum"":24,""quoted"":false},""children"":{""BLOCK_SELECT@2b4c3c29"":{""id"":""BLOCK_SELECT@2b4c3c29"",""parentId"":""BLOCK_SETOP@27fde870"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@1a3e5f23"",""value"":""*"",""pos"":{""lineNum"":17,""columnNum"":9,""endLineNum"":17,""endColumnNum"":9,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@4a5905d9""],""fromNode"":{""id"":""JOIN_OPERAND@5ac7aa18"",""value"":""NS_IDENT@4a5905d9"",""pos"":{""lineNum"":18,""columnNum"":6,""endLineNum"":18,""endColumnNum"":7,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":17,""columnNum"":2,""endLineNum"":18,""endColumnNum"":7,""quoted"":false},""children"":{}},""BLOCK_SELECT@4cdd2c73"":{""id"":""BLOCK_SELECT@4cdd2c73"",""parentId"":""BLOCK_SETOP@27fde870"",""fields"":[""D1 VARCHAR(100)"",""D2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@365553de"",""value"":""*"",""pos"":{""lineNum"":19,""columnNum"":16,""endLineNum"":19,""endColumnNum"":16,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@6293e39e""],""fromNode"":{""id"":""JOIN_OPERAND@4abf3f0"",""value"":""NS_IDENT@6293e39e"",""pos"":{""lineNum"":19,""columnNum"":23,""endLineNum"":19,""endColumnNum"":24,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":19,""columnNum"":9,""endLineNum"":19,""endColumnNum"":24,""quoted"":false},""children"":{}}}}]}
"
"select distinct L1.drinker, L2.drinker
from likes L1, likes L2
where L1.drinker <> L2.drinker
  and L1.beer in (select L3.beer
  from likes L3
  where L2.drinker = L3.drinker);","{""blocks"":{""id"":""BLOCK_SELECT@40021799"",""fields"":[""DRINKER VARCHAR(100)"",""DRINKER VARCHAR(100)""],""isDistinct"":true,""selectList"":[{""id"":""COLUMN_LOCAL@4dafba3e"",""value"":""NS_IDENT@60d1b21f.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@40368a46"",""value"":""NS_IDENT@f339eae.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":29,""endLineNum"":1,""endColumnNum"":38,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@60d1b21f"",""NS_IDENT@f339eae""],""fromNode"":{""id"":""OP_JOIN@4690f583"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":14,""endLineNum"":2,""endColumnNum"":14,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@59712875"",""value"":""NS_IDENT@60d1b21f"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@47b2e9e1"",""value"":""NS_IDENT@f339eae"",""pos"":{""lineNum"":2,""columnNum"":16,""endLineNum"":2,""endColumnNum"":20,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@5af97169"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":6,""endColumnNum"":31,""quoted"":false},""children"":[{""id"":""OP_BINARY@42e22a53"",""value"":""<>"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":30,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1b005a0b"",""value"":""NS_IDENT@60d1b21f.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@257cc1fc"",""value"":""NS_IDENT@f339eae.drinker"",""pos"":{""lineNum"":3,""columnNum"":21,""endLineNum"":3,""endColumnNum"":30,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@1949309d"",""value"":""IN"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":6,""endColumnNum"":31,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@57adfab0"",""value"":""NS_IDENT@60d1b21f.beer"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@4e868ef5"",""value"":""BLOCK_SELECT@4e868ef5"",""pos"":{""lineNum"":4,""columnNum"":19,""endLineNum"":6,""endColumnNum"":31,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@257cc1fc"",""value"":""NS_IDENT@f339eae.drinker"",""pos"":{""lineNum"":3,""columnNum"":21,""endLineNum"":3,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1b005a0b"",""value"":""NS_IDENT@60d1b21f.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@57adfab0"",""value"":""NS_IDENT@60d1b21f.beer"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4dafba3e"",""value"":""NS_IDENT@60d1b21f.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@40368a46"",""value"":""NS_IDENT@f339eae.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":29,""endLineNum"":1,""endColumnNum"":38,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@f339eae.drinker""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":6,""endColumnNum"":32,""quoted"":false},""children"":{""BLOCK_SELECT@4e868ef5"":{""id"":""BLOCK_SELECT@4e868ef5"",""parentId"":""BLOCK_SELECT@40021799"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@7c6442c2"",""value"":""NS_IDENT@676ff3b0.BEER"",""pos"":{""lineNum"":4,""columnNum"":26,""endLineNum"":4,""endColumnNum"":32,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@676ff3b0""],""fromNode"":{""id"":""JOIN_OPERAND@afb5821"",""value"":""NS_IDENT@676ff3b0"",""pos"":{""lineNum"":5,""columnNum"":8,""endLineNum"":5,""endColumnNum"":12,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@3b7b05a8"",""value"":""="",""pos"":{""lineNum"":6,""columnNum"":9,""endLineNum"":6,""endColumnNum"":31,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@d8948cd"",""value"":""NS_IDENT@f339eae.drinker"",""pos"":{""lineNum"":6,""columnNum"":9,""endLineNum"":6,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1436a7ab"",""value"":""NS_IDENT@676ff3b0.drinker"",""pos"":{""lineNum"":6,""columnNum"":22,""endLineNum"":6,""endColumnNum"":31,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@7c6442c2"",""value"":""NS_IDENT@676ff3b0.BEER"",""pos"":{""lineNum"":4,""columnNum"":26,""endLineNum"":4,""endColumnNum"":32,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1436a7ab"",""value"":""NS_IDENT@676ff3b0.drinker"",""pos"":{""lineNum"":6,""columnNum"":22,""endLineNum"":6,""endColumnNum"":31,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@d8948cd"",""value"":""NS_IDENT@f339eae.drinker"",""pos"":{""lineNum"":6,""columnNum"":9,""endLineNum"":6,""endColumnNum"":18,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@f339eae""],""corrCtxIds"":[""BLOCK_SELECT@40021799""],""pos"":{""lineNum"":4,""columnNum"":19,""endLineNum"":6,""endColumnNum"":31,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@676ff3b0"":{""tableId"":""NS_IDENT@676ff3b0"",""identifier"":""L3"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":8,""endLineNum"":5,""endColumnNum"":15,""quoted"":false}},""NS_IDENT@f339eae"":{""tableId"":""NS_IDENT@f339eae"",""identifier"":""L2"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":16,""endLineNum"":2,""endColumnNum"":23,""quoted"":false}},""NS_IDENT@60d1b21f"":{""tableId"":""NS_IDENT@60d1b21f"",""identifier"":""L1"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":13,""quoted"":false}}},""corrTables"":[""NS_IDENT@f339eae""]}
"
"WITH pairs AS
(SELECT drinker1.name d1, drinker2.name d2
 FROM drinker drinker1, drinker drinker2
 WHERE drinker1.name <> drinker2.name), 

one AS
(SELECT pairs.d1, pairs.d2, L.beer
 FROM likes L, pairs
 WHERE pairs.d1 = L.drinker),

two AS
(SELECT pairs.d1, pairs.d2, L.beer
 FROM likes L, pairs
 WHERE pairs.d2 = L.drinker),

difference AS
(SELECT *
 FROM one
 EXCEPT (SELECT * FROM two))

SELECT *
FROM pairs
EXCEPT (SELECT difference.d1, difference.d2 FROM difference)","{""failed"":true,""errorMsg"":""Parsing error at line 6, column 1. Query syntax may be incorrect""}
"
"with pairs as
(select drinker1.name d1, drinker2.name d2
from drinker drinker1, drinker drinker2
where drinker1.name <> drinker2.name), 

one as
(select pairs.d1, pairs.d2, l.beer
from likes l, pairs
where pairs.d1 = l.drinker),

two as
(select pairs.d1, pairs.d2, l.beer
from likes l, pairs
where pairs.d2 = l.drinker),

difference as
(select *
from one
except (select * from two))

select *
from pairs
except (select difference.d1, difference.d2 from difference)","{""failed"":true,""errorMsg"":""Parsing error at line 6, column 1. Query syntax may be incorrect""}
"
"WITH allPairs AS (
	SELECT drinker1.name AS drinker1, drinker2.name AS drinker2
	FROM drinker AS drinker1 JOIN drinker AS drinker2 ON NOT drinker1.name = drinker2.name
)
SELECT * 
FROM allPairs
EXCEPT(
	SELECT sameLikes.drinker1, sameLikes.drinker2
	FROM (
		SELECT allPairs.drinker1, allPairs.drinker2, likes.beer
		FROM allPairs JOIN likes ON (allPairs.drinker1 = likes.drinker)
		EXCEPT(
			SELECT allPairs.drinker1, allPairs.drinker2, likes.beer
			FROM allPairs JOIN likes ON (allPairs.drinker2 = likes.drinker)
		)
	) AS sameLikes
)","{""failed"":true}
"
"SELECT D1.name AS drinker1, D2.name AS drinker2
FROM drinker D1, drinker D2
WHERE D1.name<>D2.name AND
(D2.name IN (SELECT drinker as name FROM likes) OR (D1.name NOT IN (SELECT drinker as name FROM likes) AND D2.name NOT IN (SELECT drinker as name FROM likes)))
EXCEPT
SELECT D.drinker1, D.drinker2
FROM (SELECT L1.drinker AS drinker1, L1.beer, L2.drinker AS drinker2
FROM likes L1, likes L2
WHERE L1.drinker <> L2.drinker 
EXCEPT SELECT L1.drinker, L1.beer, L2.drinker
FROM likes L1, likes L2
WHERE L1.drinker<>L2.drinker AND L1.beer=L2.beer) AS D;","{""failed"":true}
"
"-- Find drinker pairs (drinker1, drinker2) such that the beers liked by drinker1 is a subset of
-- beers liked by drinker2. Format your output as list of (drinker1, drinker2) pairs (x)
-- [Output columns: drinker1, drinker2]

-- with onlyd1likes as ((select distinct l1.drinker as d1, l2.drinker as d2, l1.beer as beer
-- from likes l1, likes l2)
-- except
-- (select distinct l1.drinker as d1, l2.drinker as d2, l2.beer as beer
-- from likes l1, likes l2)),

-- ans as ((select d1, d2 from onlyd1likes) except (select l1.drinker as d1, l2.drinker as d2
-- from likes l1, likes l2
-- where l1.beer = l2.beer and l1.drinker != l2.drinker) )

-- select *
-- from ans


with onlyd1likes as ((select distinct l1.drinker as d1, l2.drinker as d2, l1.beer as beer
from likes l1, likes l2
where l1.beer = l2.beer)
except
(select distinct l1.drinker as d1, l2.drinker as d2, l2.beer as beer
from likes l1, likes l2
where l1.beer = l2.beer)),

ans as ((select d1, d2 from onlyd1likes) except (select l1.drinker as d1, l2.drinker as d2
from likes l1, likes l2
where l1.beer = l2.beer and l1.drinker != l2.drinker))

select *
from ans","{""failed"":true,""errorMsg"":""Parsing error at line 29, column 40. Query syntax may be incorrect""}
"
"SELECT a.drinker AS drinker1, b.drinker AS drinker2
FROM likes a, likes b
WHERE a.drinker <> b.drinker

EXCEPT

SELECT drinker1, drinker2
FROM (
  SELECT drinker1, drinker2, beer
  FROM (
    SELECT a.drinker AS drinker1, b.drinker AS drinker2, a.beer AS beer1, b.beer AS beer2
    FROM likes a, likes b
    WHERE a.drinker <> b.drinker
  ) s, likes
  WHERE drinker1 = likes.drinker
  
  EXCEPT
  
  SELECT drinker1, drinker2, beer
  FROM (
    SELECT a.drinker AS drinker1, b.drinker AS drinker2, a.beer AS beer1, b.beer AS beer2
    FROM likes a, likes b
    WHERE a.drinker <> b.drinker
  ) s, likes
  WHERE drinker2 = likes.drinker
  ) t

","{""blocks"":{""id"":""BLOCK_SETOP@3f36b447"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@65004ff6"",""rightBlockId"":""BLOCK_SELECT@319854f0"",""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":26,""endColumnNum"":5,""quoted"":false},""children"":{""BLOCK_SELECT@65004ff6"":{""id"":""BLOCK_SELECT@65004ff6"",""parentId"":""BLOCK_SETOP@3f36b447"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@1be59f28"",""value"":""NS_IDENT@7b3315a5.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":16,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@153d4abb"",""value"":""NS_IDENT@540dbda9.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":31,""endLineNum"":1,""endColumnNum"":39,""quoted"":false},""children"":[],""alias"":""DRINKER2""}],""fromItemIds"":[""NS_IDENT@7b3315a5"",""NS_IDENT@540dbda9""],""fromNode"":{""id"":""OP_JOIN@383f1975"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":13,""endLineNum"":2,""endColumnNum"":13,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@773c0293"",""value"":""NS_IDENT@7b3315a5"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@1a5f7e7c"",""value"":""NS_IDENT@540dbda9"",""pos"":{""lineNum"":2,""columnNum"":15,""endLineNum"":2,""endColumnNum"":19,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@545607f2"",""value"":""<>"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":28,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@2d746ce4"",""value"":""NS_IDENT@7b3315a5.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@515ebef3"",""value"":""NS_IDENT@540dbda9.drinker"",""pos"":{""lineNum"":3,""columnNum"":20,""endLineNum"":3,""endColumnNum"":28,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@153d4abb"",""value"":""NS_IDENT@540dbda9.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":31,""endLineNum"":1,""endColumnNum"":39,""quoted"":false},""children"":[],""alias"":""DRINKER2""},{""id"":""COLUMN_LOCAL@2d746ce4"",""value"":""NS_IDENT@7b3315a5.drinker"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@515ebef3"",""value"":""NS_IDENT@540dbda9.drinker"",""pos"":{""lineNum"":3,""columnNum"":20,""endLineNum"":3,""endColumnNum"":28,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1be59f28"",""value"":""NS_IDENT@7b3315a5.DRINKER"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":16,""quoted"":false},""children"":[],""alias"":""DRINKER1""}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":3,""endColumnNum"":28,""quoted"":false},""children"":{}},""BLOCK_SELECT@319854f0"":{""id"":""BLOCK_SELECT@319854f0"",""parentId"":""BLOCK_SETOP@3f36b447"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@29a69a35"",""value"":""NS_SETOP@27b000f7.DRINKER1"",""pos"":{""lineNum"":7,""columnNum"":8,""endLineNum"":7,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@e344ad3"",""value"":""NS_SETOP@27b000f7.DRINKER2"",""pos"":{""lineNum"":7,""columnNum"":18,""endLineNum"":7,""endColumnNum"":25,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_SETOP@27b000f7""],""fromNode"":{""id"":""JOIN_OPERAND@748fe51d"",""value"":""BLOCK_SETOP@748fe51d"",""pos"":{""lineNum"":9,""columnNum"":3,""endLineNum"":25,""endColumnNum"":32,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@29a69a35"",""value"":""NS_SETOP@27b000f7.DRINKER1"",""pos"":{""lineNum"":7,""columnNum"":8,""endLineNum"":7,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@e344ad3"",""value"":""NS_SETOP@27b000f7.DRINKER2"",""pos"":{""lineNum"":7,""columnNum"":18,""endLineNum"":7,""endColumnNum"":25,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":7,""columnNum"":1,""endLineNum"":26,""endColumnNum"":5,""quoted"":false},""children"":{""BLOCK_SETOP@748fe51d"":{""id"":""BLOCK_SETOP@748fe51d"",""parentId"":""BLOCK_SELECT@319854f0"",""alias"":""T"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@415156bf"",""rightBlockId"":""BLOCK_SELECT@8c46918"",""pos"":{""lineNum"":9,""columnNum"":3,""endLineNum"":25,""endColumnNum"":32,""quoted"":false},""children"":{""BLOCK_SELECT@8c46918"":{""id"":""BLOCK_SELECT@8c46918"",""parentId"":""BLOCK_SETOP@748fe51d"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@1a3e5f23"",""value"":""NS_SELECT@42fcc7e6.DRINKER1"",""pos"":{""lineNum"":19,""columnNum"":10,""endLineNum"":19,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@365553de"",""value"":""NS_SELECT@42fcc7e6.DRINKER2"",""pos"":{""lineNum"":19,""columnNum"":20,""endLineNum"":19,""endColumnNum"":27,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5c0f79f0"",""value"":""NS_IDENT@4a5905d9.BEER"",""pos"":{""lineNum"":19,""columnNum"":30,""endLineNum"":19,""endColumnNum"":33,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_SELECT@42fcc7e6"",""NS_IDENT@4a5905d9""],""fromNode"":{""id"":""OP_JOIN@226b143b"",""value"":""COMMA"",""pos"":{""lineNum"":24,""columnNum"":6,""endLineNum"":24,""endColumnNum"":6,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@682bd3c4"",""value"":""BLOCK_SELECT@682bd3c4"",""pos"":{""lineNum"":21,""columnNum"":5,""endLineNum"":23,""endColumnNum"":32,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@68ba310d"",""value"":""NS_IDENT@4a5905d9"",""pos"":{""lineNum"":24,""columnNum"":8,""endLineNum"":24,""endColumnNum"":12,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@32b9bd12"",""value"":""="",""pos"":{""lineNum"":25,""columnNum"":9,""endLineNum"":25,""endColumnNum"":32,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@37c2eacb"",""value"":""NS_SELECT@42fcc7e6.DRINKER2"",""pos"":{""lineNum"":25,""columnNum"":9,""endLineNum"":25,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@232cce0"",""value"":""NS_IDENT@4a5905d9.drinker"",""pos"":{""lineNum"":25,""columnNum"":20,""endLineNum"":25,""endColumnNum"":32,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@365553de"",""value"":""NS_SELECT@42fcc7e6.DRINKER2"",""pos"":{""lineNum"":19,""columnNum"":20,""endLineNum"":19,""endColumnNum"":27,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5c0f79f0"",""value"":""NS_IDENT@4a5905d9.BEER"",""pos"":{""lineNum"":19,""columnNum"":30,""endLineNum"":19,""endColumnNum"":33,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@37c2eacb"",""value"":""NS_SELECT@42fcc7e6.DRINKER2"",""pos"":{""lineNum"":25,""columnNum"":9,""endLineNum"":25,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@232cce0"",""value"":""NS_IDENT@4a5905d9.drinker"",""pos"":{""lineNum"":25,""columnNum"":20,""endLineNum"":25,""endColumnNum"":32,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1a3e5f23"",""value"":""NS_SELECT@42fcc7e6.DRINKER1"",""pos"":{""lineNum"":19,""columnNum"":10,""endLineNum"":19,""endColumnNum"":17,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":19,""columnNum"":3,""endLineNum"":25,""endColumnNum"":32,""quoted"":false},""children"":{""BLOCK_SELECT@682bd3c4"":{""id"":""BLOCK_SELECT@682bd3c4"",""parentId"":""BLOCK_SELECT@8c46918"",""alias"":""S"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER1 VARCHAR(100)"",""BEER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@78830d9a"",""value"":""NS_IDENT@9255c05.DRINKER"",""pos"":{""lineNum"":21,""columnNum"":12,""endLineNum"":21,""endColumnNum"":20,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@7f829c76"",""value"":""NS_IDENT@5da7cee2.DRINKER"",""pos"":{""lineNum"":21,""columnNum"":35,""endLineNum"":21,""endColumnNum"":43,""quoted"":false},""children"":[],""alias"":""DRINKER2""},{""id"":""COLUMN_LOCAL@7c3ebc6b"",""value"":""NS_IDENT@9255c05.BEER"",""pos"":{""lineNum"":21,""columnNum"":58,""endLineNum"":21,""endColumnNum"":63,""quoted"":false},""children"":[],""alias"":""BEER1""},{""id"":""COLUMN_LOCAL@6a9950f1"",""value"":""NS_IDENT@5da7cee2.BEER"",""pos"":{""lineNum"":21,""columnNum"":75,""endLineNum"":21,""endColumnNum"":80,""quoted"":false},""children"":[],""alias"":""BEER2""}],""fromItemIds"":[""NS_IDENT@9255c05"",""NS_IDENT@5da7cee2""],""fromNode"":{""id"":""OP_JOIN@f2e4acf"",""value"":""COMMA"",""pos"":{""lineNum"":22,""columnNum"":17,""endLineNum"":22,""endColumnNum"":17,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@24097e9b"",""value"":""NS_IDENT@9255c05"",""pos"":{""lineNum"":22,""columnNum"":10,""endLineNum"":22,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@5eb97ced"",""value"":""NS_IDENT@5da7cee2"",""pos"":{""lineNum"":22,""columnNum"":19,""endLineNum"":22,""endColumnNum"":23,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@4dafba3e"",""value"":""<>"",""pos"":{""lineNum"":23,""columnNum"":11,""endLineNum"":23,""endColumnNum"":32,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@f339eae"",""value"":""NS_IDENT@9255c05.drinker"",""pos"":{""lineNum"":23,""columnNum"":11,""endLineNum"":23,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2822c6ff"",""value"":""NS_IDENT@5da7cee2.drinker"",""pos"":{""lineNum"":23,""columnNum"":24,""endLineNum"":23,""endColumnNum"":32,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@6a9950f1"",""value"":""NS_IDENT@5da7cee2.BEER"",""pos"":{""lineNum"":21,""columnNum"":75,""endLineNum"":21,""endColumnNum"":80,""quoted"":false},""children"":[],""alias"":""BEER2""},{""id"":""COLUMN_LOCAL@f339eae"",""value"":""NS_IDENT@9255c05.drinker"",""pos"":{""lineNum"":23,""columnNum"":11,""endLineNum"":23,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7c3ebc6b"",""value"":""NS_IDENT@9255c05.BEER"",""pos"":{""lineNum"":21,""columnNum"":58,""endLineNum"":21,""endColumnNum"":63,""quoted"":false},""children"":[],""alias"":""BEER1""},{""id"":""COLUMN_LOCAL@7f829c76"",""value"":""NS_IDENT@5da7cee2.DRINKER"",""pos"":{""lineNum"":21,""columnNum"":35,""endLineNum"":21,""endColumnNum"":43,""quoted"":false},""children"":[],""alias"":""DRINKER2""},{""id"":""COLUMN_LOCAL@2822c6ff"",""value"":""NS_IDENT@5da7cee2.drinker"",""pos"":{""lineNum"":23,""columnNum"":24,""endLineNum"":23,""endColumnNum"":32,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@78830d9a"",""value"":""NS_IDENT@9255c05.DRINKER"",""pos"":{""lineNum"":21,""columnNum"":12,""endLineNum"":21,""endColumnNum"":20,""quoted"":false},""children"":[],""alias"":""DRINKER1""}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":21,""columnNum"":5,""endLineNum"":23,""endColumnNum"":32,""quoted"":false},""children"":{}}}},""BLOCK_SELECT@415156bf"":{""id"":""BLOCK_SELECT@415156bf"",""parentId"":""BLOCK_SETOP@748fe51d"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@333cb916"",""value"":""NS_SELECT@42f9c19a.DRINKER1"",""pos"":{""lineNum"":9,""columnNum"":10,""endLineNum"":9,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1d25c1c"",""value"":""NS_SELECT@42f9c19a.DRINKER2"",""pos"":{""lineNum"":9,""columnNum"":20,""endLineNum"":9,""endColumnNum"":27,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5bca7664"",""value"":""NS_IDENT@3b36e000.BEER"",""pos"":{""lineNum"":9,""columnNum"":30,""endLineNum"":9,""endColumnNum"":33,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_SELECT@42f9c19a"",""NS_IDENT@3b36e000""],""fromNode"":{""id"":""OP_JOIN@393881f0"",""value"":""COMMA"",""pos"":{""lineNum"":14,""columnNum"":6,""endLineNum"":14,""endColumnNum"":6,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@4af46df3"",""value"":""BLOCK_SELECT@4af46df3"",""pos"":{""lineNum"":11,""columnNum"":5,""endLineNum"":13,""endColumnNum"":32,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@4a55a6e8"",""value"":""NS_IDENT@3b36e000"",""pos"":{""lineNum"":14,""columnNum"":8,""endLineNum"":14,""endColumnNum"":12,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@7207cb51"",""value"":""="",""pos"":{""lineNum"":15,""columnNum"":9,""endLineNum"":15,""endColumnNum"":32,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@35835fa"",""value"":""NS_SELECT@42f9c19a.DRINKER1"",""pos"":{""lineNum"":15,""columnNum"":9,""endLineNum"":15,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@56f71edb"",""value"":""NS_IDENT@3b36e000.drinker"",""pos"":{""lineNum"":15,""columnNum"":20,""endLineNum"":15,""endColumnNum"":32,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@5bca7664"",""value"":""NS_IDENT@3b36e000.BEER"",""pos"":{""lineNum"":9,""columnNum"":30,""endLineNum"":9,""endColumnNum"":33,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@333cb916"",""value"":""NS_SELECT@42f9c19a.DRINKER1"",""pos"":{""lineNum"":9,""columnNum"":10,""endLineNum"":9,""endColumnNum"":17,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@56f71edb"",""value"":""NS_IDENT@3b36e000.drinker"",""pos"":{""lineNum"":15,""columnNum"":20,""endLineNum"":15,""endColumnNum"":32,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@35835fa"",""value"":""NS_SELECT@42f9c19a.DRINKER1"",""pos"":{""lineNum"":15,""columnNum"":9,""endLineNum"":15,""endColumnNum"":16,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1d25c1c"",""value"":""NS_SELECT@42f9c19a.DRINKER2"",""pos"":{""lineNum"":9,""columnNum"":20,""endLineNum"":9,""endColumnNum"":27,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":9,""columnNum"":3,""endLineNum"":15,""endColumnNum"":32,""quoted"":false},""children"":{""BLOCK_SELECT@4af46df3"":{""id"":""BLOCK_SELECT@4af46df3"",""parentId"":""BLOCK_SELECT@415156bf"",""alias"":""S"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER1 VARCHAR(100)"",""BEER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@253b380a"",""value"":""NS_IDENT@64bfd6fd.DRINKER"",""pos"":{""lineNum"":11,""columnNum"":12,""endLineNum"":11,""endColumnNum"":20,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@3350ebdd"",""value"":""NS_IDENT@2ab2710.DRINKER"",""pos"":{""lineNum"":11,""columnNum"":35,""endLineNum"":11,""endColumnNum"":43,""quoted"":false},""children"":[],""alias"":""DRINKER2""},{""id"":""COLUMN_LOCAL@149f5761"",""value"":""NS_IDENT@64bfd6fd.BEER"",""pos"":{""lineNum"":11,""columnNum"":58,""endLineNum"":11,""endColumnNum"":63,""quoted"":false},""children"":[],""alias"":""BEER1""},{""id"":""COLUMN_LOCAL@1f193686"",""value"":""NS_IDENT@2ab2710.BEER"",""pos"":{""lineNum"":11,""columnNum"":75,""endLineNum"":11,""endColumnNum"":80,""quoted"":false},""children"":[],""alias"":""BEER2""}],""fromItemIds"":[""NS_IDENT@64bfd6fd"",""NS_IDENT@2ab2710""],""fromNode"":{""id"":""OP_JOIN@4158debd"",""value"":""COMMA"",""pos"":{""lineNum"":12,""columnNum"":17,""endLineNum"":12,""endColumnNum"":17,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@af78c87"",""value"":""NS_IDENT@64bfd6fd"",""pos"":{""lineNum"":12,""columnNum"":10,""endLineNum"":12,""endColumnNum"":14,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@773dab28"",""value"":""NS_IDENT@2ab2710"",""pos"":{""lineNum"":12,""columnNum"":19,""endLineNum"":12,""endColumnNum"":23,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@63718b93"",""value"":""<>"",""pos"":{""lineNum"":13,""columnNum"":11,""endLineNum"":13,""endColumnNum"":32,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@3721177d"",""value"":""NS_IDENT@64bfd6fd.drinker"",""pos"":{""lineNum"":13,""columnNum"":11,""endLineNum"":13,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@766a4535"",""value"":""NS_IDENT@2ab2710.drinker"",""pos"":{""lineNum"":13,""columnNum"":24,""endLineNum"":13,""endColumnNum"":32,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@3721177d"",""value"":""NS_IDENT@64bfd6fd.drinker"",""pos"":{""lineNum"":13,""columnNum"":11,""endLineNum"":13,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@253b380a"",""value"":""NS_IDENT@64bfd6fd.DRINKER"",""pos"":{""lineNum"":11,""columnNum"":12,""endLineNum"":11,""endColumnNum"":20,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@766a4535"",""value"":""NS_IDENT@2ab2710.drinker"",""pos"":{""lineNum"":13,""columnNum"":24,""endLineNum"":13,""endColumnNum"":32,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3350ebdd"",""value"":""NS_IDENT@2ab2710.DRINKER"",""pos"":{""lineNum"":11,""columnNum"":35,""endLineNum"":11,""endColumnNum"":43,""quoted"":false},""children"":[],""alias"":""DRINKER2""},{""id"":""COLUMN_LOCAL@1f193686"",""value"":""NS_IDENT@2ab2710.BEER"",""pos"":{""lineNum"":11,""columnNum"":75,""endLineNum"":11,""endColumnNum"":80,""quoted"":false},""children"":[],""alias"":""BEER2""},{""id"":""COLUMN_LOCAL@149f5761"",""value"":""NS_IDENT@64bfd6fd.BEER"",""pos"":{""lineNum"":11,""columnNum"":58,""endLineNum"":11,""endColumnNum"":63,""quoted"":false},""children"":[],""alias"":""BEER1""}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":11,""columnNum"":5,""endLineNum"":13,""endColumnNum"":32,""quoted"":false},""children"":{}}}}}}}}}},""tables"":{""NS_IDENT@3b36e000"":{""tableId"":""NS_IDENT@3b36e000"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":14,""columnNum"":8,""endLineNum"":14,""endColumnNum"":12,""quoted"":false}},""NS_IDENT@540dbda9"":{""tableId"":""NS_IDENT@540dbda9"",""identifier"":""B"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":15,""endLineNum"":2,""endColumnNum"":21,""quoted"":false}},""NS_IDENT@2ab2710"":{""tableId"":""NS_IDENT@2ab2710"",""identifier"":""B"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":12,""columnNum"":19,""endLineNum"":12,""endColumnNum"":25,""quoted"":false}},""NS_IDENT@7b3315a5"":{""tableId"":""NS_IDENT@7b3315a5"",""identifier"":""A"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false}},""NS_SELECT@42fcc7e6"":{""tableId"":""NS_SELECT@42fcc7e6"",""identifier"":""S"",""blockId"":""BLOCK_SELECT@682bd3c4"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER1 VARCHAR(100)"",""BEER2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":21,""columnNum"":5,""endLineNum"":24,""endColumnNum"":5,""quoted"":false}},""NS_IDENT@64bfd6fd"":{""tableId"":""NS_IDENT@64bfd6fd"",""identifier"":""A"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":12,""columnNum"":10,""endLineNum"":12,""endColumnNum"":16,""quoted"":false}},""NS_IDENT@9255c05"":{""tableId"":""NS_IDENT@9255c05"",""identifier"":""A"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":22,""columnNum"":10,""endLineNum"":22,""endColumnNum"":16,""quoted"":false}},""NS_IDENT@4a5905d9"":{""tableId"":""NS_IDENT@4a5905d9"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":24,""columnNum"":8,""endLineNum"":24,""endColumnNum"":12,""quoted"":false}},""NS_SELECT@42f9c19a"":{""tableId"":""NS_SELECT@42f9c19a"",""identifier"":""S"",""blockId"":""BLOCK_SELECT@4af46df3"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER1 VARCHAR(100)"",""BEER2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":11,""columnNum"":5,""endLineNum"":14,""endColumnNum"":5,""quoted"":false}},""NS_IDENT@5da7cee2"":{""tableId"":""NS_IDENT@5da7cee2"",""identifier"":""B"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":22,""columnNum"":19,""endLineNum"":22,""endColumnNum"":25,""quoted"":false}},""NS_SETOP@27b000f7"":{""tableId"":""NS_SETOP@27b000f7"",""identifier"":""T"",""blockId"":""BLOCK_SETOP@748fe51d"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":9,""columnNum"":3,""endLineNum"":25,""endColumnNum"":32,""quoted"":false}}},""corrTables"":[]}
"
"select d1.name as drinker1, d2.name as drinker2
from drinker as d1, drinker as d2 
where d1.name <> d2.name and not exists (select beer from likes where drinker = d1.name and beer not in 
(select beer from likes where drinker = d2.name));
","{""blocks"":{""id"":""BLOCK_SELECT@61d01788"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@1d12b024"",""value"":""NS_IDENT@61799544.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":14,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@43effd89"",""value"":""NS_IDENT@476ec9d0.NAME"",""pos"":{""lineNum"":1,""columnNum"":29,""endLineNum"":1,""endColumnNum"":35,""quoted"":false},""children"":[],""alias"":""DRINKER2""}],""fromItemIds"":[""NS_IDENT@61799544"",""NS_IDENT@476ec9d0""],""fromNode"":{""id"":""OP_JOIN@6d2d99fc"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":19,""endLineNum"":2,""endColumnNum"":19,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@5e3a39cd"",""value"":""NS_IDENT@61799544"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@21f9277b"",""value"":""NS_IDENT@476ec9d0"",""pos"":{""lineNum"":2,""columnNum"":21,""endLineNum"":2,""endColumnNum"":27,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@6b587673"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":4,""endColumnNum"":48,""quoted"":false},""children"":[{""id"":""OP_BINARY@dffa30b"",""value"":""<>"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4784013e"",""value"":""NS_IDENT@61799544.name"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7f02251"",""value"":""NS_IDENT@476ec9d0.name"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[]}]},{""id"":""OP_PREFIX@6d3c232f"",""value"":""NOT"",""pos"":{""lineNum"":3,""columnNum"":30,""endLineNum"":4,""endColumnNum"":48,""quoted"":false},""children"":[{""id"":""OP_PREFIX@4d8126f"",""value"":""EXISTS"",""pos"":{""lineNum"":3,""columnNum"":34,""endLineNum"":4,""endColumnNum"":48,""quoted"":false},""children"":[{""id"":""BLOCK_SELECT@247667dd"",""value"":""BLOCK_SELECT@247667dd"",""pos"":{""lineNum"":3,""columnNum"":42,""endLineNum"":4,""endColumnNum"":48,""quoted"":false},""children"":[]}]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@4784013e"",""value"":""NS_IDENT@61799544.name"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1d12b024"",""value"":""NS_IDENT@61799544.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":14,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@7f02251"",""value"":""NS_IDENT@476ec9d0.name"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@43effd89"",""value"":""NS_IDENT@476ec9d0.NAME"",""pos"":{""lineNum"":1,""columnNum"":29,""endLineNum"":1,""endColumnNum"":35,""quoted"":false},""children"":[],""alias"":""DRINKER2""}],""incomingIdentifiers"":[""NS_IDENT@61799544.name"",""NS_IDENT@476ec9d0.name""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":4,""endColumnNum"":49,""quoted"":false},""children"":{""BLOCK_SELECT@247667dd"":{""id"":""BLOCK_SELECT@247667dd"",""parentId"":""BLOCK_SELECT@61d01788"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@3a4ba480"",""value"":""NS_IDENT@1e9804b9.BEER"",""pos"":{""lineNum"":3,""columnNum"":49,""endLineNum"":3,""endColumnNum"":52,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@1e9804b9""],""fromNode"":{""id"":""JOIN_OPERAND@37a64f9d"",""value"":""NS_IDENT@1e9804b9"",""pos"":{""lineNum"":3,""columnNum"":59,""endLineNum"":3,""endColumnNum"":63,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@2dbd803f"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":71,""endLineNum"":4,""endColumnNum"":47,""quoted"":false},""children"":[{""id"":""OP_BINARY@55b8dbda"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":71,""endLineNum"":3,""endColumnNum"":87,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@3766c667"",""value"":""NS_IDENT@1e9804b9.drinker"",""pos"":{""lineNum"":3,""columnNum"":71,""endLineNum"":3,""endColumnNum"":77,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@773c0293"",""value"":""NS_IDENT@61799544.name"",""pos"":{""lineNum"":3,""columnNum"":81,""endLineNum"":3,""endColumnNum"":87,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@3a022576"",""value"":""NOT IN"",""pos"":{""lineNum"":3,""columnNum"":93,""endLineNum"":4,""endColumnNum"":47,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@3b569985"",""value"":""NS_IDENT@1e9804b9.beer"",""pos"":{""lineNum"":3,""columnNum"":93,""endLineNum"":3,""endColumnNum"":96,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@6f099cef"",""value"":""BLOCK_SELECT@6f099cef"",""pos"":{""lineNum"":4,""columnNum"":2,""endLineNum"":4,""endColumnNum"":47,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@3a4ba480"",""value"":""NS_IDENT@1e9804b9.BEER"",""pos"":{""lineNum"":3,""columnNum"":49,""endLineNum"":3,""endColumnNum"":52,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3766c667"",""value"":""NS_IDENT@1e9804b9.drinker"",""pos"":{""lineNum"":3,""columnNum"":71,""endLineNum"":3,""endColumnNum"":77,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3b569985"",""value"":""NS_IDENT@1e9804b9.beer"",""pos"":{""lineNum"":3,""columnNum"":93,""endLineNum"":3,""endColumnNum"":96,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@773c0293"",""value"":""NS_IDENT@61799544.name"",""pos"":{""lineNum"":3,""columnNum"":81,""endLineNum"":3,""endColumnNum"":87,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@476ec9d0"",""NS_IDENT@61799544""],""corrCtxIds"":[""BLOCK_SELECT@61d01788""],""pos"":{""lineNum"":3,""columnNum"":42,""endLineNum"":4,""endColumnNum"":48,""quoted"":false},""children"":{""BLOCK_SELECT@6f099cef"":{""id"":""BLOCK_SELECT@6f099cef"",""parentId"":""BLOCK_SELECT@247667dd"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@6c37bd27"",""value"":""NS_IDENT@15fa55a6.BEER"",""pos"":{""lineNum"":4,""columnNum"":9,""endLineNum"":4,""endColumnNum"":12,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@15fa55a6""],""fromNode"":{""id"":""JOIN_OPERAND@1d207fad"",""value"":""NS_IDENT@15fa55a6"",""pos"":{""lineNum"":4,""columnNum"":19,""endLineNum"":4,""endColumnNum"":23,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@1a5f7e7c"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":31,""endLineNum"":4,""endColumnNum"":47,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@3e48e859"",""value"":""NS_IDENT@15fa55a6.drinker"",""pos"":{""lineNum"":4,""columnNum"":31,""endLineNum"":4,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@31ddd4a4"",""value"":""NS_IDENT@476ec9d0.name"",""pos"":{""lineNum"":4,""columnNum"":41,""endLineNum"":4,""endColumnNum"":47,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_CORRELATE@31ddd4a4"",""value"":""NS_IDENT@476ec9d0.name"",""pos"":{""lineNum"":4,""columnNum"":41,""endLineNum"":4,""endColumnNum"":47,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6c37bd27"",""value"":""NS_IDENT@15fa55a6.BEER"",""pos"":{""lineNum"":4,""columnNum"":9,""endLineNum"":4,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3e48e859"",""value"":""NS_IDENT@15fa55a6.drinker"",""pos"":{""lineNum"":4,""columnNum"":31,""endLineNum"":4,""endColumnNum"":37,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@476ec9d0""],""corrCtxIds"":[""BLOCK_SELECT@61d01788""],""pos"":{""lineNum"":4,""columnNum"":2,""endLineNum"":4,""endColumnNum"":47,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@61799544"":{""tableId"":""NS_IDENT@61799544"",""identifier"":""D1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":18,""quoted"":false}},""NS_IDENT@1e9804b9"":{""tableId"":""NS_IDENT@1e9804b9"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":59,""endLineNum"":3,""endColumnNum"":63,""quoted"":false}},""NS_IDENT@15fa55a6"":{""tableId"":""NS_IDENT@15fa55a6"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":4,""columnNum"":19,""endLineNum"":4,""endColumnNum"":23,""quoted"":false}},""NS_IDENT@476ec9d0"":{""tableId"":""NS_IDENT@476ec9d0"",""identifier"":""D2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":21,""endLineNum"":2,""endColumnNum"":33,""quoted"":false}}},""corrTables"":[""NS_IDENT@61799544"",""NS_IDENT@476ec9d0""]}
"
"SELECT drinker.name as drinker1, drinkers.name as drinker2
      FROM drinker
      CROSS JOIN drinker as drinkers
      WHERE drinker.name <> drinkers.name
EXCEPT
SELECT subtract.drinker1, subtract.drinker2
FROM
(SELECT drinkers.drinker1, drinkers.drinker2, likes.beer
FROM
(SELECT drinker.name as drinker1, drinkers.name as drinker2
      FROM drinker
      CROSS JOIN drinker as drinkers) drinkers
INNER JOIN likes
ON likes.drinker = drinkers.drinker1
EXCEPT
SELECT drinker_list.drinker1, drinker_list2.drinker2, drinker_list2.beer
FROM (SELECT drinker.name as drinker2, likes.beer
FROM drinker
LEFT JOIN likes
ON drinker.name = likes.drinker) as drinker_list2
JOIN 
(SELECT drinker.name as drinker1, likes.beer
FROM drinker
LEFT JOIN likes
ON drinker.name = likes.drinker) as drinker_list
ON drinker_list2.beer = drinker_list.beer
WHERE drinker_list.drinker1 <> drinker_list2.drinker2) as subtract","{""failed"":true}
"
"SELECT D1.name AS drinker1, D2.name AS drinker2
FROM drinker D1, drinker D2
WHERE D1.name <> D2.name AND NOT EXISTS ((SELECT beer FROM likes WHERE drinker = D1.name) EXCEPT (SELECT beer FROM likes WHERE drinker = D2.name))","{""blocks"":{""id"":""BLOCK_SELECT@4b1abd11"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@37c2eacb"",""value"":""NS_IDENT@65bcf7c2.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":14,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@32b9bd12"",""value"":""NS_IDENT@55ecbafe.NAME"",""pos"":{""lineNum"":1,""columnNum"":29,""endLineNum"":1,""endColumnNum"":35,""quoted"":false},""children"":[],""alias"":""DRINKER2""}],""fromItemIds"":[""NS_IDENT@65bcf7c2"",""NS_IDENT@55ecbafe""],""fromNode"":{""id"":""OP_JOIN@415156bf"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":16,""endLineNum"":2,""endColumnNum"":16,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@4af46df3"",""value"":""NS_IDENT@65bcf7c2"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@4158debd"",""value"":""NS_IDENT@55ecbafe"",""pos"":{""lineNum"":2,""columnNum"":18,""endLineNum"":2,""endColumnNum"":24,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@2a22ad2b"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":144,""quoted"":false},""children"":[{""id"":""OP_BINARY@31da6b2e"",""value"":""<>"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@6e0f7aad"",""value"":""NS_IDENT@65bcf7c2.name"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@99a78d7"",""value"":""NS_IDENT@55ecbafe.name"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[]}]},{""id"":""OP_PREFIX@70242f38"",""value"":""NOT"",""pos"":{""lineNum"":3,""columnNum"":30,""endLineNum"":3,""endColumnNum"":144,""quoted"":false},""children"":[{""id"":""OP_PREFIX@61c76850"",""value"":""EXISTS"",""pos"":{""lineNum"":3,""columnNum"":34,""endLineNum"":3,""endColumnNum"":144,""quoted"":false},""children"":[{""id"":""BLOCK_SETOP@31cb96e1"",""value"":""BLOCK_SETOP@31cb96e1"",""pos"":{""lineNum"":3,""columnNum"":43,""endLineNum"":3,""endColumnNum"":144,""quoted"":false},""children"":[]}]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@37c2eacb"",""value"":""NS_IDENT@65bcf7c2.NAME"",""pos"":{""lineNum"":1,""columnNum"":8,""endLineNum"":1,""endColumnNum"":14,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@99a78d7"",""value"":""NS_IDENT@55ecbafe.name"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@32b9bd12"",""value"":""NS_IDENT@55ecbafe.NAME"",""pos"":{""lineNum"":1,""columnNum"":29,""endLineNum"":1,""endColumnNum"":35,""quoted"":false},""children"":[],""alias"":""DRINKER2""},{""id"":""COLUMN_LOCAL@6e0f7aad"",""value"":""NS_IDENT@65bcf7c2.name"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@55ecbafe.name"",""NS_IDENT@65bcf7c2.name""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":3,""endColumnNum"":146,""quoted"":false},""children"":{""BLOCK_SETOP@31cb96e1"":{""id"":""BLOCK_SETOP@31cb96e1"",""parentId"":""BLOCK_SELECT@4b1abd11"",""fields"":[""BEER VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@3eed0f5"",""rightBlockId"":""BLOCK_SELECT@1cbb3d3b"",""pos"":{""lineNum"":3,""columnNum"":43,""endLineNum"":3,""endColumnNum"":144,""quoted"":false},""children"":{""BLOCK_SELECT@3eed0f5"":{""id"":""BLOCK_SELECT@3eed0f5"",""parentId"":""BLOCK_SETOP@31cb96e1"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@49798e84"",""value"":""NS_IDENT@385ef531.BEER"",""pos"":{""lineNum"":3,""columnNum"":50,""endLineNum"":3,""endColumnNum"":53,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@385ef531""],""fromNode"":{""id"":""JOIN_OPERAND@55b8dbda"",""value"":""NS_IDENT@385ef531"",""pos"":{""lineNum"":3,""columnNum"":60,""endLineNum"":3,""endColumnNum"":64,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@3c0fbd3a"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":72,""endLineNum"":3,""endColumnNum"":88,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@66ec9390"",""value"":""NS_IDENT@385ef531.drinker"",""pos"":{""lineNum"":3,""columnNum"":72,""endLineNum"":3,""endColumnNum"":78,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@6e91893"",""value"":""NS_IDENT@65bcf7c2.name"",""pos"":{""lineNum"":3,""columnNum"":82,""endLineNum"":3,""endColumnNum"":88,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@49798e84"",""value"":""NS_IDENT@385ef531.BEER"",""pos"":{""lineNum"":3,""columnNum"":50,""endLineNum"":3,""endColumnNum"":53,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@66ec9390"",""value"":""NS_IDENT@385ef531.drinker"",""pos"":{""lineNum"":3,""columnNum"":72,""endLineNum"":3,""endColumnNum"":78,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@6e91893"",""value"":""NS_IDENT@65bcf7c2.name"",""pos"":{""lineNum"":3,""columnNum"":82,""endLineNum"":3,""endColumnNum"":88,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@65bcf7c2""],""corrCtxIds"":[""BLOCK_SELECT@4b1abd11""],""pos"":{""lineNum"":3,""columnNum"":43,""endLineNum"":3,""endColumnNum"":88,""quoted"":false},""children"":{}},""BLOCK_SELECT@1cbb3d3b"":{""id"":""BLOCK_SELECT@1cbb3d3b"",""parentId"":""BLOCK_SETOP@31cb96e1"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@5a6482a9"",""value"":""NS_IDENT@3cbcd8f3.BEER"",""pos"":{""lineNum"":3,""columnNum"":106,""endLineNum"":3,""endColumnNum"":109,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@3cbcd8f3""],""fromNode"":{""id"":""JOIN_OPERAND@529cfee5"",""value"":""NS_IDENT@3cbcd8f3"",""pos"":{""lineNum"":3,""columnNum"":116,""endLineNum"":3,""endColumnNum"":120,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@630d1b2f"",""value"":""="",""pos"":{""lineNum"":3,""columnNum"":128,""endLineNum"":3,""endColumnNum"":144,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@f202d6d"",""value"":""NS_IDENT@3cbcd8f3.drinker"",""pos"":{""lineNum"":3,""columnNum"":128,""endLineNum"":3,""endColumnNum"":134,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@60e21209"",""value"":""NS_IDENT@55ecbafe.name"",""pos"":{""lineNum"":3,""columnNum"":138,""endLineNum"":3,""endColumnNum"":144,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_CORRELATE@60e21209"",""value"":""NS_IDENT@55ecbafe.name"",""pos"":{""lineNum"":3,""columnNum"":138,""endLineNum"":3,""endColumnNum"":144,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@f202d6d"",""value"":""NS_IDENT@3cbcd8f3.drinker"",""pos"":{""lineNum"":3,""columnNum"":128,""endLineNum"":3,""endColumnNum"":134,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5a6482a9"",""value"":""NS_IDENT@3cbcd8f3.BEER"",""pos"":{""lineNum"":3,""columnNum"":106,""endLineNum"":3,""endColumnNum"":109,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@55ecbafe""],""corrCtxIds"":[""BLOCK_SELECT@4b1abd11""],""pos"":{""lineNum"":3,""columnNum"":99,""endLineNum"":3,""endColumnNum"":144,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@3cbcd8f3"":{""tableId"":""NS_IDENT@3cbcd8f3"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":116,""endLineNum"":3,""endColumnNum"":120,""quoted"":false}},""NS_IDENT@65bcf7c2"":{""tableId"":""NS_IDENT@65bcf7c2"",""identifier"":""D1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":15,""quoted"":false}},""NS_IDENT@55ecbafe"":{""tableId"":""NS_IDENT@55ecbafe"",""identifier"":""D2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":18,""endLineNum"":2,""endColumnNum"":27,""quoted"":false}},""NS_IDENT@385ef531"":{""tableId"":""NS_IDENT@385ef531"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":60,""endLineNum"":3,""endColumnNum"":64,""quoted"":false}}},""corrTables"":[""NS_IDENT@65bcf7c2"",""NS_IDENT@55ecbafe""]}
"
"WITH pairs AS (
    SELECT d1.name AS drinker1, d2.name AS drinker2
    FROM drinker AS d1, drinker AS d2
    WHERE d1.name <> d2.name
),
remove AS (
    SELECT drinker1, drinker2, likes.beer AS beer
    FROM (
            pairs JOIN likes ON drinker1 = likes.drinker 
    )
    EXCEPT
    SELECT drinker1, drinker2, likes.beer AS beer
    FROM (
            pairs JOIN likes ON drinker2 = likes.drinker 
    )
)
SELECT drinker1, drinker2 FROM pairs EXCEPT SELECT drinker1, drinker2 FROM remove
","{""failed"":true,""errorMsg"":""Parsing error at line 9, column 13. Query syntax may be incorrect""}
"
"select distinct d1.name as drinker1, d2.name as drinker2
from drinker as d1, drinker as d2
where d1.name <> d2.name and d1.name not in
  (select likes3.drinker as name
  from likes as likes3
  where likes3.beer not in
    (select likes4.beer
    from likes as likes4
    where likes4.drinker = d2.name)
  )","{""blocks"":{""id"":""BLOCK_SELECT@40021799"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":true,""selectList"":[{""id"":""COLUMN_LOCAL@16c8b7bd"",""value"":""NS_IDENT@74ad8d05.NAME"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":23,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@65bcf7c2"",""value"":""NS_IDENT@476a736d.NAME"",""pos"":{""lineNum"":1,""columnNum"":38,""endLineNum"":1,""endColumnNum"":44,""quoted"":false},""children"":[],""alias"":""DRINKER2""}],""fromItemIds"":[""NS_IDENT@74ad8d05"",""NS_IDENT@476a736d""],""fromNode"":{""id"":""OP_JOIN@47b2e9e1"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":19,""endLineNum"":2,""endColumnNum"":19,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@59942b48"",""value"":""NS_IDENT@74ad8d05"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@1869f114"",""value"":""NS_IDENT@476a736d"",""pos"":{""lineNum"":2,""columnNum"":21,""endLineNum"":2,""endColumnNum"":27,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@31da6b2e"",""value"":""AND"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":9,""endColumnNum"":35,""quoted"":false},""children"":[{""id"":""OP_BINARY@1949309d"",""value"":""<>"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@109d724c"",""value"":""NS_IDENT@74ad8d05.name"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@57adfab0"",""value"":""NS_IDENT@476a736d.name"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@99a78d7"",""value"":""NOT IN"",""pos"":{""lineNum"":3,""columnNum"":30,""endLineNum"":9,""endColumnNum"":35,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5af97169"",""value"":""NS_IDENT@74ad8d05.name"",""pos"":{""lineNum"":3,""columnNum"":30,""endLineNum"":3,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@4e868ef5"",""value"":""BLOCK_SELECT@4e868ef5"",""pos"":{""lineNum"":4,""columnNum"":4,""endLineNum"":9,""endColumnNum"":35,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@109d724c"",""value"":""NS_IDENT@74ad8d05.name"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@65bcf7c2"",""value"":""NS_IDENT@476a736d.NAME"",""pos"":{""lineNum"":1,""columnNum"":38,""endLineNum"":1,""endColumnNum"":44,""quoted"":false},""children"":[],""alias"":""DRINKER2""},{""id"":""COLUMN_LOCAL@5af97169"",""value"":""NS_IDENT@74ad8d05.name"",""pos"":{""lineNum"":3,""columnNum"":30,""endLineNum"":3,""endColumnNum"":36,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@16c8b7bd"",""value"":""NS_IDENT@74ad8d05.NAME"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":23,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@57adfab0"",""value"":""NS_IDENT@476a736d.name"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@476a736d.name""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":10,""endColumnNum"":3,""quoted"":false},""children"":{""BLOCK_SELECT@4e868ef5"":{""id"":""BLOCK_SELECT@4e868ef5"",""parentId"":""BLOCK_SELECT@40021799"",""fields"":[""NAME VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@1948ea69"",""value"":""NS_IDENT@5a8ba37c.DRINKER"",""pos"":{""lineNum"":4,""columnNum"":11,""endLineNum"":4,""endColumnNum"":24,""quoted"":false},""children"":[],""alias"":""NAME""}],""fromItemIds"":[""NS_IDENT@5a8ba37c""],""fromNode"":{""id"":""JOIN_OPERAND@1d207fad"",""value"":""NS_IDENT@5a8ba37c"",""pos"":{""lineNum"":5,""columnNum"":8,""endLineNum"":5,""endColumnNum"":12,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@4074023c"",""value"":""NOT IN"",""pos"":{""lineNum"":6,""columnNum"":9,""endLineNum"":9,""endColumnNum"":34,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@3ac04654"",""value"":""NS_IDENT@5a8ba37c.beer"",""pos"":{""lineNum"":6,""columnNum"":9,""endLineNum"":6,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@71c905a3"",""value"":""BLOCK_SELECT@71c905a3"",""pos"":{""lineNum"":7,""columnNum"":6,""endLineNum"":9,""endColumnNum"":34,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@3ac04654"",""value"":""NS_IDENT@5a8ba37c.beer"",""pos"":{""lineNum"":6,""columnNum"":9,""endLineNum"":6,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1948ea69"",""value"":""NS_IDENT@5a8ba37c.DRINKER"",""pos"":{""lineNum"":4,""columnNum"":11,""endLineNum"":4,""endColumnNum"":24,""quoted"":false},""children"":[],""alias"":""NAME""}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@476a736d""],""corrCtxIds"":[],""pos"":{""lineNum"":4,""columnNum"":4,""endLineNum"":9,""endColumnNum"":35,""quoted"":false},""children"":{""BLOCK_SELECT@71c905a3"":{""id"":""BLOCK_SELECT@71c905a3"",""parentId"":""BLOCK_SELECT@4e868ef5"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@39109136"",""value"":""NS_IDENT@32b9bd12.BEER"",""pos"":{""lineNum"":7,""columnNum"":13,""endLineNum"":7,""endColumnNum"":23,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@32b9bd12""],""fromNode"":{""id"":""JOIN_OPERAND@4bff2185"",""value"":""NS_IDENT@32b9bd12"",""pos"":{""lineNum"":8,""columnNum"":10,""endLineNum"":8,""endColumnNum"":14,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@66ec9390"",""value"":""="",""pos"":{""lineNum"":9,""columnNum"":11,""endLineNum"":9,""endColumnNum"":34,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@3ed0918d"",""value"":""NS_IDENT@32b9bd12.drinker"",""pos"":{""lineNum"":9,""columnNum"":11,""endLineNum"":9,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@5e268ce6"",""value"":""NS_IDENT@476a736d.name"",""pos"":{""lineNum"":9,""columnNum"":28,""endLineNum"":9,""endColumnNum"":34,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_CORRELATE@5e268ce6"",""value"":""NS_IDENT@476a736d.name"",""pos"":{""lineNum"":9,""columnNum"":28,""endLineNum"":9,""endColumnNum"":34,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@39109136"",""value"":""NS_IDENT@32b9bd12.BEER"",""pos"":{""lineNum"":7,""columnNum"":13,""endLineNum"":7,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3ed0918d"",""value"":""NS_IDENT@32b9bd12.drinker"",""pos"":{""lineNum"":9,""columnNum"":11,""endLineNum"":9,""endColumnNum"":24,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@476a736d""],""corrCtxIds"":[""BLOCK_SELECT@40021799""],""pos"":{""lineNum"":7,""columnNum"":6,""endLineNum"":9,""endColumnNum"":34,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@476a736d"":{""tableId"":""NS_IDENT@476a736d"",""identifier"":""D2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":21,""endLineNum"":2,""endColumnNum"":33,""quoted"":false}},""NS_IDENT@5a8ba37c"":{""tableId"":""NS_IDENT@5a8ba37c"",""identifier"":""LIKES3"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":8,""endLineNum"":5,""endColumnNum"":22,""quoted"":false}},""NS_IDENT@74ad8d05"":{""tableId"":""NS_IDENT@74ad8d05"",""identifier"":""D1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":18,""quoted"":false}},""NS_IDENT@32b9bd12"":{""tableId"":""NS_IDENT@32b9bd12"",""identifier"":""LIKES4"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":10,""endLineNum"":8,""endColumnNum"":24,""quoted"":false}}},""corrTables"":[""NS_IDENT@476a736d""]}
"
"with like1 as ((select l1.drinker as drinker1, l2.drinker as drinker2 from likes as l1, likes as l2 where l1.drinker!=l2.drinker) except (select drinker1, drinker2 from ((select l1.drinker as drinker1,l2.drinker as drinker2,l1.beer as beer from likes as l1, likes as l2 where l1.drinker!=l2.drinker) except (select l1.drinker as drinker1,l2.drinker as drinker2,l2.beer as beer from likes as l1, likes as l2 where l1.drinker!=l2.drinker)) as like4))
select drinker1, drinker2 from (((select drinker1,drinker2 from like1) union (select drinker1, likes.drinker as drinker2 from ((select name as drinker1 from drinker) except (select drinker as drinker1 from likes)) as d1, likes) 
) 
union (select d2.drinker as drinker1,d3.drinker as drinker2 from ((select name as drinker from drinker) except (select drinker from likes)) as d2,((select name as drinker from drinker) except (select drinker from likes)) as d3 where d2.drinker!=d3.drinker)) as d4","{""failed"":true,""errorMsg"":""Parsing error at line 1, column 117. Query syntax may be incorrect""}
"
"SELECT DISTINCT d1.name, d2.name
FROM drinker d1, drinker d2
WHERE d1.name<>d2.name

EXCEPT

SELECT DISTINCT l1.drinker, d2.name
FROM likes l1, drinker d2
WHERE l1.beer NOT IN (SELECT beer FROM likes WHERE likes.drinker = d2.name);
","{""blocks"":{""id"":""BLOCK_SETOP@5eeedb60"",""fields"":[""NAME VARCHAR(100)"",""NAME VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@562c877a"",""rightBlockId"":""BLOCK_SELECT@415156bf"",""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":9,""endColumnNum"":75,""quoted"":false},""children"":{""BLOCK_SELECT@562c877a"":{""id"":""BLOCK_SELECT@562c877a"",""parentId"":""BLOCK_SETOP@5eeedb60"",""fields"":[""NAME VARCHAR(100)"",""NAME VARCHAR(100)""],""isDistinct"":true,""selectList"":[{""id"":""COLUMN_LOCAL@5a8ba37c"",""value"":""NS_IDENT@7159139f.NAME"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@232cce0"",""value"":""NS_IDENT@576c5536.NAME"",""pos"":{""lineNum"":1,""columnNum"":26,""endLineNum"":1,""endColumnNum"":32,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@7159139f"",""NS_IDENT@576c5536""],""fromNode"":{""id"":""OP_JOIN@73a00e09"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":16,""endLineNum"":2,""endColumnNum"":16,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@3b569985"",""value"":""NS_IDENT@7159139f"",""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@22d1886d"",""value"":""NS_IDENT@576c5536"",""pos"":{""lineNum"":2,""columnNum"":18,""endLineNum"":2,""endColumnNum"":24,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@121c54fa"",""value"":""<>"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":22,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@1949309d"",""value"":""NS_IDENT@7159139f.name"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@48c3205a"",""value"":""NS_IDENT@576c5536.name"",""pos"":{""lineNum"":3,""columnNum"":16,""endLineNum"":3,""endColumnNum"":22,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@1949309d"",""value"":""NS_IDENT@7159139f.name"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5a8ba37c"",""value"":""NS_IDENT@7159139f.NAME"",""pos"":{""lineNum"":1,""columnNum"":17,""endLineNum"":1,""endColumnNum"":23,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@232cce0"",""value"":""NS_IDENT@576c5536.NAME"",""pos"":{""lineNum"":1,""columnNum"":26,""endLineNum"":1,""endColumnNum"":32,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@48c3205a"",""value"":""NS_IDENT@576c5536.name"",""pos"":{""lineNum"":3,""columnNum"":16,""endLineNum"":3,""endColumnNum"":22,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":1,""columnNum"":1,""endLineNum"":3,""endColumnNum"":22,""quoted"":false},""children"":{}},""BLOCK_SELECT@415156bf"":{""id"":""BLOCK_SELECT@415156bf"",""parentId"":""BLOCK_SETOP@5eeedb60"",""fields"":[""DRINKER VARCHAR(100)"",""NAME VARCHAR(100)""],""isDistinct"":true,""selectList"":[{""id"":""COLUMN_LOCAL@7fc645e4"",""value"":""NS_IDENT@7e75bf2d.DRINKER"",""pos"":{""lineNum"":7,""columnNum"":17,""endLineNum"":7,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@73044cdf"",""value"":""NS_IDENT@385ef531.NAME"",""pos"":{""lineNum"":7,""columnNum"":29,""endLineNum"":7,""endColumnNum"":35,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@7e75bf2d"",""NS_IDENT@385ef531""],""fromNode"":{""id"":""OP_JOIN@353efdbf"",""value"":""COMMA"",""pos"":{""lineNum"":8,""columnNum"":14,""endLineNum"":8,""endColumnNum"":14,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@55cff952"",""value"":""NS_IDENT@7e75bf2d"",""pos"":{""lineNum"":8,""columnNum"":6,""endLineNum"":8,""endColumnNum"":10,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@660591fb"",""value"":""NS_IDENT@385ef531"",""pos"":{""lineNum"":8,""columnNum"":16,""endLineNum"":8,""endColumnNum"":22,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@66ec9390"",""value"":""NOT IN"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":74,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5e268ce6"",""value"":""NS_IDENT@7e75bf2d.beer"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""BLOCK_SELECT@393881f0"",""value"":""BLOCK_SELECT@393881f0"",""pos"":{""lineNum"":9,""columnNum"":23,""endLineNum"":9,""endColumnNum"":74,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@7fc645e4"",""value"":""NS_IDENT@7e75bf2d.DRINKER"",""pos"":{""lineNum"":7,""columnNum"":17,""endLineNum"":7,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5e268ce6"",""value"":""NS_IDENT@7e75bf2d.beer"",""pos"":{""lineNum"":9,""columnNum"":7,""endLineNum"":9,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@73044cdf"",""value"":""NS_IDENT@385ef531.NAME"",""pos"":{""lineNum"":7,""columnNum"":29,""endLineNum"":7,""endColumnNum"":35,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@385ef531.name""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":7,""columnNum"":1,""endLineNum"":9,""endColumnNum"":75,""quoted"":false},""children"":{""BLOCK_SELECT@393881f0"":{""id"":""BLOCK_SELECT@393881f0"",""parentId"":""BLOCK_SELECT@415156bf"",""fields"":[""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@562457e1"",""value"":""NS_IDENT@9a2ec9b.BEER"",""pos"":{""lineNum"":9,""columnNum"":30,""endLineNum"":9,""endColumnNum"":33,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@9a2ec9b""],""fromNode"":{""id"":""JOIN_OPERAND@2fc07784"",""value"":""NS_IDENT@9a2ec9b"",""pos"":{""lineNum"":9,""columnNum"":40,""endLineNum"":9,""endColumnNum"":44,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@63718b93"",""value"":""="",""pos"":{""lineNum"":9,""columnNum"":52,""endLineNum"":9,""endColumnNum"":74,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@3721177d"",""value"":""NS_IDENT@9a2ec9b.drinker"",""pos"":{""lineNum"":9,""columnNum"":52,""endLineNum"":9,""endColumnNum"":64,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@766a4535"",""value"":""NS_IDENT@385ef531.name"",""pos"":{""lineNum"":9,""columnNum"":68,""endLineNum"":9,""endColumnNum"":74,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@562457e1"",""value"":""NS_IDENT@9a2ec9b.BEER"",""pos"":{""lineNum"":9,""columnNum"":30,""endLineNum"":9,""endColumnNum"":33,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3721177d"",""value"":""NS_IDENT@9a2ec9b.drinker"",""pos"":{""lineNum"":9,""columnNum"":52,""endLineNum"":9,""endColumnNum"":64,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@766a4535"",""value"":""NS_IDENT@385ef531.name"",""pos"":{""lineNum"":9,""columnNum"":68,""endLineNum"":9,""endColumnNum"":74,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@385ef531""],""corrCtxIds"":[""BLOCK_SELECT@415156bf""],""pos"":{""lineNum"":9,""columnNum"":23,""endLineNum"":9,""endColumnNum"":74,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@7159139f"":{""tableId"":""NS_IDENT@7159139f"",""identifier"":""D1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":2,""endColumnNum"":15,""quoted"":false}},""NS_IDENT@9a2ec9b"":{""tableId"":""NS_IDENT@9a2ec9b"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":9,""columnNum"":40,""endLineNum"":9,""endColumnNum"":44,""quoted"":false}},""NS_IDENT@576c5536"":{""tableId"":""NS_IDENT@576c5536"",""identifier"":""D2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":18,""endLineNum"":2,""endColumnNum"":27,""quoted"":false}},""NS_IDENT@385ef531"":{""tableId"":""NS_IDENT@385ef531"",""identifier"":""D2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":16,""endLineNum"":8,""endColumnNum"":25,""quoted"":false}},""NS_IDENT@7e75bf2d"":{""tableId"":""NS_IDENT@7e75bf2d"",""identifier"":""L1"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":6,""endLineNum"":8,""endColumnNum"":13,""quoted"":false}}},""corrTables"":[""NS_IDENT@385ef531""]}
"
"SELECT drinker1, drinker2
FROM (
    SELECT d1.name AS drinker1, d2.name AS drinker2
    FROM drinker AS d1, drinker AS d2
    WHERE d1.name <> d2.name
) AS pairs

EXCEPT 

SELECT drinker1, drinker2
FROM
(
    SELECT drinker1, drinker2, likes.beer AS beer
    FROM (
            (
                SELECT d1.name AS drinker1, d2.name AS drinker2
                FROM drinker AS d1, drinker AS d2
                WHERE d1.name <> d2.name
            ) AS pair1
            JOIN likes 
            ON drinker1 = likes.drinker 
    )

    EXCEPT 

    SELECT drinker1, drinker2, likes.beer AS beer
    FROM (
            (
                SELECT d1.name AS drinker1, d2.name AS drinker2
                FROM drinker AS d1, drinker AS d2
                WHERE d1.name <> d2.name
            ) AS pair2
            JOIN likes 
            ON drinker2 = likes.drinker 
    )
) AS remove","{""failed"":true,""errorMsg"":""Parsing error at line 19, column 15. Query syntax may be incorrect""}
"
"WITH e1 AS
(SELECT d1.name as name1, d2.name as name2
FROM drinker d1, drinker d2
WHERE d1.name <> d2.name), 
e2 AS
(SELECT name1, name2, beer
FROM e1
JOIN likes ON name1 = drinker 
EXCEPT
(SELECT name1, name2, beer
FROM e1 JOIN likes ON name2 = drinker 
))

SELECT name2, name1
FROM e1
EXCEPT 
(SELECT name1, name2 FROM e2);","{""blocks"":{""id"":""BLOCK_SETOP@4a7761b1"",""fields"":[""NAME2 VARCHAR(100)"",""NAME1 VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@3e850122"",""rightBlockId"":""BLOCK_SELECT@2b4c3c29"",""pos"":{""lineNum"":14,""columnNum"":1,""endLineNum"":17,""endColumnNum"":28,""quoted"":false},""children"":{""BLOCK_SELECT@2b4c3c29"":{""id"":""BLOCK_SELECT@2b4c3c29"",""parentId"":""BLOCK_SETOP@4a7761b1"",""fields"":[""NAME1 VARCHAR(100)"",""NAME2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@2ab2710"",""value"":""NS_IDENT@64bfd6fd.NAME1"",""pos"":{""lineNum"":17,""columnNum"":9,""endLineNum"":17,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@29c2c826"",""value"":""NS_IDENT@64bfd6fd.NAME2"",""pos"":{""lineNum"":17,""columnNum"":16,""endLineNum"":17,""endColumnNum"":20,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@64bfd6fd""],""fromNode"":{""id"":""JOIN_OPERAND@5ac7aa18"",""value"":""NS_IDENT@64bfd6fd"",""pos"":{""lineNum"":17,""columnNum"":27,""endLineNum"":17,""endColumnNum"":28,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@2ab2710"",""value"":""NS_IDENT@64bfd6fd.NAME1"",""pos"":{""lineNum"":17,""columnNum"":9,""endLineNum"":17,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@29c2c826"",""value"":""NS_IDENT@64bfd6fd.NAME2"",""pos"":{""lineNum"":17,""columnNum"":16,""endLineNum"":17,""endColumnNum"":20,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":17,""columnNum"":2,""endLineNum"":17,""endColumnNum"":28,""quoted"":false},""children"":{}},""BLOCK_SELECT@3e850122"":{""id"":""BLOCK_SELECT@3e850122"",""parentId"":""BLOCK_SETOP@4a7761b1"",""fields"":[""NAME2 VARCHAR(100)"",""NAME1 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@545e57d7"",""value"":""NS_IDENT@5a67e962.NAME2"",""pos"":{""lineNum"":14,""columnNum"":8,""endLineNum"":14,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@27b000f7"",""value"":""NS_IDENT@5a67e962.NAME1"",""pos"":{""lineNum"":14,""columnNum"":15,""endLineNum"":14,""endColumnNum"":19,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@5a67e962""],""fromNode"":{""id"":""JOIN_OPERAND@27fde870"",""value"":""NS_IDENT@5a67e962"",""pos"":{""lineNum"":15,""columnNum"":6,""endLineNum"":15,""endColumnNum"":7,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@27b000f7"",""value"":""NS_IDENT@5a67e962.NAME1"",""pos"":{""lineNum"":14,""columnNum"":15,""endLineNum"":14,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@545e57d7"",""value"":""NS_IDENT@5a67e962.NAME2"",""pos"":{""lineNum"":14,""columnNum"":8,""endLineNum"":14,""endColumnNum"":12,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":14,""columnNum"":1,""endLineNum"":15,""endColumnNum"":7,""quoted"":false},""children"":{}}}},""tables"":{""NS_IDENT@8ed9cf"":{""tableId"":""NS_IDENT@8ed9cf"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":11,""columnNum"":14,""endLineNum"":11,""endColumnNum"":18,""quoted"":false}},""NS_IDENT@287f7811"":{""tableId"":""NS_IDENT@287f7811"",""identifier"":""D2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":27,""quoted"":false}},""NS_IDENT@67c277a0"":{""tableId"":""NS_IDENT@67c277a0"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":6,""endLineNum"":8,""endColumnNum"":10,""quoted"":false}},""NS_IDENT@29a4f594"":{""tableId"":""NS_IDENT@29a4f594"",""identifier"":""D1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":6,""endLineNum"":3,""endColumnNum"":15,""quoted"":false}},""NS_IDENT@7b3315a5"":{""tableId"":""NS_IDENT@7b3315a5"",""identifier"":""E1"",""dbTableName"":""E1"",""fields"":[""NAME1 VARCHAR(100)"",""NAME2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":11,""columnNum"":6,""endLineNum"":11,""endColumnNum"":7,""quoted"":false}},""NS_IDENT@5a67e962"":{""tableId"":""NS_IDENT@5a67e962"",""identifier"":""E1"",""dbTableName"":""E1"",""fields"":[""NAME1 VARCHAR(100)"",""NAME2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":15,""columnNum"":6,""endLineNum"":15,""endColumnNum"":7,""quoted"":false}},""NS_IDENT@64bfd6fd"":{""tableId"":""NS_IDENT@64bfd6fd"",""identifier"":""E2"",""dbTableName"":""E2"",""fields"":[""NAME1 VARCHAR(100)"",""NAME2 VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":17,""columnNum"":27,""endLineNum"":17,""endColumnNum"":28,""quoted"":false}},""NS_IDENT@58294867"":{""tableId"":""NS_IDENT@58294867"",""identifier"":""E1"",""dbTableName"":""E1"",""fields"":[""NAME1 VARCHAR(100)"",""NAME2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":6,""endLineNum"":7,""endColumnNum"":7,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@4bff2185"",""alias"":""E1"",""fields"":[""NAME1 VARCHAR(100)"",""NAME2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@2b556bb2"",""value"":""NS_IDENT@29a4f594.NAME"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":15,""quoted"":false},""children"":[],""alias"":""NAME1""},{""id"":""COLUMN_LOCAL@17271176"",""value"":""NS_IDENT@287f7811.NAME"",""pos"":{""lineNum"":2,""columnNum"":27,""endLineNum"":2,""endColumnNum"":33,""quoted"":false},""children"":[],""alias"":""NAME2""}],""fromItemIds"":[""NS_IDENT@29a4f594"",""NS_IDENT@287f7811""],""fromNode"":{""id"":""OP_JOIN@458544e0"",""value"":""COMMA"",""pos"":{""lineNum"":3,""columnNum"":16,""endLineNum"":3,""endColumnNum"":16,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@47b2e9e1"",""value"":""NS_IDENT@29a4f594"",""pos"":{""lineNum"":3,""columnNum"":6,""endLineNum"":3,""endColumnNum"":12,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@25b865b5"",""value"":""NS_IDENT@287f7811"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@749ab7b4"",""value"":""<>"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5a6482a9"",""value"":""NS_IDENT@29a4f594.name"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@65fd6708"",""value"":""NS_IDENT@287f7811.name"",""pos"":{""lineNum"":4,""columnNum"":18,""endLineNum"":4,""endColumnNum"":24,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@65fd6708"",""value"":""NS_IDENT@287f7811.name"",""pos"":{""lineNum"":4,""columnNum"":18,""endLineNum"":4,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2b556bb2"",""value"":""NS_IDENT@29a4f594.NAME"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":15,""quoted"":false},""children"":[],""alias"":""NAME1""},{""id"":""COLUMN_LOCAL@5a6482a9"",""value"":""NS_IDENT@29a4f594.name"",""pos"":{""lineNum"":4,""columnNum"":7,""endLineNum"":4,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@17271176"",""value"":""NS_IDENT@287f7811.NAME"",""pos"":{""lineNum"":2,""columnNum"":27,""endLineNum"":2,""endColumnNum"":33,""quoted"":false},""children"":[],""alias"":""NAME2""}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":2,""endLineNum"":4,""endColumnNum"":24,""quoted"":false},""children"":{}},{""id"":""BLOCK_SETOP@f2e4acf"",""alias"":""E2"",""fields"":[""NAME1 VARCHAR(100)"",""NAME2 VARCHAR(100)"",""BEER VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@24097e9b"",""rightBlockId"":""BLOCK_SELECT@4912d525"",""pos"":{""lineNum"":6,""columnNum"":2,""endLineNum"":11,""endColumnNum"":37,""quoted"":false},""children"":{""BLOCK_SELECT@24097e9b"":{""id"":""BLOCK_SELECT@24097e9b"",""parentId"":""BLOCK_SETOP@f2e4acf"",""fields"":[""NAME1 VARCHAR(100)"",""NAME2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@6fc3e1a4"",""value"":""NS_IDENT@58294867.NAME1"",""pos"":{""lineNum"":6,""columnNum"":9,""endLineNum"":6,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2d5f7182"",""value"":""NS_IDENT@58294867.NAME2"",""pos"":{""lineNum"":6,""columnNum"":16,""endLineNum"":6,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@29ea78b1"",""value"":""NS_IDENT@67c277a0.BEER"",""pos"":{""lineNum"":6,""columnNum"":23,""endLineNum"":6,""endColumnNum"":26,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@58294867"",""NS_IDENT@67c277a0""],""fromNode"":{""id"":""OP_JOIN@5eb97ced"",""value"":""INNER"",""pos"":{""lineNum"":8,""columnNum"":1,""endLineNum"":8,""endColumnNum"":4,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@2bcec6a6"",""value"":""NS_IDENT@58294867"",""pos"":{""lineNum"":7,""columnNum"":6,""endLineNum"":7,""endColumnNum"":7,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@77a281fc"",""value"":""NS_IDENT@67c277a0"",""pos"":{""lineNum"":8,""columnNum"":6,""endLineNum"":8,""endColumnNum"":10,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@56f71edb"",""value"":""="",""pos"":{""lineNum"":8,""columnNum"":15,""endLineNum"":8,""endColumnNum"":29,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@b8a7e43"",""value"":""NS_IDENT@58294867.NAME1"",""pos"":{""lineNum"":8,""columnNum"":15,""endLineNum"":8,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@35835fa"",""value"":""NS_IDENT@67c277a0.drinker"",""pos"":{""lineNum"":8,""columnNum"":23,""endLineNum"":8,""endColumnNum"":29,""quoted"":false},""children"":[]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@b8a7e43"",""value"":""NS_IDENT@58294867.NAME1"",""pos"":{""lineNum"":8,""columnNum"":15,""endLineNum"":8,""endColumnNum"":19,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@29ea78b1"",""value"":""NS_IDENT@67c277a0.BEER"",""pos"":{""lineNum"":6,""columnNum"":23,""endLineNum"":6,""endColumnNum"":26,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6fc3e1a4"",""value"":""NS_IDENT@58294867.NAME1"",""pos"":{""lineNum"":6,""columnNum"":9,""endLineNum"":6,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2d5f7182"",""value"":""NS_IDENT@58294867.NAME2"",""pos"":{""lineNum"":6,""columnNum"":16,""endLineNum"":6,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@35835fa"",""value"":""NS_IDENT@67c277a0.drinker"",""pos"":{""lineNum"":8,""columnNum"":23,""endLineNum"":8,""endColumnNum"":29,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":6,""columnNum"":2,""endLineNum"":8,""endColumnNum"":29,""quoted"":false},""children"":{}},""BLOCK_SELECT@4912d525"":{""id"":""BLOCK_SELECT@4912d525"",""parentId"":""BLOCK_SETOP@f2e4acf"",""fields"":[""NAME1 VARCHAR(100)"",""NAME2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@f72203"",""value"":""NS_IDENT@7b3315a5.NAME1"",""pos"":{""lineNum"":10,""columnNum"":9,""endLineNum"":10,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@540dbda9"",""value"":""NS_IDENT@7b3315a5.NAME2"",""pos"":{""lineNum"":10,""columnNum"":16,""endLineNum"":10,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1be59f28"",""value"":""NS_IDENT@8ed9cf.BEER"",""pos"":{""lineNum"":10,""columnNum"":23,""endLineNum"":10,""endColumnNum"":26,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@7b3315a5"",""NS_IDENT@8ed9cf""],""fromNode"":{""id"":""OP_JOIN@2bfbffb2"",""value"":""INNER"",""pos"":{""lineNum"":11,""columnNum"":9,""endLineNum"":11,""endColumnNum"":12,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@765df79d"",""value"":""NS_IDENT@7b3315a5"",""pos"":{""lineNum"":11,""columnNum"":6,""endLineNum"":11,""endColumnNum"":7,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@151335cb"",""value"":""NS_IDENT@8ed9cf"",""pos"":{""lineNum"":11,""columnNum"":14,""endLineNum"":11,""endColumnNum"":18,""quoted"":false},""children"":[]}],""natural"":false,""joinCondition"":{""id"":""OP_BINARY@621f89b8"",""value"":""="",""pos"":{""lineNum"":11,""columnNum"":23,""endLineNum"":11,""endColumnNum"":37,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@66c83fc8"",""value"":""NS_IDENT@7b3315a5.NAME2"",""pos"":{""lineNum"":11,""columnNum"":23,""endLineNum"":11,""endColumnNum"":27,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@546621c4"",""value"":""NS_IDENT@8ed9cf.drinker"",""pos"":{""lineNum"":11,""columnNum"":31,""endLineNum"":11,""endColumnNum"":37,""quoted"":false},""children"":[]}]}},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@546621c4"",""value"":""NS_IDENT@8ed9cf.drinker"",""pos"":{""lineNum"":11,""columnNum"":31,""endLineNum"":11,""endColumnNum"":37,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@66c83fc8"",""value"":""NS_IDENT@7b3315a5.NAME2"",""pos"":{""lineNum"":11,""columnNum"":23,""endLineNum"":11,""endColumnNum"":27,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@540dbda9"",""value"":""NS_IDENT@7b3315a5.NAME2"",""pos"":{""lineNum"":10,""columnNum"":16,""endLineNum"":10,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@f72203"",""value"":""NS_IDENT@7b3315a5.NAME1"",""pos"":{""lineNum"":10,""columnNum"":9,""endLineNum"":10,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1be59f28"",""value"":""NS_IDENT@8ed9cf.BEER"",""pos"":{""lineNum"":10,""columnNum"":23,""endLineNum"":10,""endColumnNum"":26,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":10,""columnNum"":2,""endLineNum"":11,""endColumnNum"":37,""quoted"":false},""children"":{}}}}]}
"
"WITH PairLikes AS
(SELECT d1.name AS drinker1,d2.name AS drinker2 FROM drinker AS d1,drinker AS d2
WHERE d1.name <> d2.name)

SELECT * FROM PairLikes p
  WHERE not EXISTS
    (SELECT * 
    FROM likes l
    WHERE p.drinker1 = l.drinker
      and not EXISTS
        (SELECT * 
        FROM likes
          WHERE beer = l.beer AND drinker = p.drinker2));","{""blocks"":{""id"":""BLOCK_SELECT@4f20a5e0"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@215a34b4"",""value"":""*"",""pos"":{""lineNum"":5,""columnNum"":8,""endLineNum"":5,""endColumnNum"":8,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@5bcde458""],""fromNode"":{""id"":""JOIN_OPERAND@21fff664"",""value"":""NS_IDENT@5bcde458"",""pos"":{""lineNum"":5,""columnNum"":15,""endLineNum"":5,""endColumnNum"":23,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_PREFIX@1cbb3d3b"",""value"":""NOT"",""pos"":{""lineNum"":6,""columnNum"":9,""endLineNum"":13,""endColumnNum"":55,""quoted"":false},""children"":[{""id"":""OP_PREFIX@7df60067"",""value"":""EXISTS"",""pos"":{""lineNum"":6,""columnNum"":13,""endLineNum"":13,""endColumnNum"":55,""quoted"":false},""children"":[{""id"":""BLOCK_SELECT@54da32dc"",""value"":""BLOCK_SELECT@54da32dc"",""pos"":{""lineNum"":7,""columnNum"":6,""endLineNum"":13,""endColumnNum"":55,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[""NS_IDENT@5bcde458.DRINKER2"",""NS_IDENT@5bcde458.DRINKER1""],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":5,""columnNum"":1,""endLineNum"":13,""endColumnNum"":56,""quoted"":false},""children"":{""BLOCK_SELECT@54da32dc"":{""id"":""BLOCK_SELECT@54da32dc"",""parentId"":""BLOCK_SELECT@4f20a5e0"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@319854f0"",""value"":""*"",""pos"":{""lineNum"":7,""columnNum"":13,""endLineNum"":7,""endColumnNum"":13,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@77bd7fe7""],""fromNode"":{""id"":""JOIN_OPERAND@4aac85fa"",""value"":""NS_IDENT@77bd7fe7"",""pos"":{""lineNum"":8,""columnNum"":10,""endLineNum"":8,""endColumnNum"":14,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@388b401d"",""value"":""AND"",""pos"":{""lineNum"":9,""columnNum"":11,""endLineNum"":13,""endColumnNum"":54,""quoted"":false},""children"":[{""id"":""OP_BINARY@566d0c69"",""value"":""="",""pos"":{""lineNum"":9,""columnNum"":11,""endLineNum"":9,""endColumnNum"":32,""quoted"":false},""children"":[{""id"":""COLUMN_CORRELATE@4af46df3"",""value"":""NS_IDENT@5bcde458.DRINKER1"",""pos"":{""lineNum"":9,""columnNum"":11,""endLineNum"":9,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6f667ad1"",""value"":""NS_IDENT@77bd7fe7.drinker"",""pos"":{""lineNum"":9,""columnNum"":24,""endLineNum"":9,""endColumnNum"":32,""quoted"":false},""children"":[]}]},{""id"":""OP_PREFIX@af78c87"",""value"":""NOT"",""pos"":{""lineNum"":10,""columnNum"":11,""endLineNum"":13,""endColumnNum"":54,""quoted"":false},""children"":[{""id"":""OP_PREFIX@773dab28"",""value"":""EXISTS"",""pos"":{""lineNum"":10,""columnNum"":15,""endLineNum"":13,""endColumnNum"":54,""quoted"":false},""children"":[{""id"":""BLOCK_SELECT@1d782abe"",""value"":""BLOCK_SELECT@1d782abe"",""pos"":{""lineNum"":11,""columnNum"":10,""endLineNum"":13,""endColumnNum"":54,""quoted"":false},""children"":[]}]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_CORRELATE@4af46df3"",""value"":""NS_IDENT@5bcde458.DRINKER1"",""pos"":{""lineNum"":9,""columnNum"":11,""endLineNum"":9,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@6f667ad1"",""value"":""NS_IDENT@77bd7fe7.drinker"",""pos"":{""lineNum"":9,""columnNum"":24,""endLineNum"":9,""endColumnNum"":32,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[""NS_IDENT@77bd7fe7.beer""],""corrTableIds"":[""NS_IDENT@5bcde458""],""corrCtxIds"":[""BLOCK_SELECT@4f20a5e0""],""pos"":{""lineNum"":7,""columnNum"":6,""endLineNum"":13,""endColumnNum"":55,""quoted"":false},""children"":{""BLOCK_SELECT@1d782abe"":{""id"":""BLOCK_SELECT@1d782abe"",""parentId"":""BLOCK_SELECT@54da32dc"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@2fc07784"",""value"":""*"",""pos"":{""lineNum"":11,""columnNum"":17,""endLineNum"":11,""endColumnNum"":17,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@71870da7""],""fromNode"":{""id"":""JOIN_OPERAND@66bfd864"",""value"":""NS_IDENT@71870da7"",""pos"":{""lineNum"":12,""columnNum"":14,""endLineNum"":12,""endColumnNum"":18,""quoted"":false},""children"":[]},""whereNode"":{""id"":""OP_BINARY@151335cb"",""value"":""AND"",""pos"":{""lineNum"":13,""columnNum"":17,""endLineNum"":13,""endColumnNum"":54,""quoted"":false},""children"":[{""id"":""OP_BINARY@4912d525"",""value"":""="",""pos"":{""lineNum"":13,""columnNum"":17,""endLineNum"":13,""endColumnNum"":29,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@2bcec6a6"",""value"":""NS_IDENT@71870da7.beer"",""pos"":{""lineNum"":13,""columnNum"":17,""endLineNum"":13,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@77a281fc"",""value"":""NS_IDENT@77bd7fe7.beer"",""pos"":{""lineNum"":13,""columnNum"":24,""endLineNum"":13,""endColumnNum"":29,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@765df79d"",""value"":""="",""pos"":{""lineNum"":13,""columnNum"":35,""endLineNum"":13,""endColumnNum"":54,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@2bfbffb2"",""value"":""NS_IDENT@71870da7.drinker"",""pos"":{""lineNum"":13,""columnNum"":35,""endLineNum"":13,""endColumnNum"":41,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@24097e9b"",""value"":""NS_IDENT@5bcde458.DRINKER2"",""pos"":{""lineNum"":13,""columnNum"":45,""endLineNum"":13,""endColumnNum"":54,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@2bcec6a6"",""value"":""NS_IDENT@71870da7.beer"",""pos"":{""lineNum"":13,""columnNum"":17,""endLineNum"":13,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@77a281fc"",""value"":""NS_IDENT@77bd7fe7.beer"",""pos"":{""lineNum"":13,""columnNum"":24,""endLineNum"":13,""endColumnNum"":29,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@2bfbffb2"",""value"":""NS_IDENT@71870da7.drinker"",""pos"":{""lineNum"":13,""columnNum"":35,""endLineNum"":13,""endColumnNum"":41,""quoted"":false},""children"":[]},{""id"":""COLUMN_CORRELATE@24097e9b"",""value"":""NS_IDENT@5bcde458.DRINKER2"",""pos"":{""lineNum"":13,""columnNum"":45,""endLineNum"":13,""endColumnNum"":54,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[""NS_IDENT@5bcde458"",""NS_IDENT@77bd7fe7""],""corrCtxIds"":[""BLOCK_SELECT@4f20a5e0"",""BLOCK_SELECT@54da32dc""],""pos"":{""lineNum"":11,""columnNum"":10,""endLineNum"":13,""endColumnNum"":54,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@5bcde458"":{""tableId"":""NS_IDENT@5bcde458"",""identifier"":""P"",""dbTableName"":""PAIRLIKES"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":5,""columnNum"":15,""endLineNum"":5,""endColumnNum"":25,""quoted"":false}},""NS_IDENT@173373b4"":{""tableId"":""NS_IDENT@173373b4"",""identifier"":""D2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":68,""endLineNum"":2,""endColumnNum"":80,""quoted"":false}},""NS_IDENT@71870da7"":{""tableId"":""NS_IDENT@71870da7"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":12,""columnNum"":14,""endLineNum"":12,""endColumnNum"":18,""quoted"":false}},""NS_IDENT@77bd7fe7"":{""tableId"":""NS_IDENT@77bd7fe7"",""identifier"":""L"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":8,""columnNum"":10,""endLineNum"":8,""endColumnNum"":16,""quoted"":false}},""NS_IDENT@60e5272"":{""tableId"":""NS_IDENT@60e5272"",""identifier"":""D1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":2,""columnNum"":54,""endLineNum"":2,""endColumnNum"":66,""quoted"":false}}},""corrTables"":[""NS_IDENT@5bcde458"",""NS_IDENT@77bd7fe7""],""withBlocks"":[{""id"":""BLOCK_SELECT@5c20ffa8"",""alias"":""PAIRLIKES"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@60dd3c23"",""value"":""NS_IDENT@60e5272.NAME"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":15,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@5e9456ae"",""value"":""NS_IDENT@173373b4.NAME"",""pos"":{""lineNum"":2,""columnNum"":29,""endLineNum"":2,""endColumnNum"":35,""quoted"":false},""children"":[],""alias"":""DRINKER2""}],""fromItemIds"":[""NS_IDENT@60e5272"",""NS_IDENT@173373b4""],""fromNode"":{""id"":""OP_JOIN@6bcbf05b"",""value"":""COMMA"",""pos"":{""lineNum"":2,""columnNum"":67,""endLineNum"":2,""endColumnNum"":67,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@59942b48"",""value"":""NS_IDENT@60e5272"",""pos"":{""lineNum"":2,""columnNum"":54,""endLineNum"":2,""endColumnNum"":60,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@f9b5552"",""value"":""NS_IDENT@173373b4"",""pos"":{""lineNum"":2,""columnNum"":68,""endLineNum"":2,""endColumnNum"":74,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@27b71f50"",""value"":""<>"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@5f404594"",""value"":""NS_IDENT@60e5272.name"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3a4ba480"",""value"":""NS_IDENT@173373b4.name"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@3a4ba480"",""value"":""NS_IDENT@173373b4.name"",""pos"":{""lineNum"":3,""columnNum"":18,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@5e9456ae"",""value"":""NS_IDENT@173373b4.NAME"",""pos"":{""lineNum"":2,""columnNum"":29,""endLineNum"":2,""endColumnNum"":35,""quoted"":false},""children"":[],""alias"":""DRINKER2""},{""id"":""COLUMN_LOCAL@60dd3c23"",""value"":""NS_IDENT@60e5272.NAME"",""pos"":{""lineNum"":2,""columnNum"":9,""endLineNum"":2,""endColumnNum"":15,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@5f404594"",""value"":""NS_IDENT@60e5272.name"",""pos"":{""lineNum"":3,""columnNum"":7,""endLineNum"":3,""endColumnNum"":13,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":2,""endLineNum"":3,""endColumnNum"":24,""quoted"":false},""children"":{}}]}
"
"WITH allpairs AS (SELECT d1.name, d2.name FROM drinker AS d1, drinker AS d2 WHERE d1.name <> d2.name),
hates AS ((SELECT drinker.name as drinker, beer.name as beer FROM drinker, beer) EXCEPT (SELECT * FROM likes)),
subtract AS (SELECT likes.drinker, hates.drinker FROM likes, hates WHERE likes.beer = hates.beer)

(SELECT * FROM allPairs)
EXCEPT ALL
(SELECT * FROM subtract)

","{""failed"":true,""errorMsg"":""From line 1, column 19 to line 1, column 100: Column has duplicate column name 'NAME' and no column list specified""}
"
"WITH temp1 AS (
SELECT d1.name AS drinker1, d2.name AS drinker2
FROM drinker d1, drinker d2
WHERE d1.name!=d2.name
), temp2 AS (
(SELECT p1.drinker1 AS secondDrinker1, p1.drinker2 AS secondDrinker2, l1.beer AS beerName
FROM temp1 p1, likes l1
WHERE p1.drinker1=l1.drinker)
EXCEPT
(SELECT p2.drinker1 AS secondDrinker1, p2.drinker2 AS secondDrinker2, l2.beer AS beerName
FROM temp1 p2, likes l2
WHERE p2.drinker2=l2.drinker))

SELECT drinker1, drinker2
FROM temp1
EXCEPT
(SELECT secondDrinker1, secondDrinker2
FROM temp2);","{""failed"":true,""errorMsg"":""Parsing error at line 4, column 14. Query syntax may be incorrect""}
"
"with dislikes as (select *
from ((select name as beer from beer) a cross join (select name as drinker from drinker) b) c
except (select beer, drinker from likes)
order by beer),

allLikes as (select d.name drinker, l.beer
from drinker d left join likes l on d.name = l.drinker
)

(select distinct a1.drinker drinker1, a2.drinker drinker2
from allLikes a1, allLikes a2
where a1.drinker <> a2.drinker)

except

(select distinct a1.drinker drinker1, a2.drinker drinker2
from allLikes a1, allLikes a2
where (a1.beer, a2.drinker) in (select * from dislikes))","{""failed"":true,""errorMsg"":""Parsing error at line 2, column 39. Query syntax may be incorrect""}
"
"with dl1 as
    (select d1.name drinker1, d2.name drinker2, beer
      from drinker d1, drinker d2, likes
        where d1.name <> d2.name and d1.name = drinker),
  dl2 as
    (select d1.name drinker1, d2.name drinker2, beer
      from drinker d1, drinker d2, likes
        where d1.name <> d2.name and d2.name = drinker),
  sp as
    (select drinker1, drinker2
      from ((select * from dl1) except (select * from dl2)) as P),
  ap as
    (select d1.name drinker1, d2.name drinker2
      from drinker d1, drinker d2
        where d1.name <> d2.name)
select drinker1, drinker2
  from ((select * from ap) except (select * from sp)) as T","{""blocks"":{""id"":""BLOCK_SELECT@78faea5f"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@7d37f1c"",""value"":""NS_SETOP@68dcfd52.DRINKER1"",""pos"":{""lineNum"":16,""columnNum"":8,""endLineNum"":16,""endColumnNum"":15,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@3162743f"",""value"":""NS_SETOP@68dcfd52.DRINKER2"",""pos"":{""lineNum"":16,""columnNum"":18,""endLineNum"":16,""endColumnNum"":25,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_SETOP@68dcfd52""],""fromNode"":{""id"":""JOIN_OPERAND@37fdfb05"",""value"":""BLOCK_SETOP@37fdfb05"",""pos"":{""lineNum"":17,""columnNum"":10,""endLineNum"":17,""endColumnNum"":51,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@3162743f"",""value"":""NS_SETOP@68dcfd52.DRINKER2"",""pos"":{""lineNum"":16,""columnNum"":18,""endLineNum"":16,""endColumnNum"":25,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@7d37f1c"",""value"":""NS_SETOP@68dcfd52.DRINKER1"",""pos"":{""lineNum"":16,""columnNum"":8,""endLineNum"":16,""endColumnNum"":15,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":16,""columnNum"":1,""endLineNum"":17,""endColumnNum"":58,""quoted"":false},""children"":{""BLOCK_SETOP@37fdfb05"":{""id"":""BLOCK_SETOP@37fdfb05"",""parentId"":""BLOCK_SELECT@78faea5f"",""alias"":""T"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@5e39850"",""rightBlockId"":""BLOCK_SELECT@398474a2"",""pos"":{""lineNum"":17,""columnNum"":10,""endLineNum"":17,""endColumnNum"":51,""quoted"":false},""children"":{""BLOCK_SELECT@5e39850"":{""id"":""BLOCK_SELECT@5e39850"",""parentId"":""BLOCK_SETOP@37fdfb05"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@5177e388"",""value"":""*"",""pos"":{""lineNum"":17,""columnNum"":17,""endLineNum"":17,""endColumnNum"":17,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@25b5c5e3""],""fromNode"":{""id"":""JOIN_OPERAND@1603dc2f"",""value"":""NS_IDENT@25b5c5e3"",""pos"":{""lineNum"":17,""columnNum"":24,""endLineNum"":17,""endColumnNum"":25,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":17,""columnNum"":10,""endLineNum"":17,""endColumnNum"":25,""quoted"":false},""children"":{}},""BLOCK_SELECT@398474a2"":{""id"":""BLOCK_SELECT@398474a2"",""parentId"":""BLOCK_SETOP@37fdfb05"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@cc239ba"",""value"":""*"",""pos"":{""lineNum"":17,""columnNum"":43,""endLineNum"":17,""endColumnNum"":43,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@37b72ea""],""fromNode"":{""id"":""JOIN_OPERAND@61799544"",""value"":""NS_IDENT@37b72ea"",""pos"":{""lineNum"":17,""columnNum"":50,""endLineNum"":17,""endColumnNum"":51,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":17,""columnNum"":36,""endLineNum"":17,""endColumnNum"":51,""quoted"":false},""children"":{}}}}}},""tables"":{""NS_IDENT@37b72ea"":{""tableId"":""NS_IDENT@37b72ea"",""identifier"":""SP"",""dbTableName"":""SP"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":17,""columnNum"":50,""endLineNum"":17,""endColumnNum"":51,""quoted"":false}},""NS_IDENT@3eee3e2b"":{""tableId"":""NS_IDENT@3eee3e2b"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":36,""endLineNum"":7,""endColumnNum"":40,""quoted"":false}},""NS_IDENT@25b5c5e3"":{""tableId"":""NS_IDENT@25b5c5e3"",""identifier"":""AP"",""dbTableName"":""AP"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":17,""columnNum"":24,""endLineNum"":17,""endColumnNum"":25,""quoted"":false}},""NS_IDENT@5b4d25e7"":{""tableId"":""NS_IDENT@5b4d25e7"",""identifier"":""DL2"",""dbTableName"":""DL2"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":11,""columnNum"":55,""endLineNum"":11,""endColumnNum"":57,""quoted"":false}},""NS_SETOP@5c748168"":{""tableId"":""NS_SETOP@5c748168"",""identifier"":""P"",""blockId"":""BLOCK_SETOP@3e850122"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":11,""columnNum"":14,""endLineNum"":11,""endColumnNum"":57,""quoted"":false}},""NS_IDENT@7772054c"":{""tableId"":""NS_IDENT@7772054c"",""identifier"":""D1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":14,""columnNum"":12,""endLineNum"":14,""endColumnNum"":21,""quoted"":false}},""NS_IDENT@4cbf4f53"":{""tableId"":""NS_IDENT@4cbf4f53"",""identifier"":""LIKES"",""dbTableName"":""LIKES"",""fields"":[""drinker VARCHAR(100)"",""beer VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":36,""endLineNum"":3,""endColumnNum"":40,""quoted"":false}},""NS_IDENT@b18c4"":{""tableId"":""NS_IDENT@b18c4"",""identifier"":""D2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":24,""endLineNum"":3,""endColumnNum"":33,""quoted"":false}},""NS_SETOP@68dcfd52"":{""tableId"":""NS_SETOP@68dcfd52"",""identifier"":""T"",""blockId"":""BLOCK_SETOP@37fdfb05"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":17,""columnNum"":10,""endLineNum"":17,""endColumnNum"":51,""quoted"":false}},""NS_IDENT@834831b"":{""tableId"":""NS_IDENT@834831b"",""identifier"":""DL1"",""dbTableName"":""DL1"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":11,""columnNum"":28,""endLineNum"":11,""endColumnNum"":30,""quoted"":false}},""NS_IDENT@108bdbd8"":{""tableId"":""NS_IDENT@108bdbd8"",""identifier"":""D1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":3,""columnNum"":12,""endLineNum"":3,""endColumnNum"":21,""quoted"":false}},""NS_IDENT@2f61f937"":{""tableId"":""NS_IDENT@2f61f937"",""identifier"":""D2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":14,""columnNum"":24,""endLineNum"":14,""endColumnNum"":33,""quoted"":false}},""NS_IDENT@7965a51c"":{""tableId"":""NS_IDENT@7965a51c"",""identifier"":""D2"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":24,""endLineNum"":7,""endColumnNum"":33,""quoted"":false}},""NS_IDENT@486bc9a4"":{""tableId"":""NS_IDENT@486bc9a4"",""identifier"":""D1"",""dbTableName"":""DRINKER"",""fields"":[""name VARCHAR(100)"",""address VARCHAR(100)""],""cursor"":[0],""pos"":{""lineNum"":7,""columnNum"":12,""endLineNum"":7,""endColumnNum"":21,""quoted"":false}}},""corrTables"":[],""withBlocks"":[{""id"":""BLOCK_SELECT@4bff2185"",""alias"":""DL1"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@15dd5ac2"",""value"":""NS_IDENT@108bdbd8.NAME"",""pos"":{""lineNum"":2,""columnNum"":13,""endLineNum"":2,""endColumnNum"":19,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@7bbbb6a8"",""value"":""NS_IDENT@b18c4.NAME"",""pos"":{""lineNum"":2,""columnNum"":31,""endLineNum"":2,""endColumnNum"":37,""quoted"":false},""children"":[],""alias"":""DRINKER2""},{""id"":""COLUMN_LOCAL@27d57a2c"",""value"":""NS_IDENT@4cbf4f53.BEER"",""pos"":{""lineNum"":2,""columnNum"":49,""endLineNum"":2,""endColumnNum"":52,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@108bdbd8"",""NS_IDENT@b18c4"",""NS_IDENT@4cbf4f53""],""fromNode"":{""id"":""OP_JOIN@458544e0"",""value"":""COMMA"",""pos"":{""lineNum"":3,""columnNum"":34,""endLineNum"":3,""endColumnNum"":34,""quoted"":false},""children"":[{""id"":""OP_JOIN@6bcbf05b"",""value"":""COMMA"",""pos"":{""lineNum"":3,""columnNum"":22,""endLineNum"":3,""endColumnNum"":22,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@59942b48"",""value"":""NS_IDENT@108bdbd8"",""pos"":{""lineNum"":3,""columnNum"":12,""endLineNum"":3,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@f9b5552"",""value"":""NS_IDENT@b18c4"",""pos"":{""lineNum"":3,""columnNum"":24,""endLineNum"":3,""endColumnNum"":30,""quoted"":false},""children"":[]}],""natural"":false},{""id"":""JOIN_OPERAND@4f20a5e0"",""value"":""NS_IDENT@4cbf4f53"",""pos"":{""lineNum"":3,""columnNum"":36,""endLineNum"":3,""endColumnNum"":40,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@773e2eb5"",""value"":""AND"",""pos"":{""lineNum"":4,""columnNum"":15,""endLineNum"":4,""endColumnNum"":54,""quoted"":false},""children"":[{""id"":""OP_BINARY@6b760460"",""value"":""<>"",""pos"":{""lineNum"":4,""columnNum"":15,""endLineNum"":4,""endColumnNum"":32,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4349754"",""value"":""NS_IDENT@108bdbd8.name"",""pos"":{""lineNum"":4,""columnNum"":15,""endLineNum"":4,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@723ed581"",""value"":""NS_IDENT@b18c4.name"",""pos"":{""lineNum"":4,""columnNum"":26,""endLineNum"":4,""endColumnNum"":32,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@2c306a57"",""value"":""="",""pos"":{""lineNum"":4,""columnNum"":38,""endLineNum"":4,""endColumnNum"":54,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@796065aa"",""value"":""NS_IDENT@108bdbd8.name"",""pos"":{""lineNum"":4,""columnNum"":38,""endLineNum"":4,""endColumnNum"":44,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@28a6301f"",""value"":""NS_IDENT@4cbf4f53.drinker"",""pos"":{""lineNum"":4,""columnNum"":48,""endLineNum"":4,""endColumnNum"":54,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@7bbbb6a8"",""value"":""NS_IDENT@b18c4.NAME"",""pos"":{""lineNum"":2,""columnNum"":31,""endLineNum"":2,""endColumnNum"":37,""quoted"":false},""children"":[],""alias"":""DRINKER2""},{""id"":""COLUMN_LOCAL@796065aa"",""value"":""NS_IDENT@108bdbd8.name"",""pos"":{""lineNum"":4,""columnNum"":38,""endLineNum"":4,""endColumnNum"":44,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4349754"",""value"":""NS_IDENT@108bdbd8.name"",""pos"":{""lineNum"":4,""columnNum"":15,""endLineNum"":4,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@723ed581"",""value"":""NS_IDENT@b18c4.name"",""pos"":{""lineNum"":4,""columnNum"":26,""endLineNum"":4,""endColumnNum"":32,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@15dd5ac2"",""value"":""NS_IDENT@108bdbd8.NAME"",""pos"":{""lineNum"":2,""columnNum"":13,""endLineNum"":2,""endColumnNum"":19,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@28a6301f"",""value"":""NS_IDENT@4cbf4f53.drinker"",""pos"":{""lineNum"":4,""columnNum"":48,""endLineNum"":4,""endColumnNum"":54,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@27d57a2c"",""value"":""NS_IDENT@4cbf4f53.BEER"",""pos"":{""lineNum"":2,""columnNum"":49,""endLineNum"":2,""endColumnNum"":52,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":2,""columnNum"":6,""endLineNum"":4,""endColumnNum"":54,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@1917d90f"",""alias"":""DL2"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@4f63e3c7"",""value"":""NS_IDENT@486bc9a4.NAME"",""pos"":{""lineNum"":6,""columnNum"":13,""endLineNum"":6,""endColumnNum"":19,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@dca2615"",""value"":""NS_IDENT@7965a51c.NAME"",""pos"":{""lineNum"":6,""columnNum"":31,""endLineNum"":6,""endColumnNum"":37,""quoted"":false},""children"":[],""alias"":""DRINKER2""},{""id"":""COLUMN_LOCAL@1237e0be"",""value"":""NS_IDENT@3eee3e2b.BEER"",""pos"":{""lineNum"":6,""columnNum"":49,""endLineNum"":6,""endColumnNum"":52,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@486bc9a4"",""NS_IDENT@7965a51c"",""NS_IDENT@3eee3e2b""],""fromNode"":{""id"":""OP_JOIN@66bfd864"",""value"":""COMMA"",""pos"":{""lineNum"":7,""columnNum"":34,""endLineNum"":7,""endColumnNum"":34,""quoted"":false},""children"":[{""id"":""OP_JOIN@4aac85fa"",""value"":""COMMA"",""pos"":{""lineNum"":7,""columnNum"":22,""endLineNum"":7,""endColumnNum"":22,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@21fff664"",""value"":""NS_IDENT@486bc9a4"",""pos"":{""lineNum"":7,""columnNum"":12,""endLineNum"":7,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@6079cf5"",""value"":""NS_IDENT@7965a51c"",""pos"":{""lineNum"":7,""columnNum"":24,""endLineNum"":7,""endColumnNum"":30,""quoted"":false},""children"":[]}],""natural"":false},{""id"":""JOIN_OPERAND@1e6308a9"",""value"":""NS_IDENT@3eee3e2b"",""pos"":{""lineNum"":7,""columnNum"":36,""endLineNum"":7,""endColumnNum"":40,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@74ad8d05"",""value"":""AND"",""pos"":{""lineNum"":8,""columnNum"":15,""endLineNum"":8,""endColumnNum"":54,""quoted"":false},""children"":[{""id"":""OP_BINARY@40368a46"",""value"":""<>"",""pos"":{""lineNum"":8,""columnNum"":15,""endLineNum"":8,""endColumnNum"":32,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@4dafba3e"",""value"":""NS_IDENT@486bc9a4.name"",""pos"":{""lineNum"":8,""columnNum"":15,""endLineNum"":8,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@53e3a87a"",""value"":""NS_IDENT@7965a51c.name"",""pos"":{""lineNum"":8,""columnNum"":26,""endLineNum"":8,""endColumnNum"":32,""quoted"":false},""children"":[]}]},{""id"":""OP_BINARY@3d43fe"",""value"":""="",""pos"":{""lineNum"":8,""columnNum"":38,""endLineNum"":8,""endColumnNum"":54,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@7e9da981"",""value"":""NS_IDENT@7965a51c.name"",""pos"":{""lineNum"":8,""columnNum"":38,""endLineNum"":8,""endColumnNum"":44,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4ed38226"",""value"":""NS_IDENT@3eee3e2b.drinker"",""pos"":{""lineNum"":8,""columnNum"":48,""endLineNum"":8,""endColumnNum"":54,""quoted"":false},""children"":[]}]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@1237e0be"",""value"":""NS_IDENT@3eee3e2b.BEER"",""pos"":{""lineNum"":6,""columnNum"":49,""endLineNum"":6,""endColumnNum"":52,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4ed38226"",""value"":""NS_IDENT@3eee3e2b.drinker"",""pos"":{""lineNum"":8,""columnNum"":48,""endLineNum"":8,""endColumnNum"":54,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4f63e3c7"",""value"":""NS_IDENT@486bc9a4.NAME"",""pos"":{""lineNum"":6,""columnNum"":13,""endLineNum"":6,""endColumnNum"":19,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@53e3a87a"",""value"":""NS_IDENT@7965a51c.name"",""pos"":{""lineNum"":8,""columnNum"":26,""endLineNum"":8,""endColumnNum"":32,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@4dafba3e"",""value"":""NS_IDENT@486bc9a4.name"",""pos"":{""lineNum"":8,""columnNum"":15,""endLineNum"":8,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@dca2615"",""value"":""NS_IDENT@7965a51c.NAME"",""pos"":{""lineNum"":6,""columnNum"":31,""endLineNum"":6,""endColumnNum"":37,""quoted"":false},""children"":[],""alias"":""DRINKER2""},{""id"":""COLUMN_LOCAL@7e9da981"",""value"":""NS_IDENT@7965a51c.name"",""pos"":{""lineNum"":8,""columnNum"":38,""endLineNum"":8,""endColumnNum"":44,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":6,""columnNum"":6,""endLineNum"":8,""endColumnNum"":54,""quoted"":false},""children"":{}},{""id"":""BLOCK_SELECT@6edc4161"",""alias"":""SP"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@1dc2de84"",""value"":""NS_SETOP@5c748168.DRINKER1"",""pos"":{""lineNum"":10,""columnNum"":13,""endLineNum"":10,""endColumnNum"":20,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@58d63b16"",""value"":""NS_SETOP@5c748168.DRINKER2"",""pos"":{""lineNum"":10,""columnNum"":23,""endLineNum"":10,""endColumnNum"":30,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_SETOP@5c748168""],""fromNode"":{""id"":""JOIN_OPERAND@3e850122"",""value"":""BLOCK_SETOP@3e850122"",""pos"":{""lineNum"":11,""columnNum"":14,""endLineNum"":11,""endColumnNum"":57,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@58d63b16"",""value"":""NS_SETOP@5c748168.DRINKER2"",""pos"":{""lineNum"":10,""columnNum"":23,""endLineNum"":10,""endColumnNum"":30,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@1dc2de84"",""value"":""NS_SETOP@5c748168.DRINKER1"",""pos"":{""lineNum"":10,""columnNum"":13,""endLineNum"":10,""endColumnNum"":20,""quoted"":false},""children"":[]}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":10,""columnNum"":6,""endLineNum"":11,""endColumnNum"":64,""quoted"":false},""children"":{""BLOCK_SETOP@3e850122"":{""id"":""BLOCK_SETOP@3e850122"",""parentId"":""BLOCK_SELECT@6edc4161"",""alias"":""P"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""opName"":""EXCEPT"",""all"":false,""leftBlockId"":""BLOCK_SELECT@27fde870"",""rightBlockId"":""BLOCK_SELECT@5ac7aa18"",""pos"":{""lineNum"":11,""columnNum"":14,""endLineNum"":11,""endColumnNum"":57,""quoted"":false},""children"":{""BLOCK_SELECT@27fde870"":{""id"":""BLOCK_SELECT@27fde870"",""parentId"":""BLOCK_SETOP@3e850122"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@234a8f27"",""value"":""*"",""pos"":{""lineNum"":11,""columnNum"":21,""endLineNum"":11,""endColumnNum"":21,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@834831b""],""fromNode"":{""id"":""JOIN_OPERAND@2b4c3c29"",""value"":""NS_IDENT@834831b"",""pos"":{""lineNum"":11,""columnNum"":28,""endLineNum"":11,""endColumnNum"":30,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":11,""columnNum"":14,""endLineNum"":11,""endColumnNum"":30,""quoted"":false},""children"":{}},""BLOCK_SELECT@5ac7aa18"":{""id"":""BLOCK_SELECT@5ac7aa18"",""parentId"":""BLOCK_SETOP@3e850122"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)"",""BEER VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_STAR@31c2affc"",""value"":""*"",""pos"":{""lineNum"":11,""columnNum"":48,""endLineNum"":11,""endColumnNum"":48,""quoted"":false},""children"":[]}],""fromItemIds"":[""NS_IDENT@5b4d25e7""],""fromNode"":{""id"":""JOIN_OPERAND@4cdd2c73"",""value"":""NS_IDENT@5b4d25e7"",""pos"":{""lineNum"":11,""columnNum"":55,""endLineNum"":11,""endColumnNum"":57,""quoted"":false},""children"":[]},""isAggregate"":false,""identifiers"":[],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":11,""columnNum"":41,""endLineNum"":11,""endColumnNum"":57,""quoted"":false},""children"":{}}}}}},{""id"":""BLOCK_SELECT@4e4c3a38"",""alias"":""AP"",""fields"":[""DRINKER1 VARCHAR(100)"",""DRINKER2 VARCHAR(100)""],""isDistinct"":false,""selectList"":[{""id"":""COLUMN_LOCAL@46866946"",""value"":""NS_IDENT@7772054c.NAME"",""pos"":{""lineNum"":13,""columnNum"":13,""endLineNum"":13,""endColumnNum"":19,""quoted"":false},""children"":[],""alias"":""DRINKER1""},{""id"":""COLUMN_LOCAL@236134a1"",""value"":""NS_IDENT@2f61f937.NAME"",""pos"":{""lineNum"":13,""columnNum"":31,""endLineNum"":13,""endColumnNum"":37,""quoted"":false},""children"":[],""alias"":""DRINKER2""}],""fromItemIds"":[""NS_IDENT@7772054c"",""NS_IDENT@2f61f937""],""fromNode"":{""id"":""OP_JOIN@293cde83"",""value"":""COMMA"",""pos"":{""lineNum"":14,""columnNum"":22,""endLineNum"":14,""endColumnNum"":22,""quoted"":false},""children"":[{""id"":""JOIN_OPERAND@c27d163"",""value"":""NS_IDENT@7772054c"",""pos"":{""lineNum"":14,""columnNum"":12,""endLineNum"":14,""endColumnNum"":18,""quoted"":false},""children"":[]},{""id"":""JOIN_OPERAND@57c88764"",""value"":""NS_IDENT@2f61f937"",""pos"":{""lineNum"":14,""columnNum"":24,""endLineNum"":14,""endColumnNum"":30,""quoted"":false},""children"":[]}],""natural"":false},""whereNode"":{""id"":""OP_BINARY@3350ebdd"",""value"":""<>"",""pos"":{""lineNum"":15,""columnNum"":15,""endLineNum"":15,""endColumnNum"":32,""quoted"":false},""children"":[{""id"":""COLUMN_LOCAL@253b380a"",""value"":""NS_IDENT@7772054c.name"",""pos"":{""lineNum"":15,""columnNum"":15,""endLineNum"":15,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@29c2c826"",""value"":""NS_IDENT@2f61f937.name"",""pos"":{""lineNum"":15,""columnNum"":26,""endLineNum"":15,""endColumnNum"":32,""quoted"":false},""children"":[]}]},""isAggregate"":false,""identifiers"":[{""id"":""COLUMN_LOCAL@236134a1"",""value"":""NS_IDENT@2f61f937.NAME"",""pos"":{""lineNum"":13,""columnNum"":31,""endLineNum"":13,""endColumnNum"":37,""quoted"":false},""children"":[],""alias"":""DRINKER2""},{""id"":""COLUMN_LOCAL@253b380a"",""value"":""NS_IDENT@7772054c.name"",""pos"":{""lineNum"":15,""columnNum"":15,""endLineNum"":15,""endColumnNum"":21,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@29c2c826"",""value"":""NS_IDENT@2f61f937.name"",""pos"":{""lineNum"":15,""columnNum"":26,""endLineNum"":15,""endColumnNum"":32,""quoted"":false},""children"":[]},{""id"":""COLUMN_LOCAL@46866946"",""value"":""NS_IDENT@7772054c.NAME"",""pos"":{""lineNum"":13,""columnNum"":13,""endLineNum"":13,""endColumnNum"":19,""quoted"":false},""children"":[],""alias"":""DRINKER1""}],""incomingIdentifiers"":[],""corrTableIds"":[],""corrCtxIds"":[],""pos"":{""lineNum"":13,""columnNum"":6,""endLineNum"":15,""endColumnNum"":32,""quoted"":false},""children"":{}}]}
"
